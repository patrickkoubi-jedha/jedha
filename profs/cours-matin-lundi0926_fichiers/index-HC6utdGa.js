var WQ=Object.defineProperty;var KQ=(e,t,n)=>t in e?WQ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var B=(e,t,n)=>(KQ(e,typeof t!="symbol"?t+"":t,n),n);import{aA as Hl,bC as Ue,aC as ll,bD as ZQ}from"./mermaid-to-excalidraw-C2eqzxpF.js";function qQ(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in e)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();var eO={exports:{}},py={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QQ=Symbol.for("react.transitional.element"),JQ=Symbol.for("react.fragment");function tO(e,t,n){var i=null;if(n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),"key"in t){n={};for(var s in t)s!=="key"&&(n[s]=t[s])}else n=t;return t=n.ref,{$$typeof:QQ,type:e,key:i,ref:t!==void 0?t:null,props:n}}py.Fragment=JQ;py.jsx=tO;py.jsxs=tO;eO.exports=py;var Tw=eO.exports;const fe=Tw.Fragment,g=Tw.jsx,P=Tw.jsxs;var nO={exports:{}},it={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iw=Symbol.for("react.transitional.element"),eJ=Symbol.for("react.portal"),tJ=Symbol.for("react.fragment"),nJ=Symbol.for("react.strict_mode"),iJ=Symbol.for("react.profiler"),sJ=Symbol.for("react.consumer"),rJ=Symbol.for("react.context"),oJ=Symbol.for("react.forward_ref"),aJ=Symbol.for("react.suspense"),lJ=Symbol.for("react.memo"),iO=Symbol.for("react.lazy"),Ex=Symbol.iterator;function cJ(e){return e===null||typeof e!="object"?null:(e=Ex&&e[Ex]||e["@@iterator"],typeof e=="function"?e:null)}var sO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rO=Object.assign,oO={};function Ng(e,t,n){this.props=e,this.context=t,this.refs=oO,this.updater=n||sO}Ng.prototype.isReactComponent={};Ng.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ng.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function aO(){}aO.prototype=Ng.prototype;function Sw(e,t,n){this.props=e,this.context=t,this.refs=oO,this.updater=n||sO}var Cw=Sw.prototype=new aO;Cw.constructor=Sw;rO(Cw,Ng.prototype);Cw.isPureReactComponent=!0;var vx=Array.isArray,vn={H:null,A:null,T:null,S:null},lO=Object.prototype.hasOwnProperty;function xw(e,t,n,i,s,r){return n=r.ref,{$$typeof:Iw,type:e,key:t,ref:n!==void 0?n:null,props:r}}function dJ(e,t){return xw(e.type,t,void 0,void 0,void 0,e.props)}function Aw(e){return typeof e=="object"&&e!==null&&e.$$typeof===Iw}function uJ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var _x=/\/+/g;function P8(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uJ(""+e.key):t.toString(36)}function wx(){}function fJ(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(wx,wx):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Nf(e,t,n,i,s){var r=typeof e;(r==="undefined"||r==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(r){case"bigint":case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Iw:case eJ:o=!0;break;case iO:return o=e._init,Nf(o(e._payload),t,n,i,s)}}if(o)return s=s(e),o=i===""?"."+P8(e,0):i,vx(s)?(n="",o!=null&&(n=o.replace(_x,"$&/")+"/"),Nf(s,t,n,"",function(c){return c})):s!=null&&(Aw(s)&&(s=dJ(s,n+(s.key==null||e&&e.key===s.key?"":(""+s.key).replace(_x,"$&/")+"/")+o)),t.push(s)),1;o=0;var a=i===""?".":i+":";if(vx(e))for(var l=0;l<e.length;l++)i=e[l],r=a+P8(i,l),o+=Nf(i,t,n,r,s);else if(l=cJ(e),typeof l=="function")for(e=l.call(e),l=0;!(i=e.next()).done;)i=i.value,r=a+P8(i,l++),o+=Nf(i,t,n,r,s);else if(r==="object"){if(typeof e.then=="function")return Nf(fJ(e),t,n,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return o}function q2(e,t,n){if(e==null)return e;var i=[],s=0;return Nf(e,i,"","",function(r){return t.call(n,r,s++)}),i}function hJ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tx=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function gJ(){}it.Children={map:q2,forEach:function(e,t,n){q2(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return q2(e,function(){t++}),t},toArray:function(e){return q2(e,function(t){return t})||[]},only:function(e){if(!Aw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};it.Component=Ng;it.Fragment=tJ;it.Profiler=iJ;it.PureComponent=Sw;it.StrictMode=nJ;it.Suspense=aJ;it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=vn;it.act=function(){throw Error("act(...) is not supported in production builds of React.")};it.cache=function(e){return function(){return e.apply(null,arguments)}};it.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var i=rO({},e.props),s=e.key,r=void 0;if(t!=null)for(o in t.ref!==void 0&&(r=void 0),t.key!==void 0&&(s=""+t.key),t)!lO.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(i[o]=t[o]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}return xw(e.type,s,void 0,void 0,r,i)};it.createContext=function(e){return e={$$typeof:rJ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:sJ,_context:e},e};it.createElement=function(e,t,n){var i,s={},r=null;if(t!=null)for(i in t.key!==void 0&&(r=""+t.key),t)lO.call(t,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(s[i]=t[i]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];s.children=a}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)s[i]===void 0&&(s[i]=o[i]);return xw(e,r,void 0,void 0,null,s)};it.createRef=function(){return{current:null}};it.forwardRef=function(e){return{$$typeof:oJ,render:e}};it.isValidElement=Aw;it.lazy=function(e){return{$$typeof:iO,_payload:{_status:-1,_result:e},_init:hJ}};it.memo=function(e,t){return{$$typeof:lJ,type:e,compare:t===void 0?null:t}};it.startTransition=function(e){var t=vn.T,n={};vn.T=n;try{var i=e(),s=vn.S;s!==null&&s(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(gJ,Tx)}catch(r){Tx(r)}finally{vn.T=t}};it.unstable_useCacheRefresh=function(){return vn.H.useCacheRefresh()};it.use=function(e){return vn.H.use(e)};it.useActionState=function(e,t,n){return vn.H.useActionState(e,t,n)};it.useCallback=function(e,t){return vn.H.useCallback(e,t)};it.useContext=function(e){return vn.H.useContext(e)};it.useDebugValue=function(){};it.useDeferredValue=function(e,t){return vn.H.useDeferredValue(e,t)};it.useEffect=function(e,t){return vn.H.useEffect(e,t)};it.useId=function(){return vn.H.useId()};it.useImperativeHandle=function(e,t,n){return vn.H.useImperativeHandle(e,t,n)};it.useInsertionEffect=function(e,t){return vn.H.useInsertionEffect(e,t)};it.useLayoutEffect=function(e,t){return vn.H.useLayoutEffect(e,t)};it.useMemo=function(e,t){return vn.H.useMemo(e,t)};it.useOptimistic=function(e,t){return vn.H.useOptimistic(e,t)};it.useReducer=function(e,t,n){return vn.H.useReducer(e,t,n)};it.useRef=function(e){return vn.H.useRef(e)};it.useState=function(e){return vn.H.useState(e)};it.useSyncExternalStore=function(e,t,n){return vn.H.useSyncExternalStore(e,t,n)};it.useTransition=function(){return vn.H.useTransition()};it.version="19.0.0";nO.exports=it;var C=nO.exports;const de=Hl(C),cO=qQ({__proto__:null,default:de},[C]);var dO={exports:{}},Uy={},uO={exports:{}},fO={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,O){var z=G.length;G.push(O);e:for(;0<z;){var H=z-1>>>1,X=G[H];if(0<s(X,O))G[H]=O,G[z]=X,z=H;else break e}}function n(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var O=G[0],z=G.pop();if(z!==O){G[0]=z;e:for(var H=0,X=G.length,Q=X>>>1;H<Q;){var re=2*(H+1)-1,ie=G[re],me=re+1,ke=G[me];if(0>s(ie,z))me<X&&0>s(ke,ie)?(G[H]=ke,G[me]=z,H=me):(G[H]=ie,G[re]=z,H=re);else if(me<X&&0>s(ke,z))G[H]=ke,G[me]=z,H=me;else break e}}return O}function s(G,O){var z=G.sortIndex-O.sortIndex;return z!==0?z:G.id-O.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;e.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,u=null,f=3,h=!1,m=!1,p=!1,U=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function E(G){for(var O=n(c);O!==null;){if(O.callback===null)i(c);else if(O.startTime<=G)i(c),O.sortIndex=O.expirationTime,t(l,O);else break;O=n(c)}}function _(G){if(p=!1,E(G),!m)if(n(l)!==null)m=!0,j();else{var O=n(c);O!==null&&Y(_,O.startTime-G)}}var I=!1,k=-1,w=5,T=-1;function A(){return!(e.unstable_now()-T<w)}function S(){if(I){var G=e.unstable_now();T=G;var O=!0;try{e:{m=!1,p&&(p=!1,b(k),k=-1),h=!0;var z=f;try{t:{for(E(G),u=n(l);u!==null&&!(u.expirationTime>G&&A());){var H=u.callback;if(typeof H=="function"){u.callback=null,f=u.priorityLevel;var X=H(u.expirationTime<=G);if(G=e.unstable_now(),typeof X=="function"){u.callback=X,E(G),O=!0;break t}u===n(l)&&i(l),E(G)}else i(l);u=n(l)}if(u!==null)O=!0;else{var Q=n(c);Q!==null&&Y(_,Q.startTime-G),O=!1}}break e}finally{u=null,f=z,h=!1}O=void 0}}finally{O?D():I=!1}}}var D;if(typeof y=="function")D=function(){y(S)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,L=N.port2;N.port1.onmessage=S,D=function(){L.postMessage(null)}}else D=function(){U(S,0)};function j(){I||(I=!0,D())}function Y(G,O){k=U(function(){G(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,j())},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(G){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var z=f;f=O;try{return G()}finally{f=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,O){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var z=f;f=G;try{return O()}finally{f=z}},e.unstable_scheduleCallback=function(G,O,z){var H=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?H+z:H):z=H,G){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=z+X,G={id:d++,callback:O,priorityLevel:G,startTime:z,expirationTime:X,sortIndex:-1},z>H?(G.sortIndex=z,t(c,G),n(l)===null&&G===n(c)&&(p?(b(k),k=-1):p=!0,Y(_,z-H))):(G.sortIndex=X,t(l,G),m||h||(m=!0,j())),G},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(G){var O=f;return function(){var z=f;f=O;try{return G.apply(this,arguments)}finally{f=z}}}})(fO);uO.exports=fO;var mJ=uO.exports,hO={exports:{}},Ms={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pJ=C;function gO(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ql(){}var Ts={d:{f:ql,r:function(){throw Error(gO(522))},D:ql,C:ql,L:ql,m:ql,X:ql,S:ql,M:ql},p:0,findDOMNode:null},UJ=Symbol.for("react.portal");function bJ(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:UJ,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}var M1=pJ.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function by(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}Ms.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ts;Ms.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(gO(299));return bJ(e,t,null,n)};Ms.flushSync=function(e){var t=M1.T,n=Ts.p;try{if(M1.T=null,Ts.p=2,e)return e()}finally{M1.T=t,Ts.p=n,Ts.d.f()}};Ms.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,Ts.d.C(e,t))};Ms.prefetchDNS=function(e){typeof e=="string"&&Ts.d.D(e)};Ms.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,i=by(n,t.crossOrigin),s=typeof t.integrity=="string"?t.integrity:void 0,r=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?Ts.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:i,integrity:s,fetchPriority:r}):n==="script"&&Ts.d.X(e,{crossOrigin:i,integrity:s,fetchPriority:r,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};Ms.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=by(t.as,t.crossOrigin);Ts.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&Ts.d.M(e)};Ms.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,i=by(n,t.crossOrigin);Ts.d.L(e,n,{crossOrigin:i,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};Ms.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=by(t.as,t.crossOrigin);Ts.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else Ts.d.m(e)};Ms.requestFormReset=function(e){Ts.d.r(e)};Ms.unstable_batchedUpdates=function(e,t){return e(t)};Ms.useFormState=function(e,t,n){return M1.H.useFormState(e,t,n)};Ms.useFormStatus=function(){return M1.H.useHostTransitionStatus()};Ms.version="19.0.0";function mO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mO)}catch(e){console.error(e)}}mO(),hO.exports=Ms;var tn=hO.exports;const yJ=Hl(tn);/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bi=mJ,pO=C,EJ=tn;function se(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function UO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var vJ=Symbol.for("react.element"),Q2=Symbol.for("react.transitional.element"),i1=Symbol.for("react.portal"),Kf=Symbol.for("react.fragment"),bO=Symbol.for("react.strict_mode"),gv=Symbol.for("react.profiler"),_J=Symbol.for("react.provider"),yO=Symbol.for("react.consumer"),cl=Symbol.for("react.context"),Mw=Symbol.for("react.forward_ref"),mv=Symbol.for("react.suspense"),pv=Symbol.for("react.suspense_list"),kw=Symbol.for("react.memo"),ac=Symbol.for("react.lazy"),EO=Symbol.for("react.offscreen"),wJ=Symbol.for("react.memo_cache_sentinel"),Ix=Symbol.iterator;function Tm(e){return e===null||typeof e!="object"?null:(e=Ix&&e[Ix]||e["@@iterator"],typeof e=="function"?e:null)}var TJ=Symbol.for("react.client.reference");function Uv(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===TJ?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kf:return"Fragment";case i1:return"Portal";case gv:return"Profiler";case bO:return"StrictMode";case mv:return"Suspense";case pv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cl:return(e.displayName||"Context")+".Provider";case yO:return(e._context.displayName||"Context")+".Consumer";case Mw:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kw:return t=e.displayName||null,t!==null?t:Uv(e.type)||"Memo";case ac:t=e._payload,e=e._init;try{return Uv(e(t))}catch{}}return null}var nt=pO.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,un=Object.assign,N8,Sx;function s1(e){if(N8===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N8=t&&t[1]||"",Sx=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+N8+e+Sx}var O8=!1;function F8(e,t){if(!e||O8)return"";O8=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var u=function(){throw Error()};if(Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(h){var f=h}Reflect.construct(e,[],u)}else{try{u.call()}catch(h){f=h}e.call(u.prototype)}}else{try{throw Error()}catch(h){f=h}(u=e())&&typeof u.catch=="function"&&u.catch(function(){})}}catch(h){if(h&&f&&typeof h.stack=="string")return[h.stack,f.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=i.DetermineComponentFrameRoot(),o=r[0],a=r[1];if(o&&a){var l=o.split(`
`),c=a.split(`
`);for(s=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(i===l.length||s===c.length)for(i=l.length-1,s=c.length-1;1<=i&&0<=s&&l[i]!==c[s];)s--;for(;1<=i&&0<=s;i--,s--)if(l[i]!==c[s]){if(i!==1||s!==1)do if(i--,s--,0>s||l[i]!==c[s]){var d=`
`+l[i].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=i&&0<=s);break}}}finally{O8=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?s1(n):""}function IJ(e){switch(e.tag){case 26:case 27:case 5:return s1(e.type);case 16:return s1("Lazy");case 13:return s1("Suspense");case 19:return s1("SuspenseList");case 0:case 15:return e=F8(e.type,!1),e;case 11:return e=F8(e.type.render,!1),e;case 1:return e=F8(e.type,!0),e;default:return""}}function Cx(e){try{var t="";do t+=IJ(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Og(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function vO(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function xx(e){if(Og(e)!==e)throw Error(se(188))}function SJ(e){var t=e.alternate;if(!t){if(t=Og(e),t===null)throw Error(se(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){n=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===n)return xx(s),e;if(r===i)return xx(s),t;r=r.sibling}throw Error(se(188))}if(n.return!==i.return)n=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==i)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?e:t}function _O(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=_O(e),t!==null)return t;e=e.sibling}return null}var r1=Array.isArray,dn=EJ.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,du={pending:!1,data:null,method:null,action:null},bv=[],Zf=-1;function Ra(e){return{current:e}}function Ri(e){0>Zf||(e.current=bv[Zf],bv[Zf]=null,Zf--)}function Un(e,t){Zf++,bv[Zf]=e.current,e.current=t}var la=Ra(null),E0=Ra(null),Mc=Ra(null),Qb=Ra(null);function Jb(e,t){switch(Un(Mc,t),Un(E0,e),Un(la,null),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?AA(t):0;break;default:if(e=e===8?t.parentNode:t,t=e.tagName,e=e.namespaceURI)e=AA(e),t=LB(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Ri(la),Un(la,t)}function jh(){Ri(la),Ri(E0),Ri(Mc)}function yv(e){e.memoizedState!==null&&Un(Qb,e);var t=la.current,n=LB(t,e.type);t!==n&&(Un(E0,e),Un(la,n))}function e6(e){E0.current===e&&(Ri(la),Ri(E0)),Qb.current===e&&(Ri(Qb),k0._currentValue=du)}var Ev=Object.prototype.hasOwnProperty,Rw=bi.unstable_scheduleCallback,B8=bi.unstable_cancelCallback,CJ=bi.unstable_shouldYield,xJ=bi.unstable_requestPaint,ca=bi.unstable_now,AJ=bi.unstable_getCurrentPriorityLevel,wO=bi.unstable_ImmediatePriority,TO=bi.unstable_UserBlockingPriority,t6=bi.unstable_NormalPriority,MJ=bi.unstable_LowPriority,IO=bi.unstable_IdlePriority,kJ=bi.log,RJ=bi.unstable_setDisableYieldValue,Mp=null,gr=null;function DJ(e){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Mp,e,void 0,(e.current.flags&128)===128)}catch{}}function _c(e){if(typeof kJ=="function"&&RJ(e),gr&&typeof gr.setStrictMode=="function")try{gr.setStrictMode(Mp,e)}catch{}}var mr=Math.clz32?Math.clz32:NJ,LJ=Math.log,PJ=Math.LN2;function NJ(e){return e>>>=0,e===0?32:31-(LJ(e)/PJ|0)|0}var J2=128,eU=4194304;function Vd(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function yy(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,s=e.suspendedLanes,r=e.pingedLanes,o=e.warmLanes;e=e.finishedLanes!==0;var a=n&134217727;return a!==0?(n=a&~s,n!==0?i=Vd(n):(r&=a,r!==0?i=Vd(r):e||(o=a&~o,o!==0&&(i=Vd(o))))):(a=n&~s,a!==0?i=Vd(a):r!==0?i=Vd(r):e||(o=n&~o,o!==0&&(i=Vd(o)))),i===0?0:t!==0&&t!==i&&!(t&s)&&(s=i&-i,o=t&-t,s>=o||s===32&&(o&4194176)!==0)?t:i}function kp(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function OJ(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SO(){var e=J2;return J2<<=1,!(J2&4194176)&&(J2=128),e}function CO(){var e=eU;return eU<<=1,!(eU&62914560)&&(eU=4194304),e}function z8(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rp(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function FJ(e,t,n,i,s,r){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var d=31-mr(n),u=1<<d;a[d]=0,l[d]=-1;var f=c[d];if(f!==null)for(c[d]=null,d=0;d<f.length;d++){var h=f[d];h!==null&&(h.lane&=-536870913)}n&=~u}i!==0&&xO(e,i,0),r!==0&&s===0&&e.tag!==0&&(e.suspendedLanes|=r&~(o&~t))}function xO(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-mr(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&4194218}function AO(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-mr(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}function MO(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function kO(){var e=dn.p;return e!==0?e:(e=window.event,e===void 0?32:GB(e.type))}function BJ(e,t){var n=dn.p;try{return dn.p=e,t()}finally{dn.p=n}}var _d=Math.random().toString(36).slice(2),ls="__reactFiber$"+_d,Gs="__reactProps$"+_d,Fg="__reactContainer$"+_d,vv="__reactEvents$"+_d,zJ="__reactListeners$"+_d,HJ="__reactHandles$"+_d,Ax="__reactResources$"+_d,v0="__reactMarker$"+_d;function Dw(e){delete e[ls],delete e[Gs],delete e[vv],delete e[zJ],delete e[HJ]}function Jd(e){var t=e[ls];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Fg]||n[ls]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=kA(e);e!==null;){if(n=e[ls])return n;e=kA(e)}return t}e=n,n=e.parentNode}return null}function Bg(e){if(e=e[ls]||e[Fg]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function o1(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(se(33))}function vh(e){var t=e[Ax];return t||(t=e[Ax]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function xi(e){e[v0]=!0}var RO=new Set,DO={};function Ku(e,t){Yh(e,t),Yh(e+"Capture",t)}function Yh(e,t){for(DO[e]=t,e=0;e<t.length;e++)RO.add(t[e])}var Il=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),VJ=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mx={},kx={};function $J(e){return Ev.call(kx,e)?!0:Ev.call(Mx,e)?!1:VJ.test(e)?kx[e]=!0:(Mx[e]=!0,!1)}function ob(e,t,n){if($J(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function tU(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Ba(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function Lr(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function LO(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function GJ(e){var t=LO(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function n6(e){e._valueTracker||(e._valueTracker=GJ(e))}function PO(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=LO(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function i6(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var XJ=/[\n"\\]/g;function Or(e){return e.replace(XJ,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function _v(e,t,n,i,s,r,o,a){e.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.type=o:e.removeAttribute("type"),t!=null?o==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Lr(t)):e.value!==""+Lr(t)&&(e.value=""+Lr(t)):o!=="submit"&&o!=="reset"||e.removeAttribute("value"),t!=null?wv(e,o,Lr(t)):n!=null?wv(e,o,Lr(n)):i!=null&&e.removeAttribute("value"),s==null&&r!=null&&(e.defaultChecked=!!r),s!=null&&(e.checked=s&&typeof s!="function"&&typeof s!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.name=""+Lr(a):e.removeAttribute("name")}function NO(e,t,n,i,s,r,o,a){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(e.type=r),t!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||t!=null))return;n=n!=null?""+Lr(n):"",t=t!=null?""+Lr(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}i=i??s,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=a?e.checked:!!i,e.defaultChecked=!!i,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.name=o)}function wv(e,t,n){t==="number"&&i6(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function _h(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Lr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,i&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function OO(e,t,n){if(t!=null&&(t=""+Lr(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Lr(n):""}function FO(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(se(92));if(r1(i)){if(1<i.length)throw Error(se(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=Lr(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i)}function Wh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var jJ=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rx(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||jJ.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function BO(e,t,n){if(t!=null&&typeof t!="object")throw Error(se(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var s in t)i=t[s],t.hasOwnProperty(s)&&n[s]!==i&&Rx(e,s,i)}else for(var r in t)t.hasOwnProperty(r)&&Rx(e,r,t[r])}function Lw(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var YJ=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),WJ=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ab(e){return WJ.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Tv=null;function Pw(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qf=null,wh=null;function Dx(e){var t=Bg(e);if(t&&(e=t.stateNode)){var n=e[Gs]||null;e:switch(e=t.stateNode,t.type){case"input":if(_v(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Or(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=i[Gs]||null;if(!s)throw Error(se(90));_v(i,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&PO(i)}break e;case"textarea":OO(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&_h(e,!!n.multiple,t,!1)}}}var H8=!1;function zO(e,t,n){if(H8)return e(t,n);H8=!0;try{var i=e(t);return i}finally{if(H8=!1,(qf!==null||wh!==null)&&(Ay(),qf&&(t=qf,e=wh,wh=qf=null,Dx(t),e)))for(t=0;t<e.length;t++)Dx(e[t])}}function _0(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Gs]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(se(231,t,typeof n));return n}var Iv=!1;if(Il)try{var Im={};Object.defineProperty(Im,"passive",{get:function(){Iv=!0}}),window.addEventListener("test",Im,Im),window.removeEventListener("test",Im,Im)}catch{Iv=!1}var wc=null,Nw=null,lb=null;function HO(){if(lb)return lb;var e,t=Nw,n=t.length,i,s="value"in wc?wc.value:wc.textContent,r=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===s[r-i];i++);return lb=s.slice(e,1<i?1-i:void 0)}function cb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nU(){return!0}function Lx(){return!1}function js(e){function t(n,i,s,r,o){this._reactName=n,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?nU:Lx,this.isPropagationStopped=Lx,this}return un(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=nU)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=nU)},persist:function(){},isPersistent:nU}),t}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ey=js(Zu),Dp=un({},Zu,{view:0,detail:0}),KJ=js(Dp),V8,$8,Sm,vy=un({},Dp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ow,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sm&&(Sm&&e.type==="mousemove"?(V8=e.screenX-Sm.screenX,$8=e.screenY-Sm.screenY):$8=V8=0,Sm=e),V8)},movementY:function(e){return"movementY"in e?e.movementY:$8}}),Px=js(vy),ZJ=un({},vy,{dataTransfer:0}),qJ=js(ZJ),QJ=un({},Dp,{relatedTarget:0}),G8=js(QJ),JJ=un({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),eee=js(JJ),tee=un({},Zu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nee=js(tee),iee=un({},Zu,{data:0}),Nx=js(iee),see={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ree={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aee(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oee[e])?!!t[e]:!1}function Ow(){return aee}var lee=un({},Dp,{key:function(e){if(e.key){var t=see[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=cb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ree[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ow,charCode:function(e){return e.type==="keypress"?cb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),cee=js(lee),dee=un({},vy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ox=js(dee),uee=un({},Dp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ow}),fee=js(uee),hee=un({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),gee=js(hee),mee=un({},vy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pee=js(mee),Uee=un({},Zu,{newState:0,oldState:0}),bee=js(Uee),yee=[9,13,27,32],Fw=Il&&"CompositionEvent"in window,k1=null;Il&&"documentMode"in document&&(k1=document.documentMode);var Eee=Il&&"TextEvent"in window&&!k1,VO=Il&&(!Fw||k1&&8<k1&&11>=k1),Fx=" ",Bx=!1;function $O(e,t){switch(e){case"keyup":return yee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qf=!1;function vee(e,t){switch(e){case"compositionend":return GO(t);case"keypress":return t.which!==32?null:(Bx=!0,Fx);case"textInput":return e=t.data,e===Fx&&Bx?null:e;default:return null}}function _ee(e,t){if(Qf)return e==="compositionend"||!Fw&&$O(e,t)?(e=HO(),lb=Nw=wc=null,Qf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return VO&&t.locale!=="ko"?null:t.data;default:return null}}var wee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wee[e.type]:t==="textarea"}function XO(e,t,n,i){qf?wh?wh.push(i):wh=[i]:qf=i,t=y6(t,"onChange"),0<t.length&&(n=new Ey("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var R1=null,w0=null;function Tee(e){kB(e,0)}function _y(e){var t=o1(e);if(PO(t))return e}function Hx(e,t){if(e==="change")return t}var jO=!1;if(Il){var X8;if(Il){var j8="oninput"in document;if(!j8){var Vx=document.createElement("div");Vx.setAttribute("oninput","return;"),j8=typeof Vx.oninput=="function"}X8=j8}else X8=!1;jO=X8&&(!document.documentMode||9<document.documentMode)}function $x(){R1&&(R1.detachEvent("onpropertychange",YO),w0=R1=null)}function YO(e){if(e.propertyName==="value"&&_y(w0)){var t=[];XO(t,w0,e,Pw(e)),zO(Tee,t)}}function Iee(e,t,n){e==="focusin"?($x(),R1=t,w0=n,R1.attachEvent("onpropertychange",YO)):e==="focusout"&&$x()}function See(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _y(w0)}function Cee(e,t){if(e==="click")return _y(t)}function xee(e,t){if(e==="input"||e==="change")return _y(t)}function Aee(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Er=typeof Object.is=="function"?Object.is:Aee;function T0(e,t){if(Er(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!Ev.call(t,s)||!Er(e[s],t[s]))return!1}return!0}function Gx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xx(e,t){var n=Gx(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gx(n)}}function WO(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?WO(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function KO(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=i6(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=i6(e.document)}return t}function Bw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Mee(e,t){var n=KO(t);t=e.focusedElem;var i=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&WO(t.ownerDocument.documentElement,t)){if(i!==null&&Bw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=Xx(t,r);var o=Xx(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var kee=Il&&"documentMode"in document&&11>=document.documentMode,Jf=null,Sv=null,D1=null,Cv=!1;function jx(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Cv||Jf==null||Jf!==i6(i)||(i=Jf,"selectionStart"in i&&Bw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),D1&&T0(D1,i)||(D1=i,i=y6(Sv,"onSelect"),0<i.length&&(t=new Ey("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Jf)))}function Od(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var eh={animationend:Od("Animation","AnimationEnd"),animationiteration:Od("Animation","AnimationIteration"),animationstart:Od("Animation","AnimationStart"),transitionrun:Od("Transition","TransitionRun"),transitionstart:Od("Transition","TransitionStart"),transitioncancel:Od("Transition","TransitionCancel"),transitionend:Od("Transition","TransitionEnd")},Y8={},ZO={};Il&&(ZO=document.createElement("div").style,"AnimationEvent"in window||(delete eh.animationend.animation,delete eh.animationiteration.animation,delete eh.animationstart.animation),"TransitionEvent"in window||delete eh.transitionend.transition);function qu(e){if(Y8[e])return Y8[e];if(!eh[e])return e;var t=eh[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ZO)return Y8[e]=t[n];return e}var qO=qu("animationend"),QO=qu("animationiteration"),JO=qu("animationstart"),Ree=qu("transitionrun"),Dee=qu("transitionstart"),Lee=qu("transitioncancel"),eF=qu("transitionend"),tF=new Map,Yx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Po(e,t){tF.set(e,t),Ku(t,[e])}var Rr=[],th=0,zw=0;function wy(){for(var e=th,t=zw=th=0;t<e;){var n=Rr[t];Rr[t++]=null;var i=Rr[t];Rr[t++]=null;var s=Rr[t];Rr[t++]=null;var r=Rr[t];if(Rr[t++]=null,i!==null&&s!==null){var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}r!==0&&nF(n,s,r)}}function Ty(e,t,n,i){Rr[th++]=e,Rr[th++]=t,Rr[th++]=n,Rr[th++]=i,zw|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function Hw(e,t,n,i){return Ty(e,t,n,i),s6(e)}function Jc(e,t){return Ty(e,null,null,t),s6(e)}function nF(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var s=!1,r=e.return;r!==null;)r.childLanes|=n,i=r.alternate,i!==null&&(i.childLanes|=n),r.tag===22&&(e=r.stateNode,e===null||e._visibility&1||(s=!0)),e=r,r=r.return;s&&t!==null&&e.tag===3&&(r=e.stateNode,s=31-mr(n),r=r.hiddenUpdates,e=r[s],e===null?r[s]=[t]:e.push(t),t.lane=n|536870912)}function s6(e){if(50<X1)throw X1=0,Kv=null,Error(se(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var nh={},Wx=new WeakMap;function Fr(e,t){if(typeof e=="object"&&e!==null){var n=Wx.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Cx(t)},Wx.set(e,t),t)}return{value:e,source:t,stack:Cx(t)}}var ih=[],sh=0,r6=null,o6=0,Pr=[],Nr=0,uu=null,dl=1,ul="";function $d(e,t){ih[sh++]=o6,ih[sh++]=r6,r6=e,o6=t}function iF(e,t,n){Pr[Nr++]=dl,Pr[Nr++]=ul,Pr[Nr++]=uu,uu=e;var i=dl;e=ul;var s=32-mr(i)-1;i&=~(1<<s),n+=1;var r=32-mr(t)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,dl=1<<32-mr(t)+s|n<<s|i,ul=r+e}else dl=1<<r|n<<s|i,ul=e}function Vw(e){e.return!==null&&($d(e,1),iF(e,1,0))}function $w(e){for(;e===r6;)r6=ih[--sh],ih[sh]=null,o6=ih[--sh],ih[sh]=null;for(;e===uu;)uu=Pr[--Nr],Pr[Nr]=null,ul=Pr[--Nr],Pr[Nr]=null,dl=Pr[--Nr],Pr[Nr]=null}var _s=null,$i=null,Pt=!1,mo=null,Ko=!1,xv=Error(se(519));function _u(e){var t=Error(se(418,""));throw I0(Fr(t,e)),xv}function Kx(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ls]=e,t[Gs]=i,n){case"dialog":mt("cancel",t),mt("close",t);break;case"iframe":case"object":case"embed":mt("load",t);break;case"video":case"audio":for(n=0;n<x0.length;n++)mt(x0[n],t);break;case"source":mt("error",t);break;case"img":case"image":case"link":mt("error",t),mt("load",t);break;case"details":mt("toggle",t);break;case"input":mt("invalid",t),NO(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),n6(t);break;case"select":mt("invalid",t);break;case"textarea":mt("invalid",t),FO(t,i.value,i.defaultValue,i.children),n6(t)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||DB(t.textContent,n)?(i.popover!=null&&(mt("beforetoggle",t),mt("toggle",t)),i.onScroll!=null&&mt("scroll",t),i.onScrollEnd!=null&&mt("scrollend",t),i.onClick!=null&&(t.onclick=ky),t=!0):t=!1,t||_u(e)}function Zx(e){for(_s=e.return;_s;)switch(_s.tag){case 3:case 27:Ko=!0;return;case 5:case 13:Ko=!1;return;default:_s=_s.return}}function Cm(e){if(e!==_s)return!1;if(!Pt)return Zx(e),Pt=!0,!1;var t=!1,n;if((n=e.tag!==3&&e.tag!==27)&&((n=e.tag===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||n4(e.type,e.memoizedProps)),n=!n),n&&(t=!0),t&&$i&&_u(e),Zx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){$i=_o(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}$i=null}}else $i=_s?_o(e.stateNode.nextSibling):null;return!0}function Lp(){$i=_s=null,Pt=!1}function I0(e){mo===null?mo=[e]:mo.push(e)}var L1=Error(se(460)),sF=Error(se(474)),Av={then:function(){}};function qx(e){return e=e.status,e==="fulfilled"||e==="rejected"}function iU(){}function rF(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(iU,iU),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===L1?Error(se(483)):e;default:if(typeof t.status=="string")t.then(iU,iU);else{if(e=rn,e!==null&&100<e.shellSuspendCounter)throw Error(se(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var s=t;s.status="fulfilled",s.value=i}},function(i){if(t.status==="pending"){var s=t;s.status="rejected",s.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===L1?Error(se(483)):e}throw P1=t,L1}}var P1=null;function Qx(){if(P1===null)throw Error(se(459));var e=P1;return P1=null,e}var Th=null,S0=0;function sU(e){var t=S0;return S0+=1,Th===null&&(Th=[]),rF(Th,e,t)}function xm(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function rU(e,t){throw t.$$typeof===vJ?Error(se(525)):(e=Object.prototype.toString.call(t),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Jx(e){var t=e._init;return t(e._payload)}function oF(e){function t(b,y){if(e){var E=b.deletions;E===null?(b.deletions=[y],b.flags|=16):E.push(y)}}function n(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function i(b){for(var y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function s(b,y){return b=Dc(b,y),b.index=0,b.sibling=null,b}function r(b,y,E){return b.index=E,e?(E=b.alternate,E!==null?(E=E.index,E<y?(b.flags|=33554434,y):E):(b.flags|=33554434,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=33554434),b}function a(b,y,E,_){return y===null||y.tag!==6?(y=r3(E,b.mode,_),y.return=b,y):(y=s(y,E),y.return=b,y)}function l(b,y,E,_){var I=E.type;return I===Kf?d(b,y,E.props.children,_,E.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ac&&Jx(I)===y.type)?(y=s(y,E.props),xm(y,E),y.return=b,y):(y=gb(E.type,E.key,E.props,null,b.mode,_),xm(y,E),y.return=b,y)}function c(b,y,E,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==E.containerInfo||y.stateNode.implementation!==E.implementation?(y=o3(E,b.mode,_),y.return=b,y):(y=s(y,E.children||[]),y.return=b,y)}function d(b,y,E,_,I){return y===null||y.tag!==7?(y=hu(E,b.mode,_,I),y.return=b,y):(y=s(y,E),y.return=b,y)}function u(b,y,E){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=r3(""+y,b.mode,E),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Q2:return E=gb(y.type,y.key,y.props,null,b.mode,E),xm(E,y),E.return=b,E;case i1:return y=o3(y,b.mode,E),y.return=b,y;case ac:var _=y._init;return y=_(y._payload),u(b,y,E)}if(r1(y)||Tm(y))return y=hu(y,b.mode,E,null),y.return=b,y;if(typeof y.then=="function")return u(b,sU(y),E);if(y.$$typeof===cl)return u(b,oU(b,y),E);rU(b,y)}return null}function f(b,y,E,_){var I=y!==null?y.key:null;if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return I!==null?null:a(b,y,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Q2:return E.key===I?l(b,y,E,_):null;case i1:return E.key===I?c(b,y,E,_):null;case ac:return I=E._init,E=I(E._payload),f(b,y,E,_)}if(r1(E)||Tm(E))return I!==null?null:d(b,y,E,_,null);if(typeof E.then=="function")return f(b,y,sU(E),_);if(E.$$typeof===cl)return f(b,y,oU(b,E),_);rU(b,E)}return null}function h(b,y,E,_,I){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return b=b.get(E)||null,a(y,b,""+_,I);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Q2:return b=b.get(_.key===null?E:_.key)||null,l(y,b,_,I);case i1:return b=b.get(_.key===null?E:_.key)||null,c(y,b,_,I);case ac:var k=_._init;return _=k(_._payload),h(b,y,E,_,I)}if(r1(_)||Tm(_))return b=b.get(E)||null,d(y,b,_,I,null);if(typeof _.then=="function")return h(b,y,E,sU(_),I);if(_.$$typeof===cl)return h(b,y,E,oU(y,_),I);rU(y,_)}return null}function m(b,y,E,_){for(var I=null,k=null,w=y,T=y=0,A=null;w!==null&&T<E.length;T++){w.index>T?(A=w,w=null):A=w.sibling;var S=f(b,w,E[T],_);if(S===null){w===null&&(w=A);break}e&&w&&S.alternate===null&&t(b,w),y=r(S,y,T),k===null?I=S:k.sibling=S,k=S,w=A}if(T===E.length)return n(b,w),Pt&&$d(b,T),I;if(w===null){for(;T<E.length;T++)w=u(b,E[T],_),w!==null&&(y=r(w,y,T),k===null?I=w:k.sibling=w,k=w);return Pt&&$d(b,T),I}for(w=i(w);T<E.length;T++)A=h(w,b,T,E[T],_),A!==null&&(e&&A.alternate!==null&&w.delete(A.key===null?T:A.key),y=r(A,y,T),k===null?I=A:k.sibling=A,k=A);return e&&w.forEach(function(D){return t(b,D)}),Pt&&$d(b,T),I}function p(b,y,E,_){if(E==null)throw Error(se(151));for(var I=null,k=null,w=y,T=y=0,A=null,S=E.next();w!==null&&!S.done;T++,S=E.next()){w.index>T?(A=w,w=null):A=w.sibling;var D=f(b,w,S.value,_);if(D===null){w===null&&(w=A);break}e&&w&&D.alternate===null&&t(b,w),y=r(D,y,T),k===null?I=D:k.sibling=D,k=D,w=A}if(S.done)return n(b,w),Pt&&$d(b,T),I;if(w===null){for(;!S.done;T++,S=E.next())S=u(b,S.value,_),S!==null&&(y=r(S,y,T),k===null?I=S:k.sibling=S,k=S);return Pt&&$d(b,T),I}for(w=i(w);!S.done;T++,S=E.next())S=h(w,b,T,S.value,_),S!==null&&(e&&S.alternate!==null&&w.delete(S.key===null?T:S.key),y=r(S,y,T),k===null?I=S:k.sibling=S,k=S);return e&&w.forEach(function(N){return t(b,N)}),Pt&&$d(b,T),I}function U(b,y,E,_){if(typeof E=="object"&&E!==null&&E.type===Kf&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Q2:e:{for(var I=E.key;y!==null;){if(y.key===I){if(I=E.type,I===Kf){if(y.tag===7){n(b,y.sibling),_=s(y,E.props.children),_.return=b,b=_;break e}}else if(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ac&&Jx(I)===y.type){n(b,y.sibling),_=s(y,E.props),xm(_,E),_.return=b,b=_;break e}n(b,y);break}else t(b,y);y=y.sibling}E.type===Kf?(_=hu(E.props.children,b.mode,_,E.key),_.return=b,b=_):(_=gb(E.type,E.key,E.props,null,b.mode,_),xm(_,E),_.return=b,b=_)}return o(b);case i1:e:{for(I=E.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===E.containerInfo&&y.stateNode.implementation===E.implementation){n(b,y.sibling),_=s(y,E.children||[]),_.return=b,b=_;break e}else{n(b,y);break}else t(b,y);y=y.sibling}_=o3(E,b.mode,_),_.return=b,b=_}return o(b);case ac:return I=E._init,E=I(E._payload),U(b,y,E,_)}if(r1(E))return m(b,y,E,_);if(Tm(E)){if(I=Tm(E),typeof I!="function")throw Error(se(150));return E=I.call(E),p(b,y,E,_)}if(typeof E.then=="function")return U(b,y,sU(E),_);if(E.$$typeof===cl)return U(b,y,oU(b,E),_);rU(b,E)}return typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint"?(E=""+E,y!==null&&y.tag===6?(n(b,y.sibling),_=s(y,E),_.return=b,b=_):(n(b,y),_=r3(E,b.mode,_),_.return=b,b=_),o(b)):n(b,y)}return function(b,y,E,_){try{S0=0;var I=U(b,y,E,_);return Th=null,I}catch(w){if(w===L1)throw w;var k=Vr(29,w,null,b.mode);return k.lanes=_,k.return=b,k}finally{}}}var wu=oF(!0),aF=oF(!1),Kh=Ra(null),a6=Ra(0);function eA(e,t){e=xl,Un(a6,e),Un(Kh,t),xl=e|t.baseLanes}function Mv(){Un(a6,xl),Un(Kh,Kh.current)}function Gw(){xl=a6.current,Ri(Kh),Ri(a6)}var Jr=Ra(null),da=null;function gc(e){var t=e.alternate;Un(hi,hi.current&1),Un(Jr,e),da===null&&(t===null||Kh.current!==null||t.memoizedState!==null)&&(da=e)}function lF(e){if(e.tag===22){if(Un(hi,hi.current),Un(Jr,e),da===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(da=e)}}else mc()}function mc(){Un(hi,hi.current),Un(Jr,Jr.current)}function fl(e){Ri(Jr),da===e&&(da=null),Ri(hi)}var hi=Ra(0);function l6(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Pee=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Nee=bi.unstable_scheduleCallback,Oee=bi.unstable_NormalPriority,fi={$$typeof:cl,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xw(){return{controller:new Pee,data:new Map,refCount:0}}function Pp(e){e.refCount--,e.refCount===0&&Nee(Oee,function(){e.controller.abort()})}var N1=null,kv=0,Zh=0,Ih=null;function Fee(e,t){if(N1===null){var n=N1=[];kv=0,Zh=g9(),Ih={status:"pending",value:void 0,then:function(i){n.push(i)}}}return kv++,t.then(tA,tA),t}function tA(){if(--kv===0&&N1!==null){Ih!==null&&(Ih.status="fulfilled");var e=N1;N1=null,Zh=0,Ih=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Bee(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(s){n.push(s)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var s=0;s<n.length;s++)(0,n[s])(t)},function(s){for(i.status="rejected",i.reason=s,s=0;s<n.length;s++)(0,n[s])(void 0)}),i}var nA=nt.S;nt.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Fee(e,t),nA!==null&&nA(e,t)};var fu=Ra(null);function jw(){var e=fu.current;return e!==null?e:rn.pooledCache}function db(e,t){t===null?Un(fu,fu.current):Un(fu,t.pool)}function cF(){var e=jw();return e===null?null:{parent:fi._currentValue,pool:e}}var ed=0,st=null,jt=null,Qn=null,c6=!1,Sh=!1,Tu=!1,d6=0,C0=0,Ch=null,zee=0;function Fn(){throw Error(se(321))}function Yw(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Er(e[n],t[n]))return!1;return!0}function Ww(e,t,n,i,s,r){return ed=r,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nt.H=e===null||e.memoizedState===null?Qu:wd,Tu=!1,r=n(i,s),Tu=!1,Sh&&(r=uF(t,n,i,s)),dF(e),r}function dF(e){nt.H=pa;var t=jt!==null&&jt.next!==null;if(ed=0,Qn=jt=st=null,c6=!1,C0=0,Ch=null,t)throw Error(se(300));e===null||Mi||(e=e.dependencies,e!==null&&h6(e)&&(Mi=!0))}function uF(e,t,n,i){st=e;var s=0;do{if(Sh&&(Ch=null),C0=0,Sh=!1,25<=s)throw Error(se(301));if(s+=1,Qn=jt=null,e.updateQueue!=null){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}nt.H=Ju,r=t(n,i)}while(Sh);return r}function Hee(){var e=nt.H,t=e.useState()[0];return t=typeof t.then=="function"?Np(t):t,e=e.useState()[0],(jt!==null?jt.memoizedState:null)!==e&&(st.flags|=1024),t}function Kw(){var e=d6!==0;return d6=0,e}function Zw(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function qw(e){if(c6){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}c6=!1}ed=0,Qn=jt=st=null,Sh=!1,C0=d6=0,Ch=null}function Ps(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qn===null?st.memoizedState=Qn=e:Qn=Qn.next=e,Qn}function ii(){if(jt===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var t=Qn===null?st.memoizedState:Qn.next;if(t!==null)Qn=t,jt=e;else{if(e===null)throw st.alternate===null?Error(se(467)):Error(se(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Qn===null?st.memoizedState=Qn=e:Qn=Qn.next=e}return Qn}var Iy;Iy=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Np(e){var t=C0;return C0+=1,Ch===null&&(Ch=[]),e=rF(Ch,e,t),t=st,(Qn===null?t.memoizedState:Qn.next)===null&&(t=t.alternate,nt.H=t===null||t.memoizedState===null?Qu:wd),e}function Sy(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Np(e);if(e.$$typeof===cl)return cs(e)}throw Error(se(438,String(e)))}function Qw(e){var t=null,n=st.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=st.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(s){return s.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Iy(),st.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=wJ;return t.index++,n}function Sl(e,t){return typeof t=="function"?t(e):t}function ub(e){var t=ii();return Jw(t,jt,e)}function Jw(e,t,n){var i=e.queue;if(i===null)throw Error(se(311));i.lastRenderedReducer=n;var s=e.baseQueue,r=i.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}t.baseQueue=s=r,i.pending=null}if(r=e.baseState,s===null)e.memoizedState=r;else{t=s.next;var a=o=null,l=null,c=t,d=!1;do{var u=c.lane&-536870913;if(u!==c.lane?(vt&u)===u:(ed&u)===u){var f=c.revertLane;if(f===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),u===Zh&&(d=!0);else if((ed&f)===f){c=c.next,f===Zh&&(d=!0);continue}else u={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=u,o=r):l=l.next=u,st.lanes|=f,nd|=f;u=c.action,Tu&&n(r,u),r=c.hasEagerState?c.eagerState:n(r,u)}else f={lane:u,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=f,o=r):l=l.next=f,st.lanes|=u,nd|=u;c=c.next}while(c!==null&&c!==t);if(l===null?o=r:l.next=a,!Er(r,e.memoizedState)&&(Mi=!0,d&&(n=Ih,n!==null)))throw n;e.memoizedState=r,e.baseState=o,e.baseQueue=l,i.lastRenderedState=r}return s===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function W8(e){var t=ii(),n=t.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,r=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do r=e(r,o.action),o=o.next;while(o!==s);Er(r,t.memoizedState)||(Mi=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),n.lastRenderedState=r}return[r,i]}function fF(e,t,n){var i=st,s=ii(),r=Pt;if(r){if(n===void 0)throw Error(se(407));n=n()}else n=t();var o=!Er((jt||s).memoizedState,n);if(o&&(s.memoizedState=n,Mi=!0),s=s.queue,e9(mF.bind(null,i,s,e),[e]),s.getSnapshot!==t||o||Qn!==null&&Qn.memoizedState.tag&1){if(i.flags|=2048,qh(9,gF.bind(null,i,s,n,t),{destroy:void 0},null),rn===null)throw Error(se(349));r||ed&60||hF(i,t,n)}return n}function hF(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=st.updateQueue,t===null?(t=Iy(),st.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function gF(e,t,n,i){t.value=n,t.getSnapshot=i,pF(t)&&UF(e)}function mF(e,t,n){return n(function(){pF(t)&&UF(e)})}function pF(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Er(e,n)}catch{return!0}}function UF(e){var t=Jc(e,2);t!==null&&Is(t,e,2)}function Rv(e){var t=Ps();if(typeof e=="function"){var n=e;if(e=n(),Tu){_c(!0);try{n()}finally{_c(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:e},t}function bF(e,t,n,i){return e.baseState=n,Jw(e,jt,typeof i=="function"?i:Sl)}function Vee(e,t,n,i,s){if(xy(e))throw Error(se(485));if(e=t.action,e!==null){var r={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){r.listeners.push(o)}};nt.T!==null?n(!0):r.isTransition=!1,i(r),n=t.pending,n===null?(r.next=t.pending=r,yF(t,r)):(r.next=n.next,t.pending=n.next=r)}}function yF(e,t){var n=t.action,i=t.payload,s=e.state;if(t.isTransition){var r=nt.T,o={};nt.T=o;try{var a=n(s,i),l=nt.S;l!==null&&l(o,a),iA(e,t,a)}catch(c){Dv(e,t,c)}finally{nt.T=r}}else try{r=n(s,i),iA(e,t,r)}catch(c){Dv(e,t,c)}}function iA(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){sA(e,t,i)},function(i){return Dv(e,t,i)}):sA(e,t,n)}function sA(e,t,n){t.status="fulfilled",t.value=n,EF(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,yF(e,n)))}function Dv(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,EF(t),t=t.next;while(t!==i)}e.action=null}function EF(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function vF(e,t){return t}function _F(e,t){if(Pt){var n=rn.formState;if(n!==null){e:{var i=st;if(Pt){if($i){t:{for(var s=$i,r=Ko;s.nodeType!==8;){if(!r){s=null;break t}if(s=_o(s.nextSibling),s===null){s=null;break t}}r=s.data,s=r==="F!"||r==="F"?s:null}if(s){$i=_o(s.nextSibling),i=s.data==="F!";break e}}_u(i)}i=!1}i&&(t=n[0])}}return n=Ps(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vF,lastRenderedState:t},n.queue=i,n=BF.bind(null,st,i),i.dispatch=n,i=Rv(!1),r=s9.bind(null,st,!1,i.queue),i=Ps(),s={state:t,dispatch:null,action:e,pending:null},i.queue=s,n=Vee.bind(null,st,s,r,n),s.dispatch=n,i.memoizedState=e,[t,n,!1]}function wF(e){var t=ii();return TF(t,jt,e)}function TF(e,t,n){t=Jw(e,t,vF)[0],e=ub(Sl)[0],t=typeof t=="object"&&t!==null&&typeof t.then=="function"?Np(t):t;var i=ii(),s=i.queue,r=s.dispatch;return n!==i.memoizedState&&(st.flags|=2048,qh(9,$ee.bind(null,s,n),{destroy:void 0},null)),[t,r,e]}function $ee(e,t){e.action=t}function IF(e){var t=ii(),n=jt;if(n!==null)return TF(t,n,e);ii(),t=t.memoizedState,n=ii();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function qh(e,t,n,i){return e={tag:e,create:t,inst:n,deps:i,next:null},t=st.updateQueue,t===null&&(t=Iy(),st.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function SF(){return ii().memoizedState}function fb(e,t,n,i){var s=Ps();st.flags|=e,s.memoizedState=qh(1|t,n,{destroy:void 0},i===void 0?null:i)}function Cy(e,t,n,i){var s=ii();i=i===void 0?null:i;var r=s.memoizedState.inst;jt!==null&&i!==null&&Yw(i,jt.memoizedState.deps)?s.memoizedState=qh(t,n,r,i):(st.flags|=e,s.memoizedState=qh(1|t,n,r,i))}function rA(e,t){fb(8390656,8,e,t)}function e9(e,t){Cy(2048,8,e,t)}function CF(e,t){return Cy(4,2,e,t)}function xF(e,t){return Cy(4,4,e,t)}function AF(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function MF(e,t,n){n=n!=null?n.concat([e]):null,Cy(4,4,AF.bind(null,t,e),n)}function t9(){}function kF(e,t){var n=ii();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Yw(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function RF(e,t){var n=ii();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Yw(t,i[1]))return i[0];if(i=e(),Tu){_c(!0);try{e()}finally{_c(!1)}}return n.memoizedState=[i,t],i}function n9(e,t,n){return n===void 0||ed&1073741824?e.memoizedState=t:(e.memoizedState=n,e=EB(),st.lanes|=e,nd|=e,n)}function DF(e,t,n,i){return Er(n,t)?n:Kh.current!==null?(e=n9(e,n,i),Er(e,t)||(Mi=!0),e):ed&42?(e=EB(),st.lanes|=e,nd|=e,t):(Mi=!0,e.memoizedState=n)}function LF(e,t,n,i,s){var r=dn.p;dn.p=r!==0&&8>r?r:8;var o=nt.T,a={};nt.T=a,s9(e,!1,t,n);try{var l=s(),c=nt.S;if(c!==null&&c(a,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=Bee(l,i);O1(e,t,d,pr(e))}else O1(e,t,i,pr(e))}catch(u){O1(e,t,{then:function(){},status:"rejected",reason:u},pr())}finally{dn.p=r,nt.T=o}}function Gee(){}function Lv(e,t,n,i){if(e.tag!==5)throw Error(se(476));var s=PF(e).queue;LF(e,s,t,du,n===null?Gee:function(){return NF(e),n(i)})}function PF(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:du,baseState:du,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:du},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function NF(e){var t=PF(e).next.queue;O1(e,t,{},pr())}function i9(){return cs(k0)}function OF(){return ii().memoizedState}function FF(){return ii().memoizedState}function Xee(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=pr();e=kc(n);var i=Rc(t,e,n);i!==null&&(Is(i,t,n),B1(i,t,n)),t={cache:Xw()},e.payload=t;return}t=t.return}}function jee(e,t,n){var i=pr();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},xy(e)?zF(t,n):(n=Hw(e,t,n,i),n!==null&&(Is(n,e,i),HF(n,t,i)))}function BF(e,t,n){var i=pr();O1(e,t,n,i)}function O1(e,t,n,i){var s={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(xy(e))zF(t,s);else{var r=e.alternate;if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var o=t.lastRenderedState,a=r(o,n);if(s.hasEagerState=!0,s.eagerState=a,Er(a,o))return Ty(e,t,s,0),rn===null&&wy(),!1}catch{}finally{}if(n=Hw(e,t,s,i),n!==null)return Is(n,e,i),HF(n,t,i),!0}return!1}function s9(e,t,n,i){if(i={lane:2,revertLane:g9(),action:i,hasEagerState:!1,eagerState:null,next:null},xy(e)){if(t)throw Error(se(479))}else t=Hw(e,n,i,2),t!==null&&Is(t,e,2)}function xy(e){var t=e.alternate;return e===st||t!==null&&t===st}function zF(e,t){Sh=c6=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function HF(e,t,n){if(n&4194176){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,AO(e,n)}}var pa={readContext:cs,use:Sy,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn};pa.useCacheRefresh=Fn;pa.useMemoCache=Fn;pa.useHostTransitionStatus=Fn;pa.useFormState=Fn;pa.useActionState=Fn;pa.useOptimistic=Fn;var Qu={readContext:cs,use:Sy,useCallback:function(e,t){return Ps().memoizedState=[e,t===void 0?null:t],e},useContext:cs,useEffect:rA,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,fb(4194308,4,AF.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fb(4194308,4,e,t)},useInsertionEffect:function(e,t){fb(4,2,e,t)},useMemo:function(e,t){var n=Ps();t=t===void 0?null:t;var i=e();if(Tu){_c(!0);try{e()}finally{_c(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Ps();if(n!==void 0){var s=n(t);if(Tu){_c(!0);try{n(t)}finally{_c(!1)}}}else s=t;return i.memoizedState=i.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},i.queue=e,e=e.dispatch=jee.bind(null,st,e),[i.memoizedState,e]},useRef:function(e){var t=Ps();return e={current:e},t.memoizedState=e},useState:function(e){e=Rv(e);var t=e.queue,n=BF.bind(null,st,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:t9,useDeferredValue:function(e,t){var n=Ps();return n9(n,e,t)},useTransition:function(){var e=Rv(!1);return e=LF.bind(null,st,e.queue,!0,!1),Ps().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=st,s=Ps();if(Pt){if(n===void 0)throw Error(se(407));n=n()}else{if(n=t(),rn===null)throw Error(se(349));vt&60||hF(i,t,n)}s.memoizedState=n;var r={value:n,getSnapshot:t};return s.queue=r,rA(mF.bind(null,i,r,e),[e]),i.flags|=2048,qh(9,gF.bind(null,i,r,n,t),{destroy:void 0},null),n},useId:function(){var e=Ps(),t=rn.identifierPrefix;if(Pt){var n=ul,i=dl;n=(i&~(1<<32-mr(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=d6++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=zee++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return Ps().memoizedState=Xee.bind(null,st)}};Qu.useMemoCache=Qw;Qu.useHostTransitionStatus=i9;Qu.useFormState=_F;Qu.useActionState=_F;Qu.useOptimistic=function(e){var t=Ps();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=s9.bind(null,st,!0,n),n.dispatch=t,[e,t]};var wd={readContext:cs,use:Sy,useCallback:kF,useContext:cs,useEffect:e9,useImperativeHandle:MF,useInsertionEffect:CF,useLayoutEffect:xF,useMemo:RF,useReducer:ub,useRef:SF,useState:function(){return ub(Sl)},useDebugValue:t9,useDeferredValue:function(e,t){var n=ii();return DF(n,jt.memoizedState,e,t)},useTransition:function(){var e=ub(Sl)[0],t=ii().memoizedState;return[typeof e=="boolean"?e:Np(e),t]},useSyncExternalStore:fF,useId:OF};wd.useCacheRefresh=FF;wd.useMemoCache=Qw;wd.useHostTransitionStatus=i9;wd.useFormState=wF;wd.useActionState=wF;wd.useOptimistic=function(e,t){var n=ii();return bF(n,jt,e,t)};var Ju={readContext:cs,use:Sy,useCallback:kF,useContext:cs,useEffect:e9,useImperativeHandle:MF,useInsertionEffect:CF,useLayoutEffect:xF,useMemo:RF,useReducer:W8,useRef:SF,useState:function(){return W8(Sl)},useDebugValue:t9,useDeferredValue:function(e,t){var n=ii();return jt===null?n9(n,e,t):DF(n,jt.memoizedState,e,t)},useTransition:function(){var e=W8(Sl)[0],t=ii().memoizedState;return[typeof e=="boolean"?e:Np(e),t]},useSyncExternalStore:fF,useId:OF};Ju.useCacheRefresh=FF;Ju.useMemoCache=Qw;Ju.useHostTransitionStatus=i9;Ju.useFormState=IF;Ju.useActionState=IF;Ju.useOptimistic=function(e,t){var n=ii();return jt!==null?bF(n,jt,e,t):(n.baseState=e,[e,n.queue.dispatch])};function K8(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:un({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Pv={isMounted:function(e){return(e=e._reactInternals)?Og(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=pr(),s=kc(i);s.payload=t,n!=null&&(s.callback=n),t=Rc(e,s,i),t!==null&&(Is(t,e,i),B1(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=pr(),s=kc(i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Rc(e,s,i),t!==null&&(Is(t,e,i),B1(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pr(),i=kc(n);i.tag=2,t!=null&&(i.callback=t),t=Rc(e,i,n),t!==null&&(Is(t,e,n),B1(t,e,n))}};function oA(e,t,n,i,s,r,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,r,o):t.prototype&&t.prototype.isPureReactComponent?!T0(n,i)||!T0(s,r):!0}function aA(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Pv.enqueueReplaceState(t,t.state,null)}function Iu(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=un({},n));for(var s in e)n[s]===void 0&&(n[s]=e[s])}return n}var u6=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function VF(e){u6(e)}function $F(e){console.error(e)}function GF(e){u6(e)}function f6(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function lA(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function Nv(e,t,n){return n=kc(n),n.tag=3,n.payload={element:null},n.callback=function(){f6(e,t)},n}function XF(e){return e=kc(e),e.tag=3,e}function jF(e,t,n,i){var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=i.value;e.payload=function(){return s(r)},e.callback=function(){lA(t,n,i)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){lA(t,n,i),typeof s!="function"&&(Lc===null?Lc=new Set([this]):Lc.add(this));var a=i.stack;this.componentDidCatch(i.value,{componentStack:a!==null?a:""})})}function Yee(e,t,n,i,s){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Op(t,n,s,!0),n=Jr.current,n!==null){switch(n.tag){case 13:return da===null?qv():n.alternate===null&&Mn===0&&(Mn=3),n.flags&=-257,n.flags|=65536,n.lanes=s,i===Av?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),l3(e,i,s)),!1;case 22:return n.flags|=65536,i===Av?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),l3(e,i,s)),!1}throw Error(se(435,n.tag))}return l3(e,i,s),qv(),!1}if(Pt)return t=Jr.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=s,i!==xv&&(e=Error(se(422),{cause:i}),I0(Fr(e,n)))):(i!==xv&&(t=Error(se(423),{cause:i}),I0(Fr(t,n))),e=e.current.alternate,e.flags|=65536,s&=-s,e.lanes|=s,i=Fr(i,n),s=Nv(e.stateNode,i,s),t3(e,s),Mn!==4&&(Mn=2)),!1;var r=Error(se(520),{cause:i});if(r=Fr(r,n),$1===null?$1=[r]:$1.push(r),Mn!==4&&(Mn=2),t===null)return!0;i=Fr(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=s&-s,n.lanes|=e,e=Nv(n.stateNode,i,e),t3(n,e),!1;case 1:if(t=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(Lc===null||!Lc.has(r))))return n.flags|=65536,s&=-s,n.lanes|=s,s=XF(s),jF(s,e,n,i),t3(n,s),!1}n=n.return}while(n!==null);return!1}var YF=Error(se(461)),Mi=!1;function zi(e,t,n,i){t.child=e===null?aF(t,null,n,i):wu(t,e.child,n,i)}function cA(e,t,n,i,s){n=n.render;var r=t.ref;if("ref"in i){var o={};for(var a in i)a!=="ref"&&(o[a]=i[a])}else o=i;return Su(t),i=Ww(e,t,n,o,r,s),a=Kw(),e!==null&&!Mi?(Zw(e,t,s),Cl(e,t,s)):(Pt&&a&&Vw(t),t.flags|=1,zi(e,t,i,s),t.child)}function dA(e,t,n,i,s){if(e===null){var r=n.type;return typeof r=="function"&&!c9(r)&&r.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=r,WF(e,t,r,i,s)):(e=gb(n.type,null,i,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(r=e.child,!r9(e,s)){var o=r.memoizedProps;if(n=n.compare,n=n!==null?n:T0,n(o,i)&&e.ref===t.ref)return Cl(e,t,s)}return t.flags|=1,e=Dc(r,i),e.ref=t.ref,e.return=t,t.child=e}function WF(e,t,n,i,s){if(e!==null){var r=e.memoizedProps;if(T0(r,i)&&e.ref===t.ref)if(Mi=!1,t.pendingProps=i=r,r9(e,s))e.flags&131072&&(Mi=!0);else return t.lanes=e.lanes,Cl(e,t,s)}return Ov(e,t,n,i,s)}function KF(e,t,n){var i=t.pendingProps,s=i.children,r=(t.stateNode._pendingVisibility&2)!==0,o=e!==null?e.memoizedState:null;if(F1(e,t),i.mode==="hidden"||r){if(t.flags&128){if(i=o!==null?o.baseLanes|n:n,e!==null){for(s=t.child=e.child,r=0;s!==null;)r=r|s.lanes|s.childLanes,s=s.sibling;t.childLanes=r&~i}else t.childLanes=0,t.child=null;return uA(e,t,i,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&db(t,o!==null?o.cachePool:null),o!==null?eA(t,o):Mv(),lF(t);else return t.lanes=t.childLanes=536870912,uA(e,t,o!==null?o.baseLanes|n:n,n)}else o!==null?(db(t,o.cachePool),eA(t,o),mc(),t.memoizedState=null):(e!==null&&db(t,null),Mv(),mc());return zi(e,t,s,n),t.child}function uA(e,t,n,i){var s=jw();return s=s===null?null:{parent:fi._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},e!==null&&db(t,null),Mv(),lF(t),e!==null&&Op(e,t,i,!0),null}function F1(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=2097664);else{if(typeof n!="function"&&typeof n!="object")throw Error(se(284));(e===null||e.ref!==n)&&(t.flags|=2097664)}}function Ov(e,t,n,i,s){return Su(t),n=Ww(e,t,n,i,void 0,s),i=Kw(),e!==null&&!Mi?(Zw(e,t,s),Cl(e,t,s)):(Pt&&i&&Vw(t),t.flags|=1,zi(e,t,n,s),t.child)}function fA(e,t,n,i,s,r){return Su(t),t.updateQueue=null,n=uF(t,i,n,s),dF(e),i=Kw(),e!==null&&!Mi?(Zw(e,t,r),Cl(e,t,r)):(Pt&&i&&Vw(t),t.flags|=1,zi(e,t,n,r),t.child)}function hA(e,t,n,i,s){if(Su(t),t.stateNode===null){var r=nh,o=n.contextType;typeof o=="object"&&o!==null&&(r=cs(o)),r=new n(i,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Pv,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=i,r.state=t.memoizedState,r.refs={},o9(t),o=n.contextType,r.context=typeof o=="object"&&o!==null?cs(o):nh,r.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(K8(t,n,o,i),r.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(o=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),o!==r.state&&Pv.enqueueReplaceState(r,r.state,null),H1(t,i,r,s),z1(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){r=t.stateNode;var a=t.memoizedProps,l=Iu(n,a);r.props=l;var c=r.context,d=n.contextType;o=nh,typeof d=="object"&&d!==null&&(o=cs(d));var u=n.getDerivedStateFromProps;d=typeof u=="function"||typeof r.getSnapshotBeforeUpdate=="function",a=t.pendingProps!==a,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a||c!==o)&&aA(t,r,i,o),lc=!1;var f=t.memoizedState;r.state=f,H1(t,i,r,s),z1(),c=t.memoizedState,a||f!==c||lc?(typeof u=="function"&&(K8(t,n,u,i),c=t.memoizedState),(l=lc||oA(t,n,l,i,f,c,o))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),r.props=i,r.state=c,r.context=o,i=l):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,$v(e,t),o=t.memoizedProps,d=Iu(n,o),r.props=d,u=t.pendingProps,f=r.context,c=n.contextType,l=nh,typeof c=="object"&&c!==null&&(l=cs(c)),a=n.getDerivedStateFromProps,(c=typeof a=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o!==u||f!==l)&&aA(t,r,i,l),lc=!1,f=t.memoizedState,r.state=f,H1(t,i,r,s),z1();var h=t.memoizedState;o!==u||f!==h||lc||e!==null&&e.dependencies!==null&&h6(e.dependencies)?(typeof a=="function"&&(K8(t,n,a,i),h=t.memoizedState),(d=lc||oA(t,n,d,i,f,h,l)||e!==null&&e.dependencies!==null&&h6(e.dependencies))?(c||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(i,h,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(i,h,l)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),r.props=i,r.state=h,r.context=l,i=d):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return r=i,F1(e,t),i=(t.flags&128)!==0,r||i?(r=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,e!==null&&i?(t.child=wu(t,e.child,null,s),t.child=wu(t,null,n,s)):zi(e,t,n,s),t.memoizedState=r.state,e=t.child):e=Cl(e,t,s),e}function gA(e,t,n,i){return Lp(),t.flags|=256,zi(e,t,n,i),t.child}var Z8={dehydrated:null,treeContext:null,retryLane:0};function q8(e){return{baseLanes:e,cachePool:cF()}}function Q8(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=$r),e}function ZF(e,t,n){var i=t.pendingProps,s=!1,r=(t.flags&128)!==0,o;if((o=r)||(o=e!==null&&e.memoizedState===null?!1:(hi.current&2)!==0),o&&(s=!0,t.flags&=-129),o=(t.flags&32)!==0,t.flags&=-33,e===null){if(Pt){if(s?gc(t):mc(),Pt){var a=$i,l;if(l=a){e:{for(l=a,a=Ko;l.nodeType!==8;){if(!a){a=null;break e}if(l=_o(l.nextSibling),l===null){a=null;break e}}a=l}a!==null?(t.memoizedState={dehydrated:a,treeContext:uu!==null?{id:dl,overflow:ul}:null,retryLane:536870912},l=Vr(18,null,null,0),l.stateNode=a,l.return=t,t.child=l,_s=t,$i=null,l=!0):l=!1}l||_u(t)}if(a=t.memoizedState,a!==null&&(a=a.dehydrated,a!==null))return a.data==="$!"?t.lanes=16:t.lanes=536870912,null;fl(t)}return a=i.children,i=i.fallback,s?(mc(),s=t.mode,a=Bv({mode:"hidden",children:a},s),i=hu(i,s,n,null),a.return=t,i.return=t,a.sibling=i,t.child=a,s=t.child,s.memoizedState=q8(n),s.childLanes=Q8(e,o,n),t.memoizedState=Z8,i):(gc(t),Fv(t,a))}if(l=e.memoizedState,l!==null&&(a=l.dehydrated,a!==null)){if(r)t.flags&256?(gc(t),t.flags&=-257,t=J8(e,t,n)):t.memoizedState!==null?(mc(),t.child=e.child,t.flags|=128,t=null):(mc(),s=i.fallback,a=t.mode,i=Bv({mode:"visible",children:i.children},a),s=hu(s,a,n,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,wu(t,e.child,null,n),i=t.child,i.memoizedState=q8(n),i.childLanes=Q8(e,o,n),t.memoizedState=Z8,t=s);else if(gc(t),a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;o=c,i=Error(se(419)),i.stack="",i.digest=o,I0({value:i,source:null,stack:null}),t=J8(e,t,n)}else if(Mi||Op(e,t,n,!1),o=(n&e.childLanes)!==0,Mi||o){if(o=rn,o!==null){if(i=n&-n,i&42)i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(i=i&(o.suspendedLanes|n)?0:i,i!==0&&i!==l.retryLane)throw l.retryLane=i,Jc(e,i),Is(o,e,i),YF}a.data==="$?"||qv(),t=J8(e,t,n)}else a.data==="$?"?(t.flags|=128,t.child=e.child,t=lte.bind(null,e),a._reactRetry=t,t=null):(e=l.treeContext,$i=_o(a.nextSibling),_s=t,Pt=!0,mo=null,Ko=!1,e!==null&&(Pr[Nr++]=dl,Pr[Nr++]=ul,Pr[Nr++]=uu,dl=e.id,ul=e.overflow,uu=t),t=Fv(t,i.children),t.flags|=4096);return t}return s?(mc(),s=i.fallback,a=t.mode,l=e.child,c=l.sibling,i=Dc(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&31457280,c!==null?s=Dc(c,s):(s=hu(s,a,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a===null?a=q8(n):(l=a.cachePool,l!==null?(c=fi._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=cF(),a={baseLanes:a.baseLanes|n,cachePool:l}),s.memoizedState=a,s.childLanes=Q8(e,o,n),t.memoizedState=Z8,i):(gc(t),n=e.child,e=n.sibling,n=Dc(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=n,t.memoizedState=null,n)}function Fv(e,t){return t=Bv({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Bv(e,t){return bB(e,t,0,null)}function J8(e,t,n){return wu(t,e.child,null,n),e=Fv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mA(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Hv(e.return,t,n)}function e3(e,t,n,i,s){var r=e.memoizedState;r===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function qF(e,t,n){var i=t.pendingProps,s=i.revealOrder,r=i.tail;if(zi(e,t,i.children,n),i=hi.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mA(e,n,t);else if(e.tag===19)mA(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(Un(hi,i),s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&l6(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),e3(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&l6(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}e3(t,!0,n,null,r);break;case"together":e3(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Cl(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),nd|=t.lanes,!(n&t.childLanes))if(e!==null){if(Op(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(se(153));if(t.child!==null){for(e=t.child,n=Dc(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Dc(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function r9(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&h6(e)))}function Wee(e,t,n){switch(t.tag){case 3:Jb(t,t.stateNode.containerInfo),pc(t,fi,e.memoizedState.cache),Lp();break;case 27:case 5:yv(t);break;case 4:Jb(t,t.stateNode.containerInfo);break;case 10:pc(t,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(gc(t),t.flags|=128,null):n&t.child.childLanes?ZF(e,t,n):(gc(t),e=Cl(e,t,n),e!==null?e.sibling:null);gc(t);break;case 19:var s=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Op(e,t,n,!1),i=(n&t.childLanes)!==0),s){if(i)return qF(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Un(hi,hi.current),i)break;return null;case 22:case 23:return t.lanes=0,KF(e,t,n);case 24:pc(t,fi,e.memoizedState.cache)}return Cl(e,t,n)}function QF(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Mi=!0;else{if(!r9(e,n)&&!(t.flags&128))return Mi=!1,Wee(e,t,n);Mi=!!(e.flags&131072)}else Mi=!1,Pt&&t.flags&1048576&&iF(t,o6,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,s=i._init;if(i=s(i._payload),t.type=i,typeof i=="function")c9(i)?(e=Iu(i,e),t.tag=1,t=hA(null,t,i,e,n)):(t.tag=0,t=Ov(null,t,i,e,n));else{if(i!=null){if(s=i.$$typeof,s===Mw){t.tag=11,t=cA(null,t,i,e,n);break e}else if(s===kw){t.tag=14,t=dA(null,t,i,e,n);break e}}throw t=Uv(i)||i,Error(se(306,t,""))}}return t;case 0:return Ov(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,s=Iu(i,t.pendingProps),hA(e,t,i,s,n);case 3:e:{if(Jb(t,t.stateNode.containerInfo),e===null)throw Error(se(387));var r=t.pendingProps;s=t.memoizedState,i=s.element,$v(e,t),H1(t,r,null,n);var o=t.memoizedState;if(r=o.cache,pc(t,fi,r),r!==s.cache&&Vv(t,[fi],n,!0),z1(),r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=gA(e,t,r,n);break e}else if(r!==i){i=Fr(Error(se(424)),t),I0(i),t=gA(e,t,r,n);break e}else for($i=_o(t.stateNode.containerInfo.firstChild),_s=t,Pt=!0,mo=null,Ko=!0,n=aF(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Lp(),r===i){t=Cl(e,t,n);break e}zi(e,t,r,n)}t=t.child}return t;case 26:return F1(e,t),e===null?(n=DA(t.type,null,t.pendingProps,null))?t.memoizedState=n:Pt||(n=t.type,e=t.pendingProps,i=E6(Mc.current).createElement(n),i[ls]=t,i[Gs]=e,Gi(i,n,e),xi(i),t.stateNode=i):t.memoizedState=DA(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return yv(t),e===null&&Pt&&(i=t.stateNode=NB(t.type,t.pendingProps,Mc.current),_s=t,Ko=!0,$i=_o(i.firstChild)),i=t.pendingProps.children,e!==null||Pt?zi(e,t,i,n):t.child=wu(t,null,i,n),F1(e,t),t.child;case 5:return e===null&&Pt&&((s=i=$i)&&(i=Tte(i,t.type,t.pendingProps,Ko),i!==null?(t.stateNode=i,_s=t,$i=_o(i.firstChild),Ko=!1,s=!0):s=!1),s||_u(t)),yv(t),s=t.type,r=t.pendingProps,o=e!==null?e.memoizedProps:null,i=r.children,n4(s,r)?i=null:o!==null&&n4(s,o)&&(t.flags|=32),t.memoizedState!==null&&(s=Ww(e,t,Hee,null,null,n),k0._currentValue=s),F1(e,t),zi(e,t,i,n),t.child;case 6:return e===null&&Pt&&((e=n=$i)&&(n=Ite(n,t.pendingProps,Ko),n!==null?(t.stateNode=n,_s=t,$i=null,e=!0):e=!1),e||_u(t)),null;case 13:return ZF(e,t,n);case 4:return Jb(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=wu(t,null,i,n):zi(e,t,i,n),t.child;case 11:return cA(e,t,t.type,t.pendingProps,n);case 7:return zi(e,t,t.pendingProps,n),t.child;case 8:return zi(e,t,t.pendingProps.children,n),t.child;case 12:return zi(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,pc(t,t.type,i.value),zi(e,t,i.children,n),t.child;case 9:return s=t.type._context,i=t.pendingProps.children,Su(t),s=cs(s),i=i(s),t.flags|=1,zi(e,t,i,n),t.child;case 14:return dA(e,t,t.type,t.pendingProps,n);case 15:return WF(e,t,t.type,t.pendingProps,n);case 19:return qF(e,t,n);case 22:return KF(e,t,n);case 24:return Su(t),i=cs(fi),e===null?(s=jw(),s===null&&(s=rn,r=Xw(),s.pooledCache=r,r.refCount++,r!==null&&(s.pooledCacheLanes|=n),s=r),t.memoizedState={parent:i,cache:s},o9(t),pc(t,fi,s)):(e.lanes&n&&($v(e,t),H1(t,null,null,n),z1()),s=e.memoizedState,r=t.memoizedState,s.parent!==i?(s={parent:i,cache:i},t.memoizedState=s,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=s),pc(t,fi,i)):(i=r.cache,pc(t,fi,i),i!==s.cache&&Vv(t,[fi],n,!0))),zi(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(se(156,t.tag))}var zv=Ra(null),ef=null,hl=null;function pc(e,t,n){Un(zv,t._currentValue),t._currentValue=n}function pl(e){e._currentValue=zv.current,Ri(zv)}function Hv(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Vv(e,t,n,i){var s=e.child;for(s!==null&&(s.return=e);s!==null;){var r=s.dependencies;if(r!==null){var o=s.child;r=r.firstContext;e:for(;r!==null;){var a=r;r=s;for(var l=0;l<t.length;l++)if(a.context===t[l]){r.lanes|=n,a=r.alternate,a!==null&&(a.lanes|=n),Hv(r.return,n,e),i||(o=null);break e}r=a.next}}else if(s.tag===18){if(o=s.return,o===null)throw Error(se(341));o.lanes|=n,r=o.alternate,r!==null&&(r.lanes|=n),Hv(o,n,e),o=null}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}}function Op(e,t,n,i){e=null;for(var s=t,r=!1;s!==null;){if(!r){if(s.flags&524288)r=!0;else if(s.flags&262144)break}if(s.tag===10){var o=s.alternate;if(o===null)throw Error(se(387));if(o=o.memoizedProps,o!==null){var a=s.type;Er(s.pendingProps.value,o.value)||(e!==null?e.push(a):e=[a])}}else if(s===Qb.current){if(o=s.alternate,o===null)throw Error(se(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(e!==null?e.push(k0):e=[k0])}s=s.return}e!==null&&Vv(t,e,n,i),t.flags|=262144}function h6(e){for(e=e.firstContext;e!==null;){if(!Er(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Su(e){ef=e,hl=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function cs(e){return JF(ef,e)}function oU(e,t){return ef===null&&Su(e),JF(e,t)}function JF(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},hl===null){if(e===null)throw Error(se(308));hl=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else hl=hl.next=t;return n}var lc=!1;function o9(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $v(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function kc(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Rc(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,_n&2){var s=i.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),i.pending=t,t=s6(e),nF(e,null,n),t}return Ty(e,i,t,n),s6(e)}function B1(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194176)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,AO(e,n)}}function t3(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var s=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?s=r=o:r=r.next=o,n=n.next}while(n!==null);r===null?s=r=t:r=r.next=t}else s=r=t;n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Gv=!1;function z1(){if(Gv){var e=Ih;if(e!==null)throw e}}function H1(e,t,n,i){Gv=!1;var s=e.updateQueue;lc=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?r=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(r!==null){var u=s.baseState;o=0,d=c=l=null,a=r;do{var f=a.lane&-536870913,h=f!==a.lane;if(h?(vt&f)===f:(i&f)===f){f!==0&&f===Zh&&(Gv=!0),d!==null&&(d=d.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,p=a;f=t;var U=n;switch(p.tag){case 1:if(m=p.payload,typeof m=="function"){u=m.call(U,u,f);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(U,u,f):m,f==null)break e;u=un({},u,f);break e;case 2:lc=!0}}f=a.callback,f!==null&&(e.flags|=64,h&&(e.flags|=8192),h=s.callbacks,h===null?s.callbacks=[f]:h.push(f))}else h={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=h,l=u):d=d.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);d===null&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,r===null&&(s.shared.lanes=0),nd|=o,e.lanes=o,e.memoizedState=u}}function eB(e,t){if(typeof e!="function")throw Error(se(191,e));e.call(t)}function tB(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)eB(n[e],t)}function Fp(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var s=i.next;n=s;do{if((n.tag&e)===e){i=void 0;var r=n.create,o=n.inst;i=r(),o.destroy=i}n=n.next}while(n!==s)}}catch(a){Kt(t,t.return,a)}}function td(e,t,n){try{var i=t.updateQueue,s=i!==null?i.lastEffect:null;if(s!==null){var r=s.next;i=r;do{if((i.tag&e)===e){var o=i.inst,a=o.destroy;if(a!==void 0){o.destroy=void 0,s=t;var l=n;try{a()}catch(c){Kt(s,l,c)}}}i=i.next}while(i!==r)}}catch(c){Kt(t,t.return,c)}}function nB(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{tB(t,n)}catch(i){Kt(e,e.return,i)}}}function iB(e,t,n){n.props=Iu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Kt(e,t,i)}}function eu(e,t){try{var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 26:case 27:case 5:var s=i;break;default:s=i}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){Kt(e,t,r)}}function rr(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(s){Kt(e,t,s)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(s){Kt(e,t,s)}else n.current=null}function sB(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(s){Kt(e,e.return,s)}}function pA(e,t,n){try{var i=e.stateNode;yte(i,e.type,n,t),i[Gs]=t}catch(s){Kt(e,e.return,s)}}function rB(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function n3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||rB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xv(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ky));else if(i!==4&&i!==27&&(e=e.child,e!==null))for(Xv(e,t,n),e=e.sibling;e!==null;)Xv(e,t,n),e=e.sibling}function g6(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&i!==27&&(e=e.child,e!==null))for(g6(e,t,n),e=e.sibling;e!==null;)g6(e,t,n),e=e.sibling}var nl=!1,xn=!1,i3=!1,UA=typeof WeakSet=="function"?WeakSet:Set,Ci=null,bA=!1;function Kee(e,t){if(e=e.containerInfo,e4=T6,e=KO(e),Bw(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,u=e,f=null;t:for(;;){for(var h;u!==n||s!==0&&u.nodeType!==3||(a=o+s),u!==r||i!==0&&u.nodeType!==3||(l=o+i),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===n&&++c===s&&(a=o),f===r&&++d===i&&(l=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(t4={focusedElem:e,selectionRange:n},T6=!1,Ci=t;Ci!==null;)if(t=Ci,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ci=e;else for(;Ci!==null;){switch(t=Ci,r=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&r!==null){e=void 0,n=t,s=r.memoizedProps,r=r.memoizedState,i=n.stateNode;try{var m=Iu(n.type,s,n.elementType===n.type);e=i.getSnapshotBeforeUpdate(m,r),i.__reactInternalSnapshotBeforeUpdate=e}catch(p){Kt(n,n.return,p)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)i4(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":i4(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(se(163))}if(e=t.sibling,e!==null){e.return=t.return,Ci=e;break}Ci=t.return}return m=bA,bA=!1,m}function oB(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Ha(e,n),i&4&&Fp(5,n);break;case 1:if(Ha(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(a){Kt(n,n.return,a)}else{var s=Iu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Kt(n,n.return,a)}}i&64&&nB(n),i&512&&eu(n,n.return);break;case 3:if(Ha(e,n),i&64&&(i=n.updateQueue,i!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{tB(i,e)}catch(a){Kt(n,n.return,a)}}break;case 26:Ha(e,n),i&512&&eu(n,n.return);break;case 27:case 5:Ha(e,n),t===null&&i&4&&sB(n),i&512&&eu(n,n.return);break;case 12:Ha(e,n);break;case 13:Ha(e,n),i&4&&cB(e,n);break;case 22:if(s=n.memoizedState!==null||nl,!s){t=t!==null&&t.memoizedState!==null||xn;var r=nl,o=xn;nl=s,(xn=t)&&!o?nc(e,n,(n.subtreeFlags&8772)!==0):Ha(e,n),nl=r,xn=o}i&512&&(n.memoizedProps.mode==="manual"?eu(n,n.return):rr(n,n.return));break;default:Ha(e,n)}}function aB(e){var t=e.alternate;t!==null&&(e.alternate=null,aB(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Dw(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Zn=null,Js=!1;function za(e,t,n){for(n=n.child;n!==null;)lB(e,t,n),n=n.sibling}function lB(e,t,n){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Mp,n)}catch{}switch(n.tag){case 26:xn||rr(n,t),za(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:xn||rr(n,t);var i=Zn,s=Js;for(Zn=n.stateNode,za(e,t,n),n=n.stateNode,t=n.attributes;t.length;)n.removeAttributeNode(t[0]);Dw(n),Zn=i,Js=s;break;case 5:xn||rr(n,t);case 6:s=Zn;var r=Js;if(Zn=null,za(e,t,n),Zn=s,Js=r,Zn!==null)if(Js)try{e=Zn,i=n.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)}catch(o){Kt(n,t,o)}else try{Zn.removeChild(n.stateNode)}catch(o){Kt(n,t,o)}break;case 18:Zn!==null&&(Js?(t=Zn,n=n.stateNode,t.nodeType===8?m3(t.parentNode,n):t.nodeType===1&&m3(t,n),L0(t)):m3(Zn,n.stateNode));break;case 4:i=Zn,s=Js,Zn=n.stateNode.containerInfo,Js=!0,za(e,t,n),Zn=i,Js=s;break;case 0:case 11:case 14:case 15:xn||td(2,n,t),xn||td(4,n,t),za(e,t,n);break;case 1:xn||(rr(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&iB(n,t,i)),za(e,t,n);break;case 21:za(e,t,n);break;case 22:xn||rr(n,t),xn=(i=xn)||n.memoizedState!==null,za(e,t,n),xn=i;break;default:za(e,t,n)}}function cB(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{L0(e)}catch(n){Kt(t,t.return,n)}}function Zee(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new UA),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new UA),t;default:throw Error(se(435,e.tag))}}function s3(e,t){var n=Zee(e);t.forEach(function(i){var s=cte.bind(null,e,i);n.has(i)||(n.add(i),i.then(s,s))})}function Cr(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i],r=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 27:case 5:Zn=a.stateNode,Js=!1;break e;case 3:Zn=a.stateNode.containerInfo,Js=!0;break e;case 4:Zn=a.stateNode.containerInfo,Js=!0;break e}a=a.return}if(Zn===null)throw Error(se(160));lB(r,o,s),Zn=null,Js=!1,r=s.alternate,r!==null&&(r.return=null),s.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)dB(t,e),t=t.sibling}var uo=null;function dB(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Cr(t,e),xr(e),i&4&&(td(3,e,e.return),Fp(3,e),td(5,e,e.return));break;case 1:Cr(t,e),xr(e),i&512&&(xn||n===null||rr(n,n.return)),i&64&&nl&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var s=uo;if(Cr(t,e),xr(e),i&512&&(xn||n===null||rr(n,n.return)),i&4){var r=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,s=s.ownerDocument||s;t:switch(i){case"title":r=s.getElementsByTagName("title")[0],(!r||r[v0]||r[ls]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=s.createElement(i),s.head.insertBefore(r,s.querySelector("head > title"))),Gi(r,i,n),r[ls]=e,xi(r),i=r;break e;case"link":var o=PA("link","href",s).get(i+(n.href||""));if(o){for(var a=0;a<o.length;a++)if(r=o[a],r.getAttribute("href")===(n.href==null?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){o.splice(a,1);break t}}r=s.createElement(i),Gi(r,i,n),s.head.appendChild(r);break;case"meta":if(o=PA("meta","content",s).get(i+(n.content||""))){for(a=0;a<o.length;a++)if(r=o[a],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){o.splice(a,1);break t}}r=s.createElement(i),Gi(r,i,n),s.head.appendChild(r);break;default:throw Error(se(468,i))}r[ls]=e,xi(r),i=r}e.stateNode=i}else NA(s,e.type,e.stateNode);else e.stateNode=LA(s,i,e.memoizedProps);else r!==i?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,i===null?NA(s,e.type,e.stateNode):LA(s,i,e.memoizedProps)):i===null&&e.stateNode!==null&&pA(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(i&4&&e.alternate===null){s=e.stateNode,r=e.memoizedProps;try{for(var l=s.firstChild;l;){var c=l.nextSibling,d=l.nodeName;l[v0]||d==="HEAD"||d==="BODY"||d==="SCRIPT"||d==="STYLE"||d==="LINK"&&l.rel.toLowerCase()==="stylesheet"||s.removeChild(l),l=c}for(var u=e.type,f=s.attributes;f.length;)s.removeAttributeNode(f[0]);Gi(s,u,r),s[ls]=e,s[Gs]=r}catch(m){Kt(e,e.return,m)}}case 5:if(Cr(t,e),xr(e),i&512&&(xn||n===null||rr(n,n.return)),e.flags&32){s=e.stateNode;try{Wh(s,"")}catch(m){Kt(e,e.return,m)}}i&4&&e.stateNode!=null&&(s=e.memoizedProps,pA(e,s,n!==null?n.memoizedProps:s)),i&1024&&(i3=!0);break;case 6:if(Cr(t,e),xr(e),i&4){if(e.stateNode===null)throw Error(se(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){Kt(e,e.return,m)}}break;case 3:if(pb=null,s=uo,uo=v6(t.containerInfo),Cr(t,e),uo=s,xr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{L0(t.containerInfo)}catch(m){Kt(e,e.return,m)}i3&&(i3=!1,uB(e));break;case 4:i=uo,uo=v6(e.stateNode.containerInfo),Cr(t,e),xr(e),uo=i;break;case 12:Cr(t,e),xr(e);break;case 13:Cr(t,e),xr(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(f9=ca()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,s3(e,i)));break;case 22:if(i&512&&(xn||n===null||rr(n,n.return)),l=e.memoizedState!==null,c=n!==null&&n.memoizedState!==null,d=nl,u=xn,nl=d||l,xn=u||c,Cr(t,e),xn=u,nl=d,xr(e),t=e.stateNode,t._current=e,t._visibility&=-3,t._visibility|=t._pendingVisibility&2,i&8192&&(t._visibility=l?t._visibility&-2:t._visibility|1,l&&(t=nl||xn,n===null||c||t||Of(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(n=null,t=e;;){if(t.tag===5||t.tag===26||t.tag===27){if(n===null){c=n=t;try{if(s=c.stateNode,l)r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none";else{o=c.stateNode,a=c.memoizedProps.style;var h=a!=null&&a.hasOwnProperty("display")?a.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(m){Kt(c,c.return,m)}}}else if(t.tag===6){if(n===null){c=t;try{c.stateNode.nodeValue=l?"":c.memoizedProps}catch(m){Kt(c,c.return,m)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,s3(e,n))));break;case 19:Cr(t,e),xr(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,s3(e,i)));break;case 21:break;default:Cr(t,e),xr(e)}}function xr(e){var t=e.flags;if(t&2){try{if(e.tag!==27){e:{for(var n=e.return;n!==null;){if(rB(n)){var i=n;break e}n=n.return}throw Error(se(160))}switch(i.tag){case 27:var s=i.stateNode,r=n3(e);g6(e,r,s);break;case 5:var o=i.stateNode;i.flags&32&&(Wh(o,""),i.flags&=-33);var a=n3(e);g6(e,a,o);break;case 3:case 4:var l=i.stateNode.containerInfo,c=n3(e);Xv(e,c,l);break;default:throw Error(se(161))}}}catch(d){Kt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function uB(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;uB(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ha(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)oB(e,t.alternate,t),t=t.sibling}function Of(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:td(4,t,t.return),Of(t);break;case 1:rr(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&iB(t,t.return,n),Of(t);break;case 26:case 27:case 5:rr(t,t.return),Of(t);break;case 22:rr(t,t.return),t.memoizedState===null&&Of(t);break;default:Of(t)}e=e.sibling}}function nc(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,s=e,r=t,o=r.flags;switch(r.tag){case 0:case 11:case 15:nc(s,r,n),Fp(4,r);break;case 1:if(nc(s,r,n),i=r,s=i.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(c){Kt(i,i.return,c)}if(i=r,s=i.updateQueue,s!==null){var a=i.stateNode;try{var l=s.shared.hiddenCallbacks;if(l!==null)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)eB(l[s],a)}catch(c){Kt(i,i.return,c)}}n&&o&64&&nB(r),eu(r,r.return);break;case 26:case 27:case 5:nc(s,r,n),n&&i===null&&o&4&&sB(r),eu(r,r.return);break;case 12:nc(s,r,n);break;case 13:nc(s,r,n),n&&o&4&&cB(s,r);break;case 22:r.memoizedState===null&&nc(s,r,n),eu(r,r.return);break;default:nc(s,r,n)}t=t.sibling}}function a9(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Pp(n))}function l9(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Pp(e))}function Ql(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)fB(e,t,n,i),t=t.sibling}function fB(e,t,n,i){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Ql(e,t,n,i),s&2048&&Fp(9,t);break;case 3:Ql(e,t,n,i),s&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Pp(e)));break;case 12:if(s&2048){Ql(e,t,n,i),e=t.stateNode;try{var r=t.memoizedProps,o=r.id,a=r.onPostCommit;typeof a=="function"&&a(o,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Kt(t,t.return,l)}}else Ql(e,t,n,i);break;case 23:break;case 22:r=t.stateNode,t.memoizedState!==null?r._visibility&4?Ql(e,t,n,i):V1(e,t):r._visibility&4?Ql(e,t,n,i):(r._visibility|=4,Ff(e,t,n,i,(t.subtreeFlags&10256)!==0)),s&2048&&a9(t.alternate,t);break;case 24:Ql(e,t,n,i),s&2048&&l9(t.alternate,t);break;default:Ql(e,t,n,i)}}function Ff(e,t,n,i,s){for(s=s&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var r=e,o=t,a=n,l=i,c=o.flags;switch(o.tag){case 0:case 11:case 15:Ff(r,o,a,l,s),Fp(8,o);break;case 23:break;case 22:var d=o.stateNode;o.memoizedState!==null?d._visibility&4?Ff(r,o,a,l,s):V1(r,o):(d._visibility|=4,Ff(r,o,a,l,s)),s&&c&2048&&a9(o.alternate,o);break;case 24:Ff(r,o,a,l,s),s&&c&2048&&l9(o.alternate,o);break;default:Ff(r,o,a,l,s)}t=t.sibling}}function V1(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,s=i.flags;switch(i.tag){case 22:V1(n,i),s&2048&&a9(i.alternate,i);break;case 24:V1(n,i),s&2048&&l9(i.alternate,i);break;default:V1(n,i)}t=t.sibling}}var a1=8192;function If(e){if(e.subtreeFlags&a1)for(e=e.child;e!==null;)hB(e),e=e.sibling}function hB(e){switch(e.tag){case 26:If(e),e.flags&a1&&e.memoizedState!==null&&Fte(uo,e.memoizedState,e.memoizedProps);break;case 5:If(e);break;case 3:case 4:var t=uo;uo=v6(e.stateNode.containerInfo),If(e),uo=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=a1,a1=16777216,If(e),a1=t):If(e));break;default:If(e)}}function gB(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Am(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ci=i,pB(i,e)}gB(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)mB(e),e=e.sibling}function mB(e){switch(e.tag){case 0:case 11:case 15:Am(e),e.flags&2048&&td(9,e,e.return);break;case 3:Am(e);break;case 12:Am(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&4&&(e.return===null||e.return.tag!==13)?(t._visibility&=-5,hb(e)):Am(e);break;default:Am(e)}}function hb(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ci=i,pB(i,e)}gB(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:td(8,t,t.return),hb(t);break;case 22:n=t.stateNode,n._visibility&4&&(n._visibility&=-5,hb(t));break;default:hb(t)}e=e.sibling}}function pB(e,t){for(;Ci!==null;){var n=Ci;switch(n.tag){case 0:case 11:case 15:td(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Pp(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Ci=i;else e:for(n=e;Ci!==null;){i=Ci;var s=i.sibling,r=i.return;if(aB(i),i===n){Ci=null;break e}if(s!==null){s.return=r,Ci=s;break e}Ci=r}}}function qee(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(e,t,n,i){return new qee(e,t,n,i)}function c9(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return n===null?(n=Vr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&31457280,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function UB(e,t){e.flags&=31457282;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function gb(e,t,n,i,s,r){var o=0;if(i=e,typeof e=="function")c9(e)&&(o=1);else if(typeof e=="string")o=Nte(e,n,la.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Kf:return hu(n.children,s,r,t);case bO:o=8,s|=24;break;case gv:return e=Vr(12,n,t,s|2),e.elementType=gv,e.lanes=r,e;case mv:return e=Vr(13,n,t,s),e.elementType=mv,e.lanes=r,e;case pv:return e=Vr(19,n,t,s),e.elementType=pv,e.lanes=r,e;case EO:return bB(n,s,r,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _J:case cl:o=10;break e;case yO:o=9;break e;case Mw:o=11;break e;case kw:o=14;break e;case ac:o=16,i=null;break e}o=29,n=Error(se(130,e===null?"null":typeof e,"")),i=null}return t=Vr(o,n,t,s),t.elementType=e,t.type=i,t.lanes=r,t}function hu(e,t,n,i){return e=Vr(7,e,i,t),e.lanes=n,e}function bB(e,t,n,i){e=Vr(22,e,i,t),e.elementType=EO,e.lanes=n;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var r=s._current;if(r===null)throw Error(se(456));if(!(s._pendingVisibility&2)){var o=Jc(r,2);o!==null&&(s._pendingVisibility|=2,Is(o,r,2))}},attach:function(){var r=s._current;if(r===null)throw Error(se(456));if(s._pendingVisibility&2){var o=Jc(r,2);o!==null&&(s._pendingVisibility&=-3,Is(o,r,2))}}};return e.stateNode=s,e}function r3(e,t,n){return e=Vr(6,e,null,t),e.lanes=n,e}function o3(e,t,n){return t=Vr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Va(e){e.flags|=4}function yA(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!BB(t)){if(t=Jr.current,t!==null&&((vt&4194176)===vt?da!==null:(vt&62914560)!==vt&&!(vt&536870912)||t!==da))throw P1=Av,sF;e.flags|=8192}}function aU(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?CO():536870912,e.lanes|=t,Qh|=t)}function Mm(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function yn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags&31457280,i|=s.flags&31457280,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Qee(e,t,n){var i=t.pendingProps;switch($w(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(t),null;case 1:return yn(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),pl(fi),jh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Cm(t)?Va(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,mo!==null&&(Zv(mo),mo=null))),yn(t),null;case 26:return n=t.memoizedState,e===null?(Va(t),n!==null?(yn(t),yA(t,n)):(yn(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Va(t),yn(t),yA(t,n)):(yn(t),t.flags&=-16777217):(e.memoizedProps!==i&&Va(t),yn(t),t.flags&=-16777217),null;case 27:e6(t),n=Mc.current;var s=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Va(t);else{if(!i){if(t.stateNode===null)throw Error(se(166));return yn(t),null}e=la.current,Cm(t)?Kx(t):(e=NB(s,i,n),t.stateNode=e,Va(t))}return yn(t),null;case 5:if(e6(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Va(t);else{if(!i){if(t.stateNode===null)throw Error(se(166));return yn(t),null}if(e=la.current,Cm(t))Kx(t);else{switch(s=E6(Mc.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof i.is=="string"?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e=typeof i.is=="string"?s.createElement(n,{is:i.is}):s.createElement(n)}}e[ls]=t,e[Gs]=i;e:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(Gi(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Va(t)}}return yn(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Va(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(se(166));if(e=Mc.current,Cm(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,s=_s,s!==null)switch(s.tag){case 27:case 5:i=s.memoizedProps}e[ls]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||DB(e.nodeValue,n)),e||_u(t)}else e=E6(e).createTextNode(i),e[ls]=t,t.stateNode=e}return yn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(s=Cm(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(se(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[ls]=t}else Lp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yn(t),s=!1}else mo!==null&&(Zv(mo),mo=null),s=!0;if(!s)return t.flags&256?(fl(t),t):(fl(t),null)}if(fl(t),t.flags&128)return t.lanes=n,t;if(n=i!==null,e=e!==null&&e.memoizedState!==null,n){i=t.child,s=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(s=i.alternate.memoizedState.cachePool.pool);var r=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==s&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),aU(t,t.updateQueue),yn(t),null;case 4:return jh(),e===null&&m9(t.stateNode.containerInfo),yn(t),null;case 10:return pl(t.type),yn(t),null;case 19:if(Ri(hi),s=t.memoizedState,s===null)return yn(t),null;if(i=(t.flags&128)!==0,r=s.rendering,r===null)if(i)Mm(s,!1);else{if(Mn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(r=l6(e),r!==null){for(t.flags|=128,Mm(s,!1),e=r.updateQueue,t.updateQueue=e,aU(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)UB(n,e),n=n.sibling;return Un(hi,hi.current&1|2),t.child}e=e.sibling}s.tail!==null&&ca()>m6&&(t.flags|=128,i=!0,Mm(s,!1),t.lanes=4194304)}else{if(!i)if(e=l6(r),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,aU(t,e),Mm(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!Pt)return yn(t),null}else 2*ca()-s.renderingStartTime>m6&&n!==536870912&&(t.flags|=128,i=!0,Mm(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(e=s.last,e!==null?e.sibling=r:t.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ca(),t.sibling=null,e=hi.current,Un(hi,i?e&1|2:e&1),t):(yn(t),null);case 22:case 23:return fl(t),Gw(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?n&536870912&&!(t.flags&128)&&(yn(t),t.subtreeFlags&6&&(t.flags|=8192)):yn(t),n=t.updateQueue,n!==null&&aU(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&Ri(fu),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),pl(fi),yn(t),null;case 25:return null}throw Error(se(156,t.tag))}function Jee(e,t){switch($w(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pl(fi),jh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return e6(t),null;case 13:if(fl(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(se(340));Lp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ri(hi),null;case 4:return jh(),null;case 10:return pl(t.type),null;case 22:case 23:return fl(t),Gw(),e!==null&&Ri(fu),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return pl(fi),null;case 25:return null;default:return null}}function yB(e,t){switch($w(t),t.tag){case 3:pl(fi),jh();break;case 26:case 27:case 5:e6(t);break;case 4:jh();break;case 13:fl(t);break;case 19:Ri(hi);break;case 10:pl(t.type);break;case 22:case 23:fl(t),Gw(),e!==null&&Ri(fu);break;case 24:pl(fi)}}var ete={getCacheForType:function(e){var t=cs(fi),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},tte=typeof WeakMap=="function"?WeakMap:Map,_n=0,rn=null,lt=null,vt=0,nn=0,er=null,il=!1,zg=!1,d9=!1,xl=0,Mn=0,nd=0,gu=0,u9=0,$r=0,Qh=0,$1=null,Zo=null,jv=!1,f9=0,m6=1/0,p6=null,Lc=null,lU=!1,Wd=null,G1=0,Yv=0,Wv=null,X1=0,Kv=null;function pr(){if(_n&2&&vt!==0)return vt&-vt;if(nt.T!==null){var e=Zh;return e!==0?e:g9()}return kO()}function EB(){$r===0&&($r=!(vt&536870912)||Pt?SO():536870912);var e=Jr.current;return e!==null&&(e.flags|=32),$r}function Is(e,t,n){(e===rn&&nn===2||e.cancelPendingCommit!==null)&&(Jh(e,0),sl(e,vt,$r,!1)),Rp(e,n),(!(_n&2)||e!==rn)&&(e===rn&&(!(_n&2)&&(gu|=n),Mn===4&&sl(e,vt,$r,!1)),Da(e))}function vB(e,t,n){if(_n&6)throw Error(se(327));var i=!n&&(t&60)===0&&(t&e.expiredLanes)===0||kp(e,t),s=i?ste(e,t):a3(e,t,!0),r=i;do{if(s===0){zg&&!i&&sl(e,t,0,!1);break}else if(s===6)sl(e,t,0,!il);else{if(n=e.current.alternate,r&&!nte(n)){s=a3(e,t,!1),r=!1;continue}if(s===2){if(r=t,e.errorRecoveryDisabledLanes&r)var o=0;else o=e.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){t=o;e:{var a=e;s=$1;var l=a.current.memoizedState.isDehydrated;if(l&&(Jh(a,o).flags|=256),o=a3(a,o,!1),o!==2){if(d9&&!l){a.errorRecoveryDisabledLanes|=r,gu|=r,s=4;break e}r=Zo,Zo=s,r!==null&&Zv(r)}s=o}if(r=!1,s!==2)continue}}if(s===1){Jh(e,0),sl(e,t,0,!0);break}e:{switch(i=e,s){case 0:case 1:throw Error(se(345));case 4:if((t&4194176)===t){sl(i,t,$r,!il);break e}break;case 2:Zo=null;break;case 3:case 5:break;default:throw Error(se(329))}if(i.finishedWork=n,i.finishedLanes=t,(t&62914560)===t&&(r=f9+300-ca(),10<r)){if(sl(i,t,$r,!il),yy(i,0)!==0)break e;i.timeoutHandle=PB(EA.bind(null,i,n,Zo,p6,jv,t,$r,gu,Qh,il,2,-0,0),r);break e}EA(i,n,Zo,p6,jv,t,$r,gu,Qh,il,0,-0,0)}}break}while(!0);Da(e)}function Zv(e){Zo===null?Zo=e:Zo.push.apply(Zo,e)}function EA(e,t,n,i,s,r,o,a,l,c,d,u,f){var h=t.subtreeFlags;if((h&8192||(h&16785408)===16785408)&&(M0={stylesheets:null,count:0,unsuspend:Ote},hB(t),t=Bte(),t!==null)){e.cancelPendingCommit=t(_A.bind(null,e,n,i,s,o,a,l,1,u,f)),sl(e,r,o,!c);return}_A(e,n,i,s,o,a,l,d,u,f)}function nte(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!Er(r(),s))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sl(e,t,n,i){t&=~u9,t&=~gu,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var s=t;0<s;){var r=31-mr(s),o=1<<r;i[r]=-1,s&=~o}n!==0&&xO(e,n,t)}function Ay(){return _n&6?!0:(Bp(0),!1)}function h9(){if(lt!==null){if(nn===0)var e=lt.return;else e=lt,hl=ef=null,qw(e),Th=null,S0=0,e=lt;for(;e!==null;)yB(e.alternate,e),e=e.return;lt=null}}function Jh(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,vte(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),h9(),rn=e,lt=n=Dc(e.current,null),vt=t,nn=0,er=null,il=!1,zg=kp(e,t),d9=!1,Qh=$r=u9=gu=nd=Mn=0,Zo=$1=null,jv=!1,t&8&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var s=31-mr(i),r=1<<s;t|=e[s],i&=~r}return xl=t,wy(),n}function _B(e,t){st=null,nt.H=pa,t===L1?(t=Qx(),nn=3):t===sF?(t=Qx(),nn=4):nn=t===YF?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,er=t,lt===null&&(Mn=1,f6(e,Fr(t,e.current)))}function wB(){var e=nt.H;return nt.H=pa,e===null?pa:e}function TB(){var e=nt.A;return nt.A=ete,e}function qv(){Mn=4,il||(vt&4194176)!==vt&&Jr.current!==null||(zg=!0),!(nd&134217727)&&!(gu&134217727)||rn===null||sl(rn,vt,$r,!1)}function a3(e,t,n){var i=_n;_n|=2;var s=wB(),r=TB();(rn!==e||vt!==t)&&(p6=null,Jh(e,t)),t=!1;var o=Mn;e:do try{if(nn!==0&&lt!==null){var a=lt,l=er;switch(nn){case 8:h9(),o=6;break e;case 3:case 2:case 6:Jr.current===null&&(t=!0);var c=nn;if(nn=0,er=null,rh(e,a,l,c),n&&zg){o=0;break e}break;default:c=nn,nn=0,er=null,rh(e,a,l,c)}}ite(),o=Mn;break}catch(d){_B(e,d)}while(!0);return t&&e.shellSuspendCounter++,hl=ef=null,_n=i,nt.H=s,nt.A=r,lt===null&&(rn=null,vt=0,wy()),o}function ite(){for(;lt!==null;)IB(lt)}function ste(e,t){var n=_n;_n|=2;var i=wB(),s=TB();rn!==e||vt!==t?(p6=null,m6=ca()+500,Jh(e,t)):zg=kp(e,t);e:do try{if(nn!==0&&lt!==null){t=lt;var r=er;t:switch(nn){case 1:nn=0,er=null,rh(e,t,r,1);break;case 2:if(qx(r)){nn=0,er=null,vA(t);break}t=function(){nn===2&&rn===e&&(nn=7),Da(e)},r.then(t,t);break e;case 3:nn=7;break e;case 4:nn=5;break e;case 7:qx(r)?(nn=0,er=null,vA(t)):(nn=0,er=null,rh(e,t,r,7));break;case 5:var o=null;switch(lt.tag){case 26:o=lt.memoizedState;case 5:case 27:var a=lt;if(!o||BB(o)){nn=0,er=null;var l=a.sibling;if(l!==null)lt=l;else{var c=a.return;c!==null?(lt=c,My(c)):lt=null}break t}}nn=0,er=null,rh(e,t,r,5);break;case 6:nn=0,er=null,rh(e,t,r,6);break;case 8:h9(),Mn=6;break e;default:throw Error(se(462))}}rte();break}catch(d){_B(e,d)}while(!0);return hl=ef=null,nt.H=i,nt.A=s,_n=n,lt!==null?0:(rn=null,vt=0,wy(),Mn)}function rte(){for(;lt!==null&&!CJ();)IB(lt)}function IB(e){var t=QF(e.alternate,e,xl);e.memoizedProps=e.pendingProps,t===null?My(e):lt=t}function vA(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=fA(n,t,t.pendingProps,t.type,void 0,vt);break;case 11:t=fA(n,t,t.pendingProps,t.type.render,t.ref,vt);break;case 5:qw(t);default:yB(n,t),t=lt=UB(t,xl),t=QF(n,t,xl)}e.memoizedProps=e.pendingProps,t===null?My(e):lt=t}function rh(e,t,n,i){hl=ef=null,qw(t),Th=null,S0=0;var s=t.return;try{if(Yee(e,s,t,n,vt)){Mn=1,f6(e,Fr(n,e.current)),lt=null;return}}catch(r){if(s!==null)throw lt=s,r;Mn=1,f6(e,Fr(n,e.current)),lt=null;return}t.flags&32768?(Pt||i===1?e=!0:zg||vt&536870912?e=!1:(il=e=!0,(i===2||i===3||i===6)&&(i=Jr.current,i!==null&&i.tag===13&&(i.flags|=16384))),SB(t,e)):My(t)}function My(e){var t=e;do{if(t.flags&32768){SB(t,il);return}e=t.return;var n=Qee(t.alternate,t,xl);if(n!==null){lt=n;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);Mn===0&&(Mn=5)}function SB(e,t){do{var n=Jee(e.alternate,e);if(n!==null){n.flags&=32767,lt=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){lt=e;return}lt=e=n}while(e!==null);Mn=6,lt=null}function _A(e,t,n,i,s,r,o,a,l,c){var d=nt.T,u=dn.p;try{dn.p=2,nt.T=null,ote(e,t,n,i,u,s,r,o,a,l,c)}finally{nt.T=d,dn.p=u}}function ote(e,t,n,i,s,r,o,a){do xh();while(Wd!==null);if(_n&6)throw Error(se(327));var l=e.finishedWork;if(i=e.finishedLanes,l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(se(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var c=l.lanes|l.childLanes;if(c|=zw,FJ(e,i,c,r,o,a),e===rn&&(lt=rn=null,vt=0),!(l.subtreeFlags&10256)&&!(l.flags&10256)||lU||(lU=!0,Yv=c,Wv=n,dte(t6,function(){return xh(),null})),n=(l.flags&15990)!==0,l.subtreeFlags&15990||n?(n=nt.T,nt.T=null,r=dn.p,dn.p=2,o=_n,_n|=4,Kee(e,l),dB(l,e),Mee(t4,e.containerInfo),T6=!!e4,t4=e4=null,e.current=l,oB(e,l.alternate,l),xJ(),_n=o,dn.p=r,nt.T=n):e.current=l,lU?(lU=!1,Wd=e,G1=i):CB(e,c),c=e.pendingLanes,c===0&&(Lc=null),DJ(l.stateNode),Da(e),t!==null)for(s=e.onRecoverableError,l=0;l<t.length;l++)c=t[l],s(c.value,{componentStack:c.stack});return G1&3&&xh(),c=e.pendingLanes,i&4194218&&c&42?e===Kv?X1++:(X1=0,Kv=e):X1=0,Bp(0),null}function CB(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Pp(t)))}function xh(){if(Wd!==null){var e=Wd,t=Yv;Yv=0;var n=MO(G1),i=nt.T,s=dn.p;try{if(dn.p=32>n?32:n,nt.T=null,Wd===null)var r=!1;else{n=Wv,Wv=null;var o=Wd,a=G1;if(Wd=null,G1=0,_n&6)throw Error(se(331));var l=_n;if(_n|=4,mB(o.current),fB(o,o.current,a,n),_n=l,Bp(0,!1),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Mp,o)}catch{}r=!0}return r}finally{dn.p=s,nt.T=i,CB(e,t)}}return!1}function wA(e,t,n){t=Fr(n,t),t=Nv(e.stateNode,t,2),e=Rc(e,t,2),e!==null&&(Rp(e,2),Da(e))}function Kt(e,t,n){if(e.tag===3)wA(e,e,n);else for(;t!==null;){if(t.tag===3){wA(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Lc===null||!Lc.has(i))){e=Fr(n,e),n=XF(2),i=Rc(t,n,2),i!==null&&(jF(n,i,t,e),Rp(i,2),Da(i));break}}t=t.return}}function l3(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new tte;var s=new Set;i.set(t,s)}else s=i.get(t),s===void 0&&(s=new Set,i.set(t,s));s.has(n)||(d9=!0,s.add(n),e=ate.bind(null,e,t,n),t.then(e,e))}function ate(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rn===e&&(vt&n)===n&&(Mn===4||Mn===3&&(vt&62914560)===vt&&300>ca()-f9?!(_n&2)&&Jh(e,0):u9|=n,Qh===vt&&(Qh=0)),Da(e)}function xB(e,t){t===0&&(t=CO()),e=Jc(e,t),e!==null&&(Rp(e,t),Da(e))}function lte(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),xB(e,n)}function cte(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(se(314))}i!==null&&i.delete(t),xB(e,n)}function dte(e,t){return Rw(e,t)}var U6=null,Bf=null,Qv=!1,b6=!1,c3=!1,mu=0;function Da(e){e!==Bf&&e.next===null&&(Bf===null?U6=Bf=e:Bf=Bf.next=e),b6=!0,Qv||(Qv=!0,fte(ute))}function Bp(e,t){if(!c3&&b6){c3=!0;do for(var n=!1,i=U6;i!==null;){if(e!==0){var s=i.pendingLanes;if(s===0)var r=0;else{var o=i.suspendedLanes,a=i.pingedLanes;r=(1<<31-mr(42|e)+1)-1,r&=s&~(o&~a),r=r&201326677?r&201326677|1:r?r|2:0}r!==0&&(n=!0,TA(i,r))}else r=vt,r=yy(i,i===rn?r:0),!(r&3)||kp(i,r)||(n=!0,TA(i,r));i=i.next}while(n);c3=!1}}function ute(){b6=Qv=!1;var e=0;mu!==0&&(Ete()&&(e=mu),mu=0);for(var t=ca(),n=null,i=U6;i!==null;){var s=i.next,r=AB(i,t);r===0?(i.next=null,n===null?U6=s:n.next=s,s===null&&(Bf=n)):(n=i,(e!==0||r&3)&&(b6=!0)),i=s}Bp(e)}function AB(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes&-62914561;0<r;){var o=31-mr(r),a=1<<o,l=s[o];l===-1?(!(a&n)||a&i)&&(s[o]=OJ(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}if(t=rn,n=vt,n=yy(e,e===t?n:0),i=e.callbackNode,n===0||e===t&&nn===2||e.cancelPendingCommit!==null)return i!==null&&i!==null&&B8(i),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||kp(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&B8(i),MO(n)){case 2:case 8:n=TO;break;case 32:n=t6;break;case 268435456:n=IO;break;default:n=t6}return i=MB.bind(null,e),n=Rw(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&B8(i),e.callbackPriority=2,e.callbackNode=null,2}function MB(e,t){var n=e.callbackNode;if(xh()&&e.callbackNode!==n)return null;var i=vt;return i=yy(e,e===rn?i:0),i===0?null:(vB(e,i,t),AB(e,ca()),e.callbackNode!=null&&e.callbackNode===n?MB.bind(null,e):null)}function TA(e,t){if(xh())return null;vB(e,t,!0)}function fte(e){_te(function(){_n&6?Rw(wO,e):e()})}function g9(){return mu===0&&(mu=SO()),mu}function IA(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ab(""+e)}function SA(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function hte(e,t,n,i,s){if(t==="submit"&&n&&n.stateNode===s){var r=IA((s[Gs]||null).action),o=i.submitter;o&&(t=(t=o[Gs]||null)?IA(t.formAction):o.getAttribute("formAction"),t!==null&&(r=t,o=null));var a=new Ey("action","action",null,i,s);e.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(mu!==0){var l=o?SA(s,o):new FormData(s);Lv(n,{pending:!0,data:l,method:s.method,action:r},null,l)}}else typeof r=="function"&&(a.preventDefault(),l=o?SA(s,o):new FormData(s),Lv(n,{pending:!0,data:l,method:s.method,action:r},r,l))},currentTarget:s}]})}}for(var d3=0;d3<Yx.length;d3++){var u3=Yx[d3],gte=u3.toLowerCase(),mte=u3[0].toUpperCase()+u3.slice(1);Po(gte,"on"+mte)}Po(qO,"onAnimationEnd");Po(QO,"onAnimationIteration");Po(JO,"onAnimationStart");Po("dblclick","onDoubleClick");Po("focusin","onFocus");Po("focusout","onBlur");Po(Ree,"onTransitionRun");Po(Dee,"onTransitionStart");Po(Lee,"onTransitionCancel");Po(eF,"onTransitionEnd");Yh("onMouseEnter",["mouseout","mouseover"]);Yh("onMouseLeave",["mouseout","mouseover"]);Yh("onPointerEnter",["pointerout","pointerover"]);Yh("onPointerLeave",["pointerout","pointerover"]);Ku("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ku("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ku("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ku("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ku("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ku("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var x0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pte=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(x0));function kB(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(d){u6(d)}s.currentTarget=null,r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(d){u6(d)}s.currentTarget=null,r=l}}}}function mt(e,t){var n=t[vv];n===void 0&&(n=t[vv]=new Set);var i=e+"__bubble";n.has(i)||(RB(t,e,2,!1),n.add(i))}function f3(e,t,n){var i=0;t&&(i|=4),RB(n,e,i,t)}var cU="_reactListening"+Math.random().toString(36).slice(2);function m9(e){if(!e[cU]){e[cU]=!0,RO.forEach(function(n){n!=="selectionchange"&&(pte.has(n)||f3(n,!1,e),f3(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cU]||(t[cU]=!0,f3("selectionchange",!1,t))}}function RB(e,t,n,i){switch(GB(t)){case 2:var s=Vte;break;case 8:s=$te;break;default:s=y9}n=s.bind(null,t,n,e),s=void 0,!Iv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),i?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function h3(e,t,n,i,s){var r=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Jd(a),o===null)return;if(l=o.tag,l===5||l===6||l===26||l===27){i=r=o;continue e}a=a.parentNode}}i=i.return}zO(function(){var c=r,d=Pw(n),u=[];e:{var f=tF.get(e);if(f!==void 0){var h=Ey,m=e;switch(e){case"keypress":if(cb(n)===0)break e;case"keydown":case"keyup":h=cee;break;case"focusin":m="focus",h=G8;break;case"focusout":m="blur",h=G8;break;case"beforeblur":case"afterblur":h=G8;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Px;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=qJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=fee;break;case qO:case QO:case JO:h=eee;break;case eF:h=gee;break;case"scroll":case"scrollend":h=KJ;break;case"wheel":h=pee;break;case"copy":case"cut":case"paste":h=nee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ox;break;case"toggle":case"beforetoggle":h=bee}var p=(t&4)!==0,U=!p&&(e==="scroll"||e==="scrollend"),b=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,E;y!==null;){var _=y;if(E=_.stateNode,_=_.tag,_!==5&&_!==26&&_!==27||E===null||b===null||(_=_0(y,b),_!=null&&p.push(A0(y,_,E))),U)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,d),u.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==Tv&&(m=n.relatedTarget||n.fromElement)&&(Jd(m)||m[Fg]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Jd(m):null,m!==null&&(U=Og(m),p=m.tag,m!==U||p!==5&&p!==27&&p!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=Px,_="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=Ox,_="onPointerLeave",b="onPointerEnter",y="pointer"),U=h==null?f:o1(h),E=m==null?f:o1(m),f=new p(_,y+"leave",h,n,d),f.target=U,f.relatedTarget=E,_=null,Jd(d)===c&&(p=new p(b,y+"enter",m,n,d),p.target=E,p.relatedTarget=U,_=p),U=_,h&&m)t:{for(p=h,b=m,y=0,E=p;E;E=Sf(E))y++;for(E=0,_=b;_;_=Sf(_))E++;for(;0<y-E;)p=Sf(p),y--;for(;0<E-y;)b=Sf(b),E--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=Sf(p),b=Sf(b)}p=null}else p=null;h!==null&&CA(u,f,h,p,!1),m!==null&&U!==null&&CA(u,U,m,p,!0)}}e:{if(f=c?o1(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var I=Hx;else if(zx(f))if(jO)I=xee;else{I=See;var k=Iee}else h=f.nodeName,!h||h.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?c&&Lw(c.elementType)&&(I=Hx):I=Cee;if(I&&(I=I(e,c))){XO(u,I,n,d);break e}k&&k(e,f,c),e==="focusout"&&c&&f.type==="number"&&c.memoizedProps.value!=null&&wv(f,"number",f.value)}switch(k=c?o1(c):window,e){case"focusin":(zx(k)||k.contentEditable==="true")&&(Jf=k,Sv=c,D1=null);break;case"focusout":D1=Sv=Jf=null;break;case"mousedown":Cv=!0;break;case"contextmenu":case"mouseup":case"dragend":Cv=!1,jx(u,n,d);break;case"selectionchange":if(kee)break;case"keydown":case"keyup":jx(u,n,d)}var w;if(Fw)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Qf?$O(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(VO&&n.locale!=="ko"&&(Qf||T!=="onCompositionStart"?T==="onCompositionEnd"&&Qf&&(w=HO()):(wc=d,Nw="value"in wc?wc.value:wc.textContent,Qf=!0)),k=y6(c,T),0<k.length&&(T=new Nx(T,e,null,n,d),u.push({event:T,listeners:k}),w?T.data=w:(w=GO(n),w!==null&&(T.data=w)))),(w=Eee?vee(e,n):_ee(e,n))&&(T=y6(c,"onBeforeInput"),0<T.length&&(k=new Nx("onBeforeInput","beforeinput",null,n,d),u.push({event:k,listeners:T}),k.data=w)),hte(u,e,c,n,d)}kB(u,t)})}function A0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function y6(e,t){for(var n=t+"Capture",i=[];e!==null;){var s=e,r=s.stateNode;s=s.tag,s!==5&&s!==26&&s!==27||r===null||(s=_0(e,n),s!=null&&i.unshift(A0(e,s,r)),s=_0(e,t),s!=null&&i.push(A0(e,s,r))),e=e.return}return i}function Sf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function CA(e,t,n,i,s){for(var r=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,l!==null&&l===i)break;a!==5&&a!==26&&a!==27||c===null||(l=c,s?(c=_0(n,r),c!=null&&o.unshift(A0(n,c,l))):s||(c=_0(n,r),c!=null&&o.push(A0(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Ute=/\r\n?/g,bte=/\u0000|\uFFFD/g;function xA(e){return(typeof e=="string"?e:""+e).replace(Ute,`
`).replace(bte,"")}function DB(e,t){return t=xA(t),xA(e)===t}function ky(){}function Xt(e,t,n,i,s,r){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Wh(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Wh(e,""+i);break;case"className":tU(e,"class",i);break;case"tabIndex":tU(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":tU(e,n,i);break;case"style":BO(e,i,r);break;case"data":if(t!=="object"){tU(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ab(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(t!=="input"&&Xt(e,t,"name",s.name,s,null),Xt(e,t,"formEncType",s.formEncType,s,null),Xt(e,t,"formMethod",s.formMethod,s,null),Xt(e,t,"formTarget",s.formTarget,s,null)):(Xt(e,t,"encType",s.encType,s,null),Xt(e,t,"method",s.method,s,null),Xt(e,t,"target",s.target,s,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ab(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=ky);break;case"onScroll":i!=null&&mt("scroll",e);break;case"onScrollEnd":i!=null&&mt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(se(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(se(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=ab(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":mt("beforetoggle",e),mt("toggle",e),ob(e,"popover",i);break;case"xlinkActuate":Ba(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Ba(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Ba(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Ba(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Ba(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Ba(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Ba(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Ba(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Ba(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ob(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=YJ.get(n)||n,ob(e,n,i))}}function Jv(e,t,n,i,s,r){switch(n){case"style":BO(e,i,r);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(se(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(se(60));e.innerHTML=n}}break;case"children":typeof i=="string"?Wh(e,i):(typeof i=="number"||typeof i=="bigint")&&Wh(e,""+i);break;case"onScroll":i!=null&&mt("scroll",e);break;case"onScrollEnd":i!=null&&mt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=ky);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!DO.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(s=n.endsWith("Capture"),t=n.slice(2,s?n.length-7:void 0),r=e[Gs]||null,r=r!=null?r[n]:null,typeof r=="function"&&e.removeEventListener(t,r,s),typeof i=="function")){typeof r!="function"&&r!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,s);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):ob(e,n,i)}}}function Gi(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",e),mt("load",e);var i=!1,s=!1,r;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(o!=null)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(se(137,t));default:Xt(e,t,r,o,n,null)}}s&&Xt(e,t,"srcSet",n.srcSet,n,null),i&&Xt(e,t,"src",n.src,n,null);return;case"input":mt("invalid",e);var a=r=o=s=null,l=null,c=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(d!=null)switch(i){case"name":s=d;break;case"type":o=d;break;case"checked":l=d;break;case"defaultChecked":c=d;break;case"value":r=d;break;case"defaultValue":a=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(se(137,t));break;default:Xt(e,t,i,d,n,null)}}NO(e,r,a,l,c,o,s,!1),n6(e);return;case"select":mt("invalid",e),i=o=r=null;for(s in n)if(n.hasOwnProperty(s)&&(a=n[s],a!=null))switch(s){case"value":r=a;break;case"defaultValue":o=a;break;case"multiple":i=a;default:Xt(e,t,s,a,n,null)}t=r,n=o,e.multiple=!!i,t!=null?_h(e,!!i,t,!1):n!=null&&_h(e,!!i,n,!0);return;case"textarea":mt("invalid",e),r=s=i=null;for(o in n)if(n.hasOwnProperty(o)&&(a=n[o],a!=null))switch(o){case"value":i=a;break;case"defaultValue":s=a;break;case"children":r=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(se(91));break;default:Xt(e,t,o,a,n,null)}FO(e,i,s,r),n6(e);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Xt(e,t,l,i,n,null)}return;case"dialog":mt("cancel",e),mt("close",e);break;case"iframe":case"object":mt("load",e);break;case"video":case"audio":for(i=0;i<x0.length;i++)mt(x0[i],e);break;case"image":mt("error",e),mt("load",e);break;case"details":mt("toggle",e);break;case"embed":case"source":case"link":mt("error",e),mt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(se(137,t));default:Xt(e,t,c,i,n,null)}return;default:if(Lw(t)){for(d in n)n.hasOwnProperty(d)&&(i=n[d],i!==void 0&&Jv(e,t,d,i,n,void 0));return}}for(a in n)n.hasOwnProperty(a)&&(i=n[a],i!=null&&Xt(e,t,a,i,n,null))}function yte(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,o=null,a=null,l=null,c=null,d=null;for(h in n){var u=n[h];if(n.hasOwnProperty(h)&&u!=null)switch(h){case"checked":break;case"value":break;case"defaultValue":l=u;default:i.hasOwnProperty(h)||Xt(e,t,h,null,i,u)}}for(var f in i){var h=i[f];if(u=n[f],i.hasOwnProperty(f)&&(h!=null||u!=null))switch(f){case"type":r=h;break;case"name":s=h;break;case"checked":c=h;break;case"defaultChecked":d=h;break;case"value":o=h;break;case"defaultValue":a=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(se(137,t));break;default:h!==u&&Xt(e,t,f,h,i,u)}}_v(e,o,a,l,c,d,r,s);return;case"select":h=o=a=f=null;for(r in n)if(l=n[r],n.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":h=l;default:i.hasOwnProperty(r)||Xt(e,t,r,null,i,l)}for(s in i)if(r=i[s],l=n[s],i.hasOwnProperty(s)&&(r!=null||l!=null))switch(s){case"value":f=r;break;case"defaultValue":a=r;break;case"multiple":o=r;default:r!==l&&Xt(e,t,s,r,i,l)}t=a,n=o,i=h,f!=null?_h(e,!!n,f,!1):!!i!=!!n&&(t!=null?_h(e,!!n,t,!0):_h(e,!!n,n?[]:"",!1));return;case"textarea":h=f=null;for(a in n)if(s=n[a],n.hasOwnProperty(a)&&s!=null&&!i.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:Xt(e,t,a,null,i,s)}for(o in i)if(s=i[o],r=n[o],i.hasOwnProperty(o)&&(s!=null||r!=null))switch(o){case"value":f=s;break;case"defaultValue":h=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(se(91));break;default:s!==r&&Xt(e,t,o,s,i,r)}OO(e,f,h);return;case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&f!=null&&!i.hasOwnProperty(m))switch(m){case"selected":e.selected=!1;break;default:Xt(e,t,m,null,i,f)}for(l in i)if(f=i[l],h=n[l],i.hasOwnProperty(l)&&f!==h&&(f!=null||h!=null))switch(l){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Xt(e,t,l,f,i,h)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)f=n[p],n.hasOwnProperty(p)&&f!=null&&!i.hasOwnProperty(p)&&Xt(e,t,p,null,i,f);for(c in i)if(f=i[c],h=n[c],i.hasOwnProperty(c)&&f!==h&&(f!=null||h!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(se(137,t));break;default:Xt(e,t,c,f,i,h)}return;default:if(Lw(t)){for(var U in n)f=n[U],n.hasOwnProperty(U)&&f!==void 0&&!i.hasOwnProperty(U)&&Jv(e,t,U,void 0,i,f);for(d in i)f=i[d],h=n[d],!i.hasOwnProperty(d)||f===h||f===void 0&&h===void 0||Jv(e,t,d,f,i,h);return}}for(var b in n)f=n[b],n.hasOwnProperty(b)&&f!=null&&!i.hasOwnProperty(b)&&Xt(e,t,b,null,i,f);for(u in i)f=i[u],h=n[u],!i.hasOwnProperty(u)||f===h||f==null&&h==null||Xt(e,t,u,f,i,h)}var e4=null,t4=null;function E6(e){return e.nodeType===9?e:e.ownerDocument}function AA(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function LB(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function n4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var g3=null;function Ete(){var e=window.event;return e&&e.type==="popstate"?e===g3?!1:(g3=e,!0):(g3=null,!1)}var PB=typeof setTimeout=="function"?setTimeout:void 0,vte=typeof clearTimeout=="function"?clearTimeout:void 0,MA=typeof Promise=="function"?Promise:void 0,_te=typeof queueMicrotask=="function"?queueMicrotask:typeof MA<"u"?function(e){return MA.resolve(null).then(e).catch(wte)}:PB;function wte(e){setTimeout(function(){throw e})}function m3(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(i===0){e.removeChild(s),L0(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=s}while(n);L0(t)}function i4(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":i4(n),Dw(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Tte(e,t,n,i){for(;e.nodeType===1;){var s=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[v0])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(r=e.getAttribute("rel"),r==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(r!==s.rel||e.getAttribute("href")!==(s.href==null?null:s.href)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||e.getAttribute("title")!==(s.title==null?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(r=e.getAttribute("src"),(r!==(s.src==null?null:s.src)||e.getAttribute("type")!==(s.type==null?null:s.type)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var r=s.name==null?null:""+s.name;if(s.type==="hidden"&&e.getAttribute("name")===r)return e}else return e;if(e=_o(e.nextSibling),e===null)break}return null}function Ite(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=_o(e.nextSibling),e===null))return null;return e}function _o(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}function kA(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function NB(e,t,n){switch(t=E6(n),e){case"html":if(e=t.documentElement,!e)throw Error(se(452));return e;case"head":if(e=t.head,!e)throw Error(se(453));return e;case"body":if(e=t.body,!e)throw Error(se(454));return e;default:throw Error(se(451))}}var eo=new Map,RA=new Set;function v6(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var Vl=dn.d;dn.d={f:Ste,r:Cte,D:xte,C:Ate,L:Mte,m:kte,X:Dte,S:Rte,M:Lte};function Ste(){var e=Vl.f(),t=Ay();return e||t}function Cte(e){var t=Bg(e);t!==null&&t.tag===5&&t.type==="form"?NF(t):Vl.r(e)}var Hg=typeof document>"u"?null:document;function OB(e,t,n){var i=Hg;if(i&&typeof t=="string"&&t){var s=Or(t);s='link[rel="'+e+'"][href="'+s+'"]',typeof n=="string"&&(s+='[crossorigin="'+n+'"]'),RA.has(s)||(RA.add(s),e={rel:e,crossOrigin:n,href:t},i.querySelector(s)===null&&(t=i.createElement("link"),Gi(t,"link",e),xi(t),i.head.appendChild(t)))}}function xte(e){Vl.D(e),OB("dns-prefetch",e,null)}function Ate(e,t){Vl.C(e,t),OB("preconnect",e,t)}function Mte(e,t,n){Vl.L(e,t,n);var i=Hg;if(i&&e&&t){var s='link[rel="preload"][as="'+Or(t)+'"]';t==="image"&&n&&n.imageSrcSet?(s+='[imagesrcset="'+Or(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(s+='[imagesizes="'+Or(n.imageSizes)+'"]')):s+='[href="'+Or(e)+'"]';var r=s;switch(t){case"style":r=eg(e);break;case"script":r=Vg(e)}eo.has(r)||(e=un({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),eo.set(r,e),i.querySelector(s)!==null||t==="style"&&i.querySelector(zp(r))||t==="script"&&i.querySelector(Hp(r))||(t=i.createElement("link"),Gi(t,"link",e),xi(t),i.head.appendChild(t)))}}function kte(e,t){Vl.m(e,t);var n=Hg;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",s='link[rel="modulepreload"][as="'+Or(i)+'"][href="'+Or(e)+'"]',r=s;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Vg(e)}if(!eo.has(r)&&(e=un({rel:"modulepreload",href:e},t),eo.set(r,e),n.querySelector(s)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Hp(r)))return}i=n.createElement("link"),Gi(i,"link",e),xi(i),n.head.appendChild(i)}}}function Rte(e,t,n){Vl.S(e,t,n);var i=Hg;if(i&&e){var s=vh(i).hoistableStyles,r=eg(e);t=t||"default";var o=s.get(r);if(!o){var a={loading:0,preload:null};if(o=i.querySelector(zp(r)))a.loading=5;else{e=un({rel:"stylesheet",href:e,"data-precedence":t},n),(n=eo.get(r))&&p9(e,n);var l=o=i.createElement("link");xi(l),Gi(l,"link",e),l._p=new Promise(function(c,d){l.onload=c,l.onerror=d}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,mb(o,t,i)}o={type:"stylesheet",instance:o,count:1,state:a},s.set(r,o)}}}function Dte(e,t){Vl.X(e,t);var n=Hg;if(n&&e){var i=vh(n).hoistableScripts,s=Vg(e),r=i.get(s);r||(r=n.querySelector(Hp(s)),r||(e=un({src:e,async:!0},t),(t=eo.get(s))&&U9(e,t),r=n.createElement("script"),xi(r),Gi(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function Lte(e,t){Vl.M(e,t);var n=Hg;if(n&&e){var i=vh(n).hoistableScripts,s=Vg(e),r=i.get(s);r||(r=n.querySelector(Hp(s)),r||(e=un({src:e,async:!0,type:"module"},t),(t=eo.get(s))&&U9(e,t),r=n.createElement("script"),xi(r),Gi(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function DA(e,t,n,i){var s=(s=Mc.current)?v6(s):null;if(!s)throw Error(se(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=eg(n.href),n=vh(s).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=eg(n.href);var r=vh(s).hoistableStyles,o=r.get(e);if(o||(s=s.ownerDocument||s,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(e,o),(r=s.querySelector(zp(e)))&&!r._p&&(o.instance=r,o.state.loading=5),eo.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},eo.set(e,n),r||Pte(s,e,n,o.state))),t&&i===null)throw Error(se(528,""));return o}if(t&&i!==null)throw Error(se(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Vg(n),n=vh(s).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(se(444,e))}}function eg(e){return'href="'+Or(e)+'"'}function zp(e){return'link[rel="stylesheet"]['+e+"]"}function FB(e){return un({},e,{"data-precedence":e.precedence,precedence:null})}function Pte(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Gi(t,"link",n),xi(t),e.head.appendChild(t))}function Vg(e){return'[src="'+Or(e)+'"]'}function Hp(e){return"script[async]"+e}function LA(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Or(n.href)+'"]');if(i)return t.instance=i,xi(i),i;var s=un({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),xi(i),Gi(i,"style",s),mb(i,n.precedence,e),t.instance=i;case"stylesheet":s=eg(n.href);var r=e.querySelector(zp(s));if(r)return t.state.loading|=4,t.instance=r,xi(r),r;i=FB(n),(s=eo.get(s))&&p9(i,s),r=(e.ownerDocument||e).createElement("link"),xi(r);var o=r;return o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Gi(r,"link",i),t.state.loading|=4,mb(r,n.precedence,e),t.instance=r;case"script":return r=Vg(n.src),(s=e.querySelector(Hp(r)))?(t.instance=s,xi(s),s):(i=n,(s=eo.get(r))&&(i=un({},n),U9(i,s)),e=e.ownerDocument||e,s=e.createElement("script"),xi(s),Gi(s,"link",i),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(se(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(i=t.instance,t.state.loading|=4,mb(i,n.precedence,e));return t.instance}function mb(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=i.length?i[i.length-1]:null,r=s,o=0;o<i.length;o++){var a=i[o];if(a.dataset.precedence===t)r=a;else if(r!==s)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function p9(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function U9(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var pb=null;function PA(e,t,n){if(pb===null){var i=new Map,s=pb=new Map;s.set(n,i)}else s=pb,i=s.get(n),i||(i=new Map,s.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),s=0;s<n.length;s++){var r=n[s];if(!(r[v0]||r[ls]||e==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var o=r.getAttribute(t)||"";o=e+o;var a=i.get(o);a?a.push(r):i.set(o,[r])}}return i}function NA(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Nte(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function BB(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var M0=null;function Ote(){}function Fte(e,t,n){if(M0===null)throw Error(se(475));var i=M0;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=eg(n.href),r=e.querySelector(zp(s));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(i.count++,i=_6.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=r,xi(r);return}r=e.ownerDocument||e,n=FB(n),(s=eo.get(s))&&p9(n,s),r=r.createElement("link"),xi(r);var o=r;o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Gi(r,"link",n),t.instance=r}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(i.count++,t=_6.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}function Bte(){if(M0===null)throw Error(se(475));var e=M0;return e.stylesheets&&e.count===0&&s4(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&s4(e,e.stylesheets),e.unsuspend){var i=e.unsuspend;e.unsuspend=null,i()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function _6(){if(this.count--,this.count===0){if(this.stylesheets)s4(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var w6=null;function s4(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,w6=new Map,t.forEach(zte,e),w6=null,_6.call(e))}function zte(e,t){if(!(t.state.loading&4)){var n=w6.get(e);if(n)var i=n.get(null);else{n=new Map,w6.set(e,n);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var o=s[r];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(n.set(o.dataset.precedence,o),i=o)}i&&n.set(null,i)}s=t.instance,o=s.getAttribute("data-precedence"),r=n.get(o)||i,r===i&&n.set(null,s),n.set(o,s),this.count++,i=_6.bind(this),s.addEventListener("load",i),s.addEventListener("error",i),r?r.parentNode.insertBefore(s,r.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(s,e.firstChild)),t.state.loading|=4}}var k0={$$typeof:cl,Provider:null,Consumer:null,_currentValue:du,_currentValue2:du,_threadCount:0};function Hte(e,t,n,i,s,r,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=z8(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z8(0),this.hiddenUpdates=z8(null),this.identifierPrefix=i,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function zB(e,t,n,i,s,r,o,a,l,c,d,u){return e=new Hte(e,t,n,o,a,l,c,u),t=1,r===!0&&(t|=24),r=Vr(3,null,null,t),e.current=r,r.stateNode=e,t=Xw(),t.refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:i,isDehydrated:n,cache:t},o9(r),e}function HB(e){return e?(e=nh,e):nh}function VB(e,t,n,i,s,r){s=HB(s),i.context===null?i.context=s:i.pendingContext=s,i=kc(t),i.payload={element:n},r=r===void 0?null:r,r!==null&&(i.callback=r),n=Rc(e,i,t),n!==null&&(Is(n,e,t),B1(n,e,t))}function OA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function b9(e,t){OA(e,t),(e=e.alternate)&&OA(e,t)}function $B(e){if(e.tag===13){var t=Jc(e,67108864);t!==null&&Is(t,e,67108864),b9(e,67108864)}}var T6=!0;function Vte(e,t,n,i){var s=nt.T;nt.T=null;var r=dn.p;try{dn.p=2,y9(e,t,n,i)}finally{dn.p=r,nt.T=s}}function $te(e,t,n,i){var s=nt.T;nt.T=null;var r=dn.p;try{dn.p=8,y9(e,t,n,i)}finally{dn.p=r,nt.T=s}}function y9(e,t,n,i){if(T6){var s=r4(i);if(s===null)h3(e,t,i,I6,n),FA(e,i);else if(Xte(s,e,t,n,i))i.stopPropagation();else if(FA(e,i),t&4&&-1<Gte.indexOf(e)){for(;s!==null;){var r=Bg(s);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var o=Vd(r.pendingLanes);if(o!==0){var a=r;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-mr(o);a.entanglements[1]|=l,o&=~l}Da(r),!(_n&6)&&(m6=ca()+500,Bp(0))}}break;case 13:a=Jc(r,2),a!==null&&Is(a,r,2),Ay(),b9(r,2)}if(r=r4(i),r===null&&h3(e,t,i,I6,n),r===s)break;s=r}s!==null&&i.stopPropagation()}else h3(e,t,i,null,n)}}function r4(e){return e=Pw(e),E9(e)}var I6=null;function E9(e){if(I6=null,e=Jd(e),e!==null){var t=Og(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=vO(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return I6=e,null}function GB(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(AJ()){case wO:return 2;case TO:return 8;case t6:case MJ:return 32;case IO:return 268435456;default:return 32}default:return 32}}var o4=!1,Pc=null,Nc=null,Oc=null,R0=new Map,D0=new Map,Uc=[],Gte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function FA(e,t){switch(e){case"focusin":case"focusout":Pc=null;break;case"dragenter":case"dragleave":Nc=null;break;case"mouseover":case"mouseout":Oc=null;break;case"pointerover":case"pointerout":R0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":D0.delete(t.pointerId)}}function km(e,t,n,i,s,r){return e===null||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},t!==null&&(t=Bg(t),t!==null&&$B(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Xte(e,t,n,i,s){switch(t){case"focusin":return Pc=km(Pc,e,t,n,i,s),!0;case"dragenter":return Nc=km(Nc,e,t,n,i,s),!0;case"mouseover":return Oc=km(Oc,e,t,n,i,s),!0;case"pointerover":var r=s.pointerId;return R0.set(r,km(R0.get(r)||null,e,t,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,D0.set(r,km(D0.get(r)||null,e,t,n,i,s)),!0}return!1}function XB(e){var t=Jd(e.target);if(t!==null){var n=Og(t);if(n!==null){if(t=n.tag,t===13){if(t=vO(n),t!==null){e.blockedOn=t,BJ(e.priority,function(){if(n.tag===13){var i=pr(),s=Jc(n,i);s!==null&&Is(s,n,i),b9(n,i)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ub(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=r4(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Tv=i,n.target.dispatchEvent(i),Tv=null}else return t=Bg(n),t!==null&&$B(t),e.blockedOn=n,!1;t.shift()}return!0}function BA(e,t,n){Ub(e)&&n.delete(t)}function jte(){o4=!1,Pc!==null&&Ub(Pc)&&(Pc=null),Nc!==null&&Ub(Nc)&&(Nc=null),Oc!==null&&Ub(Oc)&&(Oc=null),R0.forEach(BA),D0.forEach(BA)}function dU(e,t){e.blockedOn===t&&(e.blockedOn=null,o4||(o4=!0,bi.unstable_scheduleCallback(bi.unstable_NormalPriority,jte)))}var uU=null;function zA(e){uU!==e&&(uU=e,bi.unstable_scheduleCallback(bi.unstable_NormalPriority,function(){uU===e&&(uU=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],s=e[t+2];if(typeof i!="function"){if(E9(i||n)===null)continue;break}var r=Bg(n);r!==null&&(e.splice(t,3),t-=3,Lv(r,{pending:!0,data:s,method:n.method,action:i},i,s))}}))}function L0(e){function t(l){return dU(l,e)}Pc!==null&&dU(Pc,e),Nc!==null&&dU(Nc,e),Oc!==null&&dU(Oc,e),R0.forEach(t),D0.forEach(t);for(var n=0;n<Uc.length;n++){var i=Uc[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Uc.length&&(n=Uc[0],n.blockedOn===null);)XB(n),n.blockedOn===null&&Uc.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var s=n[i],r=n[i+1],o=s[Gs]||null;if(typeof r=="function")o||zA(n);else if(o){var a=null;if(r&&r.hasAttribute("formAction")){if(s=r,o=r[Gs]||null)a=o.formAction;else if(E9(s)!==null)continue}else a=o.action;typeof a=="function"?n[i+1]=a:(n.splice(i,3),i-=3),zA(n)}}}function v9(e){this._internalRoot=e}Ry.prototype.render=v9.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(se(409));var n=t.current,i=pr();VB(n,i,e,t,null,null)};Ry.prototype.unmount=v9.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;e.tag===0&&xh(),VB(e.current,2,null,e,null,null),Ay(),t[Fg]=null}};function Ry(e){this._internalRoot=e}Ry.prototype.unstable_scheduleHydration=function(e){if(e){var t=kO();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Uc.length&&t!==0&&t<Uc[n].priority;n++);Uc.splice(n,0,e),n===0&&XB(e)}};var HA=pO.version;if(HA!=="19.0.0")throw Error(se(527,HA,"19.0.0"));dn.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(se(188)):(e=Object.keys(e).join(","),Error(se(268,e)));return e=SJ(t),e=e!==null?_O(e):null,e=e===null?null:e.stateNode,e};var Yte={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:nt,findFiberByHostInstance:Jd,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fU=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fU.isDisabled&&fU.supportsFiber)try{Mp=fU.inject(Yte),gr=fU}catch{}}Uy.createRoot=function(e,t){if(!UO(e))throw Error(se(299));var n=!1,i="",s=VF,r=$F,o=GF,a=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(s=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(a=t.unstable_transitionCallbacks)),t=zB(e,1,!1,null,null,n,i,s,r,o,a,null),e[Fg]=t.current,m9(e.nodeType===8?e.parentNode:e),new v9(t)};Uy.hydrateRoot=function(e,t,n){if(!UO(e))throw Error(se(299));var i=!1,s="",r=VF,o=$F,a=GF,l=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(o=n.onCaughtError),n.onRecoverableError!==void 0&&(a=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(l=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=zB(e,1,!0,t,n??null,i,s,r,o,a,l,c),t.context=HB(null),n=t.current,i=pr(),s=kc(i),s.callback=null,Rc(n,s,i),t.current.lanes=i,Rp(t,i),Da(t),e[Fg]=t.current,m9(e),new Ry(t)};Uy.version="19.0.0";function jB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jB)}catch(e){console.error(e)}}jB(),dO.exports=Uy;var Wte=dO.exports;function Kte(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:s,onRegisteredSW:r,onRegisterError:o}=e;let a,l;const c=async(u=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(a=await Ue(()=>import("./workbox-window.prod.es5-B9K5rw8f.js"),__vite__mapDeps([])).then(({Workbox:u})=>new u("/sw.js",{scope:"/",type:"classic"})).catch(u=>{o==null||o(u)}),!a)return;a.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),a.addEventListener("installed",u=>{u.isUpdate||i==null||i()}),a.register({immediate:t}).then(u=>{r?r("/sw.js",u):s==null||s(u)}).catch(u=>{o==null||o(u)})}}return l=d(),c}class Zte{constructor(t){B(this,"content",[]);this.scoreFunction=t}sinkDown(t){const n=this.content[t],i=this.scoreFunction(n);for(;t>0;){const s=(t+1>>1)-1,r=this.content[s];if(i<this.scoreFunction(r))this.content[t]=r,t=s;else break}this.content[t]=n}bubbleUp(t){const n=this.content.length,i=this.content[t],s=this.scoreFunction(i);for(;;){const r=(t+1<<1)-1,o=r+1;let a=t,l=s;if(r<n){const c=this.scoreFunction(this.content[r]);c<l&&(a=r,l=c)}if(o<n&&this.scoreFunction(this.content[o])<l&&(a=o),a===t)break;this.content[t]=this.content[a],t=a}this.content[t]=i}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){if(this.content.length===0)return null;const t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t}remove(t){if(this.content.length===0)return;const n=this.content.indexOf(t),i=this.content.pop();n<this.content.length&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}}function S6(e){"@babel/helpers - typeof";return S6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S6(e)}var qte=/^\s+/,Qte=/\s+$/;function Re(e,t){if(e=e||"",t=t||{},e instanceof Re)return e;if(!(this instanceof Re))return new Re(e,t);var n=Jte(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}Re.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),n,i,s,r,o,a;return n=t.r/255,i=t.g/255,s=t.b/255,n<=.03928?r=n/12.92:r=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),s<=.03928?a=s/12.92:a=Math.pow((s+.055)/1.055,2.4),.2126*r+.7152*o+.0722*a},setAlpha:function(t){return this._a=YB(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=$A(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=$A(this._r,this._g,this._b),n=Math.round(t.h*360),i=Math.round(t.s*100),s=Math.round(t.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+s+"%)":"hsva("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var t=VA(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=VA(this._r,this._g,this._b),n=Math.round(t.h*360),i=Math.round(t.s*100),s=Math.round(t.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+s+"%)":"hsla("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(t){return GA(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return ine(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(gn(this._r,255)*100)+"%",g:Math.round(gn(this._g,255)*100)+"%",b:Math.round(gn(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(gn(this._r,255)*100)+"%, "+Math.round(gn(this._g,255)*100)+"%, "+Math.round(gn(this._b,255)*100)+"%)":"rgba("+Math.round(gn(this._r,255)*100)+"%, "+Math.round(gn(this._g,255)*100)+"%, "+Math.round(gn(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:mne[GA(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var n="#"+XA(this._r,this._g,this._b,this._a),i=n,s=this._gradientType?"GradientType = 1, ":"";if(t){var r=Re(t);i="#"+XA(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+n+",endColorstr="+i+")"},toString:function(t){var n=!!t;t=t||this._format;var i=!1,s=this._a<1&&this._a>=0,r=!n&&s&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return r?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Re(this.toString())},_applyModification:function(t,n){var i=t.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(ane,arguments)},brighten:function(){return this._applyModification(lne,arguments)},darken:function(){return this._applyModification(cne,arguments)},desaturate:function(){return this._applyModification(sne,arguments)},saturate:function(){return this._applyModification(rne,arguments)},greyscale:function(){return this._applyModification(one,arguments)},spin:function(){return this._applyModification(dne,arguments)},_applyCombination:function(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(hne,arguments)},complement:function(){return this._applyCombination(une,arguments)},monochromatic:function(){return this._applyCombination(gne,arguments)},splitcomplement:function(){return this._applyCombination(fne,arguments)},triad:function(){return this._applyCombination(jA,[3])},tetrad:function(){return this._applyCombination(jA,[4])}};Re.fromRatio=function(e,t){if(S6(e)=="object"){var n={};for(var i in e)e.hasOwnProperty(i)&&(i==="a"?n[i]=e[i]:n[i]=l1(e[i]));e=n}return Re(e,t)};function Jte(e){var t={r:0,g:0,b:0},n=1,i=null,s=null,r=null,o=!1,a=!1;return typeof e=="string"&&(e=yne(e)),S6(e)=="object"&&($a(e.r)&&$a(e.g)&&$a(e.b)?(t=ene(e.r,e.g,e.b),o=!0,a=String(e.r).substr(-1)==="%"?"prgb":"rgb"):$a(e.h)&&$a(e.s)&&$a(e.v)?(i=l1(e.s),s=l1(e.v),t=nne(e.h,i,s),o=!0,a="hsv"):$a(e.h)&&$a(e.s)&&$a(e.l)&&(i=l1(e.s),r=l1(e.l),t=tne(e.h,i,r),o=!0,a="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=YB(n),{ok:o,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}function ene(e,t,n){return{r:gn(e,255)*255,g:gn(t,255)*255,b:gn(n,255)*255}}function VA(e,t,n){e=gn(e,255),t=gn(t,255),n=gn(n,255);var i=Math.max(e,t,n),s=Math.min(e,t,n),r,o,a=(i+s)/2;if(i==s)r=o=0;else{var l=i-s;switch(o=a>.5?l/(2-i-s):l/(i+s),i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4;break}r/=6}return{h:r,s:o,l:a}}function tne(e,t,n){var i,s,r;e=gn(e,360),t=gn(t,100),n=gn(n,100);function o(c,d,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?c+(d-c)*6*u:u<1/2?d:u<2/3?c+(d-c)*(2/3-u)*6:c}if(t===0)i=s=r=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;i=o(l,a,e+1/3),s=o(l,a,e),r=o(l,a,e-1/3)}return{r:i*255,g:s*255,b:r*255}}function $A(e,t,n){e=gn(e,255),t=gn(t,255),n=gn(n,255);var i=Math.max(e,t,n),s=Math.min(e,t,n),r,o,a=i,l=i-s;if(o=i===0?0:l/i,i==s)r=0;else{switch(i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4;break}r/=6}return{h:r,s:o,v:a}}function nne(e,t,n){e=gn(e,360)*6,t=gn(t,100),n=gn(n,100);var i=Math.floor(e),s=e-i,r=n*(1-t),o=n*(1-s*t),a=n*(1-(1-s)*t),l=i%6,c=[n,o,r,r,a,n][l],d=[a,n,n,o,r,r][l],u=[r,r,a,n,n,o][l];return{r:c*255,g:d*255,b:u*255}}function GA(e,t,n,i){var s=[Eo(Math.round(e).toString(16)),Eo(Math.round(t).toString(16)),Eo(Math.round(n).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function ine(e,t,n,i,s){var r=[Eo(Math.round(e).toString(16)),Eo(Math.round(t).toString(16)),Eo(Math.round(n).toString(16)),Eo(WB(i))];return s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)&&r[3].charAt(0)==r[3].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}function XA(e,t,n,i){var s=[Eo(WB(i)),Eo(Math.round(e).toString(16)),Eo(Math.round(t).toString(16)),Eo(Math.round(n).toString(16))];return s.join("")}Re.equals=function(e,t){return!e||!t?!1:Re(e).toRgbString()==Re(t).toRgbString()};Re.random=function(){return Re.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function sne(e,t){t=t===0?0:t||10;var n=Re(e).toHsl();return n.s-=t/100,n.s=Dy(n.s),Re(n)}function rne(e,t){t=t===0?0:t||10;var n=Re(e).toHsl();return n.s+=t/100,n.s=Dy(n.s),Re(n)}function one(e){return Re(e).desaturate(100)}function ane(e,t){t=t===0?0:t||10;var n=Re(e).toHsl();return n.l+=t/100,n.l=Dy(n.l),Re(n)}function lne(e,t){t=t===0?0:t||10;var n=Re(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(t/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(t/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(t/100)))),Re(n)}function cne(e,t){t=t===0?0:t||10;var n=Re(e).toHsl();return n.l-=t/100,n.l=Dy(n.l),Re(n)}function dne(e,t){var n=Re(e).toHsl(),i=(n.h+t)%360;return n.h=i<0?360+i:i,Re(n)}function une(e){var t=Re(e).toHsl();return t.h=(t.h+180)%360,Re(t)}function jA(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Re(e).toHsl(),i=[Re(e)],s=360/t,r=1;r<t;r++)i.push(Re({h:(n.h+r*s)%360,s:n.s,l:n.l}));return i}function fne(e){var t=Re(e).toHsl(),n=t.h;return[Re(e),Re({h:(n+72)%360,s:t.s,l:t.l}),Re({h:(n+216)%360,s:t.s,l:t.l})]}function hne(e,t,n){t=t||6,n=n||30;var i=Re(e).toHsl(),s=360/n,r=[Re(e)];for(i.h=(i.h-(s*t>>1)+720)%360;--t;)i.h=(i.h+s)%360,r.push(Re(i));return r}function gne(e,t){t=t||6;for(var n=Re(e).toHsv(),i=n.h,s=n.s,r=n.v,o=[],a=1/t;t--;)o.push(Re({h:i,s,v:r})),r=(r+a)%1;return o}Re.mix=function(e,t,n){n=n===0?0:n||50;var i=Re(e).toRgb(),s=Re(t).toRgb(),r=n/100,o={r:(s.r-i.r)*r+i.r,g:(s.g-i.g)*r+i.g,b:(s.b-i.b)*r+i.b,a:(s.a-i.a)*r+i.a};return Re(o)};Re.readability=function(e,t){var n=Re(e),i=Re(t);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};Re.isReadable=function(e,t,n){var i=Re.readability(e,t),s,r;switch(r=!1,s=Ene(n),s.level+s.size){case"AAsmall":case"AAAlarge":r=i>=4.5;break;case"AAlarge":r=i>=3;break;case"AAAsmall":r=i>=7;break}return r};Re.mostReadable=function(e,t,n){var i=null,s=0,r,o,a,l;n=n||{},o=n.includeFallbackColors,a=n.level,l=n.size;for(var c=0;c<t.length;c++)r=Re.readability(e,t[c]),r>s&&(s=r,i=Re(t[c]));return Re.isReadable(e,i,{level:a,size:l})||!o?i:(n.includeFallbackColors=!1,Re.mostReadable(e,["#fff","#000"],n))};var a4=Re.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},mne=Re.hexNames=pne(a4);function pne(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function YB(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function gn(e,t){Une(e)&&(e="100%");var n=bne(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function Dy(e){return Math.min(1,Math.max(0,e))}function Qs(e){return parseInt(e,16)}function Une(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function bne(e){return typeof e=="string"&&e.indexOf("%")!=-1}function Eo(e){return e.length==1?"0"+e:""+e}function l1(e){return e<=1&&(e=e*100+"%"),e}function WB(e){return Math.round(parseFloat(e)*255).toString(16)}function YA(e){return Qs(e)/255}var so=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function $a(e){return!!so.CSS_UNIT.exec(e)}function yne(e){e=e.replace(qte,"").replace(Qte,"").toLowerCase();var t=!1;if(a4[e])e=a4[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=so.rgb.exec(e))?{r:n[1],g:n[2],b:n[3]}:(n=so.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=so.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=so.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=so.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=so.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=so.hex8.exec(e))?{r:Qs(n[1]),g:Qs(n[2]),b:Qs(n[3]),a:YA(n[4]),format:t?"name":"hex8"}:(n=so.hex6.exec(e))?{r:Qs(n[1]),g:Qs(n[2]),b:Qs(n[3]),format:t?"name":"hex"}:(n=so.hex4.exec(e))?{r:Qs(n[1]+""+n[1]),g:Qs(n[2]+""+n[2]),b:Qs(n[3]+""+n[3]),a:YA(n[4]+""+n[4]),format:t?"name":"hex8"}:(n=so.hex3.exec(e))?{r:Qs(n[1]+""+n[1]),g:Qs(n[2]+""+n[2]),b:Qs(n[3]+""+n[3]),format:t?"name":"hex"}:!1}function Ene(e){var t,n;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:t,size:n}}const Vp=1e-4,Ke=(e,t,n)=>Math.min(Math.max(e,t),n),Ul=(e,t,n="round")=>{const i=Math.pow(10,t);return Math[n]((e+Number.EPSILON)*i)/i},vne=(e,t,n="round")=>{const i=1/t;return Math[n](e*i)/i},hU=(e,t)=>(e+t)/2,j1=e=>typeof e=="number"&&Number.isFinite(e),WA=(e,t,n=Vp)=>Math.abs(e-t)<n,wo=e=>e<0?e%(2*Math.PI)+2*Math.PI:e%(2*Math.PI);function Fc(e){return e*Math.PI/180}function Ly(e){return e*180/Math.PI}function _ne(e){return Math.abs(Math.sin(2*e))<Vp}function wne(e,t,n){return e=wo(e),t=wo(t),n=wo(n),t<n?e>=t&&e<=n:e>=t||e<=n}function Tne(e,t){e=wo(e),t=wo(t);let n=e-t;return n<-Math.PI?n=n+2*Math.PI:n>Math.PI&&(n=n-2*Math.PI),Math.abs(n)}function An(e,t,n=0,i=0){return[e-n,t-i]}function Me(e,t=[0,0],n,i=[0,1]){const s=An(e[0]-t[0],e[1]-t[1]);return n&&KB(s)<n*n?i:s}function qn(e,t){return e[0]*t[1]-t[0]*e[1]}function Y1(e,t){return e[0]*t[0]+e[1]*t[1]}function oh(e,t){return[e[0]+t[0],e[1]+t[1]]}function C6(e,t){return[e[0]-t[0],e[1]-t[1]]}function Rn(e,t){return An(e[0]*t,e[1]*t)}function KB(e){return e[0]*e[0]+e[1]*e[1]}function Ine(e){return Math.sqrt(KB(e))}const To=e=>{const t=Ine(e);return t===0?An(0,0):An(e[0]/t,e[1]/t)},Sne=e=>An(e[1],-e[0]);function M(e,t){return[e,t]}function Py(e){return e.length===2?M(e[0],e[1]):void 0}function Xi(e,t=M(0,0)){return M(t[0]+e[0],t[1]+e[1])}function ah(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&!isNaN(e[0])&&typeof e[1]=="number"&&!isNaN(e[1])}function vr(e,t,n=Vp){const i=Math.abs;return i(e[0]-t[0])<n&&i(e[1]-t[1])<n}function Z([e,t],[n,i],s){return M((e-n)*Math.cos(s)-(t-i)*Math.sin(s)+n,(e-n)*Math.sin(s)+(t-i)*Math.cos(s)+i)}function tg(e,t=[0,0]){return M(e[0]+t[0],e[1]+t[1])}function x6(e,t){return M((e[0]+t[0])/2,(e[1]+t[1])/2)}function Qe(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function Rm(e,t){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}const c1=(e,t,n)=>tg(t,Rn(Me(e,t),n)),P0=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]),ZB=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],qB=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872];function Gr(e,t,n,i){return[e,t,n,i]}function Cne(e,t,n,i,s=.001,r=10){let o=1/0,a=0;for(;o>=s;){if(a>=r)return null;const l=1-n,c=l*l,d=c*l,u=n*n,f=u*n,h=d*e[0][0]+3*c*n*e[1][0]+3*l*u*e[2][0]+f*e[3][0],m=d*e[0][1]+3*c*n*e[1][1]+3*l*u*e[2][1]+f*e[3][1],p=t[0][0]+i*(t[1][0]-t[0][0]),U=t[0][1]+i*(t[1][1]-t[0][1]),b=h-p,y=m-U;if(o=Math.abs(b)+Math.abs(y),o<s)break;const E=-3*c*e[0][0]+3*c*e[1][0]-6*l*n*e[1][0]-3*u*e[2][0]+6*l*n*e[2][0]+3*u*e[3][0],_=-3*c*e[0][1]+3*c*e[1][1]-6*l*n*e[1][1]-3*u*e[2][1]+6*l*n*e[2][1]+3*u*e[3][1],I=-(t[1][0]-t[0][0]),k=-(t[1][1]-t[0][1]),w=E*k-I*_;if(Math.abs(w)<1e-12)return null;const T=1/w,A=T*(k*-b-I*-y),S=T*(-_*-b+E*-y);n+=A,i+=S,a+=1}return[n,i]}const Ah=(e,t)=>M((1-t)**3*e[0][0]+3*(1-t)**2*t*e[1][0]+3*(1-t)*t**2*e[2][0]+t**3*e[3][0],(1-t)**3*e[0][1]+3*(1-t)**2*t*e[1][1]+3*(1-t)*t**2*e[2][1]+t**3*e[3][1]),p3=[[.5,0],[.2,0],[.8,0]],U3=([e,t],n,i)=>{const s=Cne(i,n,e,t,.01,4);if(!s)return null;const[r,o]=s;return r<0||r>1||o<0||o>1?null:Ah(i,r)};function QB(e,t){let n=U3(p3[0],t,e);return n?[n]:(n=U3(p3[1],t,e),n?[n]:(n=U3(p3[2],t,e),n?[n]:[]))}function xne(e,t,n=.001){const i=(c,d,u,f=n)=>{let h=c,m=d,p;for(;m-h>f;)p=(m+h)/2,u(p-f)<u(p+f)?m=p:h=p;return p};let r=0;for(let c=1/0,d=0;d<30;d++){const u=Qe(t,Ah(e,d/30));u<c&&(c=u,r=d)}const o=Math.max((r-1)/30,0),a=Math.min((r+1)/30,1),l=i(o,a,c=>Qe(t,Ah(e,c)));return l?Ah(e,l):null}function _9(e,t){const n=xne(e,t);return n?Qe(t,n):0}function Ane(e){return Array.isArray(e)&&e.length===4&&ah(e[0])&&ah(e[1])&&ah(e[2])&&ah(e[3])}function w9([e,t,n,i],s){return An(-3*(1-s)*(1-s)*e[0]+3*(1-s)*(1-s)*t[0]-6*s*(1-s)*t[0]-3*s*s*n[0]+6*s*(1-s)*n[0]+3*s*s*i[0],-3*(1-s)*(1-s)*e[1]+3*(1-s)*(1-s)*t[1]-6*s*(1-s)*t[1]-3*s*s*n[1]+6*s*(1-s)*n[1]+3*s*s*i[1])}function JB(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const s=e[i-1<0?0:i-1],r=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=e[i+2>=e.length?e.length-1:i+2],l=[(o[0]-s[0])*t,(o[1]-s[1])*t],c=[(a[0]-r[0])*t,(a[1]-r[1])*t],d=r[0]+l[0]/3,u=r[1]+l[1]/3,f=o[0]-c[0]/3,h=o[1]-c[1]/3;n.push(Gr(M(r[0],r[1]),M(d,u),M(f,h),M(o[0],o[1])))}return n}function ez([e,t,n,i],s,r=50){const o=[];for(let a=0;a<=r;a++){const l=a/r,c=Gr(e,t,n,i),d=Ah(c,l),u=To(w9(c,l)),f=Sne(u);o.push(Xi(Rn(f,s),d))}return o}function T9(e){let n=0;for(let i=0;i<24;i++){const s=.5*ZB[i]+.5,r=w9(e,s),o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);n+=qB[i]*o}return .5*n}function Mne(e,t){if(t<=0)return 0;if(t>=1)return T9(e);const n=t/2,i=t/2;let s=0;for(let r=0;r<24;r++){const o=n*ZB[r]+i,a=w9(e,o),l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=qB[r]*l}return n*s}function kne(e,t){const n=T9(e),i=n*t;let s=0,r=1,o=t,a=0;const l=n*1e-4,c=20;for(let d=0;d<c&&(a=Mne(e,o),!(Math.abs(a-i)<l));d++)a<i?s=o:r=o,o=(s+r)/2;return Ah(e,o)}function tz(e,t,n){return{center:e,halfWidth:t,halfHeight:n}}const Rne=(e,t)=>{const{halfWidth:n,halfHeight:i,center:s}=t,r=n,o=i,a=oh(Me(e),Rn(Me(s),-1)),l=Math.abs(a[0]),c=Math.abs(a[1]);let d=.707,u=.707;for(let m=0;m<3;m++){const p=r*d,U=o*u,b=(r*r-o*o)*d**3/r,y=(o*o-r*r)*u**3/o,E=p-b,_=U-y,I=l-b,k=c-y,w=Math.hypot(_,E),T=Math.hypot(k,I);d=Math.min(1,Math.max(0,(I*w/T+b)/r)),u=Math.min(1,Math.max(0,(k*w/T+y)/o));const A=Math.hypot(u,d);d/=A,u/=A}const[f,h]=[r*d*Math.sign(a[0]),o*u*Math.sign(a[1])];return Qe(Xi(a),M(f,h))};function Dne(e,t){const n=e.halfWidth,i=e.halfHeight,s=Me(t[1],t[0]),r=An(t[0][0]-e.center[0],t[0][1]-e.center[1]),o=An(s[0]/(n*n),s[1]/(i*i)),a=An(r[0]/(n*n),r[1]/(i*i)),l=Y1(s,o),c=Y1(s,a),d=Y1(r,a)-1,u=c*c-l*d,f=[];if(u>0){const h=(-c-Math.sqrt(u))/l,m=(-c+Math.sqrt(u))/l;0<=h&&h<=1&&f.push(M(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h)),0<=m&&m<=1&&f.push(M(t[0][0]+(t[1][0]-t[0][0])*m,t[0][1]+(t[1][1]-t[0][1])*m))}else if(u===0){const h=-c/l;0<=h&&h<=1&&f.push(M(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h))}return f}function KA(e,t){return[e,t]}function Lne(e,t){const n=e[1][1]-e[0][1],i=e[0][0]-e[1][0],s=t[1][1]-t[0][1],r=t[0][0]-t[1][0],o=n*r-s*i;if(o!==0){const a=n*e[0][0]+i*e[0][1],l=s*t[0][0]+r*t[0][1];return M((a*r-l*i)/o,(n*l-s*a)/o)}return null}function Pe(e,t){return[e,t]}const Pne=e=>Array.isArray(e)&&e.length===2&&ah(e[0])&&ah(e[0]),A6=(e,t,n=Vp)=>{const i=Tc(e,t);return i===0?!0:i<n},Tc=(e,t)=>{const[n,i]=e,[[s,r],[o,a]]=t,l=n-s,c=i-r,d=o-s,u=a-r,f=l*d+c*u,h=d*d+u*u;let m=-1;h!==0&&(m=f/h);let p,U;m<0?(p=s,U=r):m>1?(p=o,U=a):(p=s+m*d,U=r+m*u);const b=n-p,y=i-U;return Math.sqrt(b*b+y*y)};function N0(e,t,n){const i=Lne(KA(e[0],e[1]),KA(t[0],t[1]));return!i||!A6(i,t,n)||!A6(i,e,n)?null:i}function ZA(e,t){return N0(e,t)?0:Math.min(Tc(e[0],t),Tc(e[1],t),Tc(t[0],e),Tc(t[1],e))}function l4(...e){return iz(e)}function M6(e){return iz(e)}const nz=(e,t)=>{const[n,i]=e;let s=0;for(let r=0;r<t.length;r++){const o=(r+1)%t.length,[a,l]=t[r],[c,d]=t[o];l<=i?d>i&&(c-a)*(i-l)-(n-a)*(d-l)>0&&s++:d<=i&&(c-a)*(i-l)-(n-a)*(d-l)<0&&s--}return s!==0};function iz(e){return Nne(e)?e:[...e,e[0]]}function Nne(e){return vr(e[0],e[e.length-1])}function is(e,t){return[e,t]}const k6=([e,t],[n,i])=>e<=n?t>=n:e>=n?i>=e:!1,R6=([e,t],[n,i])=>{const s=Math.max(e,n),r=Math.min(t,i);return s<=r?[s,r]:null},gU=(e,[t,n])=>e>=t&&e<=n;function One(e,t){return[e,t]}function b3([e,t,n],i){const s=(d,u,f)=>(d[0]-f[0])*(u[1]-f[1])-(u[0]-f[0])*(d[1]-f[1]),r=s(i,e,t),o=s(i,t,n),a=s(i,n,e),l=r<0||o<0||a<0,c=r>0||o>0||a>0;return!(l&&c)}const Dm=typeof window<"u"?new Map:null;function Fne(e,t,n,i){const s=e/255,r=t/255,o=n/255,a=Fc(i),l=Math.cos(a),c=Math.sin(a),d=[.213+l*.787-c*.213,.715-l*.715-c*.715,.072-l*.072+c*.928,.213-l*.213+c*.143,.715+l*.285+c*.14,.072-l*.072-c*.283,.213-l*.213-c*.787,.715-l*.715+c*.715,.072+l*.928+c*.072],u=s*d[0]+r*d[1]+o*d[2],f=s*d[3]+r*d[4]+o*d[5],h=s*d[6]+r*d[7]+o*d[8];return{r:Math.round(Math.max(0,Math.min(1,u))*255),g:Math.round(Math.max(0,Math.min(1,f))*255),b:Math.round(Math.max(0,Math.min(1,h))*255)}}const Bne=(e,t,n,i)=>{const s=Ke(i,0,100)/100,r=c=>{const d=c*(1-s)+(255-c)*s;return Math.round(Ke(d,0,255))},o=r(e),a=r(t),l=r(n);return{r:o,g:a,b:l}},Yi=e=>{const t=Dm==null?void 0:Dm.get(e);if(t)return t;const n=Re(e),i=n.getAlpha(),s=n.toRgb(),r=Bne(s.r,s.g,s.b,93),o=Fne(r.r,r.g,r.b,180),a=lz(o.r,o.g,o.b,i);return Dm&&Dm.set(e,a),a},zne=(e,t)=>t.reduce((n,i)=>(i in e&&(n[i]=e[i]),n),{}),Hne=5,zf=5,Vne=4,d1=4,u1=1,Je={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:["#f8f9fa","#e9ecef","#ced4da","#868e96","#343a40"],red:["#fff5f5","#ffc9c9","#ff8787","#fa5252","#e03131"],pink:["#fff0f6","#fcc2d7","#f783ac","#e64980","#c2255c"],grape:["#f8f0fc","#eebefa","#da77f2","#be4bdb","#9c36b5"],violet:["#f3f0ff","#d0bfff","#9775fa","#7950f2","#6741d9"],blue:["#e7f5ff","#a5d8ff","#4dabf7","#228be6","#1971c2"],cyan:["#e3fafc","#99e9f2","#3bc9db","#15aabf","#0c8599"],teal:["#e6fcf5","#96f2d7","#38d9a9","#12b886","#099268"],green:["#ebfbee","#b2f2bb","#69db7c","#40c057","#2f9e44"],yellow:["#fff9db","#ffec99","#ffd43b","#fab005","#f08c00"],orange:["#fff4e6","#ffd8a8","#ffa94d","#fd7e14","#e8590c"],bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},sz=zne(Je,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),rz=[Je.black,Je.red[d1],Je.green[d1],Je.blue[d1],Je.yellow[d1]],oz=[Je.transparent,Je.red[u1],Je.green[u1],Je.blue[u1],Je.yellow[u1]],az=[Je.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],$ne={transparent:Je.transparent,white:Je.white,gray:Je.gray,black:Je.black,bronze:Je.bronze,...sz},Gne={transparent:Je.transparent,white:Je.white,gray:Je.gray,black:Je.black,bronze:Je.bronze,...sz},Xne=e=>[Je.cyan[e],Je.blue[e],Je.violet[e],Je.grape[e],Je.pink[e],Je.green[e],Je.teal[e],Je.yellow[e],Je.orange[e],Je.red[e]],lz=(e,t,n,i)=>{const s=`#${(16777216+(e<<16)+(t<<8)+n).toString(16).slice(1)}`;if(i!==void 0&&i<1){const r=Math.round(i*255).toString(16).padStart(2,"0");return`${s}${r}`}return s},ds=e=>Re(e).getAlpha()===0,c4=240,jne=(e,t,n)=>(e*299+t*587+n*114)/1e3,D6=(e,t=160)=>{if(!e)return!0;if(ds(e))return!1;const n=Re(e);if(!n.isValid())return!0;const{r:i,g:s,b:r}=n.toRgb();return jne(i,s,r)<t},Yne=e=>{if(e=e.trim(),ds(e))return e;const t=Re(e);return t.isValid()?t.getFormat()==="hex"&&!e.startsWith("#")?`#${e}`:e:null},cz=typeof window<"u"&&"ResizeObserver"in window,Bc="Excalidraw",Wne=36,O0=10,Kne=20,bb=8,Zne=5,qA=1,qne=30,ir=Math.PI/12,Qne="red",Dt={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},ic={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},Gd={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var te=(e=>(e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.FOCUS="focus",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_DOWN="pointerdown",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.HASHCHANGE="hashchange",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.EXCALIDRAW_LINK="excalidraw-link",e.MENU_ITEM_SELECT="menu.itemSelect",e.MESSAGE="message",e.FULLSCREENCHANGE="fullscreenchange",e))(te||{});const mU={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},dz={TEST:"test",DEVELOPMENT:"development"},Wi={SIDEBAR:"sidebar",SHAPE_ACTIONS_MENU:"App-menu__left",ZOOM_ACTIONS:"zoom-actions",SEARCH_MENU_INPUT_WRAPPER:"layer-ui__search-inputWrapper",CONVERT_ELEMENT_TYPE_POPUP:"ConvertElementTypePopup",SHAPE_ACTIONS_THEME_SCOPE:"shape-actions-theme-scope",FRAME_NAME:"frame-name",DROPDOWN_MENU_EVENT_WRAPPER:"dropdown-menu-event-wrapper"},lh={sm:16,md:20,lg:28,xl:36},ch="Xiaolai",F0="Segoe UI Emoji",ct={Virgil:1,Helvetica:2,Cascadia:3,Excalifont:5,Nunito:6,"Lilita One":7,"Comic Shanns":8,"Liberation Sans":9,Assistant:10},uz="sans-serif",fz="monospace",Jne={[uz]:998,[fz]:999},dh={[ch]:100,...Jne,[F0]:1e3};function eie(e){switch(e){case ct.Cascadia:case ct["Comic Shanns"]:return fz;default:return uz}}const hz=e=>{const t=eie(e);switch(e){case ct.Excalifont:return[ch,t,F0];default:return[t,F0]}},be={LIGHT:"light",DARK:"dark"},gz="invert(93%) hue-rotate(180deg)",rt={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},I9=1,$l=20,Td=ct.Excalifont,$p="left",L6="top",mz="{version}",Cu=2,P6=2*Cu,tie=1e-5,QA=2*P6-tie,pU="#ffffff",nie="#1e1e1e",iie="#a2f1a6",N6=20,pz=5,ng={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},sie={text:"text/plain",html:"text/html",json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawClipboard:"application/vnd.excalidraw.clipboard+json",excalidrawlib:"application/vnd.excalidrawlib+json",excalidrawlibIds:"application/vnd.excalidrawlib.ids+json"},Ee={...sie,"excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...ng},rie=[Ee.text,Ee.html,...Object.values(ng)],y3={png:"png",svg:"svg",clipboard:"clipboard"},jr={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},S9=()=>window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,oie=500,aie=300,lie=500,cie=3e4,die=100,Ny=.1,C9=.1,x9=30,uie=300,JA=6e4,eM=3e3,d4={addLibrary:"addLibrary"},u4={addLibrary:"addLibrary"},tM={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0}},Lm=2,A9=[1,2,3],$g=10,fie=1440,nM=4*1024*1024,ht="http://www.w3.org/2000/svg",hie=`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`,Uz=128,Oy={excalidraw:2,excalidrawLibrary:2},ti=5,gie=.7,mie=11,lr={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},B0={LEFT:"left",CENTER:"center",RIGHT:"right"},pie=20,E3=.25,Uie=32,wn={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},bz={artist:1,cartoonist:2},v3={thin:1,bold:2,extraBold:4},En={strokeColor:Je.black,backgroundColor:Je.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:bz.artist,opacity:100,locked:!1},O6="library",pu="search",Yr={name:"default",defaultTab:O6},yz=new Set(["iframe","embeddable","image"]),ui={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",text:"text",image:"image",eraser:"eraser",frame:"frame",magicframe:"magicframe",laser:"laser"},W1={MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},Ez="Untitled",uh={generalStats:1,elementProperties:2},Dr=1,zn={sharp:"sharp",round:"round",elbow:"elbow"},vz=.3,F6="element";var tu=(e=>(e.ACTIVE="active",e.AWAY="away",e.IDLE="idle",e))(tu||{});const bie=20,yie=35,Hf=700,Gp={background:"var(--mobile-action-button-bg)"},ig={[ct.Excalifont]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25}},[ct.Nunito]:{metrics:{unitsPerEm:1e3,ascender:1011,descender:-353,lineHeight:1.25}},[ct["Lilita One"]]:{metrics:{unitsPerEm:1e3,ascender:923,descender:-220,lineHeight:1.15}},[ct["Comic Shanns"]]:{metrics:{unitsPerEm:1e3,ascender:750,descender:-250,lineHeight:1.25}},[ct.Virgil]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},deprecated:!0},[ct.Helvetica]:{metrics:{unitsPerEm:2048,ascender:1577,descender:-471,lineHeight:1.15},deprecated:!0,local:!0},[ct.Cascadia]:{metrics:{unitsPerEm:2048,ascender:1900,descender:-480,lineHeight:1.2},deprecated:!0},[ct["Liberation Sans"]]:{metrics:{unitsPerEm:2048,ascender:1854,descender:-434,lineHeight:1.15},private:!0},[ct.Assistant]:{metrics:{unitsPerEm:2048,ascender:1021,descender:-287,lineHeight:1.25},private:!0},[dh.Xiaolai]:{metrics:{unitsPerEm:1e3,ascender:880,descender:-144,lineHeight:1.25},fallback:!0},[dh["Segoe UI Emoji"]]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},local:!0,fallback:!0}},Kd={LATIN:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD",LATIN_EXT:"U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF",CYRILIC_EXT:"U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F",CYRILIC:"U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116",VIETNAMESE:"U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB"},M9="local:",_z=(e,t,n)=>{var c;const{unitsPerEm:i,ascender:s,descender:r}=((c=ig[e])==null?void 0:c.metrics)||ig[ct.Excalifont].metrics,o=t/i,a=(n-o*s+o*r)/2;return o*s+a},id=e=>{var n;const{lineHeight:t}=((n=ig[e])==null?void 0:n.metrics)||ig[ct.Excalifont].metrics;return t};class Eie{constructor(){B(this,"jobs",[]);B(this,"running",!1)}tick(){if(this.running)return;const t=this.jobs.shift();t?(this.running=!0,t.promise.resolve(sd(t.jobFactory,...t.args).finally(()=>{this.running=!1,this.tick()}))):this.running=!1}push(t,...n){const i=Fy();return this.jobs.push({jobFactory:t,promise:i,args:n}),this.tick(),i}}const wz="excalidraw.desktopUIMode",Tz=599,vie=1e3,_ie=500,wie=Tz+1,Tie=1180,Iie=1440,Sie=1229,Ao=/Mac|iPod|iPhone|iPad/.test(navigator.platform),Iz=/^Win/.test(navigator.platform),Sz=/\b(android)\b/i.test(navigator.userAgent),z0=typeof window<"u"&&"netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,Cie=navigator.userAgent.indexOf("Chrome")!==-1,Cz=!Cie&&navigator.userAgent.indexOf("Safari")!==-1,k9=/iPad|iPhone/i.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,xie=()=>{var e,t;return((t=(e=navigator.brave)==null?void 0:e.isBrave)==null?void 0:t.name)==="isBrave"},Aie=(e,t)=>e<=Tz||t<_ie&&e<vie,Mie=(e,t)=>{const n=Math.min(e,t),i=Math.max(e,t);return n>=wie&&i<=Tie},kie=()=>{const e=navigator.userAgent||"",t=navigator.platform||"",n=navigator.userAgentData;if(n){const s=(n.platform||"").toLowerCase(),r=s==="windows"||s==="macos"||s==="linux"||s==="chrome os";if(n.mobile===!0)return!0;if(n.mobile===!1&&s==="android")return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches);if(r)return!1}if(k9)return!0;if(Sz){const s=/Mobile/i.test(e);if(s||!s)return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches)}return/Win|Linux|CrOS|Mac/.test(t)||/Windows NT|X11|CrOS|Macintosh/.test(e),!1},Rie=(e,t)=>Aie(e,t)?"phone":Mie(e,t)?"tablet":"desktop",K1=e=>e.formFactor==="phone"?"mobile":e.formFactor==="tablet"?"compact":e.desktopUIMode,xz=e=>{const t=e??"";let n="unknown";return k9?n="ios":Sz?n="android":t&&(n="other"),{isMobileDevice:kie(),platform:n}},Die=()=>{if(typeof window>"u")return null;try{const e=window.localStorage.getItem(wz);if(e==="compact"||e==="full")return e}catch{}return null},Lie=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(wz,e)}catch{}},Pie=e=>{if(!(e!=="compact"&&e!=="full"))return Lie(e),e},ut={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",Y:"KeyY",R:"KeyR",S:"KeyS"},$={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:Ao?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SLASH:"/",A:"a",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},Nie=new Map([[$.Z,ut.Z],[$.Y,ut.Y]]),Oie=e=>/^[a-z]$/.test(e.toLowerCase()),f4=(e,t)=>{if(t===e.key.toLowerCase())return!0;const n=Nie.get(t);return!!(n&&!Oie(e.key)&&e.code===n)},f1=e=>e===$.ARROW_LEFT||e===$.ARROW_RIGHT||e===$.ARROW_DOWN||e===$.ARROW_UP,iM=e=>e.altKey,Pm=e=>e.shiftKey,bc=e=>e.shiftKey,sg=e=>{const t=e.map(i=>i[0]),n=e.map(i=>i[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},B6=(e,t,n,i)=>{const s=n.map(h=>h[e]),r=Math.max(...s),o=Math.min(...s),a=r-o,l=a===0?1:t/a;let c=1/0;const d=n.map(h=>{const m=h[e]*l,p=[...h];return p[e]=m,m<c&&(c=m),p});if(!i||d.length===2)return d;const u=o-c;return d.map(h=>h.map((m,p)=>p===e?m+u:m))},ci=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t];var Az={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(ll,function(){var n=function(){this._listeners={}};n.prototype.addEventListener=function(c,d){this._listeners[c]=this._listeners[c]||[],this._listeners[c].indexOf(d)<0&&this._listeners[c].push(d)},n.prototype.removeEventListener=function(c,d){if(this._listeners[c]){var u=this._listeners[c].indexOf(d);u>=0&&this._listeners[c].splice(u,1)}},n.prototype.dispatchEvent=function(c){if(this._listeners[c.type]&&this._listeners[c.type].length)for(var d=this._listeners[c.type].slice(),u=0,f=d.length;u<f;++u)d[u].call(this,c)};var i=function(c){return typeof c.constructor=="function"&&c.constructor.name==="GeneratorFunction"},s=function(c){return{next:function(){var d=c();return d?{value:d}:{done:!0}}}},r=function(c){var d=!1;return{next:function(){return d?{done:!0}:(d=!0,{value:c})}}},o=function(c,d){var u=typeof c;if(u==="object"){if(typeof c.next=="function")return c;if(typeof c.then=="function")return r(c)}return u==="function"?i(c)?c():s(c):r(d.resolve(c))},a=function(c,d,u){this.target=c,this.type=d,this.data=u},l=function(c,d,u){if(n.call(this),typeof d!="number"||Math.floor(d)!==d||d<1)throw new Error("Invalid concurrency");this._concurrency=d,this._options=u||{},this._options.promise=this._options.promise||Promise,this._iterator=o(c,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return l.prototype=new n,l.prototype.constructor=l,l.prototype.concurrency=function(c){return typeof c<"u"&&(this._concurrency=c,this.active()&&this._proceed()),this._concurrency},l.prototype.size=function(){return this._size},l.prototype.active=function(){return!!this._promise},l.prototype.promise=function(){return this._promise},l.prototype.start=function(){var c=this,d=this._options.promise;return this._promise=new d(function(u,f){c._callbacks={reject:f,resolve:u},c._proceed()}),this._promise},l.prototype._fireEvent=function(c,d){this.dispatchEvent(new a(this,c,d))},l.prototype._settle=function(c){c?this._callbacks.reject(c):this._callbacks.resolve(),this._promise=null,this._callbacks=null},l.prototype._onPooledPromiseFulfilled=function(c,d){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:c,result:d}),this._proceed())},l.prototype._onPooledPromiseRejected=function(c,d){this._size--,this.active()&&(this._fireEvent("rejected",{promise:c,error:d}),this._settle(d||new Error("Unknown error")))},l.prototype._trackPromise=function(c){var d=this;c.then(function(u){d._onPooledPromiseFulfilled(c,u)},function(u){d._onPooledPromiseRejected(c,u)}).catch(function(u){d._settle(new Error("Promise processing failed: "+u))})},l.prototype._proceed=function(){if(!this._done){for(var c={done:!1};this._size<this._concurrency&&!(c=this._iterator.next()).done;)this._size++,this._trackPromise(c.value);this._done=c===null||!!c.done}this._done&&this._size===0&&this._settle()},l.PromisePoolEvent=a,l.PromisePool=l,l})})(Az);var Fie=Az.exports;const Bie=Hl(Fie);class sM{constructor(t,n){B(this,"pool");B(this,"entries",{});this.pool=new Bie(t,n)}all(){const t=n=>{if(n.data.result){const[i,s]=n.data.result;this.entries[i]=s}};return this.pool.addEventListener("fulfilled",t),this.pool.start().then(()=>(setTimeout(()=>{this.pool.removeEventListener("fulfilled",t)}),Object.values(this.entries)))}}let Mz=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");function zie(){return Math.floor(Math.random()*2**31)}class kz{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const rM=()=>{const e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),i=`${e.getDate()}`.padStart(2,"0"),s=`${e.getHours()}`.padStart(2,"0"),r=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${i}-${s}${r}`},Ht=e=>e.charAt(0).toUpperCase()+e.slice(1),Hie=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),h4=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,Vie=e=>h4(e)||e instanceof Element&&!!e.closest("label, button"),rl=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&(e.type==="text"||e.type==="number"||e.type==="password"||e.type==="search"),Xp=({fontFamily:e})=>{for(const[t,n]of Object.entries(ct))if(n===e)return`${t}${hz(n).map(i=>`, ${i}`).join("")}`;return F0},_t=({fontSize:e,fontFamily:t})=>`${e}px ${Xp({fontFamily:t})}`,$ie=async e=>{requestAnimationFrame(()=>requestAnimationFrame(e))},Al=(e,t)=>{let n=0,i=null;const s=(...r)=>{i=r,clearTimeout(n),n=window.setTimeout(()=>{i=null,e(...r)},t)};return s.flush=()=>{if(clearTimeout(n),i){const r=i;i=null,e(...r)}},s.cancel=()=>{i=null,clearTimeout(n)},s},jp=(e,t)=>{let n=null,i=null,s=null;const r=a=>{n=window.requestAnimationFrame(()=>{n=null,e(...a),i=null,s&&(i=s,s=null,r(i))})},o=(...a)=>{i=a,n===null?r(i):t!=null&&t.trailing&&(s=a)};return o.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),i&&(e(...s||i),i=s=null)},o.cancel=()=>{i=s=null,n!==null&&(cancelAnimationFrame(n),n=null)},o},Ml=e=>1-Math.pow(1-e,4),oM=(e,t,n)=>(t-e)*Ml(n)+e,Gie=({fromValues:e,toValues:t,onStep:n,duration:i=250,interpolateValue:s,onStart:r,onEnd:o,onCancel:a})=>{let l=!1,c=0,d;function u(f){if(l)return;d===void 0&&(d=f,r==null||r());const h=Math.min(f-d,i),m=Ml(h/i),p={};if(Object.keys(e).forEach(U=>{const b=U,y=(t[b]-e[b])*m+e[b];p[b]=y}),n(p),h<i){const U=h/i,b={};Object.keys(e).forEach(y=>{const E=y,_=e[E],I=t[E];let k;k=s?s(_,I,U,E):oM(_,I,U),k==null&&(k=oM(_,I,U)),b[E]=k}),n(b),c=window.requestAnimationFrame(u)}else n(t),o==null||o()}return c=window.requestAnimationFrame(u),()=>{a==null||a(),l=!0,window.cancelAnimationFrame(c)}},Xie=(e,t)=>{if(!e.length||t<1)return[];let n=0,i=0;const s=Array(Math.ceil(e.length/t));for(;n<e.length;)s[i++]=e.slice(n,n+=t);return s},rs=(e,t)=>Math.abs(e-t),UU=e=>e==="selection"||e==="lasso",sn=(e,t)=>t.type==="custom"?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:t.lastActiveToolBeforeEraser===void 0?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked,fromSelection:t.fromSelection??!1},zt=({clientX:e,clientY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e-i)/n.value-r,l=(t-s)/n.value-o;return{x:a,y:l}},cr=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e+r)*n.value+i,l=(t+o)*n.value+s;return{x:a,y:l}},bU=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),jie="A-Za-z--------",Yie="---",Wie=new RegExp(`^[^${jie}]*[${Yie}]`),Rz=e=>Wie.test(e),_3=e=>{const[t,n]=e;return{x:t,y:n}},Dz=e=>{if((e==null?void 0:e.name)==="AbortError"){console.warn(e);return}throw e},Lz=(e,t,n=0)=>{n<0&&(n=e.length+n),n=Math.min(e.length,Math.max(n,0));let i=n-1;for(;++i<e.length;)if(t(e[i],i,e))return i;return-1},qo=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n),n=Math.min(e.length-1,Math.max(n,0));let i=n+1;for(;--i>-1;)if(t(e[i],i,e))return i;return-1},Kie=(e,t)=>{for(let n=0;n<e.length;n++){const i=t(e[n],n);if(i!=null)return i}},Fy=()=>{let e,t;const n=new Promise((i,s)=>{e=i,t=s});return n.resolve=e,n.reject=t,n},aM=(e,t)=>{const n=[{value:1,symbol:"b"},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"}],i=/\.0+$|(\.[0-9]*[1-9])0+$/;let s;for(s=n.length-1;s>0&&!(e>=n[s].value);s--);return(e/n[s].value).toFixed(t).replace(i,"$1")+n[s].symbol},g4=()=>{var e;return((e=document.querySelector('meta[name="version"]'))==null?void 0:e.content)||mz},Zie=e=>{let t=e.parentElement;for(;t;){if(t===document.body)return document;const{overflowY:n}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return t;t=t.parentElement}return document},qie=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},R9=e=>{e.preventDefault(),e.returnValue=""},Pz=e=>Array.from(e).map(t=>`0${t.toString(16)}`.slice(-2)).join(""),Gg=()=>Date.now(),we=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map),Qie=e=>e.reduce((t,n,i)=>(t.set(n.id,[n,i]),t),new Map),Ga=(e,t)=>e.reduce((n,i,s)=>(n[t?t(i):s]=i,n),{}),Jie=e=>e.reduce((t,n,i)=>{const s={...n,prev:null,next:null};if(i!==0){const r=t[i-1];if(s.prev=r,r.next=s,i===e.length-1){const o=t[0];s.next=o,o.prev=s}}return t.push(s),t},[]),cc=e=>Array.isArray(e)?e:e.values(),ese=e=>Array.isArray(e)?e:Array.from(cc(e)),tse=()=>dz.TEST==="production",D9=()=>dz.DEVELOPMENT==="production",nse=()=>typeof process<"u"&&!0,Nz=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),yb=(e,t)=>{let n=!1;for(const i in t){const s=t[i];if(typeof s<"u"){if(e[i]===s&&(typeof s!="object"||s===null))continue;n=!0}}return n?{...e,...t}:e},Yp=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},ise=()=>Yp()==="iframe",Wp=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,m4=e=>{const t=e==null?void 0:e.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(n=>n.tabIndex>-1&&!n.disabled):[]},lM=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,ki=(e,t,n,i=!1)=>{const s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return i&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(const o of n)if(!(e[o]===t[o]||lM(e[o],t[o])))return i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),!1;return!0}return s.every(o=>{const a=n==null?void 0:n[o],l=a?a(e[o],t[o]):e[o]===t[o]||lM(e[o],t[o]);return!l&&i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),l})},By=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(s){if(e==null||e(s),!n||!(s!=null&&s.defaultPrevented))return t==null?void 0:t(s)},Ua=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)};function Ce(e,t){if(!e)throw new Error(t)}const sse=e=>{let t,n;const i=function(s){const r=Object.entries(s);if(t){let a=!0;for(const[l,c]of r)if(t.get(l)!==c){a=!1;break}if(a)return n}const o=e(s);return t=new Map(r),n=o,o};return i.clear=()=>{t=void 0,n=void 0},i},Oz=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),ua=e=>JSON.parse(JSON.stringify(e)),Nm=(e,t)=>ki(e,t)?e:t;function an(e,t,n,i){var s;return e?((s=e==null?void 0:e.addEventListener)==null||s.call(e,t,n,i),()=>{var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,t,n,i)}):()=>{}}function rse(e,t=!0){const n=e.length;if(n<4)return"";let i=e[0],s=e[1];const r=e[2];let o=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${s[0].toFixed(2)},${s[1].toFixed(2)} ${hU(s[0],r[0]).toFixed(2)},${hU(s[1],r[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)i=e[a],s=e[a+1],o+=`${hU(i[0],s[0]).toFixed(2)},${hU(i[1],s[1]).toFixed(2)} `;return t&&(o+="Z"),o}const Fz=e=>e.replace(/\r?\n|\r/g,`
`);const sd=async(e,...t)=>new Promise(n=>{n(e(...t))}),ose=(...e)=>Math.max(...e.map(t=>t?1:0))>0,ase=e=>{try{return JSON.parse(e)}catch{return null}},Eb=e=>e.replace(/"/g,"&quot;"),w3=e=>Array.isArray(e)?e:[e],lse=e=>Array.isArray(e),Bz=e=>lse(e)?e.length:e instanceof Map||e instanceof Set?e.size:Object.keys(e).length,zz=(e,t)=>{if(Bz(e)===0)return null;const n=t||(s=>s);let i=null;for(const s of e){const r=n(s);if((i===null||i===r)&&r!=null)i=r;else return null}return i},cse="excalidraw-feature-flags",cM={COMPLEX_BINDINGS:!1};let T3=null;const Ii=e=>{if(!T3)try{const t=localStorage.getItem(cse);t&&(T3=JSON.parse(t)??cM)}catch{}return(T3||cM)[e]};let dse=new kz(Date.now());const to=()=>Math.floor(dse.next()*2**31),Li=()=>Mz();var L9={};Object.defineProperty(L9,"__esModule",{value:!0});var Hz=L9.sanitizeUrl=void 0,use=/^([^\w]*)(javascript|data|vbscript)/im,fse=/&#(\w+)(^\w|;)?/g,hse=/&(newline|tab);/gi,gse=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,mse=/^.+(:|&colon;)/gim,pse=[".","/"];function Use(e){return pse.indexOf(e[0])>-1}function bse(e){return e.replace(fse,function(t,n){return String.fromCharCode(n)})}function yse(e){var t=bse(e||"").replace(hse,"").replace(gse,"").trim();if(!t)return"about:blank";if(Use(t))return t;var n=t.match(mse);if(!n)return t;var i=n[0];return use.test(i)?"about:blank":t}Hz=L9.sanitizeUrl=yse;const Ur=e=>(e=e.trim(),e&&Hz(Eb(e))),Vz=e=>!!(e!=null&&e.includes(location.origin)||e!=null&&e.startsWith("/")),P9=e=>{if(e=Ur(e),e.startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e};class fo{constructor(){B(this,"subscribers",[])}on(...t){const n=t.flat().filter(i=>typeof i=="function");return this.subscribers.push(...n),()=>this.off(n)}once(...t){const n=t.flat().filter(s=>typeof s=="function");n.push(()=>i());const i=this.on(...n);return i}off(...t){const n=t.flat();this.subscribers=this.subscribers.filter(i=>!n.includes(i))}trigger(...t){for(const n of this.subscribers)n(...t);return this}clear(){this.subscribers=[]}}const $t=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Yt=globalThis,tf=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Uu="9.0.1";function zy(){return Hy(Yt),Yt}function Hy(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||Uu,t[Uu]=t[Uu]||{}}function Vy(e,t,n=Yt){const i=n.__SENTRY__=n.__SENTRY__||{},s=i[Uu]=i[Uu]||{};return s[e]||(s[e]=t())}const Ese="Sentry Logger ",z6=["debug","info","warn","error","log","assert","trace"],H6={};function Xg(e){if(!("console"in Yt))return e();const t=Yt.console,n={},i=Object.keys(H6);i.forEach(s=>{const r=H6[s];n[s]=t[s],t[s]=r});try{return e()}finally{i.forEach(s=>{t[s]=n[s]})}}function vse(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return tf?z6.forEach(n=>{t[n]=(...i)=>{e&&Xg(()=>{Yt.console[n](`${Ese}[${n}]:`,...i)})}}):z6.forEach(n=>{t[n]=()=>{}}),t}const Xe=Vy("logger",vse),$z=50,xu="?",dM=/\(error: (.*)\)/,uM=/captureMessage|captureException/;function Gz(...e){const t=e.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0,s=0)=>{const r=[],o=n.split(`
`);for(let a=i;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const c=dM.test(l)?l.replace(dM,"$1"):l;if(!c.match(/\S*Error: /)){for(const d of t){const u=d(c);if(u){r.push(u);break}}if(r.length>=$z+s)break}}return wse(r.slice(s))}}function _se(e){return Array.isArray(e)?Gz(...e):e}function wse(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(yU(t).function||"")&&t.pop(),t.reverse(),uM.test(yU(t).function||"")&&(t.pop(),uM.test(yU(t).function||"")&&t.pop()),t.slice(0,$z).map(n=>({...n,filename:n.filename||yU(t).filename,function:n.function||xu}))}function yU(e){return e[e.length-1]||{}}const I3="<anonymous>";function rd(e){try{return!e||typeof e!="function"?I3:e.name||I3}catch{return I3}}function fM(e){const t=e.exception;if(t){const n=[];try{return t.values.forEach(i=>{i.stacktrace.frames&&n.push(...i.stacktrace.frames)}),n}catch{return}}}const vb={},hM={};function nf(e,t){vb[e]=vb[e]||[],vb[e].push(t)}function sf(e,t){if(!hM[e]){hM[e]=!0;try{t()}catch(n){tf&&Xe.error(`Error while instrumenting ${e}`,n)}}}function Io(e,t){const n=e&&vb[e];if(n)for(const i of n)try{i(t)}catch(s){tf&&Xe.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${rd(i)}
Error:`,s)}}let S3=null;function Tse(e){const t="error";nf(t,e),sf(t,Ise)}function Ise(){S3=Yt.onerror,Yt.onerror=function(e,t,n,i,s){return Io("error",{column:i,error:s,line:n,msg:e,url:t}),S3?S3.apply(this,arguments):!1},Yt.onerror.__SENTRY_INSTRUMENTED__=!0}let C3=null;function Sse(e){const t="unhandledrejection";nf(t,e),sf(t,Cse)}function Cse(){C3=Yt.onunhandledrejection,Yt.onunhandledrejection=function(e){return Io("unhandledrejection",e),C3?C3.apply(this,arguments):!0},Yt.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Xz=Object.prototype.toString;function N9(e){switch(Xz.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Au(e,Error)}}function jg(e,t){return Xz.call(e)===`[object ${t}]`}function jz(e){return jg(e,"ErrorEvent")}function gM(e){return jg(e,"DOMError")}function xse(e){return jg(e,"DOMException")}function bl(e){return jg(e,"String")}function O9(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function F9(e){return e===null||O9(e)||typeof e!="object"&&typeof e!="function"}function rg(e){return jg(e,"Object")}function $y(e){return typeof Event<"u"&&Au(e,Event)}function Ase(e){return typeof Element<"u"&&Au(e,Element)}function Mse(e){return jg(e,"RegExp")}function Gy(e){return!!(e!=null&&e.then&&typeof e.then=="function")}function kse(e){return rg(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function Au(e,t){try{return e instanceof t}catch{return!1}}function Yz(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}const B9=Yt,Rse=80;function Wz(e,t={}){if(!e)return"<unknown>";try{let n=e;const i=5,s=[];let r=0,o=0;const a=" > ",l=a.length;let c;const d=Array.isArray(t)?t:t.keyAttrs,u=!Array.isArray(t)&&t.maxStringLength||Rse;for(;n&&r++<i&&(c=Dse(n,d),!(c==="html"||r>1&&o+s.length*l+c.length>=u));)s.push(c),o+=c.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Dse(e,t){const n=e,i=[];if(!(n!=null&&n.tagName))return"";if(B9.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}i.push(n.tagName.toLowerCase());const s=t!=null&&t.length?t.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{i.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&i.push(`#${n.id}`);const o=n.className;if(o&&bl(o)){const a=o.split(/\s+/);for(const l of a)i.push(`.${l}`)}}const r=["aria-label","type","name","title","alt"];for(const o of r){const a=n.getAttribute(o);a&&i.push(`[${o}="${a}"]`)}return i.join("")}function z9(){try{return B9.document.location.href}catch{return""}}function Lse(e){if(!B9.HTMLElement)return null;let t=e;const n=5;for(let i=0;i<n;i++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}function Mh(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function V6(e,t){if(!Array.isArray(e))return"";const n=[];for(let i=0;i<e.length;i++){const s=e[i];try{Yz(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function Pse(e,t,n=!1){return bl(e)?Mse(t)?t.test(e):bl(t)?n?e===t:e.includes(t):!1:!1}function Xy(e,t=[],n=!1){return t.some(i=>Pse(e,i,n))}function dr(e,t,n){if(!(t in e))return;const i=e[t],s=n(i);typeof s=="function"&&Kz(s,i);try{e[t]=s}catch{tf&&Xe.log(`Failed to replace method "${t}" in object`,e)}}function Mu(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{tf&&Xe.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Kz(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Mu(e,"__sentry_original__",t)}catch{}}function H9(e){return e.__sentry_original__}function Zz(e){if(N9(e))return{message:e.message,name:e.name,stack:e.stack,...pM(e)};if($y(e)){const t={type:e.type,target:mM(e.target),currentTarget:mM(e.currentTarget),...pM(e)};return typeof CustomEvent<"u"&&Au(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function mM(e){try{return Ase(e)?Wz(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function pM(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function Nse(e,t=40){const n=Object.keys(Zz(e));n.sort();const i=n[0];if(!i)return"[object has no keys]";if(i.length>=t)return Mh(i,t);for(let s=n.length;s>0;s--){const r=n.slice(0,s).join(", ");if(!(r.length>t))return s===n.length?r:Mh(r,t)}return""}function ur(e){return p4(e,new Map)}function p4(e,t){if(Ose(e)){const n=t.get(e);if(n!==void 0)return n;const i={};t.set(e,i);for(const s of Object.getOwnPropertyNames(e))typeof e[s]<"u"&&(i[s]=p4(e[s],t));return i}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const i=[];return t.set(e,i),e.forEach(s=>{i.push(p4(s,t))}),i}return e}function Ose(e){if(!rg(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const qz=1e3;function Kp(){return Date.now()/qz}function Fse(){const{performance:e}=Yt;if(!(e!=null&&e.now))return Kp;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/qz}const yl=Fse();function Wr(){const e=Yt,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return t.getRandomValues(i),i[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function Qz(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function dc(e){const{message:t,event_id:n}=e;if(t)return t;const i=Qz(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function U4(e,t,n){const i=e.exception=e.exception||{},s=i.values=i.values||[],r=s[0]=s[0]||{};r.value||(r.value=t||""),r.type||(r.type="Error")}function ku(e,t){const n=Qz(e);if(!n)return;const i={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...i,...s,...t},t&&"data"in t){const r={...s==null?void 0:s.data,...t.data};n.mechanism.data=r}}function UM(e){if(Bse(e))return!0;try{Mu(e,"__sentry_captured__",!0)}catch{}return!1}function Bse(e){try{return e.__sentry_captured__}catch{}}var Wa;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const i=2;e[e.REJECTED=i]="REJECTED"})(Wa||(Wa={}));function Ru(e){return new od(t=>{t(e)})}function $6(e){return new od((t,n)=>{n(e)})}class od{constructor(t){this._state=Wa.PENDING,this._handlers=[],this._runExecutor(t)}then(t,n){return new od((i,s)=>{this._handlers.push([!1,r=>{if(!t)i(r);else try{i(t(r))}catch(o){s(o)}},r=>{if(!n)s(r);else try{i(n(r))}catch(o){s(o)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new od((n,i)=>{let s,r;return this.then(o=>{r=!1,s=o,t&&t()},o=>{r=!0,s=o,t&&t()}).then(()=>{if(r){i(s);return}n(s)})})}_executeHandlers(){if(this._state===Wa.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===Wa.RESOLVED&&n[1](this._value),this._state===Wa.REJECTED&&n[2](this._value),n[0]=!0)})}_runExecutor(t){const n=(r,o)=>{if(this._state===Wa.PENDING){if(Gy(o)){o.then(i,s);return}this._state=r,this._value=o,this._executeHandlers()}},i=r=>{n(Wa.RESOLVED,r)},s=r=>{n(Wa.REJECTED,r)};try{t(i,s)}catch(r){s(r)}}}function zse(e){const t=yl(),n={sid:Wr(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Vse(n)};return e&&og(n,e),n}function og(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||yl(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:Wr()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function Hse(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),og(e,n)}function Vse(e){return ur({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}function bM(){return Wr()}function Jz(){return Wr().substring(16)}function Zp(e,t,n=2){if(!t||typeof t!="object"||n<=0)return t;if(e&&Object.keys(t).length===0)return e;const i={...e};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=Zp(i[s],t[s],n-1));return i}const b4="_sentrySpan";function yM(e,t){t?Mu(e,b4,t):delete e[b4]}function EM(e){return e[b4]}const $se=100;class ba{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:bM(),sampleRand:Math.random()}}clone(){const t=new ba;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,yM(t,EM(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&og(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t,i=n instanceof ba?n.getScopeData():rg(n)?t:void 0,{tags:s,extra:r,user:o,contexts:a,level:l,fingerprint:c=[],propagationContext:d}=i||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...r},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),l&&(this._level=l),c.length&&(this._fingerprint=c),d&&(this._propagationContext=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,yM(this,void 0),this._attachments=[],this.setPropagationContext({traceId:bM(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,n){var r;const i=typeof n=="number"?n:$se;if(i<=0)return this;const s={timestamp:Kp(),...t};return this._breadcrumbs.push(s),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),(r=this._client)==null||r.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:EM(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=Zp(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const i=(n==null?void 0:n.event_id)||Wr();if(!this._client)return Xe.warn("No client configured on scope - will not capture exception!"),i;const s=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:s,...n,event_id:i},this),i}captureMessage(t,n,i){const s=(i==null?void 0:i.event_id)||Wr();if(!this._client)return Xe.warn("No client configured on scope - will not capture message!"),s;const r=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:r,...i,event_id:s},this),s}captureEvent(t,n){const i=(n==null?void 0:n.event_id)||Wr();return this._client?(this._client.captureEvent(t,{...n,event_id:i},this),i):(Xe.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function Gse(){return Vy("defaultCurrentScope",()=>new ba)}function Xse(){return Vy("defaultIsolationScope",()=>new ba)}class jse{constructor(t,n){let i;t?i=t:i=new ba;let s;n?s=n:s=new ba,this._stack=[{scope:i}],this._isolationScope=s}withScope(t){const n=this._pushScope();let i;try{i=t(n)}catch(s){throw this._popScope(),s}return Gy(i)?i.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function ag(){const e=zy(),t=Hy(e);return t.stack=t.stack||new jse(Gse(),Xse())}function Yse(e){return ag().withScope(e)}function Wse(e,t){const n=ag();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function vM(e){return ag().withScope(()=>e(ag().getIsolationScope()))}function Kse(){return{withIsolationScope:vM,withScope:Yse,withSetScope:Wse,withSetIsolationScope:(e,t)=>vM(t),getCurrentScope:()=>ag().getScope(),getIsolationScope:()=>ag().getIsolationScope()}}function V9(e){const t=Hy(e);return t.acs?t.acs:Kse()}function No(){const e=zy();return V9(e).getCurrentScope()}function qp(){const e=zy();return V9(e).getIsolationScope()}function Zse(){return Vy("globalScope",()=>new ba)}function $9(...e){const t=zy(),n=V9(t);if(e.length===2){const[i,s]=e;return i?n.withSetScope(i,s):n.withScope(s)}return n.withScope(e[0])}function qi(){return No().getClient()}function qse(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:i,propagationSpanId:s}=t;return ur({trace_id:n,span_id:s||Jz(),parent_span_id:i})}const Qse="sentry.source",Jse="sentry.sample_rate",ere="sentry.op",tre="sentry.origin",eH="sentry.profile_id",tH="sentry.exclusive_time",nre=0,ire=1,sre="_sentryScope",rre="_sentryIsolationScope";function nH(e){return{scope:e[sre],isolationScope:e[rre]}}function ore(e){if(typeof e=="boolean")return Number(e);const t=typeof e=="string"?parseFloat(e):e;if(!(typeof t!="number"||isNaN(t)||t<0||t>1))return t}const are="sentry-",lre=/^sentry-/;function cre(e){const t=dre(e);if(!t)return;const n=Object.entries(t).reduce((i,[s,r])=>{if(s.match(lre)){const o=s.slice(are.length);i[o]=r}return i},{});if(Object.keys(n).length>0)return n}function dre(e){if(!(!e||!bl(e)&&!Array.isArray(e)))return Array.isArray(e)?e.reduce((t,n)=>{const i=_M(n);return Object.entries(i).forEach(([s,r])=>{t[s]=r}),t},{}):_M(e)}function _M(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,i])=>(n&&i&&(t[n]=i),t),{})}const ure=1;let wM=!1;function fre(e){const{spanId:t,traceId:n,isRemote:i}=e.spanContext(),s=i?t:G9(e).parent_span_id,r=nH(e).scope,o=i?(r==null?void 0:r.getPropagationContext().propagationSpanId)||Jz():t;return ur({parent_span_id:s,span_id:o,trace_id:n})}function TM(e){return typeof e=="number"?IM(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?IM(e.getTime()):yl()}function IM(e){return e>9999999999?e/1e3:e}function G9(e){if(gre(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(hre(e)){const{attributes:i,startTime:s,name:r,endTime:o,parentSpanId:a,status:l}=e;return ur({span_id:t,trace_id:n,data:i,description:r,parent_span_id:a,start_timestamp:TM(s),timestamp:TM(o)||void 0,status:pre(l),op:i[ere],origin:i[tre]})}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function hre(e){const t=e;return!!t.attributes&&!!t.startTime&&!!t.name&&!!t.endTime&&!!t.status}function gre(e){return typeof e.getSpanJSON=="function"}function mre(e){const{traceFlags:t}=e.spanContext();return t===ure}function pre(e){if(!(!e||e.code===nre))return e.code===ire?"ok":e.message||"unknown_error"}const Ure="_sentryRootSpan";function iH(e){return e[Ure]||e}function SM(){wM||(Xg(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),wM=!0)}function bre(e){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=e||((n=qi())==null?void 0:n.getOptions());return!!t&&(t.tracesSampleRate!=null||!!t.tracesSampler)}const X9="production",yre="_frozenDsc";function sH(e,t){const n=t.getOptions(),{publicKey:i}=t.getDsn()||{},s=ur({environment:n.environment||X9,release:n.release,public_key:i,trace_id:e});return t.emit("createDsc",s),s}function Ere(e,t){const n=t.getPropagationContext();return n.dsc||sH(n.traceId,e)}function vre(e){var m;const t=qi();if(!t)return{};const n=iH(e),i=G9(n),s=i.data,r=n.spanContext().traceState,o=(r==null?void 0:r.get("sentry.sample_rate"))??s[Jse];function a(p){return(typeof o=="number"||typeof o=="string")&&(p.sample_rate=`${o}`),p}const l=n[yre];if(l)return a(l);const c=r==null?void 0:r.get("sentry.dsc"),d=c&&cre(c);if(d)return a(d);const u=sH(e.spanContext().traceId,t),f=s[Qse],h=i.description;return f!=="url"&&h&&(u.transaction=h),bre()&&(u.sampled=String(mre(n)),u.sample_rand=(r==null?void 0:r.get("sentry.sample_rand"))??((m=nH(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(u),t.emit("createDsc",u,n),u}const _re=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function wre(e){return e==="http"||e==="https"}function j9(e,t=!1){const{host:n,path:i,pass:s,port:r,projectId:o,protocol:a,publicKey:l}=e;return`${a}://${l}${t&&s?`:${s}`:""}@${n}${r?`:${r}`:""}/${i&&`${i}/`}${o}`}function Tre(e){const t=_re.exec(e);if(!t){Xg(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,i,s="",r="",o="",a=""]=t.slice(1);let l="",c=a;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return rH({host:r,pass:s,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function rH(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Ire(e){if(!tf)return!0;const{port:t,projectId:n,protocol:i}=e;return["protocol","publicKey","host","projectId"].find(o=>e[o]?!1:(Xe.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?wre(i)?t&&isNaN(parseInt(t,10))?(Xe.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(Xe.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(Xe.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Sre(e){const t=typeof e=="string"?Tre(e):rH(e);if(!(!t||!Ire(t)))return t}function Ka(e,t=100,n=1/0){try{return y4("",e,t,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function oH(e,t=3,n=100*1024){const i=Ka(e,t);return Mre(i)>n?oH(e,t-1,n):i}function y4(e,t,n=1/0,i=1/0,s=kre()){const[r,o]=s;if(t==null||["boolean","string"].includes(typeof t)||typeof t=="number"&&Number.isFinite(t))return t;const a=Cre(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const l=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(r(t))return"[Circular ~]";const c=t;if(c&&typeof c.toJSON=="function")try{const h=c.toJSON();return y4("",h,l-1,i,s)}catch{}const d=Array.isArray(t)?[]:{};let u=0;const f=Zz(t);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(u>=i){d[h]="[MaxProperties ~]";break}const m=f[h];d[h]=y4(h,m,l-1,i,s),u++}return o(t),d}function Cre(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(Yz(t))return"[VueViewModel]";if(kse(t))return"[SyntheticEvent]";if(typeof t=="number"&&!Number.isFinite(t))return`[${t}]`;if(typeof t=="function")return`[Function: ${rd(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=xre(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function xre(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function Are(e){return~-encodeURI(e).split(/%..|./).length}function Mre(e){return Are(JSON.stringify(e))}function kre(){const e=new WeakSet;function t(i){return e.has(i)?!0:(e.add(i),!1)}function n(i){e.delete(i)}return[t,n]}function jy(e,t=[]){return[e,t]}function Rre(e,t){const[n,i]=e;return[n,[...i,t]]}function CM(e,t){const n=e[1];for(const i of n){const s=i[0].type;if(t(i,s))return!0}return!1}function E4(e){const t=Hy(Yt);return t.encodePolyfill?t.encodePolyfill(e):new TextEncoder().encode(e)}function Dre(e){const[t,n]=e;let i=JSON.stringify(t);function s(r){typeof i=="string"?i=typeof r=="string"?i+r:[E4(i),r]:i.push(typeof r=="string"?E4(r):r)}for(const r of n){const[o,a]=r;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Ka(a))}s(l)}}return typeof i=="string"?i:Lre(i)}function Lre(e){const t=e.reduce((s,r)=>s+r.length,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;return n}function Pre(e){const t=typeof e.data=="string"?E4(e.data):e.data;return[ur({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const Nre={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security"};function xM(e){return Nre[e]}function aH(e){if(!(e!=null&&e.sdk))return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Ore(e,t,n,i){var r;const s=(r=e.sdkProcessingMetadata)==null?void 0:r.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&i&&{dsn:j9(i)},...s&&{trace:ur({...s})}}}function Fre(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function Bre(e,t,n,i){const s=aH(n),r={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!i&&t&&{dsn:j9(t)}},o="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return jy(r,[o])}function zre(e,t,n,i){const s=aH(n),r=e.type&&e.type!=="replay_event"?e.type:"event";Fre(e,n==null?void 0:n.sdk);const o=Ore(e,s,i,t);return delete e.sdkProcessingMetadata,jy(o,[[{type:r},e]])}function v4(e,t,n,i=0){return new od((s,r)=>{const o=e[i];if(t===null||typeof o!="function")s(t);else{const a=o({...t},n);$t&&o.id&&a===null&&Xe.log(`Event processor "${o.id}" dropped event`),Gy(a)?a.then(l=>v4(e,l,n,i+1).then(s)).then(null,r):v4(e,a,n,i+1).then(s).then(null,r)}})}let EU,AM,vU;function Hre(e){const t=Yt._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return vU&&n.length===AM||(AM=n.length,vU=n.reduce((i,s)=>{EU||(EU={});const r=EU[s];if(r)i[r[0]]=r[1];else{const o=e(s);for(let a=o.length-1;a>=0;a--){const l=o[a],c=l==null?void 0:l.filename,d=t[s];if(c&&d){i[c]=d,EU[s]=[c,d];break}}}return i},{})),vU}function Vre(e,t){const{fingerprint:n,span:i,breadcrumbs:s,sdkProcessingMetadata:r}=t;$re(e,t),i&&jre(e,i),Yre(e,n),Gre(e,s),Xre(e,r)}function MM(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:d,attachments:u,propagationContext:f,transactionName:h,span:m}=t;_U(e,"extra",n),_U(e,"tags",i),_U(e,"user",s),_U(e,"contexts",r),e.sdkProcessingMetadata=Zp(e.sdkProcessingMetadata,a,2),o&&(e.level=o),h&&(e.transactionName=h),m&&(e.span=m),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),c.length&&(e.fingerprint=[...e.fingerprint,...c]),d.length&&(e.eventProcessors=[...e.eventProcessors,...d]),u.length&&(e.attachments=[...e.attachments,...u]),e.propagationContext={...e.propagationContext,...f}}function _U(e,t,n){e[t]=Zp(e[t],n,1)}function $re(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,transactionName:a}=t,l=ur(n);Object.keys(l).length&&(e.extra={...l,...e.extra});const c=ur(i);Object.keys(c).length&&(e.tags={...c,...e.tags});const d=ur(s);Object.keys(d).length&&(e.user={...d,...e.user});const u=ur(r);Object.keys(u).length&&(e.contexts={...u,...e.contexts}),o&&(e.level=o),a&&e.type!=="transaction"&&(e.transaction=a)}function Gre(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function Xre(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function jre(e,t){e.contexts={trace:fre(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:vre(t),...e.sdkProcessingMetadata};const n=iH(t),i=G9(n).description;i&&!e.transaction&&e.type==="transaction"&&(e.transaction=i)}function Yre(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}function Wre(e,t,n,i,s,r){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=e,l={...t,event_id:t.event_id||n.event_id||Wr(),timestamp:t.timestamp||Kp()},c=n.integrations||e.integrations.map(U=>U.name);Kre(l,e),Qre(l,c),s&&s.emit("applyFrameMetadata",t),t.type===void 0&&Zre(l,e.stackParser);const d=eoe(i,n.captureContext);n.mechanism&&ku(l,n.mechanism);const u=s?s.getEventProcessors():[],f=Zse().getScopeData();if(r){const U=r.getScopeData();MM(f,U)}if(d){const U=d.getScopeData();MM(f,U)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),Vre(l,f);const m=[...u,...f.eventProcessors];return v4(m,l,n).then(U=>(U&&qre(U),typeof o=="number"&&o>0?Jre(U,o,a):U))}function Kre(e,t){var l,c;const{environment:n,release:i,dist:s,maxValueLength:r=250}=t;e.environment=e.environment||n||X9,!e.release&&i&&(e.release=i),!e.dist&&s&&(e.dist=s),e.message&&(e.message=Mh(e.message,r));const o=(c=(l=e.exception)==null?void 0:l.values)==null?void 0:c[0];o!=null&&o.value&&(o.value=Mh(o.value,r));const a=e.request;a!=null&&a.url&&(a.url=Mh(a.url,r))}function Zre(e,t){var i,s;const n=Hre(t);(s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.filename&&(l.debug_id=n[l.filename])})})}function qre(e){var i,s;const t={};if((s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.debug_id&&(l.abs_path?t[l.abs_path]=l.debug_id:l.filename&&(t[l.filename]=l.debug_id),delete l.debug_id)})}),Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([r,o])=>{n.push({type:"sourcemap",code_file:r,debug_id:o})})}function Qre(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function Jre(e,t,n){var s,r;if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(o=>({...o,...o.data&&{data:Ka(o.data,t,n)}}))},...e.user&&{user:Ka(e.user,t,n)},...e.contexts&&{contexts:Ka(e.contexts,t,n)},...e.extra&&{extra:Ka(e.extra,t,n)}};return(s=e.contexts)!=null&&s.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=Ka(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map(o=>({...o,...o.data&&{data:Ka(o.data,t,n)}}))),(r=e.contexts)!=null&&r.flags&&i.contexts&&(i.contexts.flags=Ka(e.contexts.flags,3,n)),i}function eoe(e,t){if(!t)return e;const n=e?e.clone():new ba;return n.update(t),n}function toe(e){if(e)return noe(e)?{captureContext:e}:soe(e)?{captureContext:e}:e}function noe(e){return e instanceof ba||typeof e=="function"}const ioe=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function soe(e){return Object.keys(e).some(t=>ioe.includes(t))}function Y9(e,t){return No().captureException(e,toe(t))}function kM(e,t){const n=typeof t=="string"?t:void 0,i=typeof t!="string"?{captureContext:t}:void 0;return No().captureMessage(e,n,i)}function lH(e,t){return No().captureEvent(e,t)}function RM(e){const t=qp(),n=No(),{userAgent:i}=Yt.navigator||{},s=zse({user:n.getUser()||t.getUser(),...i&&{userAgent:i},...e}),r=t.getSession();return(r==null?void 0:r.status)==="ok"&&og(r,{status:"exited"}),cH(),t.setSession(s),s}function cH(){const e=qp(),n=No().getSession()||e.getSession();n&&Hse(n),dH(),e.setSession()}function dH(){const e=qp(),t=qi(),n=e.getSession();n&&t&&t.captureSession(n)}function DM(e=!1){if(e){cH();return}dH()}const roe="7";function ooe(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function aoe(e){return`${ooe(e)}${e.projectId}/envelope/`}function loe(e,t){const n={sentry_version:roe};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function coe(e,t,n){return t||`${aoe(e)}?${loe(e,n)}`}const LM=[];function doe(e){const t={};return e.forEach(n=>{const{name:i}=n,s=t[i];s&&!s.isDefaultInstance&&n.isDefaultInstance||(t[i]=n)}),Object.values(t)}function uoe(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(s=>{s.isDefaultInstance=!0});let i;if(Array.isArray(n))i=[...t,...n];else if(typeof n=="function"){const s=n(t);i=Array.isArray(s)?s:[s]}else i=t;return doe(i)}function foe(e,t){const n={};return t.forEach(i=>{i&&uH(e,i,n)}),n}function PM(e,t){for(const n of t)n!=null&&n.afterAllSetup&&n.afterAllSetup(e)}function uH(e,t,n){if(n[t.name]){$t&&Xe.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,LM.indexOf(t.name)===-1&&typeof t.setupOnce=="function"&&(t.setupOnce(),LM.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),typeof t.preprocessEvent=="function"){const i=t.preprocessEvent.bind(t);e.on("preprocessEvent",(s,r)=>i(s,r,e))}if(typeof t.processEvent=="function"){const i=t.processEvent.bind(t),s=Object.assign((r,o)=>i(r,o,e),{id:t.name});e.addEventProcessor(s)}$t&&Xe.log(`Integration installed: ${t.name}`)}function hoe(e,t,n){const i=[{type:"client_report"},{timestamp:Kp(),discarded_events:e}];return jy(t?{dsn:t}:{},[i])}class po extends Error{constructor(t,n="warn"){super(t),this.message=t,this.logLevel=n}}function fH(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n!=null&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function goe(e){var l;const{trace_id:t,parent_span_id:n,span_id:i,status:s,origin:r,data:o,op:a}=((l=e.contexts)==null?void 0:l.trace)??{};return ur({data:o??{},description:e.transaction,op:a,parent_span_id:n,span_id:i??"",start_timestamp:e.start_timestamp??0,status:s,timestamp:e.timestamp,trace_id:t??"",origin:r,profile_id:o==null?void 0:o[eH],exclusive_time:o==null?void 0:o[tH],measurements:e.measurements,is_segment:!0})}function moe(e){const t={type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:{...e.data,...e.profile_id&&{[eH]:e.profile_id},...e.exclusive_time&&{[tH]:e.exclusive_time}}}},measurements:e.measurements};return ur(t)}const NM="Not capturing exception because it's already been captured.",OM="Discarded session because of missing or non-string release";class poe{constructor(t){if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=Sre(t.dsn):$t&&Xe.warn("No DSN provided, client will not send events."),this._dsn){const n=coe(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,i){const s=Wr();if(UM(t))return $t&&Xe.log(NM),s;const r={event_id:s,...n};return this._process(this.eventFromException(t,r).then(o=>this._captureEvent(o,r,i))),r.event_id}captureMessage(t,n,i,s){const r={event_id:Wr(),...i},o=O9(t)?t:String(t),a=F9(t)?this.eventFromMessage(o,n,r):this.eventFromException(t,r);return this._process(a.then(l=>this._captureEvent(l,r,s))),r.event_id}captureEvent(t,n,i){const s=Wr();if(n!=null&&n.originalException&&UM(n.originalException))return $t&&Xe.log(NM),s;const r={event_id:s,...n},o=t.sdkProcessingMetadata||{},a=o.capturedSpanScope,l=o.capturedSpanIsolationScope;return this._process(this._captureEvent(t,r,a||i,l)),r.event_id}captureSession(t){this.sendSession(t),og(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(t).then(i=>n.flush(t).then(s=>i&&s))):Ru(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some(({name:t})=>t.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const n=this._integrations[t.name];uH(this,t,this._integrations),n||PM(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let i=zre(t,this._dsn,this._options._metadata,this._options.tunnel);for(const r of n.attachments||[])i=Rre(i,Pre(r));const s=this.sendEnvelope(i);s&&s.then(r=>this.emit("afterSendEvent",t,r),null)}sendSession(t){const{release:n,environment:i=X9}=this._options;if("aggregates"in t){const r=t.attrs||{};if(!r.release&&!n){$t&&Xe.warn(OM);return}r.release=r.release||n,r.environment=r.environment||i,t.attrs=r}else{if(!t.release&&!n){$t&&Xe.warn(OM);return}t.release=t.release||n,t.environment=t.environment||i}this.emit("beforeSendSession",t);const s=Bre(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(t,n,i=1){if(this._options.sendClientReports){const s=`${t}:${n}`;$t&&Xe.log(`Recording outcome: "${s}"${i>1?` (${i} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(t,n){const i=this._hooks[t]=this._hooks[t]||[];return i.push(n),()=>{const s=i.indexOf(n);s>-1&&i.splice(s,1)}}emit(t,...n){const i=this._hooks[t];i&&i.forEach(s=>s(...n))}sendEnvelope(t){return this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport?this._transport.send(t).then(null,n=>($t&&Xe.error("Error while sending envelope:",n),n)):($t&&Xe.error("Transport disabled"),Ru({}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=foe(this,t),PM(this,t)}_updateSessionFromEvent(t,n){var l;let i=n.level==="fatal",s=!1;const r=(l=n.exception)==null?void 0:l.values;if(r){s=!0;for(const c of r){const d=c.mechanism;if((d==null?void 0:d.handled)===!1){i=!0;break}}}const o=t.status==="ok";(o&&t.errors===0||o&&i)&&(og(t,{...i&&{status:"crashed"},errors:t.errors||Number(s||i)}),this.captureSession(t))}_isClientDoneProcessing(t){return new od(n=>{let i=0;const s=1,r=setInterval(()=>{this._numProcessing==0?(clearInterval(r),n(!0)):(i+=s,t&&i>=t&&(clearInterval(r),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,i,s){const r=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",t,n),t.type||s.setLastEventId(t.event_id||n.event_id),Wre(r,t,n,i,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:qse(i),...a.contexts};const l=Ere(this,i);return a.sdkProcessingMetadata={dynamicSamplingContext:l,...a.sdkProcessingMetadata},a})}_captureEvent(t,n={},i=No(),s=qp()){return $t&&_4(t)&&Xe.log(`Captured error event \`${fH(t)[0]||"<unknown>"}\``),this._processEvent(t,n,i,s).then(r=>r.event_id,r=>{$t&&(r instanceof po&&r.logLevel==="log"?Xe.log(r.message):Xe.warn(r))})}_processEvent(t,n,i,s){const r=this.getOptions(),{sampleRate:o}=r,a=hH(t),l=_4(t),c=t.type||"error",d=`before send for type \`${c}\``,u=typeof o>"u"?void 0:ore(o);if(l&&typeof u=="number"&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error"),$6(new po(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const f=c==="replay_event"?"replay":c;return this._prepareEvent(t,n,i,s).then(h=>{if(h===null)throw this.recordDroppedEvent("event_processor",f),new po("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return h;const p=boe(this,r,h,n);return Uoe(p,d)}).then(h=>{var U;if(h===null){if(this.recordDroppedEvent("before_send",f),a){const y=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",y)}throw new po(`${d} returned \`null\`, will not send event.`,"log")}const m=i.getSession()||s.getSession();if(l&&m&&this._updateSessionFromEvent(m,h),a){const b=((U=h.sdkProcessingMetadata)==null?void 0:U.spanCountBeforeProcessing)||0,y=h.spans?h.spans.length:0,E=b-y;E>0&&this.recordDroppedEvent("before_send","span",E)}const p=h.transaction_info;if(a&&p&&h.transaction!==t.transaction){const b="custom";h.transaction_info={...p,source:b}}return this.sendEvent(h,n),h}).then(null,h=>{throw h instanceof po?h:(this.captureException(h,{data:{__sentry__:!0},originalException:h}),new po(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${h}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map(([n,i])=>{const[s,r]=n.split(":");return{reason:s,category:r,quantity:i}})}_flushOutcomes(){$t&&Xe.log("Flushing outcomes...");const t=this._clearOutcomes();if(t.length===0){$t&&Xe.log("No outcomes to send");return}if(!this._dsn){$t&&Xe.log("No dsn provided, will not send outcomes");return}$t&&Xe.log("Sending outcomes:",t);const n=hoe(t,this._options.tunnel&&j9(this._dsn));this.sendEnvelope(n)}}function Uoe(e,t){const n=`${t} must return \`null\` or a valid event.`;if(Gy(e))return e.then(i=>{if(!rg(i)&&i!==null)throw new po(n);return i},i=>{throw new po(`${t} rejected with ${i}`)});if(!rg(e)&&e!==null)throw new po(n);return e}function boe(e,t,n,i){const{beforeSend:s,beforeSendTransaction:r,beforeSendSpan:o}=t;let a=n;if(_4(a)&&s)return s(a,i);if(hH(a)){if(o){const l=o(goe(a));if(l?a=Zp(n,moe(l)):SM(),a.spans){const c=[];for(const d of a.spans){const u=o(d);u?c.push(u):(SM(),c.push(d))}a.spans=c}}if(r){if(a.spans){const l=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return r(a,i)}}return a}function _4(e){return e.type===void 0}function hH(e){return e.type==="transaction"}function yoe(e,t){t.debug===!0&&($t?Xe.enable():Xg(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),No().update(t.initialScope);const i=new e(t);return Eoe(i),i.init(),i}function Eoe(e){No().setClient(e)}function voe(e){const t=[];function n(){return e===void 0||t.length<e}function i(o){return t.splice(t.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return $6(new po("Not adding Promise because buffer limit was reached."));const a=o();return t.indexOf(a)===-1&&t.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function r(o){return new od((a,l)=>{let c=t.length;if(!c)return a(!0);const d=setTimeout(()=>{o&&o>0&&a(!1)},o);t.forEach(u=>{Ru(u).then(()=>{--c||(clearTimeout(d),a(!0))},l)})})}return{$:t,add:s,drain:r}}const _oe=60*1e3;function woe(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${e}`);return isNaN(i)?_oe:i-t}function Toe(e,t){return e[t]||e.all||0}function Ioe(e,t,n=Date.now()){return Toe(e,t)>n}function Soe(e,{statusCode:t,headers:n},i=Date.now()){const s={...e},r=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(r)for(const a of r.trim().split(",")){const[l,c,,,d]=a.split(":",5),u=parseInt(l,10),f=(isNaN(u)?60:u)*1e3;if(!c)s.all=i+f;else for(const h of c.split(";"))h==="metric_bucket"?(!d||d.split(";").includes("custom"))&&(s[h]=i+f):s[h]=i+f}else o?s.all=i+woe(o,i):t===429&&(s.all=i+60*1e3);return s}const Coe=64;function xoe(e,t,n=voe(e.bufferSize||Coe)){let i={};const s=o=>n.drain(o);function r(o){const a=[];if(CM(o,(u,f)=>{const h=xM(f);Ioe(i,h)?e.recordDroppedEvent("ratelimit_backoff",h):a.push(u)}),a.length===0)return Ru({});const l=jy(o[0],a),c=u=>{CM(l,(f,h)=>{e.recordDroppedEvent(u,xM(h))})},d=()=>t({body:Dre(l)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&$t&&Xe.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),i=Soe(i,u),u),u=>{throw c("network_error"),u});return n.add(d).then(u=>u,u=>{if(u instanceof po)return $t&&Xe.error("Skipped sending event because buffer is full."),c("queue_overflow"),Ru({});throw u})}return{send:r,flush:s}}function Aoe(e){var t;((t=e.user)==null?void 0:t.ip_address)===void 0&&(e.user={...e.user,ip_address:"{{auto}}"})}function Moe(e){var t;"aggregates"in e?((t=e.attrs)==null?void 0:t.ip_address)===void 0&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):e.ipAddress===void 0&&(e.ipAddress="{{auto}}")}function koe(e,t,n=[t],i="npm"){const s=e._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${t}`,packages:n.map(r=>({name:`${i}:@sentry/${r}`,version:Uu})),version:Uu}),e._metadata=s}const Roe=100;function Du(e,t){const n=qi(),i=qp();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:r=Roe}=n.getOptions();if(r<=0)return;const a={timestamp:Kp(),...e},l=s?Xg(()=>s(a,t)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,t),i.addBreadcrumb(l,r))}let FM;const Doe="FunctionToString",BM=new WeakMap,Loe=()=>({name:Doe,setupOnce(){FM=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=H9(this),n=BM.has(qi())&&t!==void 0?t:this;return FM.apply(n,e)}}catch{}},setup(e){BM.set(e,!0)}}),Poe=Loe,Noe=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Ooe="InboundFilters",Foe=(e={})=>({name:Ooe,processEvent(t,n,i){const s=i.getOptions(),r=zoe(e,s);return Hoe(t,r)?null:t}}),Boe=Foe;function zoe(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Noe],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function Hoe(e,t){return t.ignoreInternal&&joe(e)?($t&&Xe.warn(`Event dropped due to being internal Sentry Error.
Event: ${dc(e)}`),!0):Voe(e,t.ignoreErrors)?($t&&Xe.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${dc(e)}`),!0):Woe(e)?($t&&Xe.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${dc(e)}`),!0):$oe(e,t.ignoreTransactions)?($t&&Xe.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${dc(e)}`),!0):Goe(e,t.denyUrls)?($t&&Xe.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${dc(e)}.
Url: ${G6(e)}`),!0):Xoe(e,t.allowUrls)?!1:($t&&Xe.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${dc(e)}.
Url: ${G6(e)}`),!0)}function Voe(e,t){return e.type||!t||!t.length?!1:fH(e).some(n=>Xy(n,t))}function $oe(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?Xy(n,t):!1}function Goe(e,t){if(!(t!=null&&t.length))return!1;const n=G6(e);return n?Xy(n,t):!1}function Xoe(e,t){if(!(t!=null&&t.length))return!0;const n=G6(e);return n?Xy(n,t):!0}function joe(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function Yoe(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function G6(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?Yoe(t):null}catch{return $t&&Xe.error(`Cannot extract url for event ${dc(e)}`),null}}function Woe(e){var t,n;return e.type||!((n=(t=e.exception)==null?void 0:t.values)!=null&&n.length)?!1:!e.message&&!e.exception.values.some(i=>i.stacktrace||i.type&&i.type!=="Error"||i.value)}function Koe(e,t,n=250,i,s,r,o){var l;if(!((l=r.exception)!=null&&l.values)||!o||!Au(o.originalException,Error))return;const a=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;a&&(r.exception.values=Zoe(w4(e,t,s,o.originalException,i,r.exception.values,a,0),n))}function w4(e,t,n,i,s,r,o,a){if(r.length>=n+1)return r;let l=[...r];if(Au(i[s],Error)){zM(o,a);const c=e(t,i[s]),d=l.length;HM(c,s,d,a),l=w4(e,t,n,i[s],s,[c,...l],c,d)}return Array.isArray(i.errors)&&i.errors.forEach((c,d)=>{if(Au(c,Error)){zM(o,a);const u=e(t,c),f=l.length;HM(u,`errors[${d}]`,f,a),l=w4(e,t,n,c,s,[u,...l],u,f)}}),l}function zM(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function HM(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}function Zoe(e,t){return e.map(n=>(n.value&&(n.value=Mh(n.value,t)),n))}function gH(e){const t="console";nf(t,e),sf(t,qoe)}function qoe(){"console"in Yt&&z6.forEach(function(e){e in Yt.console&&dr(Yt.console,e,function(t){return H6[e]=t,function(...n){Io("console",{args:n,level:e});const s=H6[e];s==null||s.apply(Yt.console,n)}})})}function mH(e){return e==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const Qoe="CaptureConsole",Joe=(e={})=>{const t=e.levels||z6,n=e.handled??!0;return{name:Qoe,setup(i){"console"in Yt&&gH(({args:s,level:r})=>{qi()!==i||!t.includes(r)||tae(s,r,n)})}}},eae=Joe;function tae(e,t,n){const i={level:mH(t),extra:{arguments:e}};$9(s=>{if(s.addEventProcessor(a=>(a.logger="console",ku(a,{handled:n,type:"console"}),a)),t==="assert"){if(!e[0]){const a=`Assertion failed: ${V6(e.slice(1)," ")||"console.assert"}`;s.setExtra("arguments",e.slice(1)),kM(a,i)}return}const r=e.find(a=>a instanceof Error);if(r){Y9(r,i);return}const o=V6(e," ");kM(o,i)})}const nae="Dedupe",iae=()=>{let e;return{name:nae,processEvent(t){if(t.type)return t;try{if(rae(t,e))return $t&&Xe.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},sae=iae;function rae(e,t){return t?!!(oae(e,t)||aae(e,t)):!1}function oae(e,t){const n=e.message,i=t.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!UH(e,t)||!pH(e,t))}function aae(e,t){const n=VM(t),i=VM(e);return!(!n||!i||n.type!==i.type||n.value!==i.value||!UH(e,t)||!pH(e,t))}function pH(e,t){let n=fM(e),i=fM(t);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let s=0;s<i.length;s++){const r=i[s],o=n[s];if(r.filename!==o.filename||r.lineno!==o.lineno||r.colno!==o.colno||r.function!==o.function)return!1}return!0}function UH(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function VM(e){var t;return((t=e.exception)==null?void 0:t.values)&&e.exception.values[0]}function x3(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function bH(e){if(e!==void 0)return e>=400&&e<500?"warning":e>=500?"error":void 0}const X6=Yt;function lae(){return"history"in X6}function yH(){if(!("fetch"in X6))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function T4(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function cae(){var n;if(typeof EdgeRuntime=="string")return!0;if(!yH())return!1;if(T4(X6.fetch))return!0;let e=!1;const t=X6.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),(n=i.contentWindow)!=null&&n.fetch&&(e=T4(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){tf&&Xe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}function dae(e,t){const n="fetch";nf(n,e),sf(n,()=>uae(void 0,t))}function uae(e,t=!1){t&&!cae()||dr(Yt,"fetch",function(n){return function(...i){const s=new Error,{method:r,url:o}=fae(i),a={args:i,fetchData:{method:r,url:o},startTimestamp:yl()*1e3,virtualError:s};return Io("fetch",{...a}),n.apply(Yt,i).then(async l=>(Io("fetch",{...a,endTimestamp:yl()*1e3,response:l}),l),l=>{throw Io("fetch",{...a,endTimestamp:yl()*1e3,error:l}),N9(l)&&l.stack===void 0&&(l.stack=s.stack,Mu(l,"framesToPop",1)),l})}})}function I4(e,t){return!!e&&typeof e=="object"&&!!e[t]}function $M(e){return typeof e=="string"?e:e?I4(e,"url")?e.url:e.toString?e.toString():"":""}function fae(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,i]=e;return{url:$M(n),method:I4(i,"method")?String(i.method).toUpperCase():"GET"}}const t=e[0];return{url:$M(t),method:I4(t,"method")?String(t.method).toUpperCase():"GET"}}function hae(){return"npm"}const $n=Yt;let S4=0;function EH(){return S4>0}function gae(){S4++,setTimeout(()=>{S4--})}function lg(e,t={}){function n(s){return typeof s=="function"}if(!n(e))return e;try{const s=e.__sentry_wrapped__;if(s)return typeof s=="function"?s:e;if(H9(e))return e}catch{return e}const i=function(...s){try{const r=s.map(o=>lg(o,t));return e.apply(this,r)}catch(r){throw gae(),$9(o=>{o.addEventProcessor(a=>(t.mechanism&&(U4(a,void 0),ku(a,t.mechanism)),a.extra={...a.extra,arguments:s},a)),Y9(r)}),r}};try{for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s])}catch{}Kz(i,e),Mu(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return e.name}})}catch{}return i}function W9(e,t){const n=K9(e,t),i={type:yae(t),value:Eae(t)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function mae(e,t,n,i){const s=qi(),r=s==null?void 0:s.getOptions().normalizeDepth,o=Iae(t),a={__serialized__:oH(t,r)};if(o)return{exception:{values:[W9(e,o)]},extra:a};const l={exception:{values:[{type:$y(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:wae(t,{isUnhandledRejection:i})}]},extra:a};if(n){const c=K9(e,n);c.length&&(l.exception.values[0].stacktrace={frames:c})}return l}function A3(e,t){return{exception:{values:[W9(e,t)]}}}function K9(e,t){const n=t.stacktrace||t.stack||"",i=Uae(t),s=bae(t);try{return e(n,i,s)}catch{}return[]}const pae=/Minified React error #\d+;/i;function Uae(e){return e&&pae.test(e.message)?1:0}function bae(e){return typeof e.framesToPop=="number"?e.framesToPop:0}function vH(e){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?e instanceof WebAssembly.Exception:!1}function yae(e){const t=e==null?void 0:e.name;return!t&&vH(e)?e.message&&Array.isArray(e.message)&&e.message.length==2?e.message[0]:"WebAssembly.Exception":t}function Eae(e){const t=e==null?void 0:e.message;return vH(e)?Array.isArray(e.message)&&e.message.length==2?e.message[1]:"wasm exception":t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function vae(e,t,n,i){const s=(n==null?void 0:n.syntheticException)||void 0,r=Z9(e,t,s,i);return ku(r),r.level="error",n!=null&&n.event_id&&(r.event_id=n.event_id),Ru(r)}function _ae(e,t,n="info",i,s){const r=(i==null?void 0:i.syntheticException)||void 0,o=C4(e,t,r,s);return o.level=n,i!=null&&i.event_id&&(o.event_id=i.event_id),Ru(o)}function Z9(e,t,n,i,s){let r;if(jz(t)&&t.error)return A3(e,t.error);if(gM(t)||xse(t)){const o=t;if("stack"in t)r=A3(e,t);else{const a=o.name||(gM(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;r=C4(e,l,n,i),U4(r,l)}return"code"in o&&(r.tags={...r.tags,"DOMException.code":`${o.code}`}),r}return N9(t)?A3(e,t):rg(t)||$y(t)?(r=mae(e,t,n,s),ku(r,{synthetic:!0}),r):(r=C4(e,t,n,i),U4(r,`${t}`),ku(r,{synthetic:!0}),r)}function C4(e,t,n,i){const s={};if(i&&n){const r=K9(e,n);r.length&&(s.exception={values:[{value:t,stacktrace:{frames:r}}]}),ku(s,{synthetic:!0})}if(O9(t)){const{__sentry_template_string__:r,__sentry_template_values__:o}=t;return s.logentry={message:r,params:o},s}return s.message=t,s}function wae(e,{isUnhandledRejection:t}){const n=Nse(e),i=t?"promise rejection":"exception";return jz(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:$y(e)?`Event \`${Tae(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function Tae(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function Iae(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}class Sae extends poe{constructor(t){const n={parentSpanIsAlwaysRootSpan:!0,...t},i=$n.SENTRY_SDK_SOURCE||hae();koe(n,"browser",["browser"],i),super(n),n.sendClientReports&&$n.document&&$n.document.addEventListener("visibilitychange",()=>{$n.document.visibilityState==="hidden"&&this._flushOutcomes()}),this._options.sendDefaultPii&&(this.on("postprocessEvent",Aoe),this.on("beforeSendSession",Moe))}eventFromException(t,n){return vae(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",i){return _ae(this._options.stackParser,t,n,i,this._options.attachStacktrace)}_prepareEvent(t,n,i,s){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,i,s)}}const Cae=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Bs=Yt,xae=1e3;let GM,x4,A4;function Aae(e){const t="dom";nf(t,e),sf(t,Mae)}function Mae(){if(!Bs.document)return;const e=Io.bind(null,"dom"),t=XM(e,!0);Bs.document.addEventListener("click",t,!1),Bs.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{var r,o;const s=(r=Bs[n])==null?void 0:r.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&(dr(s,"addEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=u[l]=u[l]||{refCount:0};if(!f.handler){const h=XM(e);f.handler=h,a.call(this,l,h,d)}f.refCount++}catch{}return a.call(this,l,c,d)}}),dr(s,"removeEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__||{},f=u[l];f&&(f.refCount--,f.refCount<=0&&(a.call(this,l,f.handler,d),f.handler=void 0,delete u[l]),Object.keys(u).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,l,c,d)}}))})}function kae(e){if(e.type!==x4)return!1;try{if(!e.target||e.target._sentryId!==A4)return!1}catch{}return!0}function Rae(e,t){return e!=="keypress"?!1:t!=null&&t.tagName?!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable):!0}function XM(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const i=Dae(n);if(Rae(n.type,i))return;Mu(n,"_sentryCaptured",!0),i&&!i._sentryId&&Mu(i,"_sentryId",Wr());const s=n.type==="keypress"?"input":n.type;kae(n)||(e({event:n,name:s,global:t}),x4=n.type,A4=i?i._sentryId:void 0),clearTimeout(GM),GM=Bs.setTimeout(()=>{A4=void 0,x4=void 0},xae)}}function Dae(e){try{return e.target}catch{return null}}let wU;function _H(e){const t="history";nf(t,e),sf(t,Lae)}function Lae(){if(Bs.addEventListener("popstate",()=>{const t=Bs.location.href,n=wU;if(wU=t,n===t)return;Io("history",{from:n,to:t})}),!lae())return;function e(t){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const s=wU,r=String(i);if(wU=r,s===r)return;Io("history",{from:s,to:r})}return t.apply(this,n)}}dr(Bs.history,"pushState",e),dr(Bs.history,"replaceState",e)}const _b={};function Pae(e){const t=_b[e];if(t)return t;let n=Bs[e];if(T4(n))return _b[e]=n.bind(Bs);const i=Bs.document;if(i&&typeof i.createElement=="function")try{const s=i.createElement("iframe");s.hidden=!0,i.head.appendChild(s);const r=s.contentWindow;r!=null&&r[e]&&(n=r[e]),i.head.removeChild(s)}catch(s){Cae&&Xe.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,s)}return n&&(_b[e]=n.bind(Bs))}function jM(e){_b[e]=void 0}const h1="__sentry_xhr_v3__";function Nae(e){const t="xhr";nf(t,e),sf(t,Oae)}function Oae(){if(!Bs.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(t,n,i){const s=new Error,r=yl()*1e3,o=bl(i[0])?i[0].toUpperCase():void 0,a=Fae(i[1]);if(!o||!a)return t.apply(n,i);n[h1]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const c=n[h1];if(c&&n.readyState===4){try{c.status_code=n.status}catch{}const d={endTimestamp:yl()*1e3,startTimestamp:r,xhr:n,virtualError:s};Io("xhr",d)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(c,d,u){return l(),c.apply(d,u)}}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(c,d,u){const[f,h]=u,m=d[h1];return m&&bl(f)&&bl(h)&&(m.request_headers[f.toLowerCase()]=h),c.apply(d,u)}}),t.apply(n,i)}}),e.send=new Proxy(e.send,{apply(t,n,i){const s=n[h1];if(!s)return t.apply(n,i);i[0]!==void 0&&(s.body=i[0]);const r={startTimestamp:yl()*1e3,xhr:n};return Io("xhr",r),t.apply(n,i)}})}function Fae(e){if(bl(e))return e;try{return e.toString()}catch{}}function Bae(e,t=Pae("fetch")){let n=0,i=0;function s(r){const o=r.body.length;n+=o,i++;const a={body:r.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};if(!t)return jM("fetch"),$6("No fetch implementation available");try{return t(e.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return jM("fetch"),n-=o,i--,$6(l)}}return xoe(e,s)}const zae=30,Hae=50;function M4(e,t,n,i){const s={filename:e,function:t==="<anonymous>"?xu:t,in_app:!0};return n!==void 0&&(s.lineno=n),i!==void 0&&(s.colno=i),s}const Vae=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,$ae=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Gae=/\((\S*)(?::(\d+))(?::(\d+))\)/,Xae=e=>{const t=Vae.exec(e);if(t){const[,i,s,r]=t;return M4(i,xu,+s,+r)}const n=$ae.exec(e);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=Gae.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,r]=wH(n[1]||xu,n[2]);return M4(r,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},jae=[zae,Xae],Yae=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Wae=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Kae=e=>{const t=Yae.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const r=Wae.exec(t[3]);r&&(t[1]=t[1]||"eval",t[3]=r[1],t[4]=r[2],t[5]="")}let i=t[3],s=t[1]||xu;return[s,i]=wH(s,i),M4(i,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},Zae=[Hae,Kae],qae=[jae,Zae],Qae=Gz(...qae),wH=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,i=e.indexOf("safari-web-extension")!==-1;return n||i?[e.indexOf("@")!==-1?e.split("@")[0]:xu,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},cg=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,TU=1024,Jae="Breadcrumbs",ele=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:Jae,setup(n){t.console&&gH(sle(n)),t.dom&&Aae(ile(n,t.dom)),t.xhr&&Nae(rle(n)),t.fetch&&dae(ole(n)),t.history&&_H(ale(n)),t.sentry&&n.on("beforeSendEvent",nle(n))}}},tle=ele;function nle(e){return function(n){qi()===e&&Du({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:dc(n)},{event:n})}}function ile(e,t){return function(i){if(qi()!==e)return;let s,r,o=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>TU&&(cg&&Xe.warn(`\`dom.maxStringLength\` cannot exceed ${TU}, but a value of ${a} was configured. Sentry will use ${TU} instead.`),a=TU),typeof o=="string"&&(o=[o]);try{const c=i.event,d=lle(c)?c.target:c;s=Wz(d,{keyAttrs:o,maxStringLength:a}),r=Lse(d)}catch{s="<unknown>"}if(s.length===0)return;const l={category:`ui.${i.name}`,message:s};r&&(l.data={"ui.component_name":r}),Du(l,{event:i.event,name:i.name,global:i.global})}}function sle(e){return function(n){if(qi()!==e)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:mH(n.level),message:V6(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${V6(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;Du(i,{input:n.args,level:n.level})}}function rle(e){return function(n){if(qi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n,r=n.xhr[h1];if(!i||!s||!r)return;const{method:o,url:a,status_code:l,body:c}=r,d={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:s},f=bH(l);Du({category:"xhr",data:d,type:"http",level:f},u)}}function ole(e){return function(n){if(qi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n;if(!s||n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST")return;const r={method:n.fetchData.method,url:n.fetchData.url};if(n.error){const o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:s};Du({category:"fetch",data:r,level:"error",type:"http"},o)}else{const o=n.response;r.request_body_size=n.fetchData.request_body_size,r.response_body_size=n.fetchData.response_body_size,r.status_code=o==null?void 0:o.status;const a={input:n.args,response:o,startTimestamp:i,endTimestamp:s},l=bH(r.status_code);Du({category:"fetch",data:r,type:"http",level:l},a)}}}function ale(e){return function(n){if(qi()!==e)return;let i=n.from,s=n.to;const r=x3($n.location.href);let o=i?x3(i):void 0;const a=x3(s);o!=null&&o.path||(o=r),r.protocol===a.protocol&&r.host===a.host&&(s=a.relative),r.protocol===o.protocol&&r.host===o.host&&(i=o.relative),Du({category:"navigation",data:{from:i,to:s}})}}function lle(e){return!!e&&!!e.target}const cle=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],dle="BrowserApiErrors",ule=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:dle,setupOnce(){t.setTimeout&&dr($n,"setTimeout",YM),t.setInterval&&dr($n,"setInterval",YM),t.requestAnimationFrame&&dr($n,"requestAnimationFrame",hle),t.XMLHttpRequest&&"XMLHttpRequest"in $n&&dr(XMLHttpRequest.prototype,"send",gle);const n=t.eventTarget;n&&(Array.isArray(n)?n:cle).forEach(mle)}}},fle=ule;function YM(e){return function(...t){const n=t[0];return t[0]=lg(n,{mechanism:{data:{function:rd(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function hle(e){return function(t){return e.apply(this,[lg(t,{mechanism:{data:{function:"requestAnimationFrame",handler:rd(e)},handled:!1,type:"instrument"}})])}}function gle(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&dr(n,s,function(r){const o={mechanism:{data:{function:s,handler:rd(r)},handled:!1,type:"instrument"}},a=H9(r);return a&&(o.mechanism.data.handler=rd(a)),lg(r,o)})}),e.apply(this,t)}}function mle(e){var i,s;const n=(i=$n[e])==null?void 0:i.prototype;(s=n==null?void 0:n.hasOwnProperty)!=null&&s.call(n,"addEventListener")&&(dr(n,"addEventListener",function(r){return function(o,a,l){try{ple(a)&&(a.handleEvent=lg(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:rd(a),target:e},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[o,lg(a,{mechanism:{data:{function:"addEventListener",handler:rd(a),target:e},handled:!1,type:"instrument"}}),l])}}),dr(n,"removeEventListener",function(r){return function(o,a,l){try{const c=a.__sentry_wrapped__;c&&r.call(this,o,c,l)}catch{}return r.call(this,o,a,l)}}))}function ple(e){return typeof e.handleEvent=="function"}const Ule=()=>({name:"BrowserSession",setupOnce(){if(typeof $n.document>"u"){cg&&Xe.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}RM({ignoreDuration:!0}),DM(),_H(({from:e,to:t})=>{e!==void 0&&e!==t&&(RM({ignoreDuration:!0}),DM())})}}),ble="GlobalHandlers",yle=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:ble,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(vle(n),WM("onerror")),t.onunhandledrejection&&(_le(n),WM("onunhandledrejection"))}}},Ele=yle;function vle(e){Tse(t=>{const{stackParser:n,attachStacktrace:i}=TH();if(qi()!==e||EH())return;const{msg:s,url:r,line:o,column:a,error:l}=t,c=Ile(Z9(n,l||s,void 0,i,!1),r,o,a);c.level="error",lH(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function _le(e){Sse(t=>{const{stackParser:n,attachStacktrace:i}=TH();if(qi()!==e||EH())return;const s=wle(t),r=F9(s)?Tle(s):Z9(n,s,void 0,i,!0);r.level="error",lH(r,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function wle(e){if(F9(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Tle(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Ile(e,t,n,i){const s=e.exception=e.exception||{},r=s.values=s.values||[],o=r[0]=r[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=i,d=n,u=bl(t)&&t.length>0?t:z9();return l.length===0&&l.push({colno:c,filename:u,function:xu,in_app:!0,lineno:d}),e}function WM(e){cg&&Xe.log(`Global Handler attached: ${e}`)}function TH(){const e=qi();return(e==null?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const Sle=()=>({name:"HttpContext",preprocessEvent(e){var o,a;if(!$n.navigator&&!$n.location&&!$n.document)return;const t=((o=e.request)==null?void 0:o.url)||z9(),{referrer:n}=$n.document||{},{userAgent:i}=$n.navigator||{},s={...(a=e.request)==null?void 0:a.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},r={...e.request,...t&&{url:t},headers:s};e.request=r}}),Cle="cause",xle=5,Ale="LinkedErrors",Mle=(e={})=>{const t=e.limit||xle,n=e.key||Cle;return{name:Ale,preprocessEvent(i,s,r){const o=r.getOptions();Koe(W9,o.stackParser,o.maxValueLength,n,t,i,s)}}},kle=Mle;function Rle(e){return[Boe(),Poe(),fle(),tle(),Ele(),kle(),sae(),Sle(),Ule()]}function Dle(e={}){var n;return{...{defaultIntegrations:Rle(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(n=$n.SENTRY_RELEASE)==null?void 0:n.id,sendClientReports:!0},...Lle(e)}}function Lle(e){const t={};for(const n of Object.getOwnPropertyNames(e)){const i=n;e[i]!==void 0&&(t[i]=e[i])}return t}function Ple(){var l;const e=typeof $n.window<"u"&&$n;if(!e)return!1;const t=e.chrome?"chrome":"browser",n=e[t],i=(l=n==null?void 0:n.runtime)==null?void 0:l.id,s=z9()||"",r=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!i&&$n===$n.top&&r.some(c=>s.startsWith(`${c}//`)),a=typeof e.nw<"u";return!!i&&!o&&!a}function Nle(e={}){const t=Dle(e);if(!t.skipBrowserExtensionCheck&&Ple()){cg&&Xg(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}cg&&!yH()&&Xe.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");const n={...t,stackParser:_se(t.stackParser||Qae),integrations:uoe(t),transport:t.transport||Bae};return yoe(Sae,n)}const Ole=100;function Fle(e){const n=No().getScopeData().contexts.flags,i=n?n.values:[];return i.length&&(e.contexts===void 0&&(e.contexts={}),e.contexts.flags={values:[...i]}),e}function Ble(e,t,n=Ole){const i=No().getScopeData().contexts;i.flags||(i.flags={values:[]});const s=i.flags.values;zle(s,e,t,n)}function zle(e,t,n,i){if(typeof n!="boolean")return;if(e.length>i){cg&&Xe.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${i}`);return}const s=e.findIndex(r=>r.flag===t);s!==-1&&e.splice(s,1),e.length===i&&e.shift(),e.push({flag:t,result:n})}const Hle=()=>({name:"FeatureFlags",processEvent(e,t,n){return Fle(e)},addFeatureFlag(e,t){Ble(e,t)}});function Vle(){const e=Error.prepareStackTrace;try{let t=[];return Error.prepareStackTrace=(n,i)=>{const s=i.slice(1);return t=s,s},new Error().stack,t}finally{Error.prepareStackTrace=e}}var $le={};const IH={"excalidraw.com":"production","staging.excalidraw.com":"staging","vercel.app":"staging"},Gle=$le.VITE_APP_DISABLE_SENTRY==="true",M3=!Gle&&Object.keys(IH).find(e=>window.location.hostname.indexOf(e)>=0);Nle({dsn:M3?"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260":void 0,environment:M3?IH[M3]:void 0,release:"3a5ef4020d7515f34c96d179b631911bb8ef8a9f",ignoreErrors:["undefined is not an object (evaluating 'window.__pad.performLoop')","InvalidStateError: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.",/(Failed to fetch|(fetch|loading) dynamically imported module)/i,/QuotaExceededError: (The quota has been exceeded|.*setItem.*Storage)/i,"Internal error opening backing store for indexedDB.open"],integrations:[eae({levels:["error"]}),Hle()],beforeSend(e){var t;return(t=e.request)!=null&&t.url&&(e.request.url=e.request.url.replace(/#.*$/,"")),e.exception||(e.exception={values:[{type:"ConsoleError",value:e.message??"Unknown error",stacktrace:{frames:Vle().slice(1).filter(n=>{var i;return n.getFileName()&&!((i=n.getFileName())!=null&&i.includes("@sentry_browser.js"))}).map(n=>{var i;return{filename:n.getFileName()??void 0,function:n.getFunctionName()??void 0,in_app:!(((i=n.getFileName())==null?void 0:i.includes("node_modules"))??!1),lineno:n.getLineNumber()??void 0,colno:n.getColumnNumber()??void 0}})},mechanism:{type:"instrument",handled:!0,data:{function:"console.error",handler:"Sentry.beforeSend"}}}]}),e}});var JN;const KM=(JN=qi())==null?void 0:JN.getIntegrationByName("FeatureFlags");KM&&KM.addFeatureFlag("COMPLEX_BINDINGS",Ii("COMPLEX_BINDINGS"));function SH(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=SH(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function ae(){for(var e=0,t,n,i="";e<arguments.length;)(t=arguments[e++])&&(n=SH(t))&&(i&&(i+=" "),i+=n);return i}var CH="Expected a function",ZM=NaN,Xle="[object Symbol]",jle=/^\s+|\s+$/g,Yle=/^[-+]0x[0-9a-f]+$/i,Wle=/^0b[01]+$/i,Kle=/^0o[0-7]+$/i,Zle=parseInt,qle=typeof ll=="object"&&ll&&ll.Object===Object&&ll,Qle=typeof self=="object"&&self&&self.Object===Object&&self,Jle=qle||Qle||Function("return this")(),ece=Object.prototype,tce=ece.toString,nce=Math.max,ice=Math.min,k3=function(){return Jle.Date.now()};function sce(e,t,n){var i,s,r,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(CH);t=qM(t)||0,j6(n)&&(d=!!n.leading,u="maxWait"in n,r=u?nce(qM(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(k){var w=i,T=s;return i=s=void 0,c=k,o=e.apply(T,w),o}function m(k){return c=k,a=setTimeout(b,t),d?h(k):o}function p(k){var w=k-l,T=k-c,A=t-w;return u?ice(A,r-T):A}function U(k){var w=k-l,T=k-c;return l===void 0||w>=t||w<0||u&&T>=r}function b(){var k=k3();if(U(k))return y(k);a=setTimeout(b,p(k))}function y(k){return a=void 0,f&&i?h(k):(i=s=void 0,o)}function E(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function _(){return a===void 0?o:y(k3())}function I(){var k=k3(),w=U(k);if(i=arguments,s=this,l=k,w){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=E,I.flush=_,I}function rce(e,t,n){var i=!0,s=!0;if(typeof e!="function")throw new TypeError(CH);return j6(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),sce(e,t,{leading:i,maxWait:t,trailing:s})}function j6(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function oce(e){return!!e&&typeof e=="object"}function ace(e){return typeof e=="symbol"||oce(e)&&tce.call(e)==Xle}function qM(e){if(typeof e=="number")return e;if(ace(e))return ZM;if(j6(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=j6(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(jle,"");var n=Wle.test(e);return n||Kle.test(e)?Zle(e.slice(2),n?2:8):Yle.test(e)?ZM:+e}var lce=rce;const na=Hl(lce);function k4(e,t,n){if(e&&e.length){const[i,s]=t,r=Math.PI/180*n,o=Math.cos(r),a=Math.sin(r);for(const l of e){const[c,d]=l;l[0]=(c-i)*o-(d-s)*a+i,l[1]=(c-i)*a+(d-s)*o+s}}}function cce(e,t,n){const i=[];e.forEach(s=>i.push(...s)),k4(i,t,n)}function dce(e,t){return e[0]===t[0]&&e[1]===t[1]}function uce(e,t,n,i=1){const s=n,r=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,a=[0,0];if(s)for(const c of o)k4(c,a,s);const l=fce(o,r,i);if(s){for(const c of o)k4(c,a,-s);cce(l,a,-s)}return l}function fce(e,t,n){const i=[];for(const c of e){const d=[...c];dce(d[0],d[d.length-1])||d.push([d[0][0],d[0][1]]),d.length>2&&i.push(d)}const s=[];t=Math.max(t,.1);const r=[];for(const c of i)for(let d=0;d<c.length-1;d++){const u=c[d],f=c[d+1];if(u[1]!==f[1]){const h=Math.min(u[1],f[1]);r.push({ymin:h,ymax:Math.max(u[1],f[1]),x:h===u[1]?u[0]:f[0],islope:(f[0]-u[0])/(f[1]-u[1])})}}if(r.sort((c,d)=>c.ymin<d.ymin?-1:c.ymin>d.ymin?1:c.x<d.x?-1:c.x>d.x?1:c.ymax===d.ymax?0:(c.ymax-d.ymax)/Math.abs(c.ymax-d.ymax)),!r.length)return s;let o=[],a=r[0].ymin,l=0;for(;o.length||r.length;){if(r.length){let c=-1;for(let u=0;u<r.length&&!(r[u].ymin>a);u++)c=u;r.splice(0,c+1).forEach(u=>{o.push({s:a,edge:u})})}if(o=o.filter(c=>!(c.edge.ymax<=a)),o.sort((c,d)=>c.edge.x===d.edge.x?0:(c.edge.x-d.edge.x)/Math.abs(c.edge.x-d.edge.x)),(n!==1||l%t===0)&&o.length>1)for(let c=0;c<o.length;c=c+2){const d=c+1;if(d>=o.length)break;const u=o[c].edge,f=o[d].edge;s.push([[Math.round(u.x),a],[Math.round(f.x),a]])}a+=n,o.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return s}function Qp(e,t){var n;const i=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=t.strokeWidth*4),s=Math.max(s,.1);let r=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(r=s),uce(e,s,i,r||1)}class q9{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const i=Qp(t,n);return{type:"fillSketch",ops:this.renderLines(i,n)}}renderLines(t,n){const i=[];for(const s of t)i.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return i}}function Yy(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class hce extends q9{fillPolygons(t,n){let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);const s=Object.assign({},n,{hachureGap:i}),r=Qp(t,s),o=Math.PI/180*n.hachureAngle,a=[],l=i*.5*Math.cos(o),c=i*.5*Math.sin(o);for(const[u,f]of r)Yy([u,f])&&a.push([[u[0]-l,u[1]+c],[...f]],[[u[0]+l,u[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class gce extends q9{fillPolygons(t,n){const i=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),r=this._fillPolygons(t,s);return i.ops=i.ops.concat(r.ops),i}}class mce{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});const i=Qp(t,n);return this.dotsOnLines(i,n)}dotsOnLines(t,n){const i=[];let s=n.hachureGap;s<0&&(s=n.strokeWidth*4),s=Math.max(s,.1);let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);const o=s/4;for(const a of t){const l=Yy(a),c=l/s,d=Math.ceil(c)-1,u=l-d*s,f=(a[0][0]+a[1][0])/2-s/4,h=Math.min(a[0][1],a[1][1]);for(let m=0;m<d;m++){const p=h+u+m*s,U=f-o+Math.random()*2*o,b=p-o+Math.random()*2*o,y=this.helper.ellipse(U,b,r,r,n);i.push(...y.ops)}}return{type:"fillSketch",ops:i}}}class pce{constructor(t){this.helper=t}fillPolygons(t,n){const i=Qp(t,n);return{type:"fillSketch",ops:this.dashedLine(i,n)}}dashedLine(t,n){const i=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,r=[];return t.forEach(o=>{const a=Yy(o),l=Math.floor(a/(i+s)),c=(a+s-l*(i+s))/2;let d=o[0],u=o[1];d[0]>u[0]&&(d=o[1],u=o[0]);const f=Math.atan((u[1]-d[1])/(u[0]-d[0]));for(let h=0;h<l;h++){const m=h*(i+s),p=m+i,U=[d[0]+m*Math.cos(f)+c*Math.cos(f),d[1]+m*Math.sin(f)+c*Math.sin(f)],b=[d[0]+p*Math.cos(f)+c*Math.cos(f),d[1]+p*Math.sin(f)+c*Math.sin(f)];r.push(...this.helper.doubleLineOps(U[0],U[1],b[0],b[1],n))}}),r}}class Uce{constructor(t){this.helper=t}fillPolygons(t,n){const i=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,s=n.zigzagOffset<0?i:n.zigzagOffset;n=Object.assign({},n,{hachureGap:i+s});const r=Qp(t,n);return{type:"fillSketch",ops:this.zigzagLines(r,s,n)}}zigzagLines(t,n,i){const s=[];return t.forEach(r=>{const o=Yy(r),a=Math.round(o/(2*n));let l=r[0],c=r[1];l[0]>c[0]&&(l=r[1],c=r[0]);const d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let u=0;u<a;u++){const f=u*2*n,h=(u+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),p=[l[0]+f*Math.cos(d),l[1]+f*Math.sin(d)],U=[l[0]+h*Math.cos(d),l[1]+h*Math.sin(d)],b=[p[0]+m*Math.cos(d+Math.PI/4),p[1]+m*Math.sin(d+Math.PI/4)];s.push(...this.helper.doubleLineOps(p[0],p[1],b[0],b[1],i),...this.helper.doubleLineOps(b[0],b[1],U[0],U[1],i))}}),s}}const Ds={};function bce(e,t){let n=e.fillStyle||"hachure";if(!Ds[n])switch(n){case"zigzag":Ds[n]||(Ds[n]=new hce(t));break;case"cross-hatch":Ds[n]||(Ds[n]=new gce(t));break;case"dots":Ds[n]||(Ds[n]=new mce(t));break;case"dashed":Ds[n]||(Ds[n]=new pce(t));break;case"zigzag-line":Ds[n]||(Ds[n]=new Uce(t));break;case"hachure":default:n="hachure",Ds[n]||(Ds[n]=new q9(t));break}return Ds[n]}const yce=0,R4=1,xH=2,IU={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Ece(e){const t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:yce,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:R4,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:xH,text:""},t}function R3(e,t){return e.type===t}function Q9(e){const t=[],n=Ece(e);let i="BOD",s=0,r=n[s];for(;!R3(r,xH);){let o=0;const a=[];if(i==="BOD")if(r.text==="M"||r.text==="m")s++,o=IU[r.text],i=r.text;else return Q9("M0,0"+e);else R3(r,R4)?o=IU[i]:(s++,o=IU[r.text],i=r.text);if(s+o<n.length){for(let l=s;l<s+o;l++){const c=n[l];if(R3(c,R4))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof IU[i]=="number"){const l={key:i,data:a};t.push(l),s+=o,r=n[s],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return t}function AH(e){let t=0,n=0,i=0,s=0;const r=[];for(const{key:o,data:a}of e)switch(o){case"M":r.push({key:"M",data:[...a]}),[t,n]=a,[i,s]=a;break;case"m":t+=a[0],n+=a[1],r.push({key:"M",data:[t,n]}),i=t,s=n;break;case"L":r.push({key:"L",data:[...a]}),[t,n]=a;break;case"l":t+=a[0],n+=a[1],r.push({key:"L",data:[t,n]});break;case"C":r.push({key:"C",data:[...a]}),t=a[4],n=a[5];break;case"c":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":r.push({key:"Q",data:[...a]}),t=a[2],n=a[3];break;case"q":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":r.push({key:"A",data:[...a]}),t=a[5],n=a[6];break;case"a":t+=a[5],n+=a[6],r.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,n]});break;case"H":r.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],r.push({key:"H",data:[t]});break;case"V":r.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],r.push({key:"V",data:[n]});break;case"S":r.push({key:"S",data:[...a]}),t=a[2],n=a[3];break;case"s":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":r.push({key:"T",data:[...a]}),t=a[0],n=a[1];break;case"t":t+=a[0],n+=a[1],r.push({key:"T",data:[t,n]});break;case"Z":case"z":r.push({key:"Z",data:[]}),t=i,n=s;break}return r}function MH(e){const t=[];let n="",i=0,s=0,r=0,o=0,a=0,l=0;for(const{key:c,data:d}of e){switch(c){case"M":t.push({key:"M",data:[...d]}),[i,s]=d,[r,o]=d;break;case"C":t.push({key:"C",data:[...d]}),i=d[4],s=d[5],a=d[2],l=d[3];break;case"L":t.push({key:"L",data:[...d]}),[i,s]=d;break;case"H":i=d[0],t.push({key:"L",data:[i,s]});break;case"V":s=d[0],t.push({key:"L",data:[i,s]});break;case"S":{let u=0,f=0;n==="C"||n==="S"?(u=i+(i-a),f=s+(s-l)):(u=i,f=s),t.push({key:"C",data:[u,f,...d]}),a=d[0],l=d[1],i=d[2],s=d[3];break}case"T":{const[u,f]=d;let h=0,m=0;n==="Q"||n==="T"?(h=i+(i-a),m=s+(s-l)):(h=i,m=s);const p=i+2*(h-i)/3,U=s+2*(m-s)/3,b=u+2*(h-u)/3,y=f+2*(m-f)/3;t.push({key:"C",data:[p,U,b,y,u,f]}),a=h,l=m,i=u,s=f;break}case"Q":{const[u,f,h,m]=d,p=i+2*(u-i)/3,U=s+2*(f-s)/3,b=h+2*(u-h)/3,y=m+2*(f-m)/3;t.push({key:"C",data:[p,U,b,y,h,m]}),a=u,l=f,i=h,s=m;break}case"A":{const u=Math.abs(d[0]),f=Math.abs(d[1]),h=d[2],m=d[3],p=d[4],U=d[5],b=d[6];u===0||f===0?(t.push({key:"C",data:[i,s,U,b,U,b]}),i=U,s=b):(i!==U||s!==b)&&(kH(i,s,U,b,u,f,h,m,p).forEach(function(E){t.push({key:"C",data:E})}),i=U,s=b);break}case"Z":t.push({key:"Z",data:[]}),i=r,s=o;break}n=c}return t}function vce(e){return Math.PI*e/180}function Om(e,t,n){const i=e*Math.cos(n)-t*Math.sin(n),s=e*Math.sin(n)+t*Math.cos(n);return[i,s]}function kH(e,t,n,i,s,r,o,a,l,c){const d=vce(o);let u=[],f=0,h=0,m=0,p=0;if(c)[f,h,m,p]=c;else{[e,t]=Om(e,t,-d),[n,i]=Om(n,i,-d);const N=(e-n)/2,L=(t-i)/2;let j=N*N/(s*s)+L*L/(r*r);j>1&&(j=Math.sqrt(j),s=j*s,r=j*r);const Y=a===l?-1:1,G=s*s,O=r*r,z=G*O-G*L*L-O*N*N,H=G*L*L+O*N*N,X=Y*Math.sqrt(Math.abs(z/H));m=X*s*L/r+(e+n)/2,p=X*-r*N/s+(t+i)/2,f=Math.asin(parseFloat(((t-p)/r).toFixed(9))),h=Math.asin(parseFloat(((i-p)/r).toFixed(9))),e<m&&(f=Math.PI-f),n<m&&(h=Math.PI-h),f<0&&(f=Math.PI*2+f),h<0&&(h=Math.PI*2+h),l&&f>h&&(f=f-Math.PI*2),!l&&h>f&&(h=h-Math.PI*2)}let U=h-f;if(Math.abs(U)>Math.PI*120/180){const N=h,L=n,j=i;l&&h>f?h=f+Math.PI*120/180*1:h=f+Math.PI*120/180*-1,n=m+s*Math.cos(h),i=p+r*Math.sin(h),u=kH(n,i,L,j,s,r,o,0,l,[h,N,m,p])}U=h-f;const b=Math.cos(f),y=Math.sin(f),E=Math.cos(h),_=Math.sin(h),I=Math.tan(U/4),k=4/3*s*I,w=4/3*r*I,T=[e,t],A=[e+k*y,t-w*b],S=[n+k*_,i-w*E],D=[n,i];if(A[0]=2*T[0]-A[0],A[1]=2*T[1]-A[1],c)return[A,S,D].concat(u);{u=[A,S,D].concat(u);const N=[];for(let L=0;L<u.length;L+=3){const j=Om(u[L][0],u[L][1],d),Y=Om(u[L+1][0],u[L+1][1],d),G=Om(u[L+2][0],u[L+2][1],d);N.push([j[0],j[1],Y[0],Y[1],G[0],G[1]])}return N}}const _ce={randOffset:Cce,randOffsetWithRange:xce,ellipse:Ice,doubleLineOps:Ace};function RH(e,t,n,i,s){return{type:"path",ops:kl(e,t,n,i,s)}}function wb(e,t,n){const i=(e||[]).length;if(i>2){const s=[];for(let r=0;r<i-1;r++)s.push(...kl(e[r][0],e[r][1],e[r+1][0],e[r+1][1],n));return t&&s.push(...kl(e[i-1][0],e[i-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}else if(i===2)return RH(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function wce(e,t){return wb(e,!0,t)}function Tce(e,t,n,i,s){const r=[[e,t],[e+n,t],[e+n,t+i],[e,t+i]];return wce(r,s)}function QM(e,t){let n=nk(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){const i=nk(e,1.5*(1+t.roughness*.22),Mce(t));n=n.concat(i)}return{type:"path",ops:n}}function Ice(e,t,n,i,s){const r=DH(n,i,s);return D4(e,t,s,r).opset}function DH(e,t,n){const i=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*i)),r=Math.PI*2/s;let o=Math.abs(e/2),a=Math.abs(t/2);const l=1-n.curveFitting;return o+=Ve(o*l,n),a+=Ve(a*l,n),{increment:r,rx:o,ry:a}}function D4(e,t,n,i){const[s,r]=ik(i.increment,e,t,i.rx,i.ry,1,i.increment*Y6(.1,Y6(.4,1,n),n),n);let o=W6(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=ik(i.increment,e,t,i.rx,i.ry,1.5,0,n),l=W6(a,null,n);o=o.concat(l)}return{estimatedPoints:r,opset:{type:"path",ops:o}}}function JM(e,t,n,i,s,r,o,a,l){const c=e,d=t;let u=Math.abs(n/2),f=Math.abs(i/2);u+=Ve(u*.01,l),f+=Ve(f*.01,l);let h=s,m=r;for(;h<0;)h+=Math.PI*2,m+=Math.PI*2;m-h>Math.PI*2&&(h=0,m=Math.PI*2);const p=Math.PI*2/l.curveStepCount,U=Math.min(p/2,(m-h)/2),b=sk(U,c,d,u,f,h,m,1,l);if(!l.disableMultiStroke){const y=sk(U,c,d,u,f,h,m,1.5,l);b.push(...y)}return o&&(a?b.push(...kl(c,d,c+u*Math.cos(h),d+f*Math.sin(h),l),...kl(c,d,c+u*Math.cos(m),d+f*Math.sin(m),l)):b.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+u*Math.cos(h),d+f*Math.sin(h)]})),{type:"path",ops:b}}function ek(e,t){const n=MH(AH(Q9(e))),i=[];let s=[0,0],r=[0,0];for(const{key:o,data:a}of n)switch(o){case"M":{r=[a[0],a[1]],s=[a[0],a[1]];break}case"L":i.push(...kl(r[0],r[1],a[0],a[1],t)),r=[a[0],a[1]];break;case"C":{const[l,c,d,u,f,h]=a;i.push(...kce(l,c,d,u,f,h,r,t)),r=[f,h];break}case"Z":i.push(...kl(r[0],r[1],s[0],s[1],t)),r=[s[0],s[1]];break}return{type:"path",ops:i}}function D3(e,t){const n=[];for(const i of e)if(i.length){const s=t.maxRandomnessOffset||0,r=i.length;if(r>2){n.push({op:"move",data:[i[0][0]+Ve(s,t),i[0][1]+Ve(s,t)]});for(let o=1;o<r;o++)n.push({op:"lineTo",data:[i[o][0]+Ve(s,t),i[o][1]+Ve(s,t)]})}}return{type:"fillPath",ops:n}}function Vf(e,t){return bce(t,_ce).fillPolygons(e,t)}function Sce(e,t,n,i,s,r,o){const a=e,l=t;let c=Math.abs(n/2),d=Math.abs(i/2);c+=Ve(c*.01,o),d+=Ve(d*.01,o);let u=s,f=r;for(;u<0;)u+=Math.PI*2,f+=Math.PI*2;f-u>Math.PI*2&&(u=0,f=Math.PI*2);const h=(f-u)/o.curveStepCount,m=[];for(let p=u;p<=f;p=p+h)m.push([a+c*Math.cos(p),l+d*Math.sin(p)]);return m.push([a+c*Math.cos(f),l+d*Math.sin(f)]),m.push([a,l]),Vf([m],o)}function Cce(e,t){return Ve(e,t)}function xce(e,t,n){return Y6(e,t,n)}function Ace(e,t,n,i,s){return kl(e,t,n,i,s,!0)}function Mce(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function LH(e){return e.randomizer||(e.randomizer=new kz(e.seed||0)),e.randomizer.next()}function Y6(e,t,n,i=1){return n.roughness*i*(LH(n)*(t-e)+e)}function Ve(e,t,n=1){return Y6(-e,e,t,n)}function kl(e,t,n,i,s,r=!1){const o=r?s.disableMultiStrokeFill:s.disableMultiStroke,a=tk(e,t,n,i,s,!0,!1);if(o)return a;const l=tk(e,t,n,i,s,!0,!0);return a.concat(l)}function tk(e,t,n,i,s,r,o){const a=Math.pow(e-n,2)+Math.pow(t-i,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=s.maxRandomnessOffset||0;d*d*100>a&&(d=l/10);const u=d/2,f=.2+LH(s)*.2;let h=s.bowing*s.maxRandomnessOffset*(i-t)/200,m=s.bowing*s.maxRandomnessOffset*(e-n)/200;h=Ve(h,s,c),m=Ve(m,s,c);const p=[],U=()=>Ve(u,s,c),b=()=>Ve(d,s,c),y=s.preserveVertices;return o?p.push({op:"move",data:[e+(y?0:U()),t+(y?0:U())]}):p.push({op:"move",data:[e+(y?0:Ve(d,s,c)),t+(y?0:Ve(d,s,c))]}),o?p.push({op:"bcurveTo",data:[h+e+(n-e)*f+U(),m+t+(i-t)*f+U(),h+e+2*(n-e)*f+U(),m+t+2*(i-t)*f+U(),n+(y?0:U()),i+(y?0:U())]}):p.push({op:"bcurveTo",data:[h+e+(n-e)*f+b(),m+t+(i-t)*f+b(),h+e+2*(n-e)*f+b(),m+t+2*(i-t)*f+b(),n+(y?0:b()),i+(y?0:b())]}),p}function nk(e,t,n){const i=[];i.push([e[0][0]+Ve(t,n),e[0][1]+Ve(t,n)]),i.push([e[0][0]+Ve(t,n),e[0][1]+Ve(t,n)]);for(let s=1;s<e.length;s++)i.push([e[s][0]+Ve(t,n),e[s][1]+Ve(t,n)]),s===e.length-1&&i.push([e[s][0]+Ve(t,n),e[s][1]+Ve(t,n)]);return W6(i,null,n)}function W6(e,t,n){const i=e.length,s=[];if(i>3){const r=[],o=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let a=1;a+2<i;a++){const l=e[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*e[a+1][0]-o*e[a-1][0])/6,l[1]+(o*e[a+1][1]-o*e[a-1][1])/6],r[2]=[e[a+1][0]+(o*e[a][0]-o*e[a+2][0])/6,e[a+1][1]+(o*e[a][1]-o*e[a+2][1])/6],r[3]=[e[a+1][0],e[a+1][1]],s.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}}else i===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):i===2&&s.push(...kl(e[0][0],e[0][1],e[1][0],e[1][1],n));return s}function ik(e,t,n,i,s,r,o,a){const l=a.roughness===0,c=[],d=[];if(l){e=e/4,d.push([t+i*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=Math.PI*2;u=u+e){const f=[t+i*Math.cos(u),n+s*Math.sin(u)];c.push(f),d.push(f)}d.push([t+i*Math.cos(0),n+s*Math.sin(0)]),d.push([t+i*Math.cos(e),n+s*Math.sin(e)])}else{const u=Ve(.5,a)-Math.PI/2;d.push([Ve(r,a)+t+.9*i*Math.cos(u-e),Ve(r,a)+n+.9*s*Math.sin(u-e)]);const f=Math.PI*2+u-.01;for(let h=u;h<f;h=h+e){const m=[Ve(r,a)+t+i*Math.cos(h),Ve(r,a)+n+s*Math.sin(h)];c.push(m),d.push(m)}d.push([Ve(r,a)+t+i*Math.cos(u+Math.PI*2+o*.5),Ve(r,a)+n+s*Math.sin(u+Math.PI*2+o*.5)]),d.push([Ve(r,a)+t+.98*i*Math.cos(u+o),Ve(r,a)+n+.98*s*Math.sin(u+o)]),d.push([Ve(r,a)+t+.9*i*Math.cos(u+o*.5),Ve(r,a)+n+.9*s*Math.sin(u+o*.5)])}return[d,c]}function sk(e,t,n,i,s,r,o,a,l){const c=r+Ve(.1,l),d=[];d.push([Ve(a,l)+t+.9*i*Math.cos(c-e),Ve(a,l)+n+.9*s*Math.sin(c-e)]);for(let u=c;u<=o;u=u+e)d.push([Ve(a,l)+t+i*Math.cos(u),Ve(a,l)+n+s*Math.sin(u)]);return d.push([t+i*Math.cos(o),n+s*Math.sin(o)]),d.push([t+i*Math.cos(o),n+s*Math.sin(o)]),W6(d,null,l)}function kce(e,t,n,i,s,r,o,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let d=[0,0];const u=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let h=0;h<u;h++)h===0?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(f?0:Ve(c[0],a)),o[1]+(f?0:Ve(c[0],a))]}),d=f?[s,r]:[s+Ve(c[h],a),r+Ve(c[h],a)],l.push({op:"bcurveTo",data:[e+Ve(c[h],a),t+Ve(c[h],a),n+Ve(c[h],a),i+Ve(c[h],a),d[0],d[1]]});return l}function Fm(e){return[...e]}function Rce(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(n===3)i.push(Fm(e[0]),Fm(e[1]),Fm(e[2]),Fm(e[2]));else{const s=[];s.push(e[0],e[0]);for(let a=1;a<e.length;a++)s.push(e[a]),a===e.length-1&&s.push(e[a]);const r=[],o=1-t;i.push(Fm(s[0]));for(let a=1;a+2<s.length;a++){const l=s[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*s[a+1][0]-o*s[a-1][0])/6,l[1]+(o*s[a+1][1]-o*s[a-1][1])/6],r[2]=[s[a+1][0]+(o*s[a][0]-o*s[a+2][0])/6,s[a+1][1]+(o*s[a][1]-o*s[a+2][1])/6],r[3]=[s[a+1][0],s[a+1][1]],i.push(r[1],r[2],r[3])}}return i}function Dce(e,t){return Math.sqrt(Tb(e,t))}function Tb(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Lce(e,t,n){const i=Tb(t,n);if(i===0)return Tb(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),Tb(e,Xd(t,n,s))}function Xd(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Pce(e,t){const n=e[t+0],i=e[t+1],s=e[t+2],r=e[t+3];let o=3*i[0]-2*n[0]-r[0];o*=o;let a=3*i[1]-2*n[1]-r[1];a*=a;let l=3*s[0]-2*r[0]-n[0];l*=l;let c=3*s[1]-2*r[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function L4(e,t,n,i){const s=i||[];if(Pce(e,t)<n){const r=e[t+0];s.length?Dce(s[s.length-1],r)>1&&s.push(r):s.push(r),s.push(e[t+3])}else{const o=e[t+0],a=e[t+1],l=e[t+2],c=e[t+3],d=Xd(o,a,.5),u=Xd(a,l,.5),f=Xd(l,c,.5),h=Xd(d,u,.5),m=Xd(u,f,.5),p=Xd(h,m,.5);L4([o,d,h,p],0,n,s),L4([p,m,f,c],0,n,s)}return s}function J9(e,t){return K6(e,0,e.length,t)}function K6(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=Lce(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(K6(e,t,c+1,i,r),K6(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}function Jp(e,t=.15,n){const i=[],s=(e.length-1)/3;for(let r=0;r<s;r++){const o=r*3;L4(e,o,t,i)}return n&&n>0?K6(i,0,i.length,n):i}function Nce(e,t,n){const i=Q9(e),s=MH(AH(i)),r=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...Jp(l,t)),l=[]},d=()=>{c(),o.length&&(r.push(o),o=[])};for(const{key:f,data:h}of s)switch(f){case"M":d(),a=[h[0],h[1]],o.push(a);break;case"L":c(),o.push([h[0],h[1]]);break;case"C":if(!l.length){const m=o.length?o[o.length-1]:a;l.push([m[0],m[1]])}l.push([h[0],h[1]]),l.push([h[2],h[3]]),l.push([h[4],h[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(d(),!n)return r;const u=[];for(const f of r){const h=J9(f,n);h.length&&u.push(h)}return u}const Zs="none";class dg{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return zie()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,i){return{shape:t,sets:n||[],options:i||this.defaultOptions}}line(t,n,i,s,r){const o=this._o(r);return this._d("line",[RH(t,n,i,s,o)],o)}rectangle(t,n,i,s,r){const o=this._o(r),a=[],l=Tce(t,n,i,s,o);if(o.fill){const c=[[t,n],[t+i,n],[t+i,n+s],[t,n+s]];o.fillStyle==="solid"?a.push(D3([c],o)):a.push(Vf([c],o))}return o.stroke!==Zs&&a.push(l),this._d("rectangle",a,o)}ellipse(t,n,i,s,r){const o=this._o(r),a=[],l=DH(i,s,o),c=D4(t,n,o,l);if(o.fill)if(o.fillStyle==="solid"){const d=D4(t,n,o,l).opset;d.type="fillPath",a.push(d)}else a.push(Vf([c.estimatedPoints],o));return o.stroke!==Zs&&a.push(c.opset),this._d("ellipse",a,o)}circle(t,n,i,s){const r=this.ellipse(t,n,i,i,s);return r.shape="circle",r}linearPath(t,n){const i=this._o(n);return this._d("linearPath",[wb(t,!1,i)],i)}arc(t,n,i,s,r,o,a=!1,l){const c=this._o(l),d=[],u=JM(t,n,i,s,r,o,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const f=Object.assign({},c);f.disableMultiStroke=!0;const h=JM(t,n,i,s,r,o,!0,!1,f);h.type="fillPath",d.push(h)}else d.push(Sce(t,n,i,s,r,o,c));return c.stroke!==Zs&&d.push(u),this._d("arc",d,c)}curve(t,n){const i=this._o(n),s=[],r=QM(t,i);if(i.fill&&i.fill!==Zs&&t.length>=3)if(i.fillStyle==="solid"){const o=QM(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=Rce(t),a=Jp(o,10,(1+i.roughness)/2);s.push(Vf([a],i))}return i.stroke!==Zs&&s.push(r),this._d("curve",s,i)}polygon(t,n){const i=this._o(n),s=[],r=wb(t,!0,i);return i.fill&&(i.fillStyle==="solid"?s.push(D3([t],i)):s.push(Vf([t],i))),i.stroke!==Zs&&s.push(r),this._d("polygon",s,i)}path(t,n){const i=this._o(n),s=[];if(!t)return this._d("path",s,i);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const r=i.fill&&i.fill!=="transparent"&&i.fill!==Zs,o=i.stroke!==Zs,a=!!(i.simplification&&i.simplification<1),l=a?4-4*(i.simplification||1):(1+i.roughness)/2,c=Nce(t,1,l),d=ek(t,i);if(r)if(i.fillStyle==="solid")if(c.length===1){const u=ek(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(D3(c,i));else s.push(Vf(c,i));return o&&(a?c.forEach(u=>{s.push(wb(u,!1,i))}):s.push(d)),this._d("path",s,i)}opsToPath(t,n){let i="";for(const s of t.ops){const r=typeof n=="number"&&n>=0?s.data.map(o=>+o.toFixed(n)):s.data;switch(s.op){case"move":i+=`M${r[0]} ${r[1]} `;break;case"bcurveTo":i+=`C${r[0]} ${r[1]}, ${r[2]} ${r[3]}, ${r[4]} ${r[5]} `;break;case"lineTo":i+=`L${r[0]} ${r[1]} `;break}}return i.trim()}toPaths(t){const n=t.sets||[],i=t.options||this.defaultOptions,s=[];for(const r of n){let o=null;switch(r.type){case"path":o={d:this.opsToPath(r),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:Zs};break;case"fillPath":o={d:this.opsToPath(r),stroke:Zs,strokeWidth:0,fill:i.fill||Zs};break;case"fillSketch":o=this.fillSketch(r,i);break}o&&s.push(o)}return s}fillSketch(t,n){let i=n.fillWeight;return i<0&&(i=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Zs,strokeWidth:i,fill:Zs}}_mergedShape(t){return t.filter((n,i)=>i===0?!0:n.op!=="move")}}class Oce{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new dg(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.ctx,r=t.options.fixedDecimalPlaceDigits;for(const o of n)switch(o.type){case"path":s.save(),s.strokeStyle=i.stroke==="none"?"transparent":i.stroke,s.lineWidth=i.strokeWidth,i.strokeLineDash&&s.setLineDash(i.strokeLineDash),i.strokeLineDashOffset&&(s.lineDashOffset=i.strokeLineDashOffset),this._drawToContext(s,o,r),s.restore();break;case"fillPath":{s.save(),s.fillStyle=i.fill||"";const a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,o,r,a),s.restore();break}case"fillSketch":this.fillSketch(s,o,i);break}}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2),t.save(),i.fillLineDash&&t.setLineDash(i.fillLineDash),i.fillLineDashOffset&&(t.lineDashOffset=i.fillLineDashOffset),t.strokeStyle=i.fill||"",t.lineWidth=s,this._drawToContext(t,n,i.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,i,s="nonzero"){t.beginPath();for(const r of n.ops){const o=typeof i=="number"&&i>=0?r.data.map(a=>+a.toFixed(i)):r.data;switch(r.op){case"move":t.moveTo(o[0],o[1]);break;case"bcurveTo":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":t.lineTo(o[0],o[1]);break}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o),o}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o),o}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o),o}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r),r}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i),i}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i),i}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c),c}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i),i}path(t,n){const i=this.gen.path(t,n);return this.draw(i),i}}const SU="http://www.w3.org/2000/svg";class Fce{constructor(t,n){this.svg=t,this.gen=new dg(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS(SU,"g"),o=t.options.fixedDecimalPlaceDigits;for(const a of n){let l=null;switch(a.type){case"path":{l=s.createElementNS(SU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke",i.stroke),l.setAttribute("stroke-width",i.strokeWidth+""),l.setAttribute("fill","none"),i.strokeLineDash&&l.setAttribute("stroke-dasharray",i.strokeLineDash.join(" ").trim()),i.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${i.strokeLineDashOffset}`);break}case"fillPath":{l=s.createElementNS(SU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",i.fill||""),(t.shape==="curve"||t.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(s,a,i);break}}l&&r.appendChild(l)}return r}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2);const r=t.createElementNS(SU,"path");return r.setAttribute("d",this.opsToPath(n,i.fixedDecimalPlaceDigits)),r.setAttribute("stroke",i.fill||""),r.setAttribute("stroke-width",s+""),r.setAttribute("fill","none"),i.fillLineDash&&r.setAttribute("stroke-dasharray",i.fillLineDash.join(" ").trim()),i.fillLineDashOffset&&r.setAttribute("stroke-dashoffset",`${i.fillLineDashOffset}`),r}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o)}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o)}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o)}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r)}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i)}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i)}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c)}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i)}path(t,n){const i=this.gen.path(t,n);return this.draw(i)}}const Id={canvas(e,t){return new Oce(e,t)},svg(e,t){return new Fce(e,t)},generator(e){return new dg(e)},newSeed(){return dg.newSeed()}};let PH=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const Bce=e=>{const{angle:t,width:n,height:i,x:s,y:r}=e,o=s+n/2,a=r+i/2,l=M(o,a);let c;return e.type==="diamond"?c=l4(Z(M(o,r),l,t),Z(M(s+n,a),l,t),Z(M(o,r+i),l,t),Z(M(s,a),l,t)):c=l4(Z(M(s,r),l,t),Z(M(s+n,r),l,t),Z(M(s+n,r+i),l,t),Z(M(s,r+i),l,t)),{type:"polygon",data:c}},zce=e=>{const{width:t,height:n,angle:i,x:s,y:r}=e;return{type:"ellipse",data:{center:M(s+t/2,r+n/2),angle:i,halfWidth:t/2,halfHeight:n/2}}},rf=e=>{if(!e)return[];for(const t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},Hce=(e,t=M(0,0),n,i)=>{const s=l=>Z(M(l[0]+t[0],l[1]+t[1]),i,n),r=rf(e),o=[];let a=M(0,0);for(const l of r){if(l.op==="move"){const c=Py(l.data);Ce(c!=null,"Ops data is not a point"),a=s(c)}if(l.op==="bcurveTo"){const c=s(M(l.data[0],l.data[1])),d=s(M(l.data[2],l.data[3])),u=s(M(l.data[4],l.data[5]));o.push(Gr(a,c,d,u)),a=u}}return{type:"polycurve",data:o}},Vce=e=>{let t=e[0];const n=[];for(let i=1;i<e.length;i++){const s=e[i];n.push(Pe(t,s)),t=s}return n},$ce=(e,t,n=!1)=>{const i=r=>Z(Xi(oh(Me(r),An(e.x,e.y))),t,e.angle),s=Vce(e.points.map(r=>i(r)));return n?{type:"polygon",data:M6(s.flat())}:{type:"polyline",data:s}},Gce=(e,t,n=M(0,0),i,s)=>{const r=d=>Z(M(d[0]+n[0],d[1]+n[1]),s,i);if(e.roundness===null)return{type:"polygon",data:M6(e.points.map(d=>r(d)))};const o=rf(t),a=[];let l=!1;for(const d of o)d.op==="move"?(l=!l,l&&a.push(M(d.data[0],d.data[1]))):d.op==="bcurveTo"?l&&(a.push(M(d.data[0],d.data[1])),a.push(M(d.data[2],d.data[3])),a.push(M(d.data[4],d.data[5]))):d.op==="lineTo"&&l&&a.push(M(d.data[0],d.data[1]));const c=Jp(a,10,5).map(d=>r(d));return{type:"polygon",data:M6(c)}};function rk(e,t,n,i=s=>s){return e*i(.5-t*(.5-n))}function Xce(e){return[-e[0],-e[1]]}function co(e,t){return[e[0]+t[0],e[1]+t[1]]}function kr(e,t){return[e[0]-t[0],e[1]-t[1]]}function ro(e,t){return[e[0]*t,e[1]*t]}function jce(e,t){return[e[0]/t,e[1]/t]}function Bm(e){return[e[1],-e[0]]}function ok(e,t){return e[0]*t[0]+e[1]*t[1]}function Yce(e,t){return e[0]===t[0]&&e[1]===t[1]}function Wce(e){return Math.hypot(e[0],e[1])}function Kce(e){return e[0]*e[0]+e[1]*e[1]}function ak(e,t){return Kce(kr(e,t))}function NH(e){return jce(e,Wce(e))}function Zce(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function zm(e,t,n){let i=Math.sin(n),s=Math.cos(n),r=e[0]-t[0],o=e[1]-t[1],a=r*s-o*i,l=r*i+o*s;return[a+t[0],l+t[1]]}function P4(e,t,n){return co(e,ro(kr(t,e),n))}function lk(e,t,n){return co(e,ro(t,n))}var{min:Cf,PI:qce}=Math,ck=.275,Hm=qce+1e-4;function Qce(e,t={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=O=>O,start:a={},end:l={},last:c=!1}=t,{cap:d=!0,easing:u=O=>O*(2-O)}=a,{cap:f=!0,easing:h=O=>--O*O*O+1}=l;if(e.length===0||n<=0)return[];let m=e[e.length-1].runningLength,p=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,U=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,b=Math.pow(n*i,2),y=[],E=[],_=e.slice(0,10).reduce((O,z)=>{let H=z.pressure;if(r){let X=Cf(1,z.distance/n),Q=Cf(1,1-X);H=Cf(1,O+(Q-O)*(X*ck))}return(O+H)/2},e[0].pressure),I=rk(n,s,e[e.length-1].pressure,o),k,w=e[0].vector,T=e[0].point,A=T,S=T,D=A,N=!1;for(let O=0;O<e.length;O++){let{pressure:z}=e[O],{point:H,vector:X,distance:Q,runningLength:re}=e[O];if(O<e.length-1&&m-re<3)continue;if(s){if(r){let Be=Cf(1,Q/n),We=Cf(1,1-Be);z=Cf(1,_+(We-_)*(Be*ck))}I=rk(n,s,z,o)}else I=n/2;k===void 0&&(k=I);let ie=re<p?u(re/p):1,me=m-re<U?h((m-re)/U):1;I=Math.max(.01,I*Math.min(ie,me));let ke=(O<e.length-1?e[O+1]:e[O]).vector,ye=O<e.length-1?ok(X,ke):1,Ae=ok(X,w)<0&&!N,$e=ye!==null&&ye<0;if(Ae||$e){let Be=ro(Bm(w),I);for(let We=1/13,bn=0;bn<=1;bn+=We)S=zm(kr(H,Be),H,Hm*bn),y.push(S),D=zm(co(H,Be),H,Hm*-bn),E.push(D);T=S,A=D,$e&&(N=!0);continue}if(N=!1,O===e.length-1){let Be=ro(Bm(X),I);y.push(kr(H,Be)),E.push(co(H,Be));continue}let et=ro(Bm(P4(ke,X,ye)),I);S=kr(H,et),(O<=1||ak(T,S)>b)&&(y.push(S),T=S),D=co(H,et),(O<=1||ak(A,D)>b)&&(E.push(D),A=D),_=z,w=X}let L=e[0].point.slice(0,2),j=e.length>1?e[e.length-1].point.slice(0,2):co(e[0].point,[1,1]),Y=[],G=[];if(e.length===1){if(!(p||U)||c){let O=lk(L,NH(Bm(kr(L,j))),-(k||I)),z=[];for(let H=1/13,X=H;X<=1;X+=H)z.push(zm(O,L,Hm*2*X));return z}}else{if(!(p||U&&e.length===1))if(d)for(let z=1/13,H=z;H<=1;H+=z){let X=zm(E[0],L,Hm*H);Y.push(X)}else{let z=kr(y[0],E[0]),H=ro(z,.5),X=ro(z,.51);Y.push(kr(L,H),kr(L,X),co(L,X),co(L,H))}let O=Bm(Xce(e[e.length-1].vector));if(U||p&&e.length===1)G.push(j);else if(f){let z=lk(j,O,I);for(let H=1/29,X=H;X<1;X+=H)G.push(zm(z,j,Hm*3*X))}else G.push(co(j,ro(O,I)),co(j,ro(O,I*.99)),kr(j,ro(O,I*.99)),kr(j,ro(O,I)))}return y.concat(G,E.reverse(),Y)}function Jce(e,t={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:h,y:m,pressure:p=.5})=>[h,m,p]);if(a.length===2){let h=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(P4(a[0],h,m/4))}a.length===1&&(a=[...a,[...co(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,u=l[0],f=a.length-1;for(let h=1;h<a.length;h++){let m=r&&h===f?a[h].slice(0,2):P4(u.point,a[h],o);if(Yce(u.point,m))continue;let p=Zce(m,u.point);if(d+=p,h<f&&!c){if(d<s)continue;c=!0}u={point:m,pressure:a[h][2]>=0?a[h][2]:.5,vector:NH(kr(u.point,m)),distance:p,runningLength:d},l.push(u)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function ede(e,t={}){return Qce(Jce(e,t),t)}const _i=10,tde=(e,t,n,i,s,r,o,a)=>{var D,N;const{width:l,height:c}=ya(e),d=i/l,u=s/c,f=(((D=e.crop)==null?void 0:D.x)??0)/d,h=(((N=e.crop)==null?void 0:N.y)??0)/u,m=Z(M(r,o),yi(e,t),-e.angle);r=m[0],o=m[1];let p=e.width,U=e.height,b=e.crop??{x:0,y:0,width:i,height:s,naturalWidth:i,naturalHeight:s};const y=b.height,E=b.width,_=e.scale[0]===-1,I=e.scale[1]===-1;let k=o-e.y,w=r-e.x;n.includes("n")&&(U=Ke(e.height-k,_i,I?c-h:e.height+h)),n.includes("s")&&(k=o-e.y-e.height,U=Ke(e.height+k,_i,I?e.height+h:c-h)),n.includes("e")&&(w=r-e.x-e.width,p=Ke(e.width+w,_i,_?e.width+f:l-f)),n.includes("w")&&(p=Ke(e.width-w,_i,_?l-f:e.width+f));const T=L=>{L.height=U*u,L.width=p*d};T(b);const A=(L,j)=>{T(j),L.includes("n")&&(I||(j.y+=y-j.height)),L.includes("s")&&I&&(j.y+=y-j.height),L.includes("e")&&_&&(j.x+=E-j.width),L.includes("w")&&(_||(j.x+=E-j.width))};switch(n){case"n":{if(a){const L=f+e.width/2,j=l-f-e.width/2,Y=Math.min(L,j)*2;p=Ke(U*a,_i,Y),U=p/a}A(n,b),a&&(b.x+=(E-b.width)/2);break}case"s":{if(a){const L=f+e.width/2,j=l-f-e.width/2,Y=Math.min(L,j)*2;p=Ke(U*a,_i,Y),U=p/a}A(n,b),a&&(b.x+=(E-b.width)/2);break}case"w":{if(a){const L=h+e.height/2,j=c-h-e.height/2,Y=Math.min(L,j)*2;U=Ke(p/a,_i,Y),p=U*a}A(n,b),a&&(b.y+=(y-b.height)/2);break}case"e":{if(a){const L=h+e.height/2,j=c-h-e.height/2,Y=Math.min(L,j)*2;U=Ke(p/a,_i,Y),p=U*a}A(n,b),a&&(b.y+=(y-b.height)/2);break}case"ne":{if(a)if(w>-k){const L=I?c-h:h+e.height;U=Ke(p/a,_i,L),p=U*a}else{const L=_?f+e.width:l-f;p=Ke(U*a,_i,L),U=p/a}A(n,b);break}case"nw":{if(a)if(w<k){const L=I?c-h:h+e.height;U=Ke(p/a,_i,L),p=U*a}else{const L=_?l-f:f+e.width;p=Ke(U*a,_i,L),U=p/a}A(n,b);break}case"se":{if(a)if(w>k){const L=I?h+e.height:c-h;U=Ke(p/a,_i,L),p=U*a}else{const L=_?f+e.width:l-f;p=Ke(U*a,_i,L),U=p/a}A(n,b);break}case"sw":{if(a)if(-w>k){const L=I?h+e.height:c-h;U=Ke(p/a,_i,L),p=U*a}else{const L=_?l-f:f+e.width;p=Ke(U*a,_i,L),U=p/a}A(n,b);break}}const S=nde(e,n,p,U,!!a);return WA(b.width,b.naturalWidth)&&WA(b.height,b.naturalHeight)&&(b=null),{x:S[0],y:S[1],width:p,height:U,crop:b}},nde=(e,t,n,i,s)=>{const[r,o,a,l]=X0(e,e.width,e.height,!0),c=M(r,o),d=M(a,l),u=x6(c,d),[f,h,m,p]=X0(e,n,i,!0),U=m-f,b=p-h;let y=[...c];if(["n","w","nw"].includes(t)&&(y=[d[0]-Math.abs(U),d[1]-Math.abs(b)]),t==="ne"){const T=[c[0],d[1]];y=[T[0],T[1]-Math.abs(b)]}if(t==="sw"){const T=[d[0],c[1]];y=[T[0]-Math.abs(U),T[1]]}s&&(["s","n"].includes(t)&&(y[0]=u[0]-U/2),["e","w"].includes(t)&&(y[1]=u[1]-b/2));const E=e.angle,_=Z(y,u,E),I=[y[0]+Math.abs(U)/2,y[1]+Math.abs(b)/2],k=Z(I,u,E);y=Z(_,k,-E);const w=[...y];return w[0]+=e.x-f,w[1]+=e.y-h,w},ide=(e,t)=>{if(e.crop){const{width:n,height:i}=ya(e),[s,r,o,a,l,c]=je(e,t),d=Me(Z(M(s,r),M(l,c),e.angle)),u=Me(Z(M(o,r),M(l,c),e.angle)),f=To(C6(u,d)),h=Me(Z(M(s,a),M(l,c),e.angle)),m=C6(h,d),p=To(m),{cropX:U,cropY:b}=sde(e.crop,e.scale),y=oh(oh(d,Rn(f,-U*n/e.crop.naturalWidth)),Rn(p,-b*i/e.crop.naturalHeight)),E=Xi(oh(oh(y,Rn(f,n/2)),Rn(p,i/2))),_=Z(Xi(y),E,-e.angle);return{...e,x:_[0],y:_[1],width:n,height:i,crop:null}}return e},ya=e=>{if(e.crop){const t=e.width/(e.crop.width/e.crop.naturalWidth),n=e.height/(e.crop.height/e.crop.naturalHeight);return{width:t,height:n}}return{width:e.width,height:e.height}},sde=(e,t)=>{let n=e.x,i=e.y;const s=t[0]===-1,r=t[1]===-1;return s&&(n=e.naturalWidth-Math.abs(n)-e.width),r&&(i=e.naturalHeight-Math.abs(i)-e.height),{cropX:n,cropY:i}},rde=(e,t=!1)=>{const n=e.crop;if(!n)return null;const i=e.scale[0]===-1,s=e.scale[1]===-1;let r=n.x,o=n.y;if(i&&(r=n.naturalWidth-n.width-n.x),s&&(o=n.naturalHeight-n.height-n.y),t)return{x:r,y:o};const{width:a,height:l}=ya(e);return{x:r/(n.naturalWidth/a),y:o/(n.naturalHeight/l)}},Jn=e=>!!e&&e.type==="image"&&!!e.fileId,xt=e=>!!e&&e.type==="image",Es=e=>!!e&&e.type==="embeddable",uc=e=>!!e&&e.type==="iframe",Br=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),he=e=>e!=null&&e.type==="text",OH=e=>e!=null&&e.type==="frame",Ib=e=>e!=null&&e.type==="magicframe",_e=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),us=e=>e!=null&&ode(e.type),ode=e=>e==="freedraw",De=e=>e!=null&&FH(e.type),cn=e=>e!=null&&e.type==="line",Te=e=>e!=null&&e.type==="arrow",ve=e=>Te(e)&&e.elbowed,L3=e=>Te(e)&&!e.elbowed,ade=e=>Te(e)&&!e.elbowed&&!e.roundness,lde=e=>Te(e)&&!e.elbowed&&e.roundness!==null,FH=e=>e==="arrow"||e==="line",ln=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&BH(e.type),BH=e=>e==="arrow",si=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),cde=e=>e!=null&&(e.type==="rectangle"||e.type==="diamond"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),dk=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="text"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="freedraw"),bu=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||Te(e)),zH=e=>{const t=e==null?void 0:e.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return Ua(t,null),!1}},Wy=e=>e.type==="rectangle"||e.type==="ellipse"||e.type==="diamond",Ki=e=>{var t;return bu(e)&&!!((t=e.boundElements)!=null&&t.some(({type:n})=>n==="text"))},Vt=e=>e!==null&&"containerId"in e&&e.containerId!==null&&he(e),HH=e=>!!e.startBinding||!!e.endBinding,of=e=>e==="rectangle"||e==="embeddable"||e==="iframe"||e==="image",VH=e=>e==="line"||e==="arrow"||e==="diamond",dde=(e,t)=>!!((e===wn.ADAPTIVE_RADIUS||e===wn.LEGACY)&&of(t.type)||e===wn.PROPORTIONAL_RADIUS&&VH(t.type)),ude=e=>VH(e.type)?{type:wn.PROPORTIONAL_RADIUS}:of(e.type)?{type:wn.ADAPTIVE_RADIUS}:null,kh=e=>ade(e)?"sharpArrow":lde(e)?"curvedArrow":ve(e)?"elbowArrow":"line",N4=e=>e.length>3&&vr(e[0],e[e.length-1]),$H=e=>e.length>3||e.length===3&&!vr(e[0],e[e.length-1]),Z1=new WeakMap,eT=(e,t)=>{const n=Z1.get(e);if(!n)return;const{version:i,shapes:s}=n;if(i!==e.version){Z1.delete(e);return}return s.get(t)},tT=(e,t,n)=>{const i=Z1.get(e);if(!i){Z1.set(e,{version:e.version,shapes:new Map([[n,t]])});return}const{version:s,shapes:r}=i;if(s!==e.version){Z1.set(e,{version:e.version,shapes:new Map([[n,t]])});return}r.set(n,t)};function Z6(e){const t=eT(e,0);if(t)return t;const n=Gue(e),i=[],s=[];for(let o=0;o<n.length;o+=1){const a=n[o],l=n[o-1]&&Py(n[o-1].data.slice(-2));switch(a.op){case"move":continue;case"lineTo":if(!l)throw new Error("prevPoint is undefined");i.push(Pe(M(e.x+l[0],e.y+l[1]),M(e.x+a.data[0],e.y+a.data[1])));continue;case"bcurveTo":if(!l)throw new Error("prevPoint is undefined");s.push(Gr(M(e.x+l[0],e.y+l[1]),M(e.x+a.data[0],e.y+a.data[1]),M(e.x+a.data[2],e.y+a.data[3]),M(e.x+a.data[4],e.y+a.data[5])));continue;default:console.error("Unknown op type",a.op)}}const r=[i,s];return tT(e,r,0),r}function e2(e,t=0){const n=eT(e,t);if(n)return n;let i=fa(Math.min(e.width,e.height),e);i===0&&(i=.01);const s=One(M(e.x,e.y),M(e.x+e.width,e.y+e.height)),r=Pe(M(s[0][0]+i,s[0][1]),M(s[1][0]-i,s[0][1])),o=Pe(M(s[1][0],s[0][1]+i),M(s[1][0],s[1][1]-i)),a=Pe(M(s[0][0]+i,s[1][1]),M(s[1][0]-i,s[1][1])),l=Pe(M(s[0][0],s[1][1]-i),M(s[0][0],s[0][1]+i)),c=[Gr(l[1],M(l[1][0]+2/3*(s[0][0]-l[1][0]),l[1][1]+2/3*(s[0][1]-l[1][1])),M(r[0][0]+2/3*(s[0][0]-r[0][0]),r[0][1]+2/3*(s[0][1]-r[0][1])),r[0]),Gr(r[1],M(r[1][0]+2/3*(s[1][0]-r[1][0]),r[1][1]+2/3*(s[0][1]-r[1][1])),M(o[0][0]+2/3*(s[1][0]-o[0][0]),o[0][1]+2/3*(s[0][1]-o[0][1])),o[0]),Gr(o[1],M(o[1][0]+2/3*(s[1][0]-o[1][0]),o[1][1]+2/3*(s[1][1]-o[1][1])),M(a[1][0]+2/3*(s[1][0]-a[1][0]),a[1][1]+2/3*(s[1][1]-a[1][1])),a[1]),Gr(a[0],M(a[0][0]+2/3*(s[0][0]-a[0][0]),a[0][1]+2/3*(s[1][1]-a[0][1])),M(l[0][0]+2/3*(s[0][0]-l[0][0]),l[0][1]+2/3*(s[1][1]-l[0][1])),l[0])],d=t>0?c.map(h=>JB(ez(h,t))):[[c[0]],[c[1]],[c[2]],[c[3]]],f=[[Pe(d[0][d[0].length-1][3],d[1][0][0]),Pe(d[1][d[1].length-1][3],d[2][0][0]),Pe(d[2][d[2].length-1][3],d[3][0][0]),Pe(d[3][d[3].length-1][3],d[0][0][0])],d.flat()];return tT(e,f,t),f}function t2(e,t=0){const n=eT(e,t);if(n)return n;const[i,s,r,o,a,l,c,d]=CT(e),u=e.roundness?fa(Math.abs(i-c),e):(i-c)*.01,f=e.roundness?fa(Math.abs(o-s),e):(o-s)*.01,[h,m,p,U]=[M(e.x+i,e.y+s),M(e.x+r,e.y+o),M(e.x+a,e.y+l),M(e.x+c,e.y+d)],y=[Gr(M(m[0]-u,m[1]-f),m,m,M(m[0]-u,m[1]+f)),Gr(M(p[0]+u,p[1]-f),p,p,M(p[0]-u,p[1]-f)),Gr(M(U[0]+u,U[1]+f),U,U,M(U[0]+u,U[1]-f)),Gr(M(h[0]-u,h[1]+f),h,h,M(h[0]+u,h[1]+f))].map(I=>JB(ez(I,t))),_=[[Pe(y[0][y[0].length-1][3],y[1][0][0]),Pe(y[1][y[1].length-1][3],y[2][0][0]),Pe(y[2][y[2].length-1][3],y[3][0][0]),Pe(y[3][y[3].length-1][3],y[0][0][0])],y.flat()];return tT(e,_,t),_}const Ea=(e,t=1)=>{if(e.length>=3){const[n,i]=[e[0],e[e.length-1]];return Qe(n,i)<=bb/t}return!1},fa=(e,t)=>{var n,i,s,r;if(((n=t.roundness)==null?void 0:n.type)===wn.PROPORTIONAL_RADIUS||((i=t.roundness)==null?void 0:i.type)===wn.LEGACY)return e*E3;if(((s=t.roundness)==null?void 0:s.type)===wn.ADAPTIVE_RADIUS){const o=((r=t.roundness)==null?void 0:r.value)??Uie,a=o/E3;return e<=a?e*E3:o}return 0},fde=(e,t)=>{const n=e.type==="rectangle"?15:0,i=a=>{const l=To(Me(a[1],a[0])),c=Rn(l,n);return Pe(tg(a[0],c),tg(a[1],Rn(c,-1)))},s=yi(e,t),r=i(dk(e)?Pe(Z(M(e.x,e.y),s,e.angle),Z(M(e.x+e.width,e.y+e.height),s,e.angle)):Pe(Z(M(e.x+e.width/2,e.y),s,e.angle),Z(M(e.x+e.width/2,e.y+e.height),s,e.angle))),o=i(dk(e)?Pe(Z(M(e.x+e.width,e.y),s,e.angle),Z(M(e.x,e.y+e.height),s,e.angle)):Pe(Z(M(e.x,e.y+e.height/2),s,e.angle),Z(M(e.x+e.width,e.y+e.height/2),s,e.angle)));return[r,o]},H0=(e,t,n,i,s)=>{if(Ce(e.points.length>=2,"Arrow must have at least two points"),e.width<3&&e.height<3)return null;const[r,o]=fde(n,s),a=ne.getPointAtIndexGlobalCoordinates(e,i==="start"?1:e.points.length-2,s),l=Xi(Rn(Me(t,a),2*Qe(a,t)+Math.max(Qe(r[0],r[1]),Qe(o[0],o[1]))),a),c=Pe(t,l),d=N0(r,c),u=N0(o,c),f=d&&Qe(a,d),h=u&&Qe(a,u);let m=null;return f!=null&&h!=null?m=f<h?d:u:m=d||u||null,m&&wa(m,n,s)?m:null},ug={},q6=(e,t)=>{const n=ug[e]||(ug[e]={height:t});return n.height=t,n},GH=e=>{ug[e]&&delete ug[e]},hde=e=>{var t;return((t=ug[e])==null?void 0:t.height)??null},ri=(e,t,n)=>{const i=e.split(`
`).map(a=>a||" ").join(`
`),s=parseFloat(t),r=Ude(i,s,n);return{width:sT(i,t),height:r}},XH="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),jH=(e,t)=>{const n=bde(e);return n===0?ri(XH.split("").join(`
`),e,t).width+ti*2:n+ti*2},nT=(e,t)=>ri("",e,t).width+ti*2,gde=()=>sT(XH,_t({fontSize:$l,fontFamily:Td}))>0,fg=e=>Fz(e).replace(/\t/g,"        "),iT=e=>fg(e).split(`
`),mde=e=>{const t=iT(e.text).length;return e.height/t/e.fontSize},n2=(e,t)=>e*t,YH=(e,t)=>n2(e,t)+ti*2;let P3;class pde{constructor(){B(this,"canvas");this.canvas=document.createElement("canvas")}getLineWidth(t,n){const i=this.canvas.getContext("2d");return i.font=n,i.measureText(t).width}}const Lu=(e,t)=>(P3||(P3=new pde),P3.getLineWidth(e,t)),sT=(e,t)=>{const n=iT(e);let i=0;return n.forEach(s=>{i=Math.max(i,Lu(s,t))}),i},Ude=(e,t,n)=>{const i=iT(e).length;return n2(t,n)*i},i2=(()=>{const e={};return{calculate:(s,r)=>{const o=s.charCodeAt(0);if(e[r]||(e[r]=[]),!e[r][o]){const a=Lu(s,r);e[r][o]=a}return e[r][o]},getCache:s=>e[s],clearCache:s=>{e[s]=[]}}})(),bde=e=>{const t=i2.getCache(e);if(!t)return 0;const n=t.filter(i=>i!==void 0);return Math.max(...n)};let N3,CU,O3;const yde=e=>(N3||(N3=Lt.class(...Object.values(Za))),N3.test(e)),Ede=()=>{if(!CU)try{CU=_de()}catch{CU=vde()}return CU},rT=()=>(O3||(O3=wde()),O3),Ar={WHITESPACE:/\s/u,HYPHEN:/-/u,OPENING:/<\(\[\{/u,CLOSING:/>\)\]\}.,:;!\?\//u},Za={CHAR:new RegExp("\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}","u"),OPENING://u,CLOSING://u,CURRENCY://u},Fd={FLAG:new RegExp("\\p{RI}\\p{RI}","u"),JOINER:new RegExp("(?:\\p{Emoji_Modifier}|\\uFE0F\\u20E3?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?","u"),ZWJ:/\u200D/u,ANY:/[\p{Emoji}]/u,MOST:/[\p{Extended_Pictographic}\p{Emoji_Presentation}]/u},vde=()=>Lt.or(rT(),Cn.On(Ar.HYPHEN,Ar.WHITESPACE,Za.CHAR)),_de=()=>Lt.or(rT(),Cn.Before(Ar.WHITESPACE).Build(),Cn.After(Ar.WHITESPACE,Ar.HYPHEN).Build(),Cn.Before(Za.CHAR,Za.CURRENCY).NotPrecededBy(Ar.OPENING,Za.OPENING).Build(),Cn.After(Za.CHAR).NotFollowedBy(Ar.HYPHEN,Ar.CLOSING,Za.CLOSING).Build(),Cn.BeforeMany(Za.OPENING).NotPrecededBy(Ar.OPENING).Build(),Cn.AfterMany(Za.CLOSING).NotFollowedBy(Ar.CLOSING).Build(),Cn.AfterMany(Ar.CLOSING).FollowedBy(Ar.OPENING).Build()),wde=()=>Lt.group(Lt.or(Fd.FLAG,Lt.and(Fd.MOST,Fd.JOINER,Lt.build(`(?:${Fd.ZWJ.source}(?:${Fd.FLAG.source}|${Fd.ANY.source}${Fd.JOINER.source}))*`)))),Lt={build:e=>new RegExp(e,"u"),join:(...e)=>e.map(t=>t.source).join(""),and:(...e)=>Lt.build(Lt.join(...e)),or:(...e)=>Lt.build(e.map(t=>t.source).join("|")),group:(...e)=>Lt.build(`(${Lt.join(...e)})`),class:(...e)=>Lt.build(`[${Lt.join(...e)}]`)},Cn={On:(...e)=>{const t=Lt.join(...e);return Lt.build(`([${t}])`)},Before:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?=[${t}])`);return Cn.Chain(n)},After:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?<=[${t}])`);return Cn.Chain(n)},BeforeMany:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?<![${t}])(?=[${t}])`);return Cn.Chain(n)},AfterMany:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?<=[${t}])(?![${t}])`);return Cn.Chain(n)},NotBefore:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?![${t}])`);return Cn.Chain(n)},NotAfter:(...e)=>{const t=Lt.join(...e),n=()=>Lt.build(`(?<![${t}])`);return Cn.Chain(n)},Chain:e=>({Build:e,PreceededBy:(...t)=>{const n=e(),i=Cn.After(...t).Build(),s=()=>Lt.and(i,n);return Cn.Chain(s)},FollowedBy:(...t)=>{const n=e(),i=Cn.Before(...t).Build(),s=()=>Lt.and(n,i);return Cn.Chain(s)},NotPrecededBy:(...t)=>{const n=e(),i=Cn.NotAfter(...t).Build(),s=()=>Lt.and(i,n);return Cn.Chain(s)},NotFollowedBy:(...t)=>{const n=e(),i=Cn.NotBefore(...t).Build(),s=()=>Lt.and(n,i);return Cn.Chain(s)}})},Tde=e=>{const t=Ede();return e.normalize("NFC").split(t).filter(Boolean)},Sd=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;const i=[],s=e.split(`
`);for(const r of s){if(Lu(r,t)<=n){i.push(r);continue}const a=Ide(r,t,n);i.push(...a)}return i.join(`
`)},Ide=(e,t,n)=>{const i=[],r=Tde(e)[Symbol.iterator]();let o="",a=0,l=r.next();for(;!l.done;){const c=l.value,d=o+c,u=xde(c)?a+i2.calculate(c,t):Lu(d,t);if(/\s/.test(c)||u<=n){o=d,a=u,l=r.next();continue}if(o)i.push(o.trimEnd()),o="",a=0;else{const f=Sde(c,t,n),h=f[f.length-1]??"",m=f.slice(0,-1);i.push(...m),o=h,a=Lu(h,t),l=r.next()}}if(o){const c=Cde(o,t,n);i.push(c)}return i},Sde=(e,t,n)=>{if(rT().test(e))return[e];const i=[],s=Array.from(e);let r="",o=0;for(const a of s){const l=i2.calculate(a,t),c=o+l;if(c<=n){r=r+a,o=c;continue}r&&i.push(r),r=a,o=l}return r&&i.push(r),i},Cde=(e,t,n)=>{if(!(Lu(e,t)>n))return e;let[,s,r]=e.match(/^(.+?)(\s+)$/)??[e,e.trimEnd(),""],o=Lu(s,t);for(const a of Array.from(r)){const l=i2.calculate(a,t),c=o+l;if(c>n)break;s=s+a,o=c}return s},xde=e=>e.codePointAt(0)!==void 0&&e.codePointAt(1)===void 0,fs=(e,t,n)=>{const i=n.getNonDeletedElementsMap();let s;const r={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,angle:t?Te(t)?0:t.angle:e.angle};r.text=e.text,(t||!e.autoResize)&&(s=t?_a(t,e):e.width,r.text=Sd(e.originalText,_t(e),s));const o=ri(r.text,_t(e),e.lineHeight);if(e.autoResize&&(r.width=o.width),r.height=o.height,t){const a=r2(t,e),l=_a(t,e);if(!Te(t)&&o.height>a){const f=Pu(o.height,t.type);n.mutateElement(t,{height:f}),q6(t.id,f)}if(o.width>l){const f=Pu(o.width,t.type);n.mutateElement(t,{width:f})}const c={...e,...r},{x:d,y:u}=Cd(t,c,i);r.x=d,r.y=u}n.mutateElement(e,r)},s2=(e,t,n,i=!1)=>{const s=t.getNonDeletedElementsMap();if(!va(e))return;GH(e.id);const o=Ne(e,s);if(o&&o.text){if(!e)return;let a=o.text,l=o.height,c=o.width;const d=_a(e,o),u=r2(e,o);let f=e.height;if(i||n!=="n"&&n!=="s"){a&&(a=Sd(o.originalText,_t(o),d));const h=ri(a,_t(o),o.lineHeight);l=h.height,c=h.width}if(l>u){f=Pu(l,e.type);const h=f-e.height,m=!Te(e)&&(n==="ne"||n==="nw"||n==="n")?e.y-h:e.y;t.mutateElement(e,{height:f,y:m})}t.mutateElement(o,{text:a,width:c,height:l}),Te(e)||t.mutateElement(o,Cd(e,o,s))}},Cd=(e,t,n)=>{if(Te(e))return ne.getBoundTextElementPosition(e,t,n);const i=Ade(e),s=r2(e,t),r=_a(e,t);let o,a;t.verticalAlign===lr.TOP?a=i.y:t.verticalAlign===lr.BOTTOM?a=i.y+(s-t.height):a=i.y+(s/2-t.height/2),t.textAlign===B0.LEFT?o=i.x:t.textAlign===B0.RIGHT?o=i.x+(r-t.width):o=i.x+(r/2-t.width/2);const l=e.angle??0;if(l!==0){const c=M(i.x+r/2,i.y+s/2),d=M(o+t.width/2,a+t.height/2),[u,f]=Z(d,c,l);return{x:u-t.width/2,y:f-t.height/2}}return{x:o,y:a}},va=e=>{var t,n,i;return(t=e==null?void 0:e.boundElements)!=null&&t.length&&((i=(n=e==null?void 0:e.boundElements)==null?void 0:n.find(s=>s.type==="text"))==null?void 0:i.id)||null},Ne=(e,t)=>{if(!e)return null;const n=va(e);return n&&t.get(n)||null},Gn=(e,t)=>e&&e.containerId&&t.get(e.containerId)||null,F3=(e,t,n)=>{if(!Te(e))return{x:e.x+e.width/2,y:e.y+e.height/2};if(ne.getPointsGlobalCoordinates(e,n).length%2===1){const o=Math.floor(e.points.length/2),a=ne.getPointGlobalCoordinates(e,e.points[o],n);return{x:a[0],y:a[1]}}const s=e.points.length/2-1;let r=ne.getEditorMidPoints(e,n,t)[s];return r||(r=ne.getSegmentMidPoint(e,s+1)),{x:r[0],y:r[1]}},Ade=e=>{let t=ti,n=ti;return e.type==="ellipse"&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),e.type==="diamond"&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},Mde=(e,t)=>Te(t)?0:t?t.angle:e.angle,WH=(e,t)=>e.some(n=>{if(Vt(n)){const i=Gn(n,t);return!Te(i)}return!1}),KH=(e,t)=>e.some(n=>{if(Vt(n)){const i=Gn(n,t);return!Te(i)}return he(n)}),kde=new Set(["rectangle","ellipse","diamond","arrow"]),Rde=e=>kde.has(e.type),Pu=(e,t)=>{e=Math.ceil(e);const n=ti*2;return t==="ellipse"?Math.round((e+n)/Math.sqrt(2)*2):t==="arrow"?e+n*8:t==="diamond"?2*(e+n):e+n},_a=(e,t)=>{const{width:n}=e;if(Te(e)){const i=((t==null?void 0:t.fontSize)??$l)*mie;return Math.max(gie*n,i)}return e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-ti*2:e.type==="diamond"?Math.round(n/2)-ti*2:n-ti*2},r2=(e,t)=>{const{height:n}=e;return Te(e)?n-ti*8*2<=0?t.height:n:e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-ti*2:e.type==="diamond"?Math.round(n/2)-ti*2:n-ti*2},oT=(e,t=`

`)=>e.reduce((i,s)=>(he(s)&&i.push(s.text),i),[]).join(t),o2=(e,t,n)=>{switch(e.type){case"selection":case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return Dde(e,t,n);case"diamond":return Lde(e,t,n);case"ellipse":return Pde(e,t,n);case"line":case"arrow":case"freedraw":return Nde(e,n)}},Dde=(e,t,n)=>{const i=yi(e,t),s=Z(n,i,-e.angle),[r,o]=e2(e);return Math.min(...r.map(a=>Tc(s,a)),...o.map(a=>_9(a,s)).filter(a=>a!==null))},Lde=(e,t,n)=>{const i=yi(e,t),s=Z(n,i,-e.angle),[r,o]=t2(e);return Math.min(...r.map(a=>Tc(s,a)),...o.map(a=>_9(a,s)).filter(a=>a!==null))},Pde=(e,t,n)=>{const i=yi(e,t);return Rne(Z(n,i,-e.angle),tz(i,e.width/2,e.height/2))},Nde=(e,t)=>{const[n,i]=Z6(e);return Math.min(...n.map(s=>Tc(t,s)),...i.map(s=>_9(s,t)))},Q6=e=>{if(e.type==="arrow")return!1;const t=!ds(e.backgroundColor)||Ki(e)||Br(e)||he(e);return e.type==="line"||e.type==="freedraw"?t&&Ea(e.points):t||xt(e)};let B3=null,xU=null,uk=1/0,fk=!1,hk=!1;const ol=({point:e,element:t,threshold:n,elementsMap:i,frameNameBound:s=null,overrideShouldTestInside:r=!1})=>{if(B3&&vr(e,B3)&&uk<=n&&r===hk){const u=xU==null?void 0:xU.deref();if(u&&u.id===t.id&&u.version===t.version&&u.versionNonce===t.versionNonce)return fk}const o=s?P0(M(s.x-n,s.y-n),e,M(s.x+s.width+n,s.y+s.height+n)):!1,a=Pn(t,i,!0);if(!P0(M(a[0]-n,a[1]-n),Z(e,Kg(a),-t.angle),M(a[2]+n,a[3]+n))&&!o)return!1;const d=(r||Q6(t))&&wa(e,t,i)||gk(e,t,i,n)||o;return B3=e,xU=new WeakRef(t),uk=n,hk=r,fk=d,d},Ky=(e,t,n,i=0)=>{let[s,r,o,a]=Pn(t,n);return s-=i,r-=i,o+=i,a+=i,P0(M(s,r),e,M(o,a))},Ode=(e,t)=>!ol(e)&&!ZH(e.point,e.element,t)&&Ky(e.point,e.element,t),ZH=(e,t,n)=>{const i=Ne(t,n);if(!i)return!1;const s=De(t)?{...i,...ne.getBoundTextElementPosition(t,i,n)}:i;return wa(e,s,n)},qH=(e,[t,n],i,s=0)=>{const r=M(t,n),o=!_e(e),a=Math.max(1,s),l=[t-a,n-a,t+a,n+a],c=Pn(e,i);if(!xd(l,c))return!1;if(e.frameId){const f=i.get(e.frameId);if(f&&_e(f)){const h=Pn(f,i);if(!Ug(r,h))return!1}}const d=So(e,i,Pe(yi(e,i),r)),u=o2(e,i,r);return o?d.length===0||u<=s:d.length>0&&u<=a},aT=(e,t,n,i)=>{const s=[];for(let r=t.length-1;r>=0;--r){const o=t[r];if(Ce(!o.isDeleted,"Elements in the function parameter for getAllElementsAtPositionForBinding() should not contain deleted elements"),si(o,!1)&&qH(o,e,n,i)&&(s.push(o),!ds(o.backgroundColor)))break}return s},Bi=(e,t,n,i)=>{const s=aT(e,t,n,i);return!s||s.length===0?null:s.length===1?s[0]:s.sort((r,o)=>o.width**2+o.height**2-(r.width**2+r.height**2)).pop()},Fde=(e,t,n,i,s)=>{const r=[];for(let a=n.length-1;a>=0;--a){const l=n[a];Ce(!l.isDeleted,"Elements in the function parameter for getAllElementsAtPositionForBinding() should not contain deleted elements"),si(l,!1)&&qH(l,e,i,s)&&r.push(l)}if(!r||r.length===0)return null;if(r.length===1)return r[0];const o=r.filter(a=>o2(a,i,e)<=sa(a,t)||wa(e,a,i));return o.length===0?null:o[0]},So=(e,t,n,i=0,s=!1)=>{const r=[Math.min(n[0][0]-i,n[1][0]-i),Math.min(n[0][1]-i,n[1][1]-i),Math.max(n[0][0]+i,n[1][0]+i),Math.max(n[0][1]+i,n[1][1]+i)],o=Pn(e,t);if(!xd(r,o))return[];switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"selection":case"magicframe":return zde(e,t,n,i,s);case"diamond":return Hde(e,t,n,i,s);case"ellipse":return Vde(e,t,n,i);case"line":case"freedraw":case"arrow":return Bde(e,n,s)}},QH=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=xT(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!xd(a,l))continue;const c=QB(o,t);if(c.length>0){for(const d of c)n.push(Z(d,i,s));if(r)return n}}return n},JH=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=N0(o,t);if(a&&(n.push(Z(a,i,s)),r))return n}return n},Bde=(e,t,n=!1)=>{const[i,s]=Z6(e),r=[];for(const o of i){const a=N0(o,t);if(a&&(r.push(a),n))return r}for(const o of s){const a=xT(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!xd(a,l))continue;const c=QB(o,t);if(c.length>0&&(r.push(...c),n))return r}return r},zde=(e,t,n,i=0,s=!1)=>{const r=yi(e,t),o=Z(n[0],r,-e.angle),a=Z(n[1],r,-e.angle),l=Pe(o,a),[c,d]=e2(e,i),u=[];return JH(c,l,u,r,e.angle,s),s&&u.length>0||QH(d,l,u,r,e.angle,s),u},Hde=(e,t,n,i=0,s=!1)=>{const r=yi(e,t),o=Z(n[0],r,-e.angle),a=Z(n[1],r,-e.angle),l=Pe(o,a),[c,d]=t2(e,i),u=[];return JH(c,l,u,r,e.angle,s),s&&u.length>0||QH(d,l,u,r,e.angle,s),u},Vde=(e,t,n,i=0)=>{const s=yi(e,t),r=Z(n[0],s,-e.angle),o=Z(n[1],s,-e.angle);return Dne(tz(s,e.width/2+i,e.height/2+i),Pe(r,o)).map(a=>Z(a,s,e.angle))},gk=(e,t,n,i=1)=>o2(t,n,e)<=i,wa=(e,t,n)=>{if((De(t)||us(t))&&!Ea(t.points))return!1;const[i,s,r,o]=Pn(t,n);if(!P0(M(i,s),e,M(r,o)))return!1;const a=M((i+r)/2,(s+o)/2),l=Xi(Rn(To(Me(e,a,.1)),Math.max(t.width,t.height)*2),a),c=Pe(e,l);return So(t,n,c).filter((u,f,h)=>h.findIndex(m=>vr(m,u))===f).length%2===1},eV=(e,t,n)=>{const i=(o,a)=>{const{x:l,y:c,width:d,height:u,angle:f}=o,h=yi(o,n);if(o.type==="diamond"){const[p,U,b,y,E,_,I,k]=CT(o);return[M(l+p,c+U-a),M(l+b+a,c+y),M(l+E,c+_+a),M(l+I-a,c+k)].map(T=>Z(T,h,f))}if(o.type==="ellipse"){const p=l+d/2,U=c+u/2,b=d/2,y=u/2;return[M(p,U-y-a),M(p+b+a,U),M(p,U+y+a),M(p-b-a,U)].map(_=>Z(_,h,f))}return[M(l-a,c-a),M(l+d+a,c-a),M(l+d+a,c+u+a),M(l-a,c+u+a)].map(p=>Z(p,h,f))},s=-1*Math.max(e.width,e.height)/20;return i(e,s).every(o=>wa(o,t,n))},ei=[1,0],ws=[0,1],zr=[-1,0],bo=[0,-1],hg=e=>{const[t,n]=e,i=Math.abs(t),s=Math.abs(n);return t>s?ei:t<=-s?zr:n>i?ws:bo},tr=(e,t)=>hg(Me(e,t)),al=(e,t)=>ia(tr(e,t)),ni=(e,t)=>e[0]===t[0]&&e[1]===t[1],ia=e=>ni(e,ei)||ni(e,zr),$de=(e,t,n)=>{const i=Kg(t),s=.95,r=Xi(Rn(Me(Z(M(e.x+e.width/2,e.y),i,e.angle),i),s),i),o=Xi(Rn(Me(Z(M(e.x+e.width,e.y+e.height/2),i,e.angle),i),s),i),a=Xi(Rn(Me(Z(M(e.x+e.width/2,e.y+e.height),i,e.angle),i),s),i),l=Xi(Rn(Me(Z(M(e.x,e.y+e.height/2),i,e.angle),i),s),i);if(qn(Me(n,r),Me(r,o))<=0&&qn(Me(n,r),Me(r,l))>0)return tr(r,i);if(qn(Me(n,o),Me(o,a))<=0&&qn(Me(n,o),Me(o,r))>0)return tr(o,i);if(qn(Me(n,a),Me(a,l))<=0&&qn(Me(n,a),Me(a,o))>0)return tr(a,i);if(qn(Me(n,l),Me(l,r))<=0&&qn(Me(n,l),Me(l,a))>0)return tr(l,i);if(qn(Me(n,i),Me(r,i))<=0&&qn(Me(n,i),Me(o,i))>0){const d=e.width>e.height?r:o;return tr(d,i)}else if(qn(Me(n,i),Me(o,i))<=0&&qn(Me(n,i),Me(a,i))>0){const d=e.width>e.height?a:o;return tr(d,i)}else if(qn(Me(n,i),Me(a,i))<=0&&qn(Me(n,i),Me(l,i))>0){const d=e.width>e.height?a:l;return tr(d,i)}const c=e.width>e.height?r:l;return tr(c,i)},lT=(e,t,n)=>{const s=Kg(t);if(e.type==="diamond")return $de(e,t,n);const r=c1(M(t[0],t[1]),s,2),o=c1(M(t[2],t[1]),s,2),a=c1(M(t[0],t[3]),s,2),l=c1(M(t[2],t[3]),s,2);return b3([r,o,s],n)?bo:b3([o,l,s],n)?ei:b3([l,a,s],n)?ws:zr},tV=e=>[e[0]===0?0:e[0]>0?-1:1,e[1]===0?0:e[1]>0?-1:1],cT=1,Hn=40,Gde=(e,t)=>{const n=e.fixedSegments?e.fixedSegments.slice():null;if(n){const i=[];e.points.map(o=>M(e.x+o[0],e.y+o[1])).forEach((o,a,l)=>{if(a<2)return i.push(o);const c=tr(o,l[a-1]),d=tr(l[a-1],l[a-2]);if(ni(c,d)){const u=(n==null?void 0:n.findIndex(h=>h.index===a-1))??-1,f=(n==null?void 0:n.findIndex(h=>h.index===a))??-1;f!==-1&&(n[f].start=M(l[a-2][0]-e.x,l[a-2][1]-e.y)),u!==-1&&n.splice(u,1),i.splice(-1,1),n.forEach(h=>{h.index>a-1&&(h.index-=1)})}return i.push(o)});const s=[];i.forEach((o,a,l)=>{if(a<3)return s.push(o);if(Qe(l[a-2],l[a-1])<cT){const c=(n==null?void 0:n.findIndex(f=>f.index===a-2))??-1,d=(n==null?void 0:n.findIndex(f=>f.index===a-1))??-1;d!==-1&&n.splice(d,1),c!==-1&&n.splice(c,1),s.splice(-2,2),n.forEach(f=>{f.index>a-2&&(f.index-=2)});const u=al(o,l[a-1]);return s.push(M(u?o[0]:l[a-2][0],u?l[a-2][1]:o[1]))}s.push(o)});const r=n.filter(o=>o.index!==1&&o.index!==s.length-1);return r.length===0?El(fT(hT(uT(e,dT(e,t,s.map(o=>M(o[0]-e.x,o[1]-e.y))))??[])),r,null,null):El(s,r,e.startIsSpecial,e.endIsSpecial)}return{x:e.x,y:e.y,points:e.points,fixedSegments:e.fixedSegments,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}},Xde=(e,t,n)=>{var A,S;const i=t.map(D=>D.index),r=(((A=e.fixedSegments)==null?void 0:A.map(D=>D.index))??[]).findIndex(D=>!i.includes(D));if(r===-1||!((S=e.fixedSegments)!=null&&S[r]))return{points:e.points};const o=e.fixedSegments[r].index,a=e.fixedSegments[r-1],l=e.fixedSegments[r+1],c=e.x+(a?a.end[0]:0),d=e.y+(a?a.end[1]:0),u=a?null:e.startBinding,f=l?null:e.endBinding,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredStartElement:b,hoveredEndElement:y,...E}=dT({x:c,y:d,startBinding:u,endBinding:f,startArrowhead:null,endArrowhead:null,points:e.points},n,[M(0,0),M(e.x+((l==null?void 0:l.start[0])??e.points[e.points.length-1][0])-c,e.y+((l==null?void 0:l.start[1])??e.points[e.points.length-1][1])-d)],{isDragging:!1}),{points:_}=El(fT(hT(uT(e,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredEndElement:y,...E})??[])),t,null,null);if(!_||_.length<2)throw new Error("Property 'points' is required in the update returned by normalizeArrowElementUpdate()");const I=[];if(a)for(let D=0;D<a.index;D++)I.push(M(e.x+e.points[D][0],e.y+e.points[D][1]));if(_.forEach(D=>{I.push(M(e.x+(a?a.end[0]:0)+D[0],e.y+(a?a.end[1]:0)+D[1]))}),l)for(let D=l.index;D<e.points.length;D++)I.push(M(e.x+e.points[D][0],e.y+e.points[D][1]));const k=((l==null?void 0:l.index)??e.points.length)-((a==null?void 0:a.index)??0)-1,w=t.map(D=>D.index>o?{...D,index:D.index-k+(_.length-1)}:D),T=I.flatMap((D,N)=>{const L=I[N-1],j=I[N+1];if(L&&j){const Y=tr(D,L),G=tr(j,D);if(ni(Y,G))return w.forEach(O=>{O.index>N&&(O.index-=1)}),[];if(ni(Y,tV(G)))return w.forEach(O=>{O.index>N&&(O.index+=1)}),[D,D]}return[D]});return El(T,w,!1,!1)},jde=(e,t,n,i,s,r)=>{var I,k;const o=t.map((w,T)=>e.fixedSegments==null||e.fixedSegments[T]===void 0||e.fixedSegments[T].index!==w.index||(w.start[0]!==e.fixedSegments[T].start[0]&&w.end[0]!==e.fixedSegments[T].end[0])!=(w.start[1]!==e.fixedSegments[T].start[1]&&w.end[1]!==e.fixedSegments[T].end[1])?T:null).filter(w=>w!==null).shift();if(o==null)return{points:e.points};const a=((I=e.fixedSegments)==null?void 0:I.findIndex(w=>w.index===1))??-1,l=((k=e.fixedSegments)==null?void 0:k.findIndex(w=>w.index===e.points.length-1))??-1,c=Qe(t[o].start,t[o].end),d=c<Hn+5;if(a===-1&&t[o].index===1&&s){const w=ia(n),A=(w?ni(n,ei):ni(n,ws))?d?c/2:Hn:d?-c/2:-40;t[o].start=M(t[o].start[0]+(w?A:0),t[o].start[1]+(w?0:A))}if(l===-1&&t[o].index===e.points.length-1&&r){const w=ia(i),A=(w?ni(i,ei):ni(i,ws))?d?c/2:Hn:d?-c/2:-40;t[o].end=M(t[o].end[0]+(w?A:0),t[o].end[1]+(w?0:A))}const u=t.map(w=>({...w,start:M(e.x+w.start[0],e.y+w.start[1]),end:M(e.x+w.end[0],e.y+w.end[1])})),f=e.points.map((w,T)=>M(e.x+w[0],e.y+w[1])),h=u[o].index-1,m=u[o].index,p=u[o].start,U=u[o].end,b=f[h-1]&&!vr(f[h],f[h-1])?al(f[h-1],f[h]):void 0,y=f[m+1]&&!vr(f[m],f[m+1])?al(f[m+1],f[m]):void 0;if(b!==void 0){const w=b?1:0;f[h-1][w]=p[w]}if(f[h]=p,f[m]=U,y!==void 0){const w=y?1:0;f[m+1][w]=U[w]}const E=u.findIndex(w=>w.index===h);if(E!==-1){const w=al(u[E].end,u[E].start)?1:0;u[E].start[w]=p[w],u[E].end=p}const _=u.findIndex(w=>w.index===m+1);if(_!==-1){const w=al(u[_].end,u[_].start)?1:0;u[_].end[w]=U[w],u[_].start=U}if(a===-1&&h===0){const w=s?ia(n):al(f[1],f[0]);f.unshift(M(w?p[0]:e.x+e.points[0][0],w?e.y+e.points[0][1]:p[1])),s&&f.unshift(M(e.x+e.points[0][0],e.y+e.points[0][1]));for(const T of u)T.index+=s?2:1}if(l===-1&&m===e.points.length-1){const w=ia(i);f.push(M(w?U[0]:e.x+e.points[e.points.length-1][0],w?e.y+e.points[e.points.length-1][1]:U[1])),r&&f.push(M(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]))}return El(f,u.map(w=>({...w,start:M(w.start[0]-e.x,w.start[1]-e.y),end:M(w.end[0]-e.x,w.end[1]-e.y)})),!1,!1)},Yde=(e,t,n,i,s,r,o,a,l)=>{let c=e.startIsSpecial??null,d=e.endIsSpecial??null;const u=t.map((U,b)=>b===0||b===t.length-1?M(e.x+U[0],e.y+U[1]):M(e.x+e.points[b][0],e.y+e.points[b][1])),f=n.map(U=>({...U,start:M(e.x+(U.start[0]-t[0][0]),e.y+(U.start[1]-t[0][1])),end:M(e.x+(U.end[0]-t[0][0]),e.y+(U.end[1]-t[0][1]))})),h=[],m=2+(c?1:0),p=2+(d?1:0);for(;h.length+m<u.length-p;)h.push(u[h.length+m]);{const U=u.at(c?2:1),b=u.at(c?3:2);if(!U||!b)throw new Error(`Second and third points must exist when handling endpoint drag (${c})`);const y=ia(i),E=ia(hg(Me(U,b)));if(a&&y===E){const _=y?ni(i,ei):ni(i,ws);if(h.unshift(M(E?r[0]+(_?Hn:-40):b[0],E?b[1]:r[1]+(_?Hn:-40))),h.unshift(M(y?r[0]+(_?Hn:-40):r[0],y?r[1]:r[1]+(_?Hn:-40))),!c){c=!0;for(const I of f)I.index>1&&(I.index+=1)}}else if(h.unshift(M(E?r[0]:U[0],E?U[1]:r[1])),c){c=!1;for(const _ of f)_.index>1&&(_.index-=1)}h.unshift(r)}{const U=u.at(u.length-(d?3:2)),b=u.at(u.length-(d?4:3));if(!U||!b)throw new Error(`Second and third to last points must exist when handling endpoint drag (${d})`);const y=ia(s),E=al(b,U);if(l&&y===E){const _=y?ni(s,ei):ni(s,ws);h.push(M(E?o[0]+(_?Hn:-40):b[0],E?b[1]:o[1]+(_?Hn:-40))),h.push(M(y?o[0]+(_?Hn:-40):o[0],y?o[1]:o[1]+(_?Hn:-40))),d||(d=!0)}else h.push(M(E?o[0]:U[0],E?U[1]:o[1])),d&&(d=!1)}return h.push(o),El(h,f.map(({index:U})=>({index:U,start:h[U-1],end:h[U]})).map(U=>({...U,start:M(U.start[0]-r[0],U.start[1]-r[1]),end:M(U.end[0]-r[0],U.end[1]-r[1])})),c,d)},AU=1e6,Yg=(e,t,n,i)=>{var I;if(e.points.length<2)return{points:n.points??e.points};const s=n.fixedSegments??e.fixedSegments??[],r=n.points?n.points&&n.points.length===2?e.points.map((k,w)=>w===0?n.points[0]:w===e.points.length-1?n.points[1]:k):n.points.slice():e.points.slice(),{startBinding:o,endBinding:a,...l}=n,c=typeof o<"u"?o:e.startBinding,d=typeof a<"u"?a:e.endBinding,u=c&&J6(c.elementId,t),f=d&&J6(d.elementId,t),h=iV(r);if(c&&!u&&h||d&&!f&&h||t.size===0&&h||Object.keys(l).length===0&&((u==null?void 0:u.id)!==(c==null?void 0:c.elementId)||(f==null?void 0:f.id)!==(d==null?void 0:d.elementId)))return El(r.map(k=>M(e.x+k[0],e.y+k[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial);const{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredStartElement:y,hoveredEndElement:E,..._}=dT({x:e.x,y:e.y,startBinding:c,endBinding:d,startArrowhead:e.startArrowhead,endArrowhead:e.endArrowhead,points:e.points},t,r,i);return t.size===0&&h?El(r.map(k=>M(e.x+k[0],e.y+k[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial):!n.points&&!n.fixedSegments&&!n.startBinding&&!n.endBinding?Gde(e,t):n.startBinding===e.startBinding&&n.endBinding===e.endBinding&&(n.points??[]).every((k,w)=>vr(k,e.points[w]??M(1/0,1/0)))&&h?{}:s.length===0?El(fT(hT(uT(e,{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredEndElement:E,..._})??[])),s,null,null):(((I=e.fixedSegments)==null?void 0:I.length)??0)>s.length?Xde(e,s,t):n.points?n.points&&n.fixedSegments?n:Yde(e,r,s,m,p,U,b,y,E):jde(e,s,m,p,y,E)},dT=(e,t,n,i)=>{var I,k;const s=tg(n[0],An(e.x,e.y)),r=tg(n[n.length-1],An(e.x,e.y));let o=null,a=null;if(i!=null&&i.isDragging){const w=Array.from(t.values());o=bk(s,t,w,i==null?void 0:i.zoom)||null,a=bk(r,t,w,i==null?void 0:i.zoom)||null}else o=e.startBinding&&J6(e.startBinding.elementId,t)||null,a=e.endBinding&&J6(e.endBinding.elementId,t)||null;const l=pk({...e,angle:0,type:"arrow",elbowed:!0,points:n},"start",(I=e.startBinding)==null?void 0:I.fixedPoint,s,o,t,i==null?void 0:i.isDragging),c=pk({...e,angle:0,type:"arrow",elbowed:!0,points:n},"end",(k=e.endBinding)==null?void 0:k.fixedPoint,r,a,t,i==null?void 0:i.isDragging),d=Uk(l,c,o,s,t,i==null?void 0:i.zoom),u=Uk(c,l,a,r,t,i==null?void 0:i.zoom),f=[l[0]-2,l[1]-2,l[0]+2,l[1]+2],h=[c[0]-2,c[1]-2,c[0]+2,c[1]+2],m=o?qa(o,t,Jl(d,e.startArrowhead?sa(o,{elbowed:!0})*6:sa(o,{elbowed:!0})*2,1)):f,p=a?qa(a,t,Jl(u,e.endArrowhead?sa(a,{elbowed:!0})*6:sa(a,{elbowed:!0})*2,1)):h,U=Ug(l,a?qa(a,t,Jl(u,Hn,Hn)):h)||Ug(c,o?qa(o,t,Jl(d,Hn,Hn)):f),b=nV(U?[f,h]:[m,p]),y=Zde(U?f:m,U?h:p,b,U?Jl(d,!o&&!a?0:Hn,0):Jl(d,!o&&!a?0:Hn-(e.startArrowhead?fh*6:fh*2),Hn),U?Jl(u,!o&&!a?0:Hn,0):Jl(u,!o&&!a?0:Hn-(e.endArrowhead?fh*6:fh*2),Hn),U,o&&qa(o,t),a&&qa(a,t)),E=mk(y[0],d,l),_=mk(y[1],u,c);return{dynamicAABBs:y,startDonglePosition:E,startGlobalPoint:l,startHeading:d,endDonglePosition:_,endGlobalPoint:c,endHeading:u,commonBounds:b,hoveredStartElement:o,hoveredEndElement:a,boundsOverlap:U,startElementBounds:m,endElementBounds:p}},uT=(e,t)=>{const{dynamicAABBs:n,startDonglePosition:i,startGlobalPoint:s,startHeading:r,endDonglePosition:o,endGlobalPoint:a,endHeading:l,commonBounds:c,hoveredEndElement:d}=t,u=qde(n,i||s,r,o||a,l,c),f=i&&MU(i,u),h=o&&MU(o,u),m=MU(a,u);m&&d&&(m.closed=!0);const p=MU(s,u);p&&e.startBinding&&(p.closed=!0);const U=f&&h&&(Ug(f.pos,n[1])||Ug(h.pos,n[0])),b=Wde(f||p,h||m,u,r||ei,l||ei,U?[]:n);if(b){const y=b.map(E=>[E.pos[0],E.pos[1]]);return f&&y.unshift(s),h&&y.push(a),y}return null},Jl=(e,t,n)=>{switch(e){case bo:return[t,n,n,n];case ei:return[n,t,n,n];case ws:return[n,n,t,n]}return[n,n,n,t]},Wde=(e,t,n,i,s,r)=>{const o=z3(e.pos,t.pos),a=new Zte(l=>l.f);for(a.push(e);a.size()>0;){const l=a.pop();if(!l||l.closed)continue;if(l===t)return Kde(e,l);l.closed=!0;const c=Jde(l.addr,n);for(let d=0;d<4;d++){const u=c[d];if(!u||u.closed)continue;const f=c1(u.pos,l.pos,.5);if(ose(...r.map(_=>Ug(f,_))))continue;const h=eue(d),m=l.parent?hg(Me(l.pos,l.parent.pos)):i,p=tV(m);if(ni(p,h)||yk(e.addr,u.addr)&&ni(h,i)||yk(t.addr,u.addr)&&ni(h,s))continue;const b=m!==h,y=l.g+z3(u.pos,l.pos)+(b?Math.pow(o,3):0),E=u.visited;if(!E||y<u.g){const _=Qde(u,t,h,s);u.visited=!0,u.parent=l,u.h=z3(t.pos,u.pos)+_*Math.pow(o,2),u.g=y,u.f=u.g+u.h,E?a.rescoreElement(u):a.push(u)}}}return null},Kde=(e,t)=>{let n=t;const i=[];for(;n.parent;)i.unshift(n),n=n.parent;return i.unshift(e),i},z3=(e,t)=>Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1]),Zde=(e,t,n,i,s,r,o,a)=>{const l=o??e,c=a??t,[d,u,f,h]=i??[0,0,0,0],[m,p,U,b]=s??[0,0,0,0],y=[e[0]>t[2]?e[1]>t[3]||e[3]<t[1]?Math.min((l[0]+c[2])/2,e[0]-h):(l[0]+c[2])/2:e[0]>t[0]?e[0]-h:n[0]-h,e[1]>t[3]?e[0]>t[2]||e[2]<t[0]?Math.min((l[1]+c[3])/2,e[1]-d):(l[1]+c[3])/2:e[1]>t[1]?e[1]-d:n[1]-d,e[2]<t[0]?e[1]>t[3]||e[3]<t[1]?Math.max((l[2]+c[0])/2,e[2]+u):(l[2]+c[0])/2:e[2]<t[2]?e[2]+u:n[2]+u,e[3]<t[1]?e[0]>t[2]||e[2]<t[0]?Math.max((l[3]+c[1])/2,e[3]+f):(l[3]+c[1])/2:e[3]<t[3]?e[3]+f:n[3]+f],E=[t[0]>e[2]?t[1]>e[3]||t[3]<e[1]?Math.min((c[0]+l[2])/2,t[0]-b):(c[0]+l[2])/2:t[0]>e[0]?t[0]-b:n[0]-b,t[1]>e[3]?t[0]>e[2]||t[2]<e[0]?Math.min((c[1]+l[3])/2,t[1]-m):(c[1]+l[3])/2:t[1]>e[1]?t[1]-m:n[1]-m,t[2]<e[0]?t[1]>e[3]||t[3]<e[1]?Math.max((c[2]+l[0])/2,t[2]+p):(c[2]+l[0])/2:t[2]<e[2]?t[2]+p:n[2]+p,t[3]<e[1]?t[0]>e[2]||t[2]<e[0]?Math.max((c[3]+l[1])/2,t[3]+U):(c[3]+l[1])/2:t[3]<e[3]?t[3]+U:n[3]+U],_=nV([y,E]);if(!r&&y[2]-y[0]+E[2]-E[0]>_[2]-_[0]+1e-11&&y[3]-y[1]+E[3]-E[1]>_[3]-_[1]+1e-11){const[I,k]=[(E[0]+E[2])/2,(E[1]+E[3])/2];if(t[0]>e[2]&&e[1]>t[3]){const w=y[2]+(E[0]-y[2])/2,T=E[3]+(y[1]-E[3])/2;return qn(An(e[2]-I,e[1]-k),An(e[0]-I,e[3]-k))>0?[[y[0],y[1],w,y[3]],[w,E[1],E[2],E[3]]]:[[y[0],T,y[2],y[3]],[E[0],E[1],E[2],T]]}else if(e[2]<t[0]&&e[3]<t[1]){const w=y[2]+(E[0]-y[2])/2,T=y[3]+(E[1]-y[3])/2;return qn(An(e[0]-I,e[1]-k),An(e[2]-I,e[3]-k))>0?[[y[0],y[1],y[2],T],[E[0],T,E[2],E[3]]]:[[y[0],y[1],w,y[3]],[w,E[1],E[2],E[3]]]}else if(e[0]>t[2]&&e[3]<t[1]){const w=E[2]+(y[0]-E[2])/2,T=y[3]+(E[1]-y[3])/2;return qn(An(e[2]-I,e[1]-k),An(e[0]-I,e[3]-k))>0?[[w,y[1],y[2],y[3]],[E[0],E[1],w,E[3]]]:[[y[0],y[1],y[2],T],[E[0],T,E[2],E[3]]]}else if(e[0]>t[2]&&e[1]>t[3]){const w=E[2]+(y[0]-E[2])/2,T=E[3]+(y[1]-E[3])/2;return qn(An(e[0]-I,e[1]-k),An(e[2]-I,e[3]-k))>0?[[w,y[1],y[2],y[3]],[E[0],E[1],w,E[3]]]:[[y[0],T,y[2],y[3]],[E[0],E[1],E[2],T]]}}return[y,E]},qde=(e,t,n,i,s,r)=>{const o=new Set,a=new Set;n===zr||n===ei?a.add(t[1]):o.add(t[0]),s===zr||s===ei?a.add(i[1]):o.add(i[0]),e.forEach(d=>{o.add(d[0]),o.add(d[2]),a.add(d[1]),a.add(d[3])}),o.add(r[0]),o.add(r[2]),a.add(r[1]),a.add(r[3]);const l=Array.from(a).sort((d,u)=>d-u),c=Array.from(o).sort((d,u)=>d-u);return{row:l.length,col:c.length,data:l.flatMap((d,u)=>c.map((f,h)=>({f:0,g:0,h:0,closed:!1,visited:!1,parent:null,addr:[h,u],pos:[f,d]})))}},mk=(e,t,n)=>{switch(t){case bo:return M(n[0],e[1]);case ei:return M(e[2],n[1]);case ws:return M(n[0],e[3])}return M(e[0],n[1])},Qde=(e,t,n,i)=>{if(i===ei)switch(n){case ei:return e.pos[0]>=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2;case bo:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case ws:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case zr:return e.pos[1]===t.pos[1]?4:2}else if(i===zr)switch(n){case ei:return e.pos[1]===t.pos[1]?4:2;case bo:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case ws:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case zr:return e.pos[0]<=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2}else if(i===bo)switch(n){case ei:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case bo:return e.pos[1]>=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case ws:return e.pos[0]===t.pos[0]?4:2;case zr:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3}else if(i===ws)switch(n){case ei:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case bo:return e.pos[0]===t.pos[0]?4:2;case ws:return e.pos[1]<=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case zr:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3}return 0},Jde=([e,t],n)=>[g1([e,t-1],n),g1([e+1,t],n),g1([e,t+1],n),g1([e-1,t],n)],g1=([e,t],n)=>e<0||e>=n.col||t<0||t>=n.row?null:n.data[t*n.col+e]??null,MU=(e,t)=>{for(let n=0;n<t.col;n++)for(let i=0;i<t.row;i++){const s=g1([n,i],t);if(s&&e[0]===s.pos[0]&&e[1]===s.pos[1])return s}return null},nV=e=>[Math.min(...e.map(t=>t[0])),Math.min(...e.map(t=>t[1])),Math.max(...e.map(t=>t[2])),Math.max(...e.map(t=>t[3]))],J6=(e,t)=>{const n=t.get(e);return n&&si(n)?n:null},El=(e,t,n,i)=>{const s=e[0][0],r=e[0][1];let o=e.map(a=>tg(a,Rn(Me(e[0]),-1)));return(s<-1e6||s>AU||r<-1e6||r>AU||s+o[o.length-1][0]<-1e6||r+o[o.length-1][0]>AU||s+o[o.length-1][1]<-1e6||r+o[o.length-1][1]>AU)&&console.error("Elbow arrow normalization is outside reasonable bounds (> 1e6)",{x:s,y:r,points:o,...sg(o)}),o=o.map(([a,l])=>M(Ke(a,-1e6,1e6),Ke(l,-1e6,1e6))),{points:o,x:Ke(s,-1e6,1e6),y:Ke(r,-1e6,1e6),fixedSegments:((t==null?void 0:t.length)??0)>0?t:null,...sg(o),startIsSpecial:n,endIsSpecial:i}},fT=e=>{if(e.length>1){let t=Math.abs(e[0][1]-e[1][1])<Math.abs(e[0][0]-e[1][0]);return e.filter((n,i)=>{if(i===0||i===e.length-1)return!0;const s=e[i+1],r=Math.abs(n[1]-s[1])<Math.abs(n[0]-s[0]);return t===r?(t=r,!1):(t=r,!0)})}return e},hT=e=>e.length>=4?e.filter((t,n)=>{if(n===0||n===e.length-1)return!0;const i=e[n-1];return Qe(i,t)>cT}):e,eue=e=>{switch(e){case 0:return bo;case 1:return ei;case 2:return ws}return zr},pk=(e,t,n,i,s,r,o)=>o?s&&r?mT(e,s,t,r):i:s?Ss(n||[0,0],s,r??we([s])):i,Uk=(e,t,n,i,s,r)=>oue(e,t,n,n&&qa(n,s,Array(4).fill(o2(n,s,e))),i,s,r),bk=(e,t,n,i)=>Bi(e,n,t,vl(i)),yk=(e,t)=>e[0]===t[0]&&e[1]===t[1],iV=(e,t=cT)=>e.slice(1).map((n,i)=>Math.abs(n[0]-e[i][0])<t||Math.abs(n[1]-e[i][1])<t).every(Boolean),Dn=(e,t,n,i)=>{let s=!1;const{points:r,fixedSegments:o,fileId:a}=n;ve(e)&&(Object.keys(n).length===0||typeof r<"u"||typeof o<"u")?n={...n,angle:0,...Yg({...e,x:n.x||e.x,y:n.y||e.y},t,n,i)}:typeof r<"u"&&(n={...sg(r),...n});for(const l in n){const c=n[l];if(typeof c<"u"){if(e[l]===c&&(typeof c!="object"||c===null||l==="groupIds"||l==="scale"))continue;if(l==="scale"){const d=e[l],u=c;if(d[0]===u[0]&&d[1]===u[1])continue}else if(l==="points"){const d=e[l],u=c;if(d.length===u.length){let f=!1,h=d.length;for(;--h;){const m=d[h],p=u[h];if(m[0]!==p[0]||m[1]!==p[1]){f=!0;break}}if(!f)continue}}e[l]=c,s=!0}}return s&&((typeof n.height<"u"||typeof n.width<"u"||typeof a<"u"||typeof r<"u")&&kn.delete(e),e.version=n.version??e.version+1,e.versionNonce=n.versionNonce??to(),e.updated=Gg()),e},xe=(e,t,n=!1)=>{let i=!1;for(const s in t){const r=t[s];if(typeof r<"u"){if(e[s]===r&&(typeof r!="object"||r===null))continue;i=!0}}return!i&&!n?e:{...e,...t,version:t.version??e.version+1,versionNonce:t.versionNonce??to(),updated:Gg()}},Qo=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=to(),e.updated=Gg(),e),sV=5,fh=5,Zy=10/1.5,sa=(e,t)=>(t.elbowed?fh:sV)+e.strokeWidth/2,vl=e=>{const t=Math.max(sV,15),n=e!=null&&e.value&&e.value<1?e.value:1;return Ke(t/(n*1.5),t,t*2)},tue=e=>!e[$.CTRL_OR_CMD],or=e=>e.isBindingEnabled,gT=(e,t,n,i,s,r,o)=>{const{start:a,end:l}=oV(e,t,n,i,s.getNonDeletedElementsMap(),s.getNonDeletedElements(),r,{...o,finalize:!0});if(Ek(e,a,"start",s),Ek(e,l,"end",s),a.focusPoint||l.focusPoint){const c=new Map;a.focusPoint&&c.set(0,{point:gl(e,"startBinding",e.startBinding,a.element,s.getNonDeletedElementsMap())||e.points[0]}),l.focusPoint&&c.set(e.points.length-1,{point:gl(e,"endBinding",e.endBinding,l.element,s.getNonDeletedElementsMap())||e.points[e.points.length-1]}),ne.movePoints(e,s,c)}return{start:a,end:l}},Ek=(e,{mode:t,element:n,focusPoint:i},s,r)=>{t===null?Cs(e,s,r):t!==void 0&&Rl(e,n,t,s,r,i)},rV=(e,t,n,i,s)=>{Ce(t.size===1,"Bound elbow arrows cannot be moved");const r=t.entries().next().value;Ce(r,"There should be a position update for dragging an elbow arrow endpoint");const[o,{point:a}]=r,l=ne.getPointGlobalCoordinates(e,a,n),c=Bi(l,i,n,vl(s)),d=c?{element:c,mode:"orbit",focusPoint:ne.getPointAtIndexGlobalCoordinates(e,o,n)}:{mode:null},u={mode:void 0};return o===0?{start:d,end:u}:{start:u,end:d}},nue=(e,t,n,i,s,r,o,a,l,c,d)=>{var U,b,y;let u={mode:void 0},f={mode:void 0};const h=e.points.length>2,m=ne.getPointGlobalCoordinates(e,t.get(s?o:a).point,n),p=Bi(m,i,n);if(s)return p?u={element:p,mode:"inside",focusPoint:m}:u={mode:null},{start:u,end:f};if(r){const E=(U=l==null?void 0:l.selectedLinearElement)==null?void 0:U.initialState.origin;if(p&&((b=e.startBinding)==null?void 0:b.elementId)===p.id){const _=M(p.x+p.width/2,p.y+p.height/2);return{start:h?{mode:void 0}:{mode:"inside",element:p,focusPoint:E??_},end:h?{mode:"orbit",element:p,focusPoint:m}:{mode:"inside",element:p,focusPoint:m}}}if(p&&e.startBinding){const _=e.startBinding;if(aT(m,i,n).find(k=>k.id===_.elementId)){const k=n.get(e.startBinding.elementId);return Ce(k,"Other element must be in the elements map"),{start:h?{mode:void 0}:{mode:k.id!==p.id?"orbit":"inside",element:k,focusPoint:E??M(e.x,e.y)},end:{mode:"orbit",element:p,focusPoint:m}}}}if(e.startBinding&&e.startBinding.elementId!==(p==null?void 0:p.id)){const _=n.get(e.startBinding.elementId);Ce(_,"Other element must be in the elements map");const k={mode:!!((y=l.selectedLinearElement)!=null&&y.initialState.arrowStartIsInside)?"inside":"orbit",element:_,focusPoint:d?yi(_,n):E??M(e.x,e.y)},w=p&&eV(_,p,n);let T;if(p){const A=c==="inside"||c==="skip";T={mode:A&&!w?"inside":"orbit",element:p,focusPoint:m}}else T={mode:null};return{start:h?{mode:void 0}:k,end:T}}if(!e.startBinding)return p?f={mode:c==="inside"||c==="skip"?"inside":"orbit",element:p,focusPoint:m}:f={mode:null},{start:u,end:f}}Ce(!1,"New arrow creation should not reach here")},vk=(e,t,n,i,s,r,o,a)=>{let l={mode:void 0},c={mode:void 0};const d=o.points.length>2,u=Bi(e,s,i),f=n?aT(e,s,i).some(U=>U.id===n.elementId):!1,h=n?i.get(n.elementId):null,m=f&&h?ds(h.backgroundColor):!1,p=u&&h&&eV(h,u,i);return r==="inside"||r==="skip"?(l=u?{element:!f||!h||m?u:h,focusPoint:e,mode:"inside"}:{mode:null},c=a&&u&&u.id===(n==null?void 0:n.elementId)?{mode:null}:c,{current:l,other:c}):u?u.id===(t==null?void 0:t.elementId)&&t.mode==="inside"?{current:{mode:"inside",focusPoint:e,element:u},other:c}:n?n.elementId===u.id?n.mode==="orbit"?(l={element:u,mode:"orbit",focusPoint:e},c={mode:a?null:void 0},{current:l,other:d?{mode:void 0}:c}):(l={element:u,mode:"inside",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):(f&&h&&!m?l={element:h,mode:"inside",focusPoint:e}:l={element:u,mode:"orbit",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):(l={element:u,mode:"orbit",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):{current:{mode:null},other:c}},oV=(e,t,n,i,s,r,o,a)=>Ii("COMPLEX_BINDINGS")?iue(e,t,s,r,o,a):aV(e,t,n,i,s,r,o,a),aV=(e,t,n,i,s,r,o,a)=>{var S,D,N,L;const c=e.points.length-1,d=t.has(0),u=t.has(c);let f={mode:void 0},h={mode:void 0};if(Ce(e.points.length>1,"Do not attempt to bind linear elements with a single point"),!d&&!u)return{start:f,end:h};if(d&&u)return{start:{mode:null},end:{mode:null}};if(!or(o))return f=d?{mode:null}:f,h=u?{mode:null}:h,{start:f,end:h};if(ve(e))return rV(e,t,s,r,a==null?void 0:a.zoom);const m=d?e.endBinding:e.startBinding,p=(S=t.get(d?0:c))==null?void 0:S.point;Ce(p,`Local point must be defined for ${d?"start":"end"} dragging`);const U=ne.getPointGlobalCoordinates(e,p,s),b=Bi(U,r,s,vl(o.zoom)),y=b&&(a!=null&&a.angleLocked?wa(M(n,i),b,s):wa(U,b,s)),E=m?s.get(m.elementId):void 0,_=m&&E&&Ss(m.fixedPoint,E,s),I=E&&_&&ol({point:_,element:E,elementsMap:s,threshold:0,overrideShouldTestInside:!0});if(m&&m.elementId===(b==null?void 0:b.id))return Ce(!(a!=null&&a.newArrow)||((D=o.selectedLinearElement)==null?void 0:D.initialState.origin),"appState.selectedLinearElement.initialState.origin must be defined for new arrows"),{start:{mode:"inside",element:b,focusPoint:d?U:a!=null&&a.newArrow?o.selectedLinearElement.initialState.origin:ne.getPointAtIndexGlobalCoordinates(e,0,s)},end:{mode:"inside",element:b,focusPoint:u?U:ne.getPointAtIndexGlobalCoordinates(e,-1,s)}};if(a!=null&&a.altKey)return{start:d?b?{mode:"inside",element:b,focusPoint:U}:{mode:null}:f,end:u?b?{mode:"inside",element:b,focusPoint:U}:{mode:null}:h};const k=b?y?{mode:"inside",element:b,focusPoint:U}:{mode:"orbit",element:b,focusPoint:H0(e,U,b,d?"start":"end",s)||U}:{mode:null},w=ne.getPointAtIndexGlobalCoordinates(e,d?-1:0,s),A=(a!=null&&a.newArrow?(N=o.selectedLinearElement)==null?void 0:N.initialState.arrowStartIsInside:(m==null?void 0:m.mode)==="inside")?{mode:void 0}:E&&!I&&((L=o.selectedLinearElement)!=null&&L.initialState.altFocusPoint)?{mode:"orbit",element:E,focusPoint:o.selectedLinearElement.initialState.altFocusPoint}:a!=null&&a.angleLocked&&E?{mode:"orbit",element:E,focusPoint:H0(e,w,E,d?"end":"start",s)||w}:{mode:void 0};return{start:d?k:A,end:u?k:A}},iue=(e,t,n,i,s,r)=>{var h,m;const o=s.bindMode||"orbit",a=0,l=e.points.length-1,c=t.has(a),d=t.has(l);let u={mode:void 0},f={mode:void 0};if(Ce(e.points.length>1,"Do not attempt to bind linear elements with a single point"),!c&&!d)return{start:u,end:f};if(c&&d)return{start:{mode:null},end:{mode:null}};if(!or(s))return u=c?{mode:null}:u,f=d?{mode:null}:f,{start:u,end:f};if(ve(e))return rV(e,t,n,i);if(r!=null&&r.newArrow){const{start:p,end:U}=nue(e,t,n,i,c,d,a,l,s,o,r==null?void 0:r.shiftKey);return{start:p,end:U}}if(c){const p=(h=t.get(a))==null?void 0:h.point;Ce(p,"Local point must be defined for start dragging");const U=ne.getPointGlobalCoordinates(e,p,n),{current:b,other:y}=vk(U,e.startBinding,e.endBinding,n,i,o,e,r==null?void 0:r.finalize);return{start:b,end:y}}if(d){const p=(m=t.get(l))==null?void 0:m.point;Ce(p,"Local point must be defined for end dragging");const U=ne.getPointGlobalCoordinates(e,p,n),{current:b,other:y}=vk(U,e.endBinding,e.startBinding,n,i,o,e,r==null?void 0:r.finalize);return{start:y,end:b}}return{start:u,end:f}},O4=(e,t,n)=>{e.forEach(i=>{gT(i,new Map,1/0,1/0,t,n)})},Rl=(e,t,n,i,s,r)=>{const o=s.getNonDeletedElementsMap();let a;ve(e)?a={elementId:t.id,mode:"orbit",...F4(e,t,i,o)}:a={elementId:t.id,mode:n,...Nu(e,t,i,o,r)},s.mutateElement(e,{[i==="start"?"startBinding":"endBinding"]:a}),we(t.boundElements||[]).has(e.id)||s.mutateElement(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},Cs=(e,t,n)=>{var o;const i=t==="start"?"startBinding":"endBinding",s=e[i];if(s==null)return null;const r=e[t==="start"?"endBinding":"startBinding"];if(!r||r.elementId!==s.elementId){const a=n.getNonDeletedElementsMap().get(s.elementId);n.mutateElement(a,{boundElements:(o=a.boundElements)==null?void 0:o.filter(l=>l.id!==e.id)})}return n.mutateElement(e,{[i]:null}),s.elementId},pi=(e,t,n)=>{if(!si(e))return;const{simultaneouslyUpdated:i}=n??{},s=rue(i);let r=t.getNonDeletedElementsMap();n!=null&&n.changedElements&&(r=new Map(r),n.changedElements.forEach(o=>{r.set(o.id,o)})),e5(r,e,o=>{if(!Te(o)||o.isDeleted||!sue(o,e))return;const a=o.startBinding?r.get(o.startBinding.elementId):null,l=o.endBinding?(a==null?void 0:a.id)===o.endBinding.elementId?a:r.get(o.endBinding.elementId):null;if(s.has(o.id))return;const c=t5(r,o,(u,f)=>{var h,m;if(u&&si(u)&&(f==="startBinding"||f==="endBinding")&&(e.id===((h=o[f])==null?void 0:h.elementId)||e.id===((m=o[f==="startBinding"?"endBinding":"startBinding"])==null?void 0:m.elementId))){const p=gl(o,f,o[f],u,r);if(p)return[f==="startBinding"?0:o.points.length-1,{point:p}]}return null}).filter(u=>u!==null);ne.movePoints(o,t,new Map(c),{moveMidPointsWithElement:!!a&&(a==null?void 0:a.id)===(l==null?void 0:l.id)});const d=Ne(o,r);d&&!d.isDeleted&&s2(o,t,!1)})},_k=(e,t,n,i,s)=>{var d;Ce(!ve(e),"Elbow arrows not supported for indirect updates");const r=e[t],o=r&&n.get(r.elementId),a=ne.getPointAtIndexGlobalCoordinates(e,t==="startBinding"?0:-1,n),l=o&&ol({element:o,point:a,elementsMap:n,threshold:vl(s.zoom)}),c=t==="startBinding"?"start":"end";if(Cs(e,c,i),l){const u=t==="startBinding"?0:e.points.length-1,f=e.points[u],h=aV(e,new Map([[u,{point:f}]]),a[0],a[1],n,i.getNonDeletedElements(),s);h[c]&&((d=h[c].element)==null?void 0:d.id)===o.id&&h[c].mode&&Rl(e,o,h[c].mode,c,i,h[c].focusPoint)}},V0=(e,t,n,i)=>{if(Te(e)){const s=t.getNonDeletedElementsMap();e.startBinding&&_k(e,"startBinding",s,t,n),e.endBinding&&_k(e,"endBinding",s,t,n)}else pi(e,t,{...i,changedElements:new Map([[e.id,e]])})},sue=(e,t)=>{var n,i;return((n=e.startBinding)==null?void 0:n.elementId)===t.id||((i=e.endBinding)==null?void 0:i.elementId)===t.id},rue=e=>new Set((e||[]).map(t=>t.id)),oue=(e,t,n,i,s,r,o)=>{const a=hg(Me(t,e));return!n||!i?a:aue(s,n,r,o)?lT(n,i,e):hg(Me(e,yi(n,r)))},aue=(e,t,n,i)=>{const s=o2(t,n,e),r=vl(i);return s>r?null:s},mT=(e,t,n,i,s)=>{const r=ve(e),o=ne.getPointAtIndexGlobalCoordinates(e,n==="start"?0:-1,i);if(e.points.length<2)return o;const a=cde(t)&&r?lue(e,t,i,o):o,l=s&&!r?s[1]:ne.getPointAtIndexGlobalCoordinates(e,n==="start"?1:-2,i),c=sa(t,e),d=qa(t,i),u=Kg(d);let f=null;if(r){const h=ia(lT(t,d,o)),m=cue(e,t,i,a),p=M(h?u[0]:m[0],h?m[1]:u[1]),U=s??Pe(p,Xi(Rn(To(Me(m,p)),Math.max(t.width,t.height)*2),p));if(f=So(t,i,U,c).sort(Rm)[0],!f){const b=M(h?m[0]:u[0],h?u[1]:m[1]),y=Pe(b,Xi(Rn(To(Me(m,b)),Math.max(t.width,t.height)*2),b));f=So(t,i,y,fh).sort(Rm)[0]}}else{let h=s;if(!h){const m=Rn(To(Me(a,l)),Qe(a,l)+Math.max(t.width,t.height)+c*2);h=s??Pe(Xi(m,l),Xi(Rn(m,-1),l))}f=Qe(a,l)<1?a:So(t,i,h,c).sort((m,p)=>Rm(m,l)-Rm(p,l))[0]}return!f||Rm(a,f)<Vp?a:f},lue=(e,t,n,i)=>{const s=yi(t,n),r=Z(i,s,-t.angle),o=sa(t,e);return r[0]<t.x&&r[1]<t.y?r[1]-t.y>-o?Z(M(t.x-o,t.y),s,t.angle):Z(M(t.x,t.y-o),s,t.angle):r[0]<t.x&&r[1]>t.y+t.height?r[0]-t.x>-o?Z(M(t.x,t.y+t.height+o),s,t.angle):Z(M(t.x-o,t.y+t.height),s,t.angle):r[0]>t.x+t.width&&r[1]>t.y+t.height?r[0]-t.x<t.width+o?Z(M(t.x+t.width,t.y+t.height+o),s,t.angle):Z(M(t.x+t.width+o,t.y+t.height),s,t.angle):r[0]>t.x+t.width&&r[1]<t.y?r[0]-t.x<t.width+o?Z(M(t.x+t.width,t.y-o),s,t.angle):Z(M(t.x+t.width+o,t.y),s,t.angle):i},cue=(e,t,n,i,s=.05)=>{const{x:r,y:o,width:a,height:l,angle:c}=t,d=yi(t,n,-.1,-.1),u=Z(i,d,-c),f=sa(t,e),h=Ke(s*l,5,80),m=Ke(s*a,5,80);if(Qe(d,u)<f)return i;if(u[0]<=r+a/2&&u[1]>d[1]-h&&u[1]<d[1]+h)return Z(M(r-f,d[1]),d,c);if(u[1]<=o+l/2&&u[0]>d[0]-m&&u[0]<d[0]+m)return Z(M(d[0],o-f),d,c);if(u[0]>=r+a/2&&u[1]>d[1]-h&&u[1]<d[1]+h)return Z(M(r+a+f,d[1]),d,c);if(u[1]>=o+l/2&&u[0]>d[0]-m&&u[0]<d[0]+m)return Z(M(d[0],o+l+f),d,c);if(t.type==="diamond"){const p=f,U=M(r+a/4-p,o+l/4-p),b=M(r+3*a/4+p,o+l/4-p),y=M(r+a/4-p,o+3*l/4+p),E=M(r+3*a/4+p,o+3*l/4+p);if(Qe(U,u)<Math.max(m,h))return Z(U,d,c);if(Qe(b,u)<Math.max(m,h))return Z(b,d,c);if(Qe(y,u)<Math.max(m,h))return Z(y,d,c);if(Qe(E,u)<Math.max(m,h))return Z(E,d,c)}return i},due=(e,t)=>t.width**2+t.height**2-(e.width**2+e.height**2),gl=(e,t,n,i,s,r)=>{if(n==null||n.elementId!==i.id&&e.points.length>2||vr(e.points[e.points.length-1],M(0,0)))return null;const o=Ss(gg(n.fixedPoint),i,s),a=t==="startBinding"?0:e.points.length-1,l=ve(e),c=t==="startBinding"?e.endBinding:e.startBinding,d=c&&s.get(c.elementId),u=Pn(i,s),f=d&&Pn(d,s),h=d&&due(i,d)<(t==="endBinding"?1:0),m=f&&xd(u,f);let p=!1;if(!m&&!l&&e.startBinding&&e.endBinding&&d&&e.points.length===2){const E=Ss(e.startBinding.fixedPoint,t==="startBinding"?i:d,s),_=Ss(e.endBinding.fixedPoint,t==="endBinding"?i:d,s),I=Pe(E,_),k=So(t==="endBinding"?i:d,s,I,0,!0),w=So(t==="startBinding"?i:d,s,I,0,!0);k.length>0&&w.length>0&&(p=Qe(k[0],w[0])<40)}const U=(p||m)&&h;let b=r==null?void 0:r.customIntersector;if(!l&&!b){const[E,_,I,k]=ne.getElementAbsoluteCoords(e,s),w=M((E+I)/2,(_+k)/2),T=o,A=Z(M(e.x+e.points[a===0?1:e.points.length-2][0],e.y+e.points[a===0?1:e.points.length-2][1]),w,e.angle),S=sa(i,e),D=Rn(To(Me(T,A)),Qe(T,A)+Math.max(i.width,i.height)+S*2);b=Pe(Xi(D,A),Xi(Rn(D,-1),A))}const y=n.mode==="orbit"&&i?U?o:mT({...e,points:[a===0?ne.createPointAt(e,s,o[0],o[1],null):e.points[0],...e.points.slice(1,-1),a===e.points.length-1?ne.createPointAt(e,s,o[0],o[1],null):e.points[e.points.length-1]]},i,a===0?"start":"end",s,b):o;return ne.createPointAt(e,s,y[0],y[1],null)},F4=(e,t,n,i)=>{const s=[t.x,t.y,t.x+t.width,t.y+t.height],r=mT(e,t,n,i),o=M(s[0]+(s[2]-s[0])/2,s[1]+(s[3]-s[1])/2),a=Z(r,o,-t.angle);return{fixedPoint:gg([(a[0]-t.x)/t.width,(a[1]-t.y)/t.height])}},Nu=(e,t,n,i,s)=>{const r=s||ne.getPointAtIndexGlobalCoordinates(e,n==="start"?0:-1,i),o=yi(t,i),a=Z(r,o,-t.angle),l=(a[0]-t.x)/t.width,c=(a[1]-t.y)/t.height;return{fixedPoint:gg([l,c])}},uue=(e,t,n)=>{for(const i of e){if("boundElements"in i&&i.boundElements&&Object.assign(i,{boundElements:i.boundElements.reduce((s,r)=>{const o=t.get(r.id);return o&&s.push({...r,id:o}),s},[])}),"containerId"in i&&i.containerId&&Object.assign(i,{containerId:t.get(i.containerId)??null}),"endBinding"in i&&i.endBinding){const s=t.get(i.endBinding.elementId);Object.assign(i,{endBinding:s?{...i.endBinding,elementId:s}:null})}if("startBinding"in i&&i.startBinding){const s=t.get(i.startBinding.elementId);Object.assign(i,{startBinding:s?{...i.startBinding,elementId:s}:null})}ve(i)&&Object.assign(i,Yg(i,n,{points:[i.points[0],i.points[i.points.length-1]]}))}},lV=(e,t)=>{const n=we(e);for(const i of t)hh.unbindAffected(n,i,(s,r)=>Dn(s,n,r)),gh.unbindAffected(n,i,(s,r)=>Dn(s,n,r))},q1=(e,t,n=[])=>{if(!e)return null;const i=e.filter(s=>!t.has(s.id));return i.push(...n.map(s=>({id:s.id,type:s.type}))),i},fue=new Set(["boundElements","frameId","containerId","startBinding","endBinding"]),e5=(e,t,n)=>{var i;si(t)&&(((i=t.boundElements)==null?void 0:i.slice())??[]).forEach(({id:r})=>{n(e.get(r),"boundElements",r)})},t5=(e,t,n)=>{const i=[];if(t.frameId){const s=t.frameId;i.push(n(e.get(s),"frameId",s))}if(Vt(t)){const s=t.containerId;i.push(n(e.get(s),"containerId",s))}if(Te(t)){if(t.startBinding){const s=t.startBinding.elementId;i.push(n(e.get(s),"startBinding",s))}if(t.endBinding){const s=t.endBinding.elementId;i.push(n(e.get(s),"endBinding",s))}}return i};class hh{static unbindAffected(t,n,i){n&&t5(t,n,s=>{!s||s.isDeleted||e5(t,s,(r,o,a)=>{a===n.id&&i(s,{boundElements:q1(s.boundElements,new Set([a]))})})})}}B(hh,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||t5(t,n,(s,r)=>{var o,a;if(!s||s.isDeleted){i(n,{[r]:null});return}r!=="frameId"&&((o=s.boundElements)!=null&&o.find(l=>l.id===n.id)||(Te(n)&&i(s,{boundElements:q1(s.boundElements,new Set,new Array(n))}),he(n)&&((a=s.boundElements)!=null&&a.find(l=>l.type==="text")?i(n,{[r]:null}):i(s,{boundElements:q1(s.boundElements,new Set,new Array(n))}))))})});class gh{static unbindAffected(t,n,i){n&&e5(t,n,s=>{!s||s.isDeleted||t5(t,s,(r,o,a)=>{a===n.id&&i(s,{[o]:null})})})}}B(gh,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||e5(t,n,(s,r,o)=>{var a,l;if(!s||s.isDeleted){i(n,{boundElements:q1(n.boundElements,new Set([o]))});return}he(s)&&(((l=(((a=n.boundElements)==null?void 0:a.slice())??[]).reverse().find(d=>d.type==="text"))==null?void 0:l.id)===s.id?s.containerId!==n.id&&i(s,{containerId:n.id}):(s.containerId!==null&&i(s,{containerId:null}),i(n,{boundElements:q1(n.boundElements,new Set([s.id]))})))})});const Ss=(e,t,n)=>{const[i,s]=gg(e);return Z(M(t.x+t.width*i,t.y+t.height*s),yi(t,n),t.angle)},hue=(e,t)=>{const n=e.startBinding&&t.get(e.startBinding.elementId),i=e.endBinding&&t.get(e.endBinding.elementId),s=n&&e.startBinding?Ss(e.startBinding.fixedPoint,n,t):M(e.x+e.points[0][0],e.y+e.points[0][1]),r=i&&e.endBinding?Ss(e.endBinding.fixedPoint,i,t):M(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]);return[s,r]},gue=(e,t)=>{const[n,i]=hue(e,t);return[ne.pointFromAbsoluteCoords(e,n,t),ne.pointFromAbsoluteCoords(e,i,t)]},gg=e=>e&&(Math.abs(e[0]-.5)<1e-4||Math.abs(e[1]-.5)<1e-4)?e.map(t=>Math.abs(t-.5)<1e-4?.5001:t):e,H3=({points:e})=>{const t=e[0][0],n=e[0][1];return{points:e.map(i=>M(i[0]-t,i[1]-n)),offsetX:t,offsetY:n}},Se=class Se{constructor(t,n,i=!1){B(this,"elementId");B(this,"selectedPointsIndices");B(this,"initialState");B(this,"isDragging");B(this,"lastUncommittedPoint");B(this,"lastCommittedPoint");B(this,"pointerOffset");B(this,"hoverPointIndex");B(this,"segmentMidPointHoveredCoords");B(this,"hoveredFocusPointBinding");B(this,"draggedFocusPointBinding");B(this,"elbowed");B(this,"customLineAngle");B(this,"isEditing");B(this,"pointerDownState");this.elementId=t.id,vr(t.points[0],M(0,0))||(console.error("Linear element is not normalized",Error().stack),Dn(t,n,Se.getNormalizeElementPointsAndCoords(t))),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.lastCommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.initialState={prevSelectedPointsIndices:null,lastClickedPoint:-1,origin:null,segmentMidpoint:{value:null,index:null,added:!1},arrowStartIsInside:!1,altFocusPoint:null},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null,this.hoveredFocusPointBinding=null,this.draggedFocusPointBinding=null,this.elbowed=ve(t)&&t.elbowed,this.customLineAngle=null,this.isEditing=i}static getElement(t,n){const i=n.get(t);return i||null}static handleBoxSelection(t,n,i,s){var p;if(!((p=n.selectedLinearElement)!=null&&p.isEditing)||!n.selectionElement)return!1;const{selectedLinearElement:r}=n,{selectedPointsIndices:o,elementId:a}=r,l=Se.getElement(a,s);if(!l)return!1;const[c,d,u,f]=je(n.selectionElement,s),m=Se.getPointsGlobalCoordinates(l,s).reduce((U,b,y)=>((b[0]>=c&&b[0]<=u&&b[1]>=d&&b[1]<=f||t.shiftKey&&(o!=null&&o.includes(y)))&&U.push(y),U),[]).filter(U=>!(ve(l)&&U!==0&&U!==l.points.length-1));i({selectedLinearElement:{...r,selectedPointsIndices:m.length?m:null}})}static handlePointerMove(t,n,i,s,r){var I,k;const o=n.scene.getNonDeletedElementsMap(),a=n.scene.getNonDeletedElements(),{elementId:l}=r,c=Se.getElement(l,o);Ce(c,"Element being dragged must exist in the scene"),Ce(c.points.length>1,"Element must have at least 2 points");const d=c.points.length-1,u=c.points[d],f=c.points[d-1],h=r.customLineAngle??Tk(f,c.points[d]);let m=0,p=0;if(bc(t)){const[w,T]=Se._getShiftLockedDelta(c,o,f,M(i,s),t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),h),A=M(w+f[0],T+f[1]);m=A[0]-u[0],p=A[1]-u[1]}else{const w=Se.createPointAt(c,o,i-r.pointerOffset.x,s-r.pointerOffset.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize());m=w[0]-u[0],p=w[1]-u[1]}let U=null;const{positions:b,updates:y}=wk([d],m,p,i,s,o,c,a,n,bc(t),t.altKey);if(Se.movePoints(c,n.scene,b,{startBinding:y==null?void 0:y.startBinding,endBinding:y==null?void 0:y.endBinding,moveMidPointsWithElement:y==null?void 0:y.moveMidPointsWithElement}),ln(c,!1)&&or(n.state)&&(U=(y==null?void 0:y.suggestedBinding)??null),ln(c)&&q4(Se.getPointGlobalCoordinates(c,c.points[c.points.length-1],o),c,a,o,n.scene),((I=n.state.selectedLinearElement)==null?void 0:I.customLineAngle)===h&&r.initialState.altFocusPoint&&(!U||ki(n.state.suggestedBinding??[],U)))return null;const E=ln(c)&&c.startBinding&&o.get(c.startBinding.elementId);return{selectedLinearElement:{...r,customLineAngle:h,initialState:{...r.initialState,altFocusPoint:!r.initialState.altFocusPoint&&E&&((k=y==null?void 0:y.suggestedBinding)==null?void 0:k.id)!==E.id?H0(c,M(c.x,c.y),E,"start",o):r.initialState.altFocusPoint}},suggestedBinding:U}}static handlePointDragging(t,n,i,s,r){var z,H;const o=n.scene.getNonDeletedElementsMap(),a=n.scene.getNonDeletedElements(),{elbowed:l,elementId:c,initialState:d}=r,u=Array.from(r.selectedPointsIndices??[]);let{lastClickedPoint:f}=d;const h=Se.getElement(c,o);Ce(h,"Element being dragged must exist in the scene"),Ce(h.points.length>1,"Element must have at least 2 points"),Ce(u,"There must be selected points in order to drag them"),l&&u.some((X,Q)=>X>0&&X!==h.points.length-1?(u[Q]=h.points.length-1,f=h.points.length-1,!0):!1),Ce(f>-1&&u.includes(f)&&h.points[f],`There must be a valid lastClickedPoint in order to drag it. selectedPointsIndices(${JSON.stringify(u)}) points(0..${h.points.length-1}) lastClickedPoint(${f})`);const m=h.points[f],p=h.points[f===0?1:f-1],U=u.length===1,b=r.customLineAngle??Tk(p,h.points[f]),y=u.includes(0),E=u.includes(h.points.length-1);let _=0,I=0;if(bc(t)&&U){const[X,Q]=Se._getShiftLockedDelta(h,o,p,M(i,s),t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),b),re=M(X+p[0],Q+p[1]);_=re[0]-m[0],I=re[1]-m[1]}else{const X=Se.createPointAt(h,o,i-r.pointerOffset.x,s-r.pointerOffset.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize());_=X[0]-m[0],I=X[1]-m[1]}let k=null;const{positions:w,updates:T}=wk(u,_,I,i,s,o,h,a,n,bc(t)&&U,t.altKey);Se.movePoints(h,n.scene,w,{startBinding:T==null?void 0:T.startBinding,endBinding:T==null?void 0:T.endBinding,moveMidPointsWithElement:T==null?void 0:T.moveMidPointsWithElement}),ln(h,!1)&&or(n.state)&&(y||E)&&(k=(T==null?void 0:T.suggestedBinding)??null),ln(h)&&y!==E&&q4(Se.getPointGlobalCoordinates(h,y?h.points[0]:h.points[h.points.length-1],o),h,a,o,n.scene),Ne(h,o)&&s2(h,n.scene,!1);const S=l?E?[h.points.length-1]:[0]:u,D=l?S[0]:f,N=!y&&!E?Se.getPointGlobalCoordinates(h,m,o):null,L=D,j=ln(h)&&h.startBinding&&o.get(h.startBinding.elementId),Y=ln(h)&&h.endBinding&&o.get(h.endBinding.elementId),G=E&&j&&((z=T==null?void 0:T.suggestedBinding)==null?void 0:z.id)!==j.id?j:y&&Y&&((H=T==null?void 0:T.suggestedBinding)==null?void 0:H.id)!==Y.id?Y:null;return{selectedLinearElement:{...r,selectedPointsIndices:S,initialState:{...r.initialState,lastClickedPoint:D,altFocusPoint:!r.initialState.altFocusPoint&&ln(h)&&G?H0(h,M(h.x,h.y),G,"start",o):r.initialState.altFocusPoint},segmentMidPointHoveredCoords:N,hoverPointIndex:L,isDragging:!0,customLineAngle:b},suggestedBinding:k}}static handlePointerUp(t,n,i,s){var u;const r=s.getNonDeletedElementsMap(),{elementId:o,selectedPointsIndices:a,isDragging:l,initialState:c}=n,d=Se.getElement(o,r);if(!d)return n;if(l&&a)for(const f of a)(f===0||f===d.points.length-1)&&Ea(d.points,i.zoom.value)&&(cn(d)&&s.mutateElement(d,{...ST(d,!0)},{informMutation:!1,isDragging:!1}),Se.movePoints(d,s,new Map([[f,{point:f===0?d.points[d.points.length-1]:d.points[0]}]])));return{...n,segmentMidPointHoveredCoords:null,hoverPointIndex:-1,selectedPointsIndices:l||t.shiftKey?!l&&t.shiftKey&&((u=c.prevSelectedPointsIndices)!=null&&u.includes(c.lastClickedPoint))?a&&a.filter(f=>f!==c.lastClickedPoint):a:a!=null&&a.includes(c.lastClickedPoint)?[c.lastClickedPoint]:a,isDragging:!1,customLineAngle:null,initialState:{...n.initialState,origin:null,arrowStartIsInside:!1}}}static isSegmentTooShort(t,n,i,s,r){if(ve(t))return s>=0&&s<t.points.length?Qe(n,i)*r.value<Se.POINT_HANDLE_SIZE/2:!1;let o=Qe(n,i);if(t.points.length>2&&t.roundness){const[a,l]=Z6(t);Ce(a.length===0&&l.length>0,"Only linears built out of curves are supported"),Ce(a.length+l.length>=s,"Invalid segment index while calculating mid point"),o=T9(l[s])}return o*r.value<Se.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(t,n){if(ve(t)){Ce(t.points.length>=n,"Invalid segment index while calculating elbow arrow mid point");const r=x6(t.points[n-1],t.points[n]);return M(t.x+r[0],t.y+r[1])}const[i,s]=Z6(t);if(Ce(i.length===0&&s.length>0||i.length>0&&s.length===0,"Only linears built out of either segments or curves are supported"),Ce(i.length+s.length>=n,"Invalid segment index while calculating mid point"),i.length){const r=i[n-1];return x6(r[0],r[1])}if(s.length){const r=s[n-1];return kne(r,.5)}Ce(!1,"Invalid segment type while calculating mid point")}static getSegmentMidPointIndex(t,n,i,s){const r=Se.getElement(t.elementId,s);if(!r)return-1;const o=Se.getEditorMidPoints(r,s,n);let a=0;for(;a<o.length;){if(Se.arePointsEqual(i,o[a]))return a+1;a++}return-1}static handlePointerDown(t,n,i,s,r,o){var T,A;const a=n.state,l=o.getNonDeletedElementsMap(),c={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!r)return c;const{elementId:d}=r,u=Se.getElement(d,l);if(!u)return c;const f=Se.getSegmentMidpointHitCoords(r,s,a,l),h=M(s.x,s.y);let m=null;if(f)m=Se.getSegmentMidPointIndex(r,a,f,l);else if(t.altKey&&((T=a.selectedLinearElement)!=null&&T.isEditing))return r.lastUncommittedPoint==null&&(o.mutateElement(u,{points:[...u.points,Se.createPointAt(u,l,s.x,s.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize())]}),c.didAddPoint=!0),i.scheduleCapture(),c.linearElementEditor={...r,initialState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:-1,origin:h,segmentMidpoint:{value:f,index:m,added:!1},arrowStartIsInside:!!n.state.newElement&&(n.state.bindMode==="inside"||n.state.bindMode==="skip"),altFocusPoint:null},selectedPointsIndices:[u.points.length-1],lastUncommittedPoint:null},c.didAddPoint=!0,c;const p=Se.getPointIndexUnderCursor(u,l,a.zoom,s.x,s.y);(p>=0||f)&&(c.hitElement=u);const[U,b,y,E]=je(u,l),_=(U+y)/2,I=(b+E)/2,k=p>-1&&Z(M(u.x+u.points[p][0],u.y+u.points[p][1]),M(_,I),u.angle),w=p>-1||t.shiftKey?t.shiftKey||(A=r.selectedPointsIndices)!=null&&A.includes(p)?mue([...r.selectedPointsIndices||[],p]):[p]:null;return c.linearElementEditor={...r,initialState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:p,origin:h,segmentMidpoint:{value:f,index:m,added:!1},arrowStartIsInside:!!n.state.newElement&&(n.state.bindMode==="inside"||n.state.bindMode==="skip"),altFocusPoint:null},selectedPointsIndices:w,pointerOffset:k?{x:s.x-k[0],y:s.y-k[1]}:{x:0,y:0}},c}static arePointsEqual(t,n){return!t&&!n?!0:!t||!n?!1:vr(t,n)}static handlePointerMoveInEditMode(t,n,i,s){var h,m;const r=s.state;if(!((h=r.selectedLinearElement)!=null&&h.isEditing))return null;const{elementId:o,lastUncommittedPoint:a}=r.selectedLinearElement,l=s.scene.getNonDeletedElementsMap(),c=Se.getElement(o,l);if(!c)return r.selectedLinearElement;const{points:d}=c,u=d[d.length-1];if(!t.altKey)return u===a&&Se.deletePoints(c,s,[d.length-1]),(m=r.selectedLinearElement)!=null&&m.lastUncommittedPoint?{...r.selectedLinearElement,lastUncommittedPoint:null}:r.selectedLinearElement;let f;if(bc(t)&&d.length>=2){const p=d[d.length-2],[U,b]=Se._getShiftLockedDelta(c,l,p,M(n,i),t[$.CTRL_OR_CMD]?null:s.getEffectiveGridSize());f=M(U+p[0],b+p[1])}else f=Se.createPointAt(c,l,n-r.selectedLinearElement.pointerOffset.x,i-r.selectedLinearElement.pointerOffset.y,t[$.CTRL_OR_CMD]||ve(c)?null:s.getEffectiveGridSize());return u===a?Se.movePoints(c,s.scene,new Map([[c.points.length-1,{point:f}]])):Se.addPoints(c,s.scene,[f]),{...r.selectedLinearElement,lastUncommittedPoint:c.points[c.points.length-1]}}static getPointGlobalCoordinates(t,n,i){const[s,r,o,a]=je(t,i),l=(s+o)/2,c=(r+a)/2,{x:d,y:u}=t;return Z(M(d+n[0],u+n[1]),M(l,c),t.angle)}static getPointsGlobalCoordinates(t,n){const[i,s,r,o]=je(t,n),a=(i+r)/2,l=(s+o)/2;return t.points.map(c=>{const{x:d,y:u}=t;return Z(M(d+c[0],u+c[1]),M(a,l),t.angle)})}static getPointAtIndexGlobalCoordinates(t,n,i){const s=n<0?t.points.length+n:n,[,,,,r,o]=je(t,i),a=M(r,o),l=t.points[s],{x:c,y:d}=t;return Z(l?M(c+l[0],d+l[1]):M(c,d),a,t.angle)}static pointFromAbsoluteCoords(t,n,i){if(ve(t))return M(n[0]-t.x,n[1]-t.y);const[s,r,o,a]=je(t,i),l=(s+o)/2,c=(r+a)/2,[d,u]=Z(M(n[0],n[1]),M(l,c),-t.angle);return M(d-t.x,u-t.y)}static getPointIndexUnderCursor(t,n,i,s,r){const o=Se.getPointsGlobalCoordinates(t,n);let a=o.length;for(;--a>-1;){const l=o[a];if(Qe(M(s,r),M(l[0],l[1]))*i.value<Se.POINT_HANDLE_SIZE+1)return a}return-1}static createPointAt(t,n,i,s,r){const o=ci(i,s,r),[a,l,c,d]=je(t,n),u=(a+c)/2,f=(l+d)/2,[h,m]=Z(M(o[0],o[1]),M(u,f),-t.angle);return M(h-t.x,m-t.y)}static getNormalizeElementPointsAndCoords(t){const{points:n,offsetX:i,offsetY:s}=H3(t);return{points:n,x:t.x+i,y:t.y+s}}static duplicateSelectedPoints(t,n){var f;Ce((f=t.selectedLinearElement)==null?void 0:f.isEditing,"Not currently editing a linear element");const i=n.getNonDeletedElementsMap(),{selectedPointsIndices:s,elementId:r}=t.selectedLinearElement,o=Se.getElement(r,i);Ce(o,"The linear element does not exist in the provided Scene"),Ce(s!=null,"There are no selected points to duplicate");const{points:a}=o,l=[];let c=!1,d=-1;const u=a.reduce((h,m,p)=>{if(++d,h.push(m),s.includes(p)){const b=a[p+1];b||(c=!0),h.push(b?M((m[0]+b[0])/2,(m[1]+b[1])/2):M(m[0],m[1])),l.push(d+1),++d}return h},[]);if(n.mutateElement(o,{points:u}),c){const h=o.points[o.points.length-1];Se.movePoints(o,n,new Map([[o.points.length-1,{point:M(h[0]+30,h[1]+30)}]]))}return{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:l}}}static deletePoints(t,n,i){var d,u;const s=((d=n.state.selectedLinearElement)==null?void 0:d.isEditing)&&((u=n.state.selectedLinearElement)==null?void 0:u.lastUncommittedPoint)===t.points[t.points.length-1],r=t.points.filter((f,h)=>!i.includes(h));cn(t)&&t.polygon&&(s||i.includes(0)||i.includes(t.points.length-1))&&(r[0]=M(r[r.length-1][0],r[r.length-1][1]));const{points:a,offsetX:l,offsetY:c}=H3({points:r});Se._updatePoints(t,n.scene,a,l,c)}static addPoints(t,n,i){const s=[...t.points,...i];cn(t)&&t.polygon&&(s[0]=M(s[s.length-1][0],s[s.length-1][1]));const{points:r,offsetX:o,offsetY:a}=H3({points:s});Se._updatePoints(t,n,r,o,a)}static movePoints(t,n,i,s){var d,u,f;const{points:r}=t;if(cn(t)&&t.polygon){const h=i.get(0),m=i.get(r.length-1);h?i.set(r.length-1,{point:M(h.point[0],h.point[1]),isDragging:h.isDragging}):m&&i.set(0,{point:M(m.point[0],m.point[1]),isDragging:m.isDragging})}const o=((d=i.get(0))==null?void 0:d.point)??M(0,0),[a,l]=o,c=ve(t)?[((u=i.get(0))==null?void 0:u.point)??r[0],((f=i.get(r.length-1))==null?void 0:f.point)??r[r.length-1]]:r.map((h,m)=>{var U;const p=((U=i.get(m))==null?void 0:U.point)??h;return s!=null&&s.moveMidPointsWithElement&&m!==0&&m!==r.length-1&&!i.has(m)?p:M(p[0]-a,p[1]-l)});Se._updatePoints(t,n,c,a,l,s,{isDragging:Array.from(i.values()).some(h=>h.isDragging)})}static shouldAddMidpoint(t,n,i,s){var c;const r=Se.getElement(t.elementId,s);if(r&&ve(r)||!r)return!1;const{segmentMidpoint:o}=t.initialState;if(o.added||o.value===null||o.index===null||t.initialState.origin===null)return!1;const a=t.initialState.origin,l=Qe(a,M(n.x,n.y));return!(!((c=i.selectedLinearElement)!=null&&c.isEditing)&&l<O0/i.zoom.value)}static addMidpoint(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=Se.getElement(t.elementId,o);if(!a)return;const{segmentMidpoint:l}=t.initialState,c={pointerDownState:t.initialState,selectedPointsIndices:t.selectedPointsIndices},d=Se.createPointAt(a,o,n.x,n.y,s&&!ve(a)?i.getEffectiveGridSize():null),u=[...a.points.slice(0,l.index),d,...a.points.slice(l.index)];return r.mutateElement(a,{points:u}),c.pointerDownState={...t.initialState,segmentMidpoint:{...t.initialState.segmentMidpoint,added:!0},lastClickedPoint:l.index},c.selectedPointsIndices=[l.index],c}static _updatePoints(t,n,i,s,r,o,a){if(ve(t)){const l={};(o==null?void 0:o.startBinding)!==void 0&&(l.startBinding=o.startBinding),(o==null?void 0:o.endBinding)!==void 0&&(l.endBinding=o.endBinding),l.points=Array.from(i),n.mutateElement(t,l,{informMutation:!0,isDragging:(a==null?void 0:a.isDragging)??!1})}else{const l=Bk(t,i),c=Bk(t,t.points),d=(l[0]+l[2])/2,u=(l[1]+l[3])/2,f=(c[0]+c[2])/2,h=(c[1]+c[3])/2,m=f-d,p=h-u,U=Z(M(s,r),M(m,p),t.angle);n.mutateElement(t,{...o,points:i,x:t.x+U[0],y:t.y+U[1]})}}static _getShiftLockedDelta(t,n,i,s,r,o){const a=Se.getPointGlobalCoordinates(t,i,n);if(ve(t))return[s[0]-a[0],s[1]-a[1]];const[l,c]=ci(s[0],s[1],r),{width:d,height:u}=rfe(a[0],a[1],l,c,o);return Z(M(d,u),M(0,0),-t.angle)}static moveFixedSegment(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=Se.getElement(t.elementId,o);if(!a||!ve(a))return t;if(n&&n>0&&n<a.points.length){const l=ia(hg(Me(a.points[n],a.points[n-1]))),c=(a.fixedSegments??[]).reduce((h,m)=>(h[m.index]=m,h),{});c[n]={index:n,start:M(l?a.points[n-1][0]:i-a.x,l?s-a.y:a.points[n-1][1]),end:M(l?a.points[n][0]:i-a.x,l?s-a.y:a.points[n][1])};const d=Object.values(c).sort((h,m)=>h.index-m.index),u=d.map(h=>h.index).reduce((h,m)=>m<n?h+1:h,0);r.mutateElement(a,{fixedSegments:d});const f=M(a.x+(a.fixedSegments[u].start[0]+a.fixedSegments[u].end[0])/2,a.y+(a.fixedSegments[u].start[1]+a.fixedSegments[u].end[1])/2);return{...t,segmentMidPointHoveredCoords:f,initialState:{...t.initialState,segmentMidpoint:{added:!1,index:a.fixedSegments[u].index,value:f}}}}return t}static deleteFixedSegment(t,n,i){var s;n.mutateElement(t,{fixedSegments:(s=t.fixedSegments)==null?void 0:s.filter(r=>r.index!==i)})}};B(Se,"POINT_HANDLE_SIZE",10),B(Se,"getEditorMidPoints",(t,n,i)=>{var l;const s=Ne(t,n);if(!ve(t)&&!((l=i.selectedLinearElement)!=null&&l.isEditing)&&t.points.length>2&&!s)return[];const r=Se.getPointsGlobalCoordinates(t,n);let o=0;const a=[];for(;o<r.length-1;){if(Se.isSegmentTooShort(t,t.points[o],t.points[o+1],o,i.zoom)){a.push(null),o++;continue}const c=Se.getSegmentMidPoint(t,o+1);a.push(c),o++}return a}),B(Se,"getSegmentMidpointHitCoords",(t,n,i,s)=>{var h;const{elementId:r}=t,o=Se.getElement(r,s);if(!o)return null;const a=Se.getPointIndexUnderCursor(o,s,i.zoom,n.x,n.y);if(!ve(o)&&a>=0||Se.getPointsGlobalCoordinates(o,s).length>=3&&!((h=i.selectedLinearElement)!=null&&h.isEditing)&&!ve(o))return null;const c=(Se.POINT_HANDLE_SIZE+1)/i.zoom.value,d=t.segmentMidPointHoveredCoords;if(d&&Qe(M(d[0],d[1]),M(n.x,n.y))<=c)return d;let u=0;const f=Se.getEditorMidPoints(o,s,i);for(;u<f.length;){if(f[u]!==null&&Qe(f[u],M(n.x,n.y))<=c)return f[u];u++}return null}),B(Se,"getBoundTextElementPosition",(t,n,i)=>{Se.getPointsGlobalCoordinates(t,i).length<2&&Dn(n,i,{isDeleted:!0});let r=0,o=0;if(t.points.length%2===1){const a=Math.floor(t.points.length/2),l=Se.getPointGlobalCoordinates(t,t.points[a],i);r=l[0]-n.width/2,o=l[1]-n.height/2}else{const a=t.points.length/2-1,l=Se.getSegmentMidPoint(t,a+1);r=l[0]-n.width/2,o=l[1]-n.height/2}return{x:r,y:o}}),B(Se,"getMinMaxXYWithBoundText",(t,n,i,s)=>{let[r,o,a,l]=i;const c=(r+a)/2,d=(o+l)/2,{x:u,y:f}=Se.getBoundTextElementPosition(t,s,n),h=u+s.width,m=f+s.height,p=M(c,d),U=Z(M(r,o),p,t.angle),b=Z(M(a,o),p,t.angle),y=Z(M(u,f),p,-t.angle),E=Z(M(h,f),p,-t.angle),_=Z(M(u,m),p,-t.angle),I=Z(M(h,m),p,-t.angle);return U[0]<b[0]&&U[1]>=b[1]?(r=Math.min(r,_[0]),a=Math.max(a,Math.max(E[0],I[0])),o=Math.min(o,y[1]),l=Math.max(l,I[1])):U[0]>=b[0]&&U[1]>b[1]?(r=Math.min(r,I[0]),a=Math.max(a,Math.max(y[0],E[0])),o=Math.min(o,_[1]),l=Math.max(l,E[1])):U[0]>=b[0]?(r=Math.min(r,E[0]),a=Math.max(a,_[0]),o=Math.min(o,I[1]),l=Math.max(l,y[1])):U[1]<=b[1]&&(r=Math.min(r,Math.min(E[0],y[0])),a=Math.max(a,I[0]),o=Math.min(o,E[1]),l=Math.max(l,_[1])),[r,o,a,l,c,d]}),B(Se,"getElementAbsoluteCoords",(t,n,i=!1)=>{const s=kn.generateElementShape(t,null),r=rf(s[0]),[o,a,l,c]=nE(r),d=o+t.x,u=a+t.y,f=l+t.x,h=c+t.y,m=(d+f)/2,p=(u+h)/2,U=i&&Ne(t,n);return U?Se.getMinMaxXYWithBoundText(t,n,[d,u,f,h],U):[d,u,f,h,m,p]});let ne=Se;const mue=e=>{let t=[...new Set(e.filter(n=>n!==null&&n!==-1))];return t=t.sort((n,i)=>n-i),t.length?t:null},wk=(e,t,n,i,s,r,o,a,l,c,d)=>{const u=new Map(e.map(G=>[G,{point:M(o.points[G][0]+t,o.points[G][1]+n),isDragging:!0}]));if(!Te(o))return{positions:u};const f=e.includes(0),h=e.includes(o.points.length-1),{start:m,end:p}=oV(o,u,i,s,r,a,l.state,{newArrow:!!l.state.newElement,angleLocked:c,altKey:d});if(ve(o))return{positions:u,updates:{suggestedBinding:f?m.element:h?p.element:null}};if(!f&&!h){const G={...o,points:o.points.map((z,H)=>{var X;return((X=u.get(H))==null?void 0:X.point)??z})},O=new Map(u);if(o.startBinding){const z=r.get(o.startBinding.elementId);if(z){const H=gl(G,"startBinding",o.startBinding,z,r)??null;H&&O.set(0,{point:H,isDragging:!0})}}if(o.endBinding){const z=r.get(o.endBinding.elementId);if(z){const H=gl(G,"endBinding",o.endBinding,z,r)??null;H&&O.set(o.points.length-1,{point:H,isDragging:!0})}}return{positions:O}}if(f===h)return{positions:u};const U={suggestedBinding:null};m.mode===null?U.startBinding=null:m.mode?(U.startBinding={elementId:m.element.id,mode:m.mode,...Nu(o,m.element,"start",r,m.focusPoint)},f&&(U.startBinding.mode==="orbit"||!Ii("COMPLEX_BINDINGS"))&&(U.suggestedBinding=m.element)):f&&(U.suggestedBinding=l.state.suggestedBinding),p.mode===null?U.endBinding=null:p.mode?(U.endBinding={elementId:p.element.id,mode:p.mode,...Nu(o,p.element,"end",r,p.focusPoint)},h&&(U.endBinding.mode==="orbit"||!Ii("COMPLEX_BINDINGS"))&&(U.suggestedBinding=p.element)):h&&(U.suggestedBinding=l.state.suggestedBinding);const b=f?M(o.points[0][0]+t,o.points[0][1]+n):o.points[0],y=h?M(o.points[o.points.length-1][0]+t,o.points[o.points.length-1][1]+n):o.points[o.points.length-1],E={...o,points:[b,...o.points.slice(1,-1),y],startBinding:U.startBinding===void 0?o.startBinding:U.startBinding===null?null:U.startBinding,endBinding:U.endBinding===void 0?o.endBinding:U.endBinding===null?null:U.endBinding},_=m.focusPoint&&p.focusPoint?Pe(m.focusPoint,p.focusPoint):void 0,I=m.focusPoint&&p.focusPoint?Pe(p.focusPoint,m.focusPoint):void 0,k=o.endBinding&&E.startBinding&&f&&E.startBinding.elementId===o.endBinding.elementId,w=o.startBinding&&E.endBinding&&h&&o.startBinding.elementId===E.endBinding.elementId,T=E.endBinding?p.element??r.get(E.endBinding.elementId):null,A=k?E.points[E.points.length-1]:w&&l.state.bindMode!=="inside"&&Ii("COMPLEX_BINDINGS")?E.points[0]:T&&gl(o,"endBinding",E.endBinding,T,r,{customIntersector:I})||E.points[E.points.length-1];E.points[E.points.length-1]=A;const S=E.startBinding?m.element??r.get(E.startBinding.elementId):null,D=w&&Ii("COMPLEX_BINDINGS")?E.points[0]:k&&l.state.bindMode!=="inside"&&Ii("COMPLEX_BINDINGS")?A:S&&gl(o,"startBinding",E.startBinding,S,r,{customIntersector:_})||E.points[0],N=!k&&!(w&&l.state.bindMode!=="inside"&&Ii("COMPLEX_BINDINGS"))&&!!T,L=Qe(D,E.points[0])!==0,j=new Set(e);S&&L&&j.add(0),T&&N&&j.add(o.points.length-1);const Y=Array.from(j);return{updates:U,positions:new Map(Y.map(G=>[G,G===0?{point:D,isDragging:!0}:G===o.points.length-1?{point:A,isDragging:!0}:u.get(G)]))}},Tk=(e,t)=>Math.atan2(t[1]-e[1],t[0]-e[0]);function Ik(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function pue(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}const Uue=1e-6;function Sk(e,t){const n=Me(e[1],e[0]),i=Me(t,e[0]),s=qn(n,i);return Math.abs(s)<Uue}function V3(e,t){const n=Me(e[1],e[0]),i=Me(t,e[0]);return qn(n,i)<0}function Ck(e,t){return Sk(e,t[0])||Sk(e,t[1])||(V3(e,t[0])?!V3(e,t[1]):V3(e,t[1]))}function bue(e,t){return pue(Ik(e),Ik(t))&&Ck(e,t)&&Ck(t,e)}const yue=e=>e.type==="diamond"?[M(e.width/2,0),M(e.width,e.height/2),M(e.width/2,e.height),M(0,e.height/2)]:[M(0,0),M(0+e.width,0),M(0+e.width,e.height),M(0,e.height)],Eue=e=>De(e)||us(e)?e.points:yue(e),xk=e=>{const t=e.reduce((n,[i,s])=>(n.minY=Math.min(n.minY,s),n.minX=Math.min(n.minX,i),n.maxX=Math.max(n.maxX,i),n.maxY=Math.max(n.maxY,s),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},vue=e=>{const t=Eue(e),{cx:n,cy:i}=xk(t),s=M(n,i),r=t.map(d=>Z(d,s,e.angle)),{minX:o,minY:a,maxX:l,maxY:c}=xk(r);return[o+e.x,a+e.y,l+e.x,c+e.y]},_ue=(e,t)=>{const n=vue(e);return(gU(n[0],is(t[0],t[2]))||gU(t[0],is(n[0],n[2])))&&(gU(n[1],is(t[1],t[3]))||gU(t[1],is(n[1],n[3])))},wue=({elements:e,bounds:t,type:n,errorMargin:i=0})=>{var o;zH(t)&&(t=Pn(t,we(e)));const s=[t[0]-i,t[1]-i,t[2]+i,t[3]+i],r=new Set;for(const a of e){if(r.has(a.id))continue;if(_ue(a,s)){if(r.add(a.id),a.boundElements)for(const c of a.boundElements)r.add(c.id);he(a)&&a.containerId&&r.add(a.containerId),Te(a)&&(a.startBinding&&r.add(a.startBinding.elementId),a.endBinding&&r.add((o=a.endBinding)==null?void 0:o.elementId))}}return e.filter(a=>r.has(a.id))},cV=(e,t,n)=>{const i=n.reduce((s,r)=>(r.groupIds.includes(e)&&(s[r.id]=!0),s),{});return Object.keys(i).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...i}}},Fi=function(){let e=null,t=null,n=null;const i=(r,o,a,l)=>{if(n!==void 0&&o===t&&r===e&&a.editingGroupId===(n==null?void 0:n.editingGroupId))return n;const c={};for(const f of r){let h=f.groupIds;if(a.editingGroupId){const m=h.indexOf(a.editingGroupId);m>-1&&(h=h.slice(0,m))}if(h.length>0){const m=h[h.length-1];c[m]=!0}}const d={},u=o.reduce((f,h)=>{if(h.isDeleted)return f;const m=h.groupIds.find(p=>c[p]);return m&&(f[h.id]=!0,Array.isArray(d[m])?d[m].push(h.id):d[m]=[h.id]),f},{});for(const f of Object.keys(d))d[f].length<2&&c[f]&&(c[f]=!1);return t=o,e=r,n={editingGroupId:a.editingGroupId,selectedGroupIds:c,selectedElementIds:It({...a.selectedElementIds,...u},l)},n},s=(r,o,a,l)=>{const c=l?l.scene.getSelectedElements({selectedElementIds:r.selectedElementIds,elements:o}):Ze(o,r);return c.length?i(c,o,r,a):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:It(r.selectedElementIds,a)}};return s.clearCache=()=>{t=null,e=null,n=null},s}(),pT=(e,t)=>dV(e,t)!=null,dV=(e,t)=>t.groupIds.filter(n=>n!==e.editingGroupId).find(n=>e.selectedGroupIds[n]),zc=e=>Object.entries(e.selectedGroupIds).filter(([t,n])=>n).map(([t,n])=>t),a2=(e,t)=>{let n={...t,selectedGroupIds:{}};for(const i of e){let s=i.groupIds;if(t.editingGroupId){const r=s.indexOf(t.editingGroupId);r>-1&&(s=s.slice(0,r))}if(s.length>0){const r=s[s.length-1];n={...n,...cV(r,n,e)}}}return n.selectedGroupIds},Tue=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),$0=(e,t)=>e.groupIds.includes(t),Ot=(e,t)=>{const n=[];for(const i of e.values())$0(i,t)&&n.push(i);return n},uV=(e,t)=>e.groupIds.find(n=>t[n]),Iue=(e,t,n)=>{const i=[...e],s=n?i.indexOf(n):-1,r=s>-1?s:i.length;return i.splice(r,0,t),i},Sue=(e,t)=>e.filter(n=>!t[n]),fV=(e,t)=>{const n=new Map;return e.forEach(i=>{const s=i.groupIds.length===0?i.id:i.groupIds[i.groupIds.length-1],r=n.get(s)||[],o=Ne(i,t);o&&r.push(o),n.set(s,[...r,i])}),Array.from(n.values())},Cue=e=>{const t=new Set;for(const[,n]of e)if(!n.isDeleted)for(const i of n.groupIds??[])t.add(i);return t},UT=e=>{const t=e.flatMap(s=>s.groupIds),n=new Map;let i=0;for(const s of t)n.set(s,(n.get(s)??0)+1),n.get(s)>i&&(i=n.get(s));return i===e.length},mg=e=>e.groupIds.length>0,xue=(e,t,n)=>{const i=[...e],s=t?e.indexOf(t):-1,r=s>-1?s:e.length;for(let o=0;o<r;o++)i[o]=n(i[o]);return i},qy=(e,t,n)=>{const i=zc(n),s=e.filter(u=>!Vt(u)),r=new Map,o=new Map,a=u=>{const f=o.get(u.id)||[],h=Ne(u,t);h&&f.push(h),o.set(u.id,[...f,u])},l=(u,f)=>{const h=r.get(f)||[],m=Ne(u,t);m&&h.push(m),r.set(f,[...h,u])},c=(u,f)=>{const h=u.groupIds.indexOf(f,0);return u.groupIds.slice(0,h).length>0?l(u,u.groupIds[h-1]):a(u)},d=e.every(u=>pT(n,u));return s.forEach(u=>{const f=uV(u,n.selectedGroupIds);f?i.length===1&&d?c(u,f):l(u,f):a(u)}),Array.from(r.values()).concat(Array.from(o.values()))},bT=e=>{const t=new Set;return e.forEach(n=>{_e(n)&&t.add(n.id)}),e.filter(n=>!(n.frameId&&t.has(n.frameId)))},yT=(e,t,n,i=!0)=>{const[s,r,o,a]=je(t,n);let l=e.filter(c=>{let[d,u,f,h]=Pn(c,n);const m=Vs(c,n);if(m){const[p,U,b,y]=Pn(m,n);d=Math.max(p,d),u=Math.max(U,u),f=Math.min(b,f),h=Math.min(y,h)}return c.locked===!1&&c.type!=="selection"&&!Vt(c)&&s<=d&&r<=u&&o>=f&&a>=h});return l=i?bT(l):l,l=l.filter(c=>{const d=Vs(c,n);return d?ad(c,d,n):!0}),l},hV=(e,t,n,i)=>{const s=new Set(t.map(r=>r.id));return e.filter(r=>{const o=d5(r,n.width,n.height,n,i);return!s.has(r.id)&&o})},oi=function(){let e=null,t=null,n=null;const i=(s,r)=>(n!=null&&s===e&&r.selectedElementIds===t||(n=s.some(o=>r.selectedElementIds[o.id]),e=s,t=r.selectedElementIds),n);return i.clearCache=()=>{e=null,t=null,n=null},i}(),Ze=(e,t,n)=>{const i=new Set,s=[];for(const r of e.values()){if(t.selectedElementIds[r.id]){s.push(r),i.add(r.id);continue}if(n!=null&&n.includeBoundTextElement&&Vt(r)&&t.selectedElementIds[r==null?void 0:r.containerId]){s.push(r),i.add(r.id);continue}}if(n!=null&&n.includeElementsInFrames){const r=[];return s.forEach(o=>{_e(o)&&br(e,o.id).forEach(a=>!i.has(a.id)&&r.push(a)),r.push(o)}),r}return s},Qy=(e,t)=>t.editingTextElement?[t.editingTextElement]:t.newElement?[t.newElement]:Ze(e,t,{includeBoundTextElement:!0}),It=(e,t)=>ki(t.selectedElementIds,e)?t.selectedElementIds:e,Aue=(e,t)=>{var i;const n=e.filter(De);if(n.length===1){const s=n[0],r=((i=s.boundElements)==null?void 0:i.map(a=>a.id))??[];if(e.every(a=>a.id===s.id||r.includes(a.id)))return new ne(s,we(t))}return null},gV=(e,t,n)=>({selectedLinearElement:Aue(e,t),...Fi({editingGroupId:n.editingGroupId,selectedElementIds:bT(e).reduce((i,s)=>(Vt(s)||(i[s.id]=!0),i),{})},t,n,null)}),Mue=(e,t,n)=>{const i=we(e);for(const s of t)if(s.frameId){const r=n.get(s.id),o=n.get(s.frameId),a=r&&i.get(r);a&&Dn(a,i,{frameId:o??null})}};function ET(e,t,n){const i=c5(t,n),s=c5(e,n);return i.some(o=>s.some(a=>bue(o,a)))}const mV=(e,t,n)=>eE(yT(e,t,n,!1)).filter(i=>!_e(i)&&!i.frameId||i.frameId===t.id),vT=(e,t,n)=>yT([t],e,n).some(i=>i.id===t.id),l2=(e,t,n)=>{const[i,s,r,o]=je(t,n),[a,l,c,d]=Et(e);return i<=a&&s<=l&&r>=c&&o>=d},ad=(e,t,n)=>l2([e],t,n)||ET(e,t,n)||vT(e,t,n),Ak=(e,t,n)=>{const[i,s,r,o]=je(t,n);return P0(M(i,s),M(e.x,e.y),M(r,o))},kue=e=>{const t=new Map;for(const n of e){const i=_e(n)?n.id:n.frameId;i&&!t.has(i)&&t.set(i,br(e,i))}return t},br=(e,t)=>{const n=[];for(const i of e.values())i.frameId===t&&n.push(i);return n},_T=e=>e.filter(t=>_e(t)),wT=e=>{const t=we(_T(e));return e.filter(n=>t.has(n.id)||!n.frameId||!t.has(n.frameId))},ha=(e,t,n,i)=>{const s=br(e,t.id),r=new Set(s),o=new Set([...mV(e,t,i),...s.filter(f=>vT(f,t,i))]),a=s.filter(f=>!o.has(f)),l=new Set(Array.from(o).flatMap(f=>f.groupIds));for(const f of a)if(!ET(f,t,i))f.groupIds.length===0&&r.delete(f);else if(f.groupIds.length>0)for(const h of f.groupIds)l.add(h);for(const f of a)if(f.groupIds.length>0){let h=!0;for(const m of f.groupIds)l.has(m)&&(h=!1);h&&r.delete(f)}const c=Array.from(o).filter(f=>f.groupIds.length===0);for(const f of c)r.add(f);const d=Array.from(o).filter(f=>f.groupIds.length>0),u=a2(d,n);for(const[f,h]of Object.entries(u))if(h){const m=Ot(e,f);if(l2(m,t,i))for(const p of m)r.add(p)}return[...r].filter(f=>!(he(f)&&f.containerId))},Rue=(e,t,n)=>Due(eE(e,mV(e,t,n)),t,n),Due=(e,t,n)=>{const i=[],s=new Map;for(const r of e){let o=!1;if(r.groupIds.length>0){if(r.groupIds.some(a=>s.get(a)))o=!0;else{const a=new Set(r.groupIds.flatMap(l=>Ot(n,l)));o=!l2(Array.from(a),t,n)}r.groupIds.forEach(a=>{s.set(a,o)})}o||i.push(r)}return i},Vs=(e,t)=>e.frameId&&t.get(e.frameId)||null,Lue=(e,t)=>{const n=new Set,i=we(e);e=eE(e);for(const o of e)_e(o)&&o.id!==t.id&&n.add(o.id);const s=new Set,r=[];for(const o of e)if(!(_e(o)||o.frameId&&n.has(o.frameId)))if(o.groupIds.length){const a=o.groupIds.at(-1);if(!s.has(a)){s.add(a);const l=Ot(e,a);if(l.some(c=>ad(c,t,i)))for(const c of l)r.push(c)}}else ad(o,t,i)&&r.push(o);return r},Q1=(e,t,n,i)=>{const s=we(e),r=new Map;for(const c of e.values())c.frameId===n.id&&r.set(c.id,!0);const o=new Set(t.map(c=>c.id)),a=[],l=new Set;for(const c of t)_e(c)&&c.id!==n.id&&l.add(c.id);for(const c of eE(e,t)){if(_e(c)||c.frameId&&l.has(c.frameId)||c.frameId&&i.selectedElementIds[c.id]&&i.selectedElementIds[c.frameId])continue;r.has(c.id)||a.push(c);const d=Ne(c,s);d&&!o.has(d.id)&&!r.has(d.id)&&a.push(d)}for(const c of a)Dn(c,s,{frameId:n.id});return e},Jy=(e,t)=>{const n=new Map,i=new Map;for(const s of e)if(s.frameId){n.set(s.id,s);const r=i.get(s.frameId)||[];r.push(s);const o=Ne(s,t);o&&(n.set(o.id,o),r.push(o)),i.set(s.frameId,r)}for(const[,s]of n)Dn(s,t,{frameId:null})},pV=(e,t)=>{const n=br(e,t.id);return Jy(n,we(e)),e},Wg=(e,t,n,i)=>Q1(pV(e,n),t,n,i.state).slice(),pg=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),s=new Set(i);if(t.editingGroupId)for(const a of i)a.groupIds.length===0?s.add(a):a.groupIds.flatMap(l=>Ot(e,l)).forEach(l=>s.add(l));const r=new Set,o=we(e);return s.forEach(a=>{a.frameId&&!_e(a)&&!i5(a,o,t)&&r.add(a)}),r.size>0&&Jy(r,o),e},eE=(e,t)=>{const n=new Set,i=t||e;for(const o of i.values()){const a=o.groupIds[o.groupIds.length-1];a&&n.add(a)}const s=new Set;for(const o of n)Ot(e,o).some(a=>_e(a))&&s.add(o);const r=[];for(const o of i.values())s.has(o.groupIds[o.groupIds.length-1])||r.push(o);return r},n5=(e,t,n)=>{const i=he(e)&&Gn(e,t)||e;return i.frameId&&n.selectedElementIds[i.id]&&n.selectedElementIds[i.frameId]?Vs(i,t):n.selectedElementIds[i.id]&&n.selectedElementsAreBeingDragged?n.frameToHighlight:Vs(i,t)},i5=(e,t,n,i)=>{var l;const s=(i==null?void 0:i.targetFrame)??n5(e,t,n);if(!s)return!1;const r=he(e)&&Gn(e,t)||e,o=c=>{i!=null&&i.checkedGroups&&r.groupIds.forEach(d=>{var u;(u=i.checkedGroups)==null||u.set(d,c)})};if(!n.selectedElementIds[r.id]||!n.selectedElementsAreBeingDragged||n.selectedElementIds[r.id]&&n.selectedElementIds[s.id])return!0;if(r.groupIds.length===0)return ad(r,s,t);for(const c of r.groupIds)if((l=i==null?void 0:i.checkedGroups)!=null&&l.has(c))return i.checkedGroups.get(c);const a=new Set(r.groupIds.filter(c=>i!=null&&i.checkedGroups?!i.checkedGroups.has(c):!0).flatMap(c=>Ot(t,c)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){const c=new Set(Ze(t,n));if(n.frameToHighlight!==null)return!0;c.forEach(u=>{a.delete(u)})}for(const c of a)if(_e(c))return o(!1),!1;for(const c of a)if(ad(c,s,t))return o(!0),!0;return!1},B4=(e,t,n,i,s)=>{if(!n.frameRendering||!n.frameRendering.clip)return!1;const r=ET(e,t,i)||vT(e,t,i);if(r){for(const o of e.groupIds)s==null||s.set(o,!0);return!0}if(!r&&e.groupIds.length>0&&!l2([e],t,i)){let o=!1;if(n.selectedElementsAreBeingDragged)o=i5(e,i,n,{targetFrame:t,checkedGroups:s});else{o=e.frameId===t.id;for(const a of e.groupIds)s==null||s.set(a,o)}for(const a of e.groupIds)s==null||s.set(a,o);return o}return!1},Pue="Frame",Nue="AI Frame",TT=e=>OH(e)?Pue:Nue,UV=e=>e.name===null?TT(e):e.name,IT=(e,t)=>wue({elements:e,bounds:t,type:"overlap"}).filter(n=>!n.frameId||n.frameId===t.id),bV=e=>{const t=we(e);return e.length>1&&e.some(n=>n.frameId&&t.has(n.frameId))},Oue=(e,t)=>Jn(e)&&!t.imageCache.has(e.fileId),tE=e=>{switch(e.type){case"freedraw":return e.strokeWidth*12;case"text":return e.fontSize/2;case"arrow":return e.endArrowhead||e.endArrowhead?40:20;default:return 20}},yV=(e,t,n,i,s=1)=>{let r=((t==null?void 0:t.opacity)??100)*e.opacity/1e4*s;return(n.has(e.id)||i&&i.some(o=>o.id===e.id)||t&&n.has(t.id))&&(r*=pie/100),r},Fue=(e,t,n)=>{const r=tE(e),[o,a,l,c]=je(e,t),d=De(e)||us(e)?rs(o,l):e.width,u=De(e)||us(e)?rs(a,c):e.height;let f=d*window.devicePixelRatio+r*2,h=u*window.devicePixelRatio+r*2,m=n.value;return(f*m>32767||h*m>32767)&&(m=Math.min(32767/f,32767/h)),f*h*m*m>16777216&&(m=Math.sqrt(16777216/(f*h))),f=Math.floor(f*m),h=Math.floor(h*m),{width:f,height:h,scale:m}},EV=(e,t,n,i,s)=>{var b,y;const r=document.createElement("canvas"),o=r.getContext("2d"),a=tE(e),{width:l,height:c,scale:d}=Fue(e,t,n);if(!l||!c)return null;r.width=l,r.height=c;let u=-100,f=0;if(De(e)||us(e)){const[E,_]=je(e,t);u=e.x>E?rs(e.x,E)*window.devicePixelRatio*d:0,f=e.y>_?rs(e.y,_)*window.devicePixelRatio*d:0,o.translate(u,f)}o.save(),o.translate(a*d,a*d),o.scale(window.devicePixelRatio*d,window.devicePixelRatio*d);const h=Id.canvas(r);Sb(e,h,o,i),o.restore();const m=Ne(e,t),p=document.createElement("canvas"),U=p.getContext("2d");if(Te(e)&&m){const[E,_,I,k]=je(e,t),w=Math.max(rs(E,I),rs(_,k));p.width=w*window.devicePixelRatio*d+a*d*10,p.height=w*window.devicePixelRatio*d+a*d*10,U.translate(p.width/2,p.height/2),U.rotate(e.angle),U.drawImage(r,-r.width/2,-r.height/2,r.width,r.height);const[,,,,T,A]=je(m,t);U.rotate(-e.angle);const S=(p.width-r.width)/2,D=(p.height-r.height)/2,N=p.width/2-(T-E)*window.devicePixelRatio*d-S-a*d,L=p.height/2-(A-_)*window.devicePixelRatio*d-D-a*d;U.translate(-N,-L),U.clearRect(-(m.width/2+ti)*window.devicePixelRatio*d,-(m.height/2+ti)*window.devicePixelRatio*d,(m.width+ti*2)*window.devicePixelRatio*d,(m.height+ti*2)*window.devicePixelRatio*d)}return{element:e,canvas:r,theme:s.theme,scale:d,zoomValue:n.value,canvasOffsetX:u,canvasOffsetY:f,boundTextElementVersion:((b=Ne(e,t))==null?void 0:b.version)||null,containingFrameOpacity:((y=Vs(e,t))==null?void 0:y.opacity)||100,boundTextCanvas:p,angle:e.angle,imageCrop:xt(e)?e.crop:null}},vV=typeof document<"u"?document.createElement("img"):{src:""};vV.src=`data:${Ee.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;const _V=typeof document<"u"?document.createElement("img"):{src:""};_V.src=`data:${Ee.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;const Bue=(e,t,n)=>{t.fillStyle=n===be.DARK?"#2E2E2E":"#E7E7E7",t.fillRect(0,0,e.width,e.height);const i=Math.min(e.width,e.height),s=Math.min(i,Math.min(i*.4,100));t.drawImage(e.status==="error"?_V:vV,e.width/2-s/2,e.height/2-s/2,s,s)},Sb=(e,t,n,i)=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",t.draw(kn.generateElementShape(e,i));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",kn.generateElementShape(e,i).forEach(s=>{t.draw(s)});break}case"freedraw":{n.save();const s=kn.generateElementShape(e,i);for(const r of s)typeof r=="string"?(n.fillStyle=i.theme===be.DARK?Yi(e.strokeColor):e.strokeColor,n.fill(new Path2D(r))):t.draw(r);n.restore();break}case"image":{n.save();const s=e.fileId!==null?i.imageCache.get(e.fileId):null,r=Jn(e)?s==null?void 0:s.image:void 0;if(r!=null&&!(r instanceof Promise)){e.roundness&&n.roundRect&&(n.beginPath(),n.roundRect(0,0,e.width,e.height,fa(Math.min(e.width,e.height),e)),n.clip());const{x:o,y:a,width:l,height:c}=e.crop?e.crop:{x:0,y:0,width:r.naturalWidth,height:r.naturalHeight},d=i.theme===be.DARK&&(s==null?void 0:s.mimeType)===Ee.svg;if(d&&Cz){const u=window.devicePixelRatio||1,f=document.createElement("canvas");f.width=e.width*u,f.height=e.height*u;const h=f.getContext("2d");if(h){h.scale(u,u),h.drawImage(r,o,a,l,c,0,0,e.width,e.height);const m=h.getImageData(0,0,f.width,f.height),p=m.data;for(let U=0;U<p.length;U+=4)p[U]=255-p[U],p[U+1]=255-p[U+1],p[U+2]=255-p[U+2];h.putImageData(m,0,0),n.drawImage(f,0,0,f.width,f.height,0,0,e.width,e.height)}}else d&&(n.filter=gz),n.drawImage(r,o,a,l,c,0,0,e.width,e.height)}else Bue(e,n,i.theme);n.restore();break}default:if(he(e)){const s=Rz(e.text),r=s&&!n.canvas.isConnected;r&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",s?"rtl":"ltr"),n.save(),n.font=_t(e),n.fillStyle=i.theme===be.DARK?Yi(e.strokeColor):e.strokeColor,n.textAlign=e.textAlign;const o=e.text.replace(/\r\n?/g,`
`).split(`
`),a=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,l=n2(e.fontSize,e.lineHeight),c=_z(e.fontFamily,e.fontSize,l);for(let d=0;d<o.length;d++)n.fillText(o[d],a,d*l+c);n.restore(),r&&n.canvas.remove()}else throw new Error(`Unimplemented type ${e.type}`)}},s5=new WeakMap,Mk=(e,t,n,i)=>{var u;const s=n?i.zoom:{value:1},r=s5.get(e),o=r&&r.zoomValue!==s.value&&!(i!=null&&i.shouldCacheIgnoreZoom),a=Ne(e,t),l=(a==null?void 0:a.version)||null,c=xt(e)?e.crop:null,d=((u=Vs(e,t))==null?void 0:u.opacity)||100;if(!r||o||r.theme!==i.theme||r.boundTextElementVersion!==l||r.imageCrop!==c||r.containingFrameOpacity!==d||Te(e)&&a&&e.angle!==r.angle){const f=EV(e,t,s,n,i);return f?(s5.set(e,f),f):null}return r},$3=(e,t,n,i,s)=>{const r=e.element,o=tE(r),a=e.scale,[l,c,d,u]=je(r,s),f=((l+d)/2+i.scrollX)*window.devicePixelRatio,h=((c+u)/2+i.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);const m=Ne(r,s);if(Te(r)&&m){const p=(e.boundTextCanvas.width-e.canvas.width)/2,U=(e.boundTextCanvas.height-e.canvas.height)/2;t.translate(f,h),t.drawImage(e.boundTextCanvas,-(d-l)/2*window.devicePixelRatio-p/a-o,-(u-c)/2*window.devicePixelRatio-U/a-o,e.boundTextCanvas.width/a,e.boundTextCanvas.height/a)}else t.translate(f,h),t.rotate(r.angle),"scale"in e.element&&!Oue(r,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-f,-h),t.drawImage(e.canvas,(l+i.scrollX)*window.devicePixelRatio-o*e.scale/e.scale,(c+i.scrollY)*window.devicePixelRatio-o*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale);t.restore()},zue=(e,t,n,i)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";const s=.5/n.zoom.value;t.fillRect(s,s,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(s,s,e.width,e.height),t.restore()},jd=(e,t,n,i,s,r,o)=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="elementLinkSelector"&&!o.selectedElementIds[e.id]&&!o.hoveredElementIds[e.id];switch(s.globalAlpha=yV(e,Vs(e,t),r.elementsPendingErasure,r.pendingFlowchartNodes,a?vz:1),e.type){case"magicframe":case"frame":{o.frameRendering.enabled&&o.frameRendering.outline&&(s.save(),s.translate(e.x+o.scrollX,e.y+o.scrollY),s.fillStyle="rgba(0, 0, 200, 0.04)",s.lineWidth=rt.strokeWidth/o.zoom.value,s.strokeStyle=o.theme===be.DARK?Yi(rt.strokeColor):rt.strokeColor,Ib(e)&&(s.strokeStyle=o.theme===be.LIGHT?"#7affd7":Yi("#1d8264")),s.roundRect?(s.beginPath(),s.roundRect(0,0,e.width,e.height,rt.radius/o.zoom.value),s.stroke(),s.closePath()):s.strokeRect(0,0,e.width,e.height),s.restore());break}case"freedraw":{if(r.isExporting){const[c,d,u,f]=je(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY,p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);s.save(),s.translate(h,m),s.rotate(e.angle),s.translate(-p,-U),Sb(e,i,s,r),s.restore()}else{const c=Mk(e,n,r,o);if(!c)return;$3(c,s,r,o,n)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(r.isExporting){const[c,d,u,f]=je(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY;let p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);if(he(e)){const y=Gn(e,t);if(Te(y)){const E=ne.getBoundTextElementPosition(y,e,t);p=(u-c)/2-(E.x-c),U=(f-d)/2-(E.y-d)}}s.save(),s.translate(h,m);const b=Ne(e,t);if(Te(e)&&b){const y=document.createElement("canvas"),E=y.getContext("2d"),_=Math.max(rs(c,u),rs(d,f)),I=tE(e);y.width=_*o.exportScale+I*10*o.exportScale,y.height=_*o.exportScale+I*10*o.exportScale,E.translate(y.width/2,y.height/2),E.scale(o.exportScale,o.exportScale),p=e.width/2-(e.x-c),U=e.height/2-(e.y-d),E.rotate(e.angle);const k=Id.canvas(y);E.translate(-p,-U),Sb(e,k,E,r),E.translate(p,U),E.rotate(-e.angle);const[,,,,w,T]=je(b,t),A=(c+u)/2-w,S=(d+f)/2-T;E.translate(-A,-S),E.clearRect(-b.width/2,-b.height/2,b.width,b.height),s.scale(1/o.exportScale,1/o.exportScale),s.drawImage(y,-y.width/2,-y.height/2,y.width,y.height)}else s.rotate(e.angle),e.type==="image"&&s.scale(e.scale[0],e.scale[1]),s.translate(-p,-U),Sb(e,i,s,r);s.restore()}else{const c=Mk(e,n,r,o);if(!c)return;const d=s.imageSmoothingEnabled;if(!(o!=null&&o.shouldCacheIgnoreZoom)&&(!e.angle||_ne(e.angle))&&(s.imageSmoothingEnabled=!1),e.id===o.croppingElementId&&xt(c.element)&&c.element.crop!==null){s.save(),s.globalAlpha=.1;const u=EV(ide(c.element,t),n,o.zoom,r,o);u&&$3(u,s,r,o,n),s.restore()}$3(c,s,r,o,n),s.imageSmoothingEnabled=d}break}default:throw new Error(`Unimplemented type ${e.type}`)}s.globalAlpha=1};function Hue(e,t,n){const i=Pn({...e,angle:0},n),s=M((i[0]+i[2])/2,(i[1]+i[3])/2);return Ce(t.length>=2,"Freepath outline must have at least 2 points"),t.slice(2).reduce((r,o)=>(r.push(Pe(r[r.length-1][1],Z(M(o[0]+e.x,o[1]+e.y),s,e.angle))),r),[Pe(Z(M(t[0][0]+e.x,t[0][1]+e.y),s,e.angle),Z(M(t[1][0]+e.x,t[1][1]+e.y),s,e.angle))])}const ld=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="line"||e==="freedraw",z4=e=>e==="rectangle"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line"||e==="text"||e==="embeddable",r5=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line",o5=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="arrow"||e==="line",G0=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="line"||e==="diamond"||e==="image",a5=e=>e==="arrow",l5=e=>e==="arrow",Ls=class Ls{};B(Ls,"rg",new dg),B(Ls,"cache",new WeakMap),B(Ls,"get",(t,n)=>{const i=Ls.cache.get(t);if(i&&(n===null||i.theme===n))return i.shape}),B(Ls,"delete",t=>{Ls.cache.delete(t),s5.delete(t)}),B(Ls,"destroy",()=>{Ls.cache=new WeakMap}),B(Ls,"generateElementShape",(t,n)=>{const i=n!=null&&n.isExporting?void 0:Ls.get(t,n?n.theme:null);if(i!==void 0)return i;s5.delete(t);const s=Xue(t,Ls.rg,n||{isExporting:!1,canvasBackgroundColor:Je.white,embedsValidationStatus:null,theme:be.LIGHT});return n!=null&&n.isExporting||Ls.cache.set(t,{shape:s,theme:(n==null?void 0:n.theme)||be.LIGHT}),s});let kn=Ls;const Vue=e=>[8,8+e],wV=e=>[1.5,6+e];function $ue(e){const t=e.roughness,n=Math.max(e.width,e.height),i=Math.min(e.width,e.height);return i>=20&&n>=50||i>=15&&e.roundness&&G0(e.type)||De(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}const nr=(e,t=!1,n=!1)=>{const i={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?Vue(e.strokeWidth):e.strokeStyle==="dotted"?wV(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:$ue(e),stroke:n?Yi(e.strokeColor):e.strokeColor,preserveVertices:t||e.roughness<bz.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return i.fillStyle=e.fillStyle,i.fill=ds(e.backgroundColor)?void 0:n?Yi(e.backgroundColor):e.backgroundColor,e.type==="ellipse"&&(i.curveFitting=1),i;case"line":case"freedraw":return Ea(e.points)&&(i.fillStyle=e.fillStyle,i.fill=e.backgroundColor==="transparent"?void 0:n?Yi(e.backgroundColor):e.backgroundColor),i;case"arrow":return i;default:throw new Error(`Unimplemented type ${e.type}`)}},kk=(e,t,n)=>Br(e)&&(t||Es(e)&&(n==null?void 0:n.get(e.id))!==!0)&&ds(e.backgroundColor)&&ds(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:uc(e)?{...e,strokeColor:ds(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:ds(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,Rk=(e,t,n,i,s,r,o,a)=>{const l=Fk(e,t,n,i);if(l===null)return[];const c=(u,f)=>{if(u===null)return[];const[,,h,m,p,U]=u;return[s.line(h,m,p,U,f)]},d=a?Yi(e.strokeColor):e.strokeColor;switch(i){case"dot":case"circle":case"circle_outline":{const[u,f,h]=l;return delete r.strokeLineDash,[s.circle(u,f,h,{...r,fill:i==="circle_outline"?o:d,fillStyle:"solid",stroke:d,roughness:Math.min(.5,r.roughness||0)})]}case"triangle":case"triangle_outline":{const[u,f,h,m,p,U]=l;return delete r.strokeLineDash,[s.polygon([[u,f],[h,m],[p,U],[u,f]],{...r,fill:i==="triangle_outline"?o:d,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"diamond":case"diamond_outline":{const[u,f,h,m,p,U,b,y]=l;return delete r.strokeLineDash,[s.polygon([[u,f],[h,m],[p,U],[b,y],[u,f]],{...r,fill:i==="diamond_outline"?o:d,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"crowfoot_one":return c(l,r);case"bar":case"arrow":case"crowfoot_many":case"crowfoot_one_or_many":default:{const[u,f,h,m,p,U]=l;if(e.strokeStyle==="dotted"){const b=wV(e.strokeWidth-1);r.strokeLineDash=[b[0],b[1]-1]}else delete r.strokeLineDash;return r.roughness=Math.min(1,r.roughness||0),[s.line(h,m,u,f,r),s.line(p,U,u,f,r),...i==="crowfoot_one_or_many"?c(Fk(e,t,n,"crowfoot_one"),r):[]]}}},Gue=e=>{const t=new dg,n={seed:e.seed,disableMultiStroke:!0,disableMultiStrokeFill:!0,roughness:0,preserveVertices:!0},i=Kg(e.points.reduce((s,r)=>[Math.min(e.x+r[0],s[0]),Math.min(e.y+r[1],s[1]),Math.max(e.x+r[0],s[2]),Math.max(e.y+r[1],s[3])],[1/0,1/0,-1/0,-1/0]));switch(e.type){case"line":case"arrow":{const s=e.points.length?e.points:[M(0,0)];return ve(e)?t.path(TV(s,16),n).sets[0].ops:e.roundness?t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=Z(M(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:M(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Z(M(e.x+r.data[0],e.y+r.data[1]),i,e.angle),Z(M(e.x+r.data[2],e.y+r.data[3]),i,e.angle),Z(M(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>M(a[0]-e.x,a[1]-e.y)).flat()}}):s.map((r,o)=>{const a=Z(M(e.x+r[0],e.y+r[1]),i,e.angle);return{op:o===0?"move":"lineTo",data:M(a[0]-e.x,a[1]-e.y)}})}case"freedraw":{if(e.points.length<2)return[];const s=J9(e.points,.75);return t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=Z(M(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:M(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Z(M(e.x+r.data[0],e.y+r.data[1]),i,e.angle),Z(M(e.x+r.data[2],e.y+r.data[3]),i,e.angle),Z(M(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>M(a[0]-e.x,a[1]-e.y)).flat()}})}}},Xue=(e,t,{isExporting:n,canvasBackgroundColor:i,embedsValidationStatus:s,theme:r})=>{const o=r===be.DARK;switch(e.type){case"rectangle":case"iframe":case"embeddable":{let a;if(e.roundness){const l=e.width,c=e.height,d=fa(Math.min(l,c),e);a=t.path(`M ${d} 0 L ${l-d} 0 Q ${l} 0, ${l} ${d} L ${l} ${c-d} Q ${l} ${c}, ${l-d} ${c} L ${d} ${c} Q 0 ${c}, 0 ${c-d} L 0 ${d} Q 0 0, ${d} 0`,nr(kk(e,n,s),!0,o))}else a=t.rectangle(0,0,e.width,e.height,nr(kk(e,n,s),!1,o));return a}case"diamond":{let a;const[l,c,d,u,f,h,m,p]=CT(e);if(e.roundness){const U=fa(Math.abs(l-m),e),b=fa(Math.abs(u-c),e);a=t.path(`M ${l+U} ${c+b} L ${d-U} ${u-b}
            C ${d} ${u}, ${d} ${u}, ${d-U} ${u+b}
            L ${f+U} ${h-b}
            C ${f} ${h}, ${f} ${h}, ${f-U} ${h-b}
            L ${m+U} ${p+b}
            C ${m} ${p}, ${m} ${p}, ${m+U} ${p-b}
            L ${l-U} ${c+b}
            C ${l} ${c}, ${l} ${c}, ${l+U} ${c+b}`,nr(e,!0,o))}else a=t.polygon([[l,c],[d,u],[f,h],[m,p]],nr(e,!1,o));return a}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,nr(e,!1,o));case"line":case"arrow":{let a;const l=nr(e,!1,o),c=e.points.length?e.points:[M(0,0)];if(ve(e)?c.every(d=>Math.abs(d[0])<=1e6&&Math.abs(d[1])<=1e6)?a=[t.path(TV(c,16),nr(e,!0,o))]:(console.error("Elbow arrow with extreme point positions detected. Arrow not rendered.",e.id,JSON.stringify(c)),a=[]):e.roundness?a=[t.curve(c,l)]:l.fill?a=[t.polygon(c,l)]:a=[t.linearPath(c,l)],e.type==="arrow"){const{startArrowhead:d=null,endArrowhead:u="arrow"}=e;if(d!==null){const f=Rk(e,a,"start",d,t,l,i,o);a.push(...f)}if(u!==null){const f=Rk(e,a,"end",u,t,l,i,o);a.push(...f)}}return a}case"freedraw":{const a=[];if(Ea(e.points)){const l=J9(e.points,.75);a.push(t.curve(l,{...nr(e,!1,o),stroke:"none"}))}return a.push(Yue(e)),a}case"frame":case"magicframe":case"text":case"image":return null;default:return Ua(e,`generateElementShape(): Unimplemented type ${e==null?void 0:e.type}`),null}},TV=(e,t)=>{const n=[];for(let s=1;s<e.length-1;s+=1){const r=e[s-1],o=e[s+1],a=e[s],l=al(a,r),c=al(o,a),d=Math.min(t,Qe(e[s],o)/2,Qe(e[s],r)/2);l?r[0]<a[0]?n.push([e[s][0]-d,e[s][1]]):n.push([e[s][0]+d,e[s][1]]):r[1]<a[1]?n.push([e[s][0],e[s][1]-d]):n.push([e[s][0],e[s][1]+d]),n.push(e[s]),c?o[0]<a[0]?n.push([e[s][0]-d,e[s][1]]):n.push([e[s][0]+d,e[s][1]]):o[1]<a[1]?n.push([e[s][0],e[s][1]-d]):n.push([e[s][0],e[s][1]+d])}const i=[`M ${e[0][0]} ${e[0][1]}`];for(let s=0;s<n.length;s+=3)i.push(`L ${n[s][0]} ${n[s][1]}`),i.push(`Q ${n[s+1][0]} ${n[s+1][1]}, ${n[s+2][0]} ${n[s+2][1]}`);return i.push(`L ${e[e.length-1][0]} ${e[e.length-1][1]}`),i.join(" ")},jue=(e,t)=>{switch(e.type){case"rectangle":case"diamond":case"frame":case"magicframe":case"embeddable":case"image":case"iframe":case"text":case"selection":return Bce(e);case"arrow":case"line":{const n=kn.generateElementShape(e,null)[0],[,,,,i,s]=je(e,t);return Q6(e)?Gce(e,n,M(e.x,e.y),e.angle,M(i,s)):Hce(n,M(e.x,e.y),e.angle,M(i,s))}case"ellipse":return zce(e);case"freedraw":{const[,,,,n,i]=je(e,t);return $ce(e,M(n,i),Q6(e))}}},ST=(e,t)=>{const n=[...e.points];if(t){if(!$H(e.points))return null;const s=n[0],r=n[n.length-1];Math.hypot(s[0]-r[0],s[1]-r[1])>bie||n.length<4?n.push(M(s[0],s[1])):n[n.length-1]=M(s[0],s[1])}return{polygon:t,points:n}},Yue=e=>Kue(IV(e)),IV=e=>{const t=e.simulatePressure?e.points:e.points.length?e.points.map(([n,i],s)=>[n,i,e.pressures[s]]):[[0,0,.5]];return ede(t,{simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:n=>Math.sin(n*Math.PI/2),last:!0})},Dk=(e,t)=>[(e[0]+t[0])/2,(e[1]+t[1])/2],Wue=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g,Kue=e=>{if(!e.length)return"";const t=e.length-1;return e.reduce((n,i,s,r)=>(s===t?n.push(i,Dk(i,r[0]),"L",r[0],"Z"):n.push(i,Dk(i,r[s+1])),n),["M",e[0],"Q"]).join(" ").replace(Wue,"$1")},jo=class jo{static getBounds(t,n,i=!1){const s=i&&t.angle!==0?jo.nonRotatedBoundsCache.get(t):jo.boundsCache.get(t);if(s!=null&&s.version&&s.version===t.version&&!Vt(t))return s.bounds;if(i&&t.angle!==0){const o=jo.calculateBounds({...t,angle:0},n);return jo.nonRotatedBoundsCache.set(t,{version:t.version,bounds:o}),o}const r=jo.calculateBounds(t,n);return jo.boundsCache.set(t,{version:t.version,bounds:r}),r}static calculateBounds(t,n){let i;const[s,r,o,a,l,c]=je(t,n);if(us(t)){const[d,u,f,h]=AT(t.points.map(([m,p])=>Z(M(m,p),M(l-t.x,c-t.y),t.angle)));return[d+t.x,u+t.y,f+t.x,h+t.y]}else if(De(t))i=nfe(t,l,c,n);else if(t.type==="diamond"){const[d,u]=Z(M(l,r),M(l,c),t.angle),[f,h]=Z(M(l,a),M(l,c),t.angle),[m,p]=Z(M(s,c),M(l,c),t.angle),[U,b]=Z(M(o,c),M(l,c),t.angle),y=Math.min(d,f,m,U),E=Math.min(u,h,p,b),_=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,E,_,I]}else if(t.type==="ellipse"){const d=(o-s)/2,u=(a-r)/2,f=Math.cos(t.angle),h=Math.sin(t.angle),m=Math.hypot(d*f,u*h),p=Math.hypot(u*f,d*h);i=[l-m,c-p,l+m,c+p]}else{const[d,u]=Z(M(s,r),M(l,c),t.angle),[f,h]=Z(M(s,a),M(l,c),t.angle),[m,p]=Z(M(o,a),M(l,c),t.angle),[U,b]=Z(M(o,r),M(l,c),t.angle),y=Math.min(d,f,m,U),E=Math.min(u,h,p,b),_=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,E,_,I]}return i}};B(jo,"boundsCache",new WeakMap),B(jo,"nonRotatedBoundsCache",new WeakMap);let H4=jo;const je=(e,t,n=!1)=>{if(us(e))return Que(e);if(De(e))return ne.getElementAbsoluteCoords(e,t,n);if(he(e)){const i=t?Gn(e,t):null;if(Te(i)){const{x:s,y:r}=ne.getBoundTextElementPosition(i,e,t);return[s,r,s+e.width,r+e.height,s+e.width/2,r+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},c5=(e,t)=>{const n=jue(e,t),[i,s,r,o,a,l]=je(e,t),c=M(a,l);if(n.type==="polycurve"){const b=n.data.map(E=>Jp(E,10)),y=[];if(cn(e)&&!e.polygon||Te(e))for(const E of b){let _=0;for(;_<E.length-1;)y.push(Pe(M(E[_][0],E[_][1]),M(E[_+1][0],E[_+1][1]))),_++}else{const E=b.flat();let _=0;for(;_<E.length-1;)y.push(Pe(M(E[_][0],E[_][1]),M(E[_+1][0],E[_+1][1]))),_++}return y}else{if(n.type==="polyline")return n.data;if(Zue(e)){const[U,b]=e2(e),y=b.map(_=>Pk(_,c,e.angle)).flat();return[...Lk(U,c,e.angle),...y]}else if(e.type==="diamond"){const[U,b]=t2(e),y=b.map(_=>Pk(_,c,e.angle)).flat();return[...Lk(U,c,e.angle),...y]}else if(n.type==="polygon"){if(he(e)){const y=Gn(e,t);if(y&&De(y))return[Pe(M(i,s),M(r,s)),Pe(M(r,s),M(r,o)),Pe(M(r,o),M(i,o)),Pe(M(i,o),M(i,s))]}const U=n.data,b=[];for(let y=0;y<U.length-1;y++)b.push(Pe(U[y],U[y+1]));return b}else if(n.type==="ellipse")return que(e)}const[d,u,f,h,,,m,p]=[[i,s],[r,s],[i,o],[r,o],[a,s],[a,o],[i,l],[r,l]].map(U=>Z(U,c,e.angle));return[Pe(d,u),Pe(f,h),Pe(d,f),Pe(u,h),Pe(d,p),Pe(f,p),Pe(u,m),Pe(h,m)]},Zue=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),Lk=(e,t,n)=>e.map(i=>Pe(Z(i[0],t,n),Z(i[1],t,n))),Pk=(e,t,n)=>{const i=Jp(e,10);let s=0;const r=[];for(;s<i.length-1;)r.push(Pe(Z(M(i[s][0],i[s][1]),t,n),Z(M(i[s+1][0],i[s+1][1]),t,n))),s++;return r},que=e=>{const t=M(e.x+e.width/2,e.y+e.height/2),n=e.width/2,i=e.height/2,s=[],r=[],o=90,a=Math.PI*2/o;for(let l=0;l<o;l++){const c=l*a,d=t[0]+n*Math.cos(c),u=t[1]+i*Math.sin(c);r.push(Z(M(d,u),t,e.angle))}for(let l=0;l<r.length-1;l++)s.push(Pe(r[l],r[l+1]));return s.push(Pe(r[r.length-1],r[0])),s},CT=e=>{const t=Math.floor(e.width/2)+1,n=0,i=e.width,s=Math.floor(e.height/2)+1,r=t,o=e.height;return[t,n,i,s,r,o,0,s]},Nk=(e,t,n,i,s)=>{const r=1-e;return Math.pow(r,3)*t+3*Math.pow(r,2)*e*n+3*r*Math.pow(e,2)*i+Math.pow(e,3)*s},Ok=(e,t,n,i)=>{const s=t-e,r=n-t,o=i-n,a=3*s-6*r+3*o,l=6*r-6*s,c=3*s,d=l*l-4*a*c;if(!(d>=0))return!1;let f=null,h=null,m=1/0,p=1/0;return a===0?m=p=-c/l:(m=(-l+Math.sqrt(d))/(2*a),p=(-l-Math.sqrt(d))/(2*a)),m>=0&&m<=1&&(f=Nk(m,e,t,n,i)),p>=0&&p<=1&&(h=Nk(p,e,t,n,i)),[f,h]},xT=(e,t,n,i)=>{const s=Ok(e[0],t[0],n[0],i[0]),r=Ok(e[1],t[1],n[1],i[1]);let o=Math.min(e[0],i[0]),a=Math.max(e[0],i[0]);if(s){const d=s.filter(u=>u!==null);o=Math.min(o,...d),a=Math.max(a,...d)}let l=Math.min(e[1],i[1]),c=Math.max(e[1],i[1]);if(r){const d=r.filter(u=>u!==null);l=Math.min(l,...d),c=Math.max(c,...d)}return[o,l,a,c]},nE=(e,t)=>{let n=M(0,0);const{minX:i,minY:s,maxX:r,maxY:o}=e.reduce((a,{op:l,data:c})=>{if(l==="move"){const d=Py(c);Ce(d!=null,"Op data is not a point"),n=d}else if(l==="bcurveTo"){const d=M(c[0],c[1]),u=M(c[2],c[3]),f=M(c[4],c[5]),h=t?t(d):d,m=t?t(u):u,p=t?t(f):f,U=t?t(n):n;n=f;const[b,y,E,_]=xT(U,h,m,p);a.minX=Math.min(a.minX,b),a.minY=Math.min(a.minY,y),a.maxX=Math.max(a.maxX,E),a.maxY=Math.max(a.maxY,_)}return a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[i,s,r,o]},AT=e=>{let t=1/0,n=1/0,i=-1/0,s=-1/0;for(const[r,o]of e)t=Math.min(t,r),n=Math.min(n,o),i=Math.max(i,r),s=Math.max(s,o);return[t,n,i,s]},Que=e=>{const[t,n,i,s]=AT(e.points),r=t+e.x,o=n+e.y,a=i+e.x,l=s+e.y;return[r,o,a,l,(r+a)/2,(o+l)/2]},Jue=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;case"crowfoot_many":case"crowfoot_one":case"crowfoot_one_or_many":return 20;default:return 15}},efe=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},Fk=(e,t,n,i)=>{if(t.length<1)return null;const s=rf(t[0]);if(s.length<1)return null;const r=n==="start"?1:s.length-1,o=s[r].data;Ce(o.length===6,"Op data length is not 6");const a=M(o[4],o[5]),l=M(o[2],o[3]),c=M(o[0],o[1]),d=s[r-1];let u=M(0,0);if(d.op==="move"){const Y=Py(d.data);Ce(Y!=null,"Op data is not a point"),u=Y}else d.op==="bcurveTo"&&(u=M(d.data[4],d.data[5]));const f=(Y,G)=>Math.pow(1-Y,3)*a[G]+3*Y*Math.pow(1-Y,2)*l[G]+3*Math.pow(Y,2)*(1-Y)*c[G]+u[G]*Math.pow(Y,3),[h,m]=n==="start"?u:a,[p,U]=[f(.3,0),f(.3,1)],b=Math.hypot(h-p,m-U),y=(h-p)/b,E=(m-U)/b,_=Jue(i);let I=0;{const[Y,G]=n==="end"?e.points[e.points.length-1]:e.points[0],[O,z]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];I=Math.hypot(Y-O,G-z)}const w=Math.min(_,I*(i==="diamond"||i==="diamond_outline"?.25:.5)),T=h-y*w,A=m-E*w;if(i==="dot"||i==="circle"||i==="circle_outline"){const Y=Math.hypot(A-m,T-h)+e.strokeWidth-2;return[h,m,Y]}const S=efe(i);if(i==="crowfoot_many"||i==="crowfoot_one_or_many"){const[Y,G]=Z(M(h,m),M(T,A),Fc(-S)),[O,z]=Z(M(h,m),M(T,A),Fc(S));return[T,A,Y,G,O,z]}const[D,N]=Z(M(T,A),M(h,m),-S*Math.PI/180),[L,j]=Z(M(T,A),M(h,m),Fc(S));if(i==="diamond"||i==="diamond_outline"){let Y,G;if(n==="start"){const[O,z]=e.points.length>1?e.points[1]:[0,0];[Y,G]=Z(M(h+w*2,m),M(h,m),Math.atan2(z-m,O-h))}else{const[O,z]=e.points.length>1?e.points[e.points.length-2]:[0,0];[Y,G]=Z(M(h-w*2,m),M(h,m),Math.atan2(m-z,h-O))}return[h,m,D,N,Y,G,L,j]}return[h,m,D,N,L,j]},tfe=e=>{const t=Id.generator(),n=nr(e),i=e.roundness?"curve":n.fill?"polygon":"linearPath";return t[i](e.points,n)},nfe=(e,t,n,i)=>{var u;const s=Ne(e,i);if(e.points.length<2){const[f,h]=e.points[0],[m,p]=Z(M(e.x+f,e.y+h),M(t,n),e.angle);let U=[m,p,m,p];if(s){const b=ne.getMinMaxXYWithBoundText(e,i,[m,p,m,p],s);U=[b[0],b[1],b[2],b[3]]}return U}const o=((u=kn.get(e,null))==null?void 0:u[0])??tfe(e),a=rf(o),c=nE(a,([f,h])=>Z(M(e.x+f,e.y+h),M(t,n),e.angle));let d=[c[0],c[1],c[2],c[3]];if(s){const f=ne.getMinMaxXYWithBoundText(e,i,d,s);d=[f[0],f[1],f[2],f[3]]}return d},Pn=(e,t,n=!1)=>H4.getBounds(e,t,n),Et=(e,t)=>{if(!Bz(e))return[0,0,0,0];let n=1/0,i=-1/0,s=1/0,r=-1/0;const o=t||we(e);return e.forEach(a=>{const[l,c,d,u]=Pn(a,o);n=Math.min(n,l),s=Math.min(s,c),i=Math.max(i,d),r=Math.max(r,u)}),[n,s,i,r]},MT=(e,t)=>{const[n,i,s,r]=Et(e);return[n+t.x,i+t.y,s+t.x,r+t.y]},X0=(e,t,n,i)=>{if(!(De(e)||us(e)))return[e.x,e.y,e.x+t,e.y+n];const s=B6(0,t,B6(1,n,e.points,i),i);let r;if(us(e))r=AT(s);else{const d=Id.generator(),u=e.roundness?d.curve(s,nr(e)):d.linearPath(s,nr(e)),f=rf(u);r=nE(f)}const[o,a,l,c]=r;return[o+e.x,a+e.y,l+e.x,c+e.y]},Bk=(e,t)=>{const n=Id.generator(),i=e.roundness==null?n.linearPath(t,nr(e)):n.curve(t,nr(e)),s=rf(i),[r,o,a,l]=nE(s);return[r+e.x,o+e.y,a+e.x,l+e.y]},ife=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,i=e[0];const s=we(e);return e.forEach(r=>{const[o,a,l,c]=Pn(r,s),d=Qe(M((o+l)/2,(a+c)/2),M(t.x,t.y));d<n&&(n=d,i=r)}),Pn(i,s)},Kr=e=>{const[t,n,i,s]=Et(e);return{minX:t,minY:n,maxX:i,maxY:s,width:i-t,height:s-n,midX:(t+i)/2,midY:(n+s)/2}},SV=({scrollX:e,scrollY:t,width:n,height:i,zoom:s})=>[-e,-t,-e+n/s.value,-t+i/s.value],Kg=e=>M(e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2),qa=(e,t,n)=>{const i={minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height,midX:e.x+e.width/2,midY:e.y+e.height/2},s=yi(e,t),[r,o]=Z(M(i.minX,i.minY),s,e.angle),[a,l]=Z(M(i.maxX,i.minY),s,e.angle),[c,d]=Z(M(i.maxX,i.maxY),s,e.angle),[u,f]=Z(M(i.minX,i.maxY),s,e.angle),h=[Math.min(r,a,c,u),Math.min(o,l,d,f),Math.max(r,a,c,u),Math.max(o,l,d,f)];if(n){const[m,p,U,b]=n;return[h[0]-b,h[1]-m,h[2]+p,h[3]+U]}return h},Ug=(e,t)=>e[0]>t[0]&&e[0]<t[2]&&e[1]>t[1]&&e[1]<t[3],xd=(e,t)=>{if(e==null||t==null)return!1;const[n,i,s,r]=e,[o,a,l,c]=t;return n<l&&s>o&&i<c&&r>a},yi=(e,t,n=0,i=0)=>{if(De(e)){const[o,a,l,c]=je(e,t),[d,u]=M((o+l)/2,(a+c)/2);return M(d+n,u+i)}const[s,r]=Kg(Pn(e,t));return M(s+n,r+i)},sfe=.1,_l=e=>De(e)||us(e)?e.points.length<2||e.points.length===2&&Te(e)&&vr(e.points[0],e.points[e.points.length-1],sfe):e.width===0&&e.height===0,d5=(e,t,n,i,s)=>{const[r,o,a,l]=Pn(e,s),c=zt({clientX:i.offsetLeft,clientY:i.offsetTop},i),d=zt({clientX:i.offsetLeft+t,clientY:i.offsetTop+n},i);return c.x<=a&&c.y<=l&&d.x>=r&&d.y>=o},Cb=(e,t,n,i,s,r)=>{const[o,a,l,c]=Et(e,s),d=zt({clientX:i.offsetLeft+((r==null?void 0:r.left)||0),clientY:i.offsetTop+((r==null?void 0:r.top)||0)},i),u=zt({clientX:i.offsetLeft+t-((r==null?void 0:r.right)||0),clientY:i.offsetTop+n-((r==null?void 0:r.bottom)||0)},i);return o>=d.x&&a>=d.y&&l<=u.x&&c<=u.y},zk=(e,t,n)=>{const i=Math.abs(t),s=Math.abs(n);if(e==="line"||e==="arrow"||e==="freedraw"){const r=Math.round(Math.atan(s/i)/ir)*ir;r===0?n=0:r===Math.PI/2?t=0:n=i*Math.tan(r)*Math.sign(n)||n}else e!=="selection"&&(n=i*Math.sign(n));return{width:t,height:n}},rfe=(e,t,n,i,s)=>{let r=n-e,o=i-t;const a=Math.atan2(o,r);let l=Math.round(a/ir)*ir;if(s){const c=Math.floor(s/ir)*ir;wne(a,c,c+ir)&&(Tne(a,s)<ir/6?l=s:wo(a)>wo(s)?l=c+ir:l=c)}if(l===0)o=0;else if(l===Math.PI/2)r=0;else{const c=Math.tan(l),d=-1,u=t-c*e,f=-1/c,h=-1,m=i-f*n,p=(d*m-h*u)/(c*h-f*d),U=(u*f-m*c)/(c*h-f*d);r=p-e,o=U-t}return{width:r,height:o}},CV=e=>{const t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){const n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){const n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t},ofe=(e,t,n,i)=>{const s=qy(e,n.getNonDeletedElementsMap(),i),r=Kr(e);return s.flatMap(o=>{const a=afe(o,r,t);return o.map(l=>{const c=n.mutateElement(l,{x:l.x+a.x,y:l.y+a.y});return pi(l,n,{simultaneouslyUpdated:o}),c})})},afe=(e,t,{axis:n,position:i})=>{const s=Kr(e),[r,o]=n==="x"?["minX","maxX"]:["minY","maxY"],a={x:0,y:0};return i==="start"?{...a,[n]:t[r]-s[r]}:i==="end"?{...a,[n]:t[o]-s[o]}:{...a,[n]:(t[r]+t[o])/2-(s[r]+s[o])/2}},lfe=e=>{const t=e.slice(),n=new Set,i=r=>{var c,d,u;const o=(d=(c=r[0])==null?void 0:c.groupIds)==null?void 0:d.join(""),a=[r[0]],l=[];for(const f of r.slice(1))((u=f.groupIds)==null?void 0:u.join(""))===o?a.push(f):l.push(f);return l.length?[...a,...i(l)]:a},s=new Map;return t.forEach((r,o)=>{var a;if(!s.has(r.id))if((a=r.groupIds)!=null&&a.length){const l=r.groupIds[r.groupIds.length-1],c=t.slice(o).filter(d=>{var f;const u=(f=d==null?void 0:d.groupIds)==null?void 0:f.some(h=>h===l);return u&&s.set(d.id,!0),u});for(const d of i(c))n.add(d)}else n.add(r)}),n.size!==e.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),e):[...n]},cfe=e=>{const t=Qie(e),n=e.slice(),i=new Set;return n.forEach((s,r)=>{var o,a;if(s)if((o=s.boundElements)!=null&&o.length)i.add(s),n[r]=null,s.boundElements.forEach(l=>{const c=t.get(l.id);c&&l.type==="text"&&(i.add(c[0]),n[c[1]]=null)});else if(s.type==="text"&&s.containerId){const l=t.get(s.containerId);(a=l==null?void 0:l[0].boundElements)!=null&&a.find(c=>c.id===s.id)||(i.add(s),n[r]=null)}else i.add(s),n[r]=null}),i.size!==e.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),e):[...i]},dfe=e=>cfe(lfe(e)),ufe=(e,t,n,i)=>{const s=cd(n);return s.id=Li(),s.updated=Gg(),i&&(s.seed=to(),Qo(s)),s.groupIds=xue(s.groupIds,e,r=>(t.has(r)||t.set(r,Li()),t.get(r))),s},J1=e=>{let{elements:t}=e;const n="appState"in e?e.appState:{editingGroupId:null,selectedGroupIds:{}},i=new Map,s=new Map,r=[],o=[],a=new Map,l=new Map,c=new Map,d=we(t),u=e.type==="in-place"?e.idsOfElementsToDuplicate:new Map(t.map(U=>[U.id,U]));if(e.type==="in-place")for(const U of Object.keys(e.appState.selectedGroupIds))t.filter(b=>{var y;return(y=b.groupIds)==null?void 0:y.includes(U)}).forEach(b=>u.set(b.id,b));t=dfe(t);const f=t.slice(),h=U=>{const y=w3(U).reduce((E,_)=>{if(i.has(_.id))return E;i.set(_.id,!0);const I=ufe(n.editingGroupId,s,_,e.randomizeSeed);return i.set(I.id,!0),c.set(I.id,I),a.set(_.id,I.id),l.set(I.id,_),o.push(_),r.push(I),E.push(I),E},[]);return Array.isArray(U)?y:y[0]||null},m=(U,b)=>{if(b){if(U>f.length-1){f.push(...w3(b));return}f.splice(U+1,0,...w3(b))}},p=new Set(t.filter(U=>u.has(U.id)&&_e(U)).map(U=>U.id));for(const U of t){if(i.has(U.id)||!u.has(U.id))continue;const b=dV(n,U);if(b){const y=Ot(t,b).flatMap(_=>_e(_)?[...br(t,_.id),_]:[_]),E=qo(f,_=>{var I;return(I=_.groupIds)==null?void 0:I.includes(b)});m(E,h(y));continue}if(!(U.frameId&&p.has(U.frameId))){if(_e(U)){const y=U.id,E=br(t,y),_=qo(f,I=>I.frameId===y||I.id===y);m(_,h([...E,U]));continue}if(Ki(U)){const y=Ne(U,d),E=qo(f,_=>_.id===U.id||"containerId"in _&&_.containerId===U.id);y?m(E,h([U,y])):m(E,h(U));continue}if(Vt(U)){const y=Gn(U,d),E=qo(f,_=>_.id===U.id||_.id===(y==null?void 0:y.id));y?m(E,h([y,U])):m(E,h(U));continue}m(qo(f,y=>y.id===U.id),h(U))}}if(uue(r,a,c),Mue(f,o,a),e.overrides)for(const U of r){const b=l.get(U.id);b&&Object.assign(U,e.overrides({duplicateElement:U,origElement:b,origIdToDuplicateId:a}))}return{duplicatedElements:r,duplicateElementsMap:c,elementsWithDuplicates:f,origIdToDuplicateId:a}},V4=(e,t=0)=>{if(e==null||typeof e!="object")return e;if(Object.prototype.toString.call(e)==="[object Object]"){const i=typeof e.constructor=="function"?Object.create(Object.getPrototypeOf(e)):{};for(const s in e)if(e.hasOwnProperty(s)){if(t===0&&(s==="shape"||s==="canvas"))continue;i[s]=V4(e[s],t+1)}return i}if(Array.isArray(e)){let i=e.length;const s=new Array(i);for(;i--;)s[i]=V4(e[i],t+1);return s}return e},cd=e=>V4(e),q={IMMEDIATELY:"IMMEDIATELY",NEVER:"NEVER",EVENTUALLY:"EVENTUALLY"};class ffe{constructor(t){B(this,"onDurableIncrementEmitter",new fo);B(this,"onStoreIncrementEmitter",new fo);B(this,"scheduledMacroActions",new Set);B(this,"scheduledMicroActions",[]);B(this,"_snapshot",ra.empty());this.app=t}get snapshot(){return this._snapshot}set snapshot(t){this._snapshot=t}scheduleAction(t){this.scheduledMacroActions.add(t),this.satisfiesScheduledActionsInvariant()}scheduleCapture(){this.scheduleAction(q.IMMEDIATELY)}scheduleMicroAction(t){const{action:n}=t;let i;if("change"in t)i=t.change;else{const r=ra.create(this.app.scene.getElementsMapIncludingDeleted(),this.app.state),o=r.maybeClone(n,t.elements?bfe(t.elements):void 0,t.appState);i=Rh.create(r,o)}const s="delta"in t?t.delta:void 0;this.scheduledMicroActions.push(()=>this.processAction({action:n,change:i,delta:s}))}commit(t,n){this.flushMicroActions();try{const i=this.getScheduledMacroAction();this.processAction({action:i,elements:t,appState:n})}finally{this.satisfiesScheduledActionsInvariant(),this.scheduledMacroActions=new Set}}clear(){this.snapshot=ra.empty(),this.scheduledMacroActions=new Set}emitDurableIncrement(t,n=void 0,i=void 0){const s=this.snapshot;let r,o;if(n?r=n:r=Rh.create(s,t),i?o=i:o=Ou.calculate(s,t),!o.isEmpty()){const a=new hfe(r,o);this.onDurableIncrementEmitter.trigger(a),this.onStoreIncrementEmitter.trigger(a)}}emitEphemeralIncrement(t,n=void 0){let i;if(n)i=n;else{const r=this.snapshot;i=Rh.create(r,t)}const s=new gfe(i);this.onStoreIncrementEmitter.trigger(s)}applyChangeToSnapshot(t){const n=this.snapshot,i=this.snapshot.applyChange(t);return n===i?null:i}maybeCloneSnapshot(t,n,i){if(!n&&!i)return null;const s=this.snapshot,r=this.snapshot.maybeClone(t,n,i);return s===r?null:r}flushMicroActions(){for(const t of this.scheduledMicroActions)try{t()}catch(n){console.error("Failed to execute scheduled micro action",n)}this.scheduledMicroActions=[]}processAction(t){const{action:n}=t;if(n===q.EVENTUALLY&&!this.onStoreIncrementEmitter.subscribers.length)return;let i;if("change"in t?i=this.applyChangeToSnapshot(t.change):i=this.maybeCloneSnapshot(n,t.elements,t.appState),!i)return;const s="change"in t?t.change:void 0,r="delta"in t?t.delta:void 0;try{switch(n){case q.IMMEDIATELY:this.emitDurableIncrement(i,s,r);break;case q.NEVER:case q.EVENTUALLY:this.emitEphemeralIncrement(i,s);break;default:Ua(n,"Unknown store action")}}finally{switch(n){case q.IMMEDIATELY:case q.NEVER:this.snapshot=i;break}}}getScheduledMacroAction(){let t;return this.scheduledMacroActions.has(q.IMMEDIATELY)?t=q.IMMEDIATELY:this.scheduledMacroActions.has(q.NEVER)?t=q.NEVER:t=q.EVENTUALLY,t}satisfiesScheduledActionsInvariant(){if(!(this.scheduledMacroActions.size>=0&&this.scheduledMacroActions.size<=Object.keys(q).length)){const t=`There can be at most three store actions scheduled at the same time, but there are "${this.scheduledMacroActions.size}".`;console.error(t,this.scheduledMacroActions.values())}}}class Rh{constructor(t,n){this.elements=t,this.appState=n}static create(t,n){const i=n.getChangedElements(t),s=n.getChangedAppState(t);return new Rh(i,s)}}class xV{constructor(t,n){this.type=t,this.change=n}static isDurable(t){return t.type==="durable"}static isEphemeral(t){return t.type==="ephemeral"}}class hfe extends xV{constructor(t,n){super("durable",t),this.change=t,this.delta=n}}class gfe extends xV{constructor(t){super("ephemeral",t),this.change=t}}class Ou{constructor(t,n,i){this.id=t,this.elements=n,this.appState=i}static create(t,n,i={id:Li()}){return new this(i.id,t,n)}static calculate(t,n){const i=n.metadata.didElementsChange?Zd.calculate(t.elements,n.elements):Zd.empty(),s=n.metadata.didAppStateChange?Bn.calculate(t.appState,n.appState):Bn.empty();return this.create(i,s)}static restore(t){const{id:n,elements:i,appState:s}=t;return new this(n,Zd.restore(i),Bn.restore(s))}static load({id:t,elements:{added:n,removed:i,updated:s},appState:{delta:r}}){const o=Zd.create(n,i,s),a=Bn.create(r);return new this(t,o,a)}static squash(...t){const n=Ou.empty();for(const i of t)n.elements.squash(i.elements),n.appState.squash(i.appState);return n}static inverse(t){return this.create(t.elements.inverse(),t.appState.inverse())}static applyTo(t,n,i,s){const[r,o]=t.elements.applyTo(n,ra.empty().elements,s),[a,l]=t.appState.applyTo(i,r);return[r,a,o||l]}static applyLatestChanges(t,n,i,s){return this.create(t.elements.applyLatestChanges(n,i,s),t.appState,{id:t.id})}static empty(){return Ou.create(Zd.empty(),Bn.empty())}isEmpty(){return this.elements.isEmpty()&&this.appState.isEmpty()}}class ra{constructor(t,n,i={didElementsChange:!1,didAppStateChange:!1,isEmpty:!1}){B(this,"_lastChangedElementsHash",0);B(this,"_lastChangedAppStateHash",0);this.elements=t,this.appState=n,this.metadata=i}static create(t,n,i={didElementsChange:!1,didAppStateChange:!1}){return new ra(t,Hk(n)?n:Dh(n),i)}static empty(){return new ra(new Map,mfe(),{didElementsChange:!1,didAppStateChange:!1,isEmpty:!0})}getChangedElements(t){const n={};for(const i of cc(t.elements))this.elements.get(i.id)||(n[i.id]=xe(i,{isDeleted:!0}));for(const i of cc(this.elements))t.elements.get(i.id)!==i&&(n[i.id]=i);return n}getChangedAppState(t){return Fe.getRightDifferences(t.appState,this.appState).reduce((n,i)=>Object.assign(n,{[i]:this.appState[i]}),{})}isEmpty(){return this.metadata.isEmpty}applyChange(t){const n=new Map(this.elements);for(const[s,r]of Object.entries(t.elements))n.set(s,r);const i=Dh({...this.appState,...t.appState});return ra.create(n,i,{didElementsChange:Object.keys(t.elements).length>0,didAppStateChange:Object.keys(t.appState).length>0})}maybeClone(t,n,i){const s={shouldCompareHashes:!1};t===q.EVENTUALLY&&(s.shouldCompareHashes=!0);const r=this.maybeCreateElementsSnapshot(n,s),o=this.maybeCreateAppStateSnapshot(i,s);let a=!1,l=!1;return this.elements!==r&&(a=!0),this.appState!==o&&(l=!0),!a&&!l?this:new ra(r,o,{didElementsChange:a,didAppStateChange:l})}maybeCreateAppStateSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.appState;const i=Hk(t)?t:Dh(t);return this.detectChangedAppState(i,n)?i:this.appState}maybeCreateElementsSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.elements;const i=this.detectChangedElements(t,n);return i!=null&&i.size?this.createElementsSnapshot(i):this.elements}detectChangedAppState(t,n={shouldCompareHashes:!1}){if(this.appState===t)return;const i=Fe.isRightDifferent(this.appState,t);if(!i)return;const s=BT(JSON.stringify(t));if(!(n.shouldCompareHashes&&this._lastChangedAppStateHash===s))return this._lastChangedAppStateHash=s,i}detectChangedElements(t,n={shouldCompareHashes:!1}){if(this.elements===t)return;const i=new Map;for(const r of cc(this.elements))t.get(r.id)||i.set(r.id,xe(r,{isDeleted:!0}));for(const r of cc(t)){const o=this.elements.get(r.id);if(!o||o.version<r.version){if(xt(r)&&!Jn(r))continue;i.set(r.id,r)}}if(!i.size)return;const s=t$(i);if(!(n.shouldCompareHashes&&this._lastChangedElementsHash===s))return this._lastChangedElementsHash=s,i}createElementsSnapshot(t){const n=new Map;for(const i of cc(this.elements))n.set(i.id,i);for(const i of cc(t))n.set(i.id,cd(i));return n}}const AV="__observedAppState",mfe=()=>({name:null,editingGroupId:null,viewBackgroundColor:Je.white,selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null,croppingElementId:null,activeLockedId:null,lockedMultiSelections:{}}),Dh=e=>{const t={name:e.name,editingGroupId:e.editingGroupId,viewBackgroundColor:e.viewBackgroundColor,selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,croppingElementId:e.croppingElementId,activeLockedId:e.activeLockedId,lockedMultiSelections:e.lockedMultiSelections,selectedLinearElement:e.selectedLinearElement?{elementId:e.selectedLinearElement.elementId,isEditing:!!e.selectedLinearElement.isEditing}:null};return Reflect.defineProperty(t,AV,{value:!0,enumerable:!1}),t},Hk=e=>!!Reflect.get(e,AV),MV="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function mh(e,t,n){const i=n[0];if(t!=null&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===i||t&&t.slice(-1)===i)throw new Error("trailing zero");if(t){let o=0;for(;(e[o]||i)===t[o];)o++;if(o>0)return t.slice(0,o)+mh(e.slice(o),t.slice(o),n)}const s=e?n.indexOf(e[0]):0,r=t!=null?n.indexOf(t[0]):n.length;if(r-s>1){const o=Math.round(.5*(s+r));return n[o]}else return t&&t.length>1?t.slice(0,1):n[s]+mh(e.slice(1),null,n)}function kV(e){if(e.length!==RV(e[0]))throw new Error("invalid integer part of order key: "+e)}function RV(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function m1(e){const t=RV(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function Vk(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);const n=m1(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function $k(e,t){kV(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])+1;o===t.length?i[r]=t[0]:(i[r]=t[o],s=!1)}if(s){if(n==="Z")return"a"+t[0];if(n==="z")return null;const r=String.fromCharCode(n.charCodeAt(0)+1);return r>"a"?i.push(t[0]):i.pop(),r+i.join("")}else return n+i.join("")}function pfe(e,t){kV(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])-1;o===-1?i[r]=t.slice(-1):(i[r]=t[o],s=!1)}if(s){if(n==="a")return"Z"+t.slice(-1);if(n==="A")return null;const r=String.fromCharCode(n.charCodeAt(0)-1);return r<"Z"?i.push(t.slice(-1)):i.pop(),r+i.join("")}else return n+i.join("")}function xf(e,t,n=MV){if(e!=null&&Vk(e,n),t!=null&&Vk(t,n),e!=null&&t!=null&&e>=t)throw new Error(e+" >= "+t);if(e==null){if(t==null)return"a"+n[0];const l=m1(t),c=t.slice(l.length);if(l==="A"+n[0].repeat(26))return l+mh("",c,n);if(l<t)return l;const d=pfe(l,n);if(d==null)throw new Error("cannot decrement any more");return d}if(t==null){const l=m1(e),c=e.slice(l.length),d=$k(l,n);return d??l+mh(c,null,n)}const i=m1(e),s=e.slice(i.length),r=m1(t),o=t.slice(r.length);if(i===r)return i+mh(s,o,n);const a=$k(i,n);if(a==null)throw new Error("cannot increment any more");return a<t?a:i+mh(s,null,n)}function $4(e,t,n,i=MV){if(n===0)return[];if(n===1)return[xf(e,t,i)];if(t==null){let o=xf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=xf(o,t,i),a.push(o);return a}if(e==null){let o=xf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=xf(e,o,i),a.push(o);return a.reverse(),a}const s=Math.floor(n/2),r=xf(e,t,i);return[...$4(e,r,s,i),r,...$4(r,t,n-s-1,i)]}class Ufe extends Error{constructor(){super(...arguments);B(this,"code","ELEMENT_HAS_INVALID_INDEX")}}const kT=(e,{shouldThrow:t=!1,includeBoundTextValidation:n=!1,ignoreLogs:i,reconciliationContext:s})=>{const r=[],o=l=>`${l==null?void 0:l.index}:${l==null?void 0:l.id}:${l==null?void 0:l.type}:${l==null?void 0:l.isDeleted}:${l==null?void 0:l.version}:${l==null?void 0:l.versionNonce}`,a=e.map(l=>l.index);for(const[l,c]of a.entries()){const d=a[l-1],u=a[l+1];if(G4(c,d,u)||r.push(`Fractional indices invariant has been compromised: "${o(e[l-1])}", "${o(e[l])}", "${o(e[l+1])}"`),n&&Ki(e[l])){const f=e[l],h=Ne(f,we(e));h&&h.index<=f.index&&r.push(`Fractional indices invariant for bound elements has been compromised: "${o(h)}", "${o(f)}"`)}}if(r.length){const l=new Ufe,c=[];if(s&&(c.push("Additional reconciliation context:"),c.push(s.localElements.map(d=>o(d))),c.push(s.remoteElements.map(d=>o(d)))),i||console.error(r.join(`

`),l.stack,e.map(d=>o(d)),...c),t)throw l}},RT=e=>e.sort((t,n)=>Gk(t)&&Gk(n)?t.index<n.index?-1:t.index>n.index?1:t.id<n.id?-1:1:1),Mo=(e,t)=>{try{const n=we(e),i=yfe(e,t),s=DT(e,i),r=e.map(o=>{const a=s.get(o);return a?{...o,index:a.index}:o});kT(r,{includeBoundTextValidation:!1,shouldThrow:!0,ignoreLogs:!0});for(const[o,{index:a}]of s)Dn(o,n,{index:a})}catch{Ad(e)}return e},Ad=e=>{const t=we(e),n=DV(e),i=DT(e,n);for(const[s,{index:r}]of i)Dn(s,t,{index:r});return e},bfe=e=>{const t=we(e),n=DV(e),i=DT(e,n);for(const[s,{index:r}]of i)t.set(s.id,xe(s,{index:r}));return t},yfe=(e,t)=>{const n=[];let i=0;for(;i<e.length;)if(t.has(e[i].id)){const s=[i-1,i];for(;++i<e.length&&t.has(e[i].id);)s.push(i);s.push(i),n.push(s)}else i++;return n},DV=e=>{const t=[];let n,i,s=-1,r=0;const o=c=>{var f;const d=e[s]?e[s].index:void 0,u=(f=e[c-1])==null?void 0:f.index;return!d&&u||d&&u&&u>d?[u,c-1]:[d,s]},a=c=>{var f;const d=e[r]?e[r].index:void 0;if(d&&c<r)return[d,r];let u=r;for(;++u<e.length;){const h=(f=e[u])==null?void 0:f.index;if(!d&&h||d&&h&&h>d)return[h,u]}return[void 0,u]};let l=0;for(;l<e.length;){const c=e[l].index;if([n,s]=o(l),[i,r]=a(l),G4(c,n,i))l++;else{const d=[s,l];for(;++l<e.length;){const u=e[l].index,[f,h]=o(l),[m,p]=a(l);if(G4(u,f,m))break;[n,s]=[f,h],[i,r]=[m,p],d.push(l)}d.push(r),t.push(d)}}return t},G4=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1,DT=(e,t)=>{var i,s;const n=new Map;for(const r of t){const o=r.shift(),a=r.pop(),l=$4((i=e[o])==null?void 0:i.index,(s=e[a])==null?void 0:s.index,r.length);for(let c=0;c<r.length;c++){const d=e[r[c]];n.set(d,{index:l[c]})}}return n},Gk=e=>!!e.index,Xk=e=>{const t=new Map,n=[];for(const i of e)i.isDeleted||(n.push(i),t.set(i.id,i));return{elementsMap:t,elements:n}},Efe=na(e=>{window!=null&&window.DEBUG_FRACTIONAL_INDICES&&kT(e,{shouldThrow:tse(),includeBoundTextValidation:!0})},1e3*60,{leading:!0,trailing:!1}),vfe=e=>{const t=["includeBoundTextElement","includeElementsInFrames"];let n="";for(const i of t)n+=`${i}:${e[i]?"1":"0"}`;return n};class u5{constructor(t=null,n){B(this,"callbacks",new Set);B(this,"nonDeletedElements",[]);B(this,"nonDeletedElementsMap",new Map);B(this,"elements",[]);B(this,"nonDeletedFramesLikes",[]);B(this,"frames",[]);B(this,"elementsMap",new Map);B(this,"selectedElementsCache",{selectedElementIds:null,elements:null,cache:new Map});B(this,"sceneNonce");B(this,"insertElement",t=>{const n=t.frameId?this.getElementIndex(t.frameId):this.elements.length;this.insertElementAtIndex(t,n)});B(this,"insertElements",t=>{var i;if(!t.length)return;const n=(i=t[0])!=null&&i.frameId?this.getElementIndex(t[0].frameId):this.elements.length;this.insertElementsAtIndex(t,n)});B(this,"getContainerElement",t=>t&&t.containerId&&this.getElement(t.containerId)||null);B(this,"getElementsFromId",t=>{const n=this.getNonDeletedElementsMap(),i=n.get(t);return i?[i]:Ot(n,t)});t&&this.replaceAllElements(t,n)}getSceneNonce(){return this.sceneNonce}getNonDeletedElementsMap(){return this.nonDeletedElementsMap}getElementsIncludingDeleted(){return this.elements}getElementsMapIncludingDeleted(){return this.elementsMap}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(t){const n=vfe(t),i=(t==null?void 0:t.elements)||this.nonDeletedElements;if(this.selectedElementsCache.elements===i&&this.selectedElementsCache.selectedElementIds===t.selectedElementIds){const r=this.selectedElementsCache.cache.get(n);if(r)return r}else(t==null?void 0:t.elements)==null&&this.selectedElementsCache.cache.clear();const s=Ze(i,{selectedElementIds:t.selectedElementIds},t);return(t==null?void 0:t.elements)==null&&(this.selectedElementsCache.selectedElementIds=t.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,s)),s}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(t){return this.elementsMap.get(t)||null}getNonDeletedElement(t){const n=this.getElement(t);return n&&t_(n)?n:null}mapElements(t){let n=!1;const i=this.elements.map(s=>{const r=t(s);return r!==s&&(n=!0),r});return n&&this.replaceAllElements(i),n}replaceAllElements(t,n){const i=ese(t),s=[];n!=null&&n.skipValidation||Efe(i),this.elements=Ad(i),this.elementsMap.clear(),this.elements.forEach(o=>{_e(o)&&s.push(o),this.elementsMap.set(o.id,o)});const r=Xk(this.elements);this.nonDeletedElements=r.elements,this.nonDeletedElementsMap=r.elementsMap,this.frames=s,this.nonDeletedFramesLikes=Xk(this.frames).elements,this.triggerUpdate()}triggerUpdate(){this.sceneNonce=to();for(const t of Array.from(this.callbacks))t()}onUpdate(t){if(this.callbacks.has(t))throw new Error;return this.callbacks.add(t),()=>{if(!this.callbacks.has(t))throw new Error;this.callbacks.delete(t)}}destroy(){this.elements=[],this.nonDeletedElements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),this.callbacks.clear()}insertElementAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),t,...this.elements.slice(n)];Mo(i,we([t])),this.replaceAllElements(i)}insertElementsAtIndex(t,n){if(!t.length)return;if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),...t,...this.elements.slice(n)];Mo(i,we(t)),this.replaceAllElements(i)}getElementIndex(t){return this.elements.findIndex(n=>n.id===t)}mutateElement(t,n,i={informMutation:!0,isDragging:!1}){const s=this.getNonDeletedElementsMap(),{version:r}=t,{version:o}=Dn(t,s,n,i);return this.elementsMap.has(t.id)&&r!==o&&i.informMutation&&this.triggerUpdate(),t}}class Fe{constructor(t,n){this.deleted=t,this.inserted=n}static create(t,n,i,s){const r=i&&s!=="inserted"?i(t,"deleted"):t,o=i&&s!=="deleted"?i(n,"inserted"):n;return new Fe(r,o)}static calculate(t,n,i,s){if(t===n)return Fe.empty();const r={},o={};for(const c of this.getDifferences(t,n))r[c]=t[c],o[c]=n[c];const[a,l]=s?s(r,o):[r,o];return Fe.create(a,l,i)}static empty(){return new Fe({},{})}static isEmpty(t){return!Object.keys(t.deleted).length&&!Object.keys(t.inserted).length}static merge(t,n,i=Fe.empty()){return Fe.create({...t.deleted,...n.deleted,...i.deleted},{...t.inserted,...n.inserted,...i.inserted})}static mergeObjects(t,n,i={}){const s={...t};for(const r of Object.keys(i))delete s[r];return{...s,...n}}static mergeArrays(t,n,i,s){return Object.values(Fe.mergeObjects(Ga(t??[],s),Ga(n??[],s),Ga(i??[],s)))}static diffObjects(t,n,i,s){if(!t[i]&&!n[i])return;const r=t[i]!==null&&typeof t[i]=="object",o=n[i]!==null&&typeof n[i]=="object";if(r||o){const a=t[i]??{},l=n[i]??{},c=Fe.getLeftDifferences(a,l).reduce((u,f)=>(u[f]=s(a[f]),u),{}),d=Fe.getRightDifferences(a,l).reduce((u,f)=>(u[f]=s(l[f]),u),{});Object.keys(c).length||Object.keys(d).length?(Reflect.set(t,i,c),Reflect.set(n,i,d)):(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}else t[i]===n[i]&&(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}static diffArrays(t,n,i,s){if(!(!t[i]&&!n[i])&&(Array.isArray(t[i])||Array.isArray(n[i]))){const r=Array.isArray(t[i])?t[i]:[],o=Array.isArray(n[i])?n[i]:[],a=Ga(Fe.getLeftDifferences(Ga(r,s),Ga(o,s)),c=>c),l=Ga(Fe.getRightDifferences(Ga(r,s),Ga(o,s)),c=>c);if(Object.keys(a).length||Object.keys(l).length){const c=r.filter(u=>a[s?s(u):String(u)]),d=o.filter(u=>l[s?s(u):String(u)]);Reflect.set(t,i,c),Reflect.set(n,i,d)}else Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i)}}static isLeftDifferent(t,n,i=!1){return!!this.distinctKeysIterator("left",t,n,i).next().value}static isRightDifferent(t,n,i=!1){return!!this.distinctKeysIterator("right",t,n,i).next().value}static isInnerDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("inner",t,n,i).next().value}static isDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("full",t,n,i).next().value}static getLeftDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("left",t,n,i)).sort()}static getRightDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("right",t,n,i)).sort()}static getInnerDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("inner",t,n,i)).sort()}static getDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("full",t,n,i)).sort()}static*distinctKeysIterator(t,n,i,s=!1){if(n===i)return;let r=[];t==="left"?r=Object.keys(n):t==="right"?r=Object.keys(i):t==="inner"?r=Object.keys(n).filter(o=>o in i):t==="full"?r=Array.from(new Set([...Object.keys(n),...Object.keys(i)])):Ua(t,`Unknown distinctKeysIterator's join param "${t}"`,!0);for(const o of r){const a=n[o],l=i[o];if(a!==l){if(!s&&typeof a=="object"&&typeof l=="object"&&a!==null&&l!==null&&ki(a,l))continue;yield o}}}}class Bn{constructor(t){this.delta=t}static create(t){return new Bn(t)}static calculate(t,n){const i=Fe.calculate(t,n,Bn.orderAppStateKeys,Bn.postProcess);return new Bn(i)}static restore(t){const{delta:n}=t;return new Bn(n)}static empty(){return new Bn(Fe.create({},{}))}inverse(){const t=Fe.create(this.delta.inserted,this.delta.deleted);return new Bn(t)}squash(t){if(t.isEmpty())return this;const n=Fe.mergeObjects(this.delta.deleted.selectedElementIds??{},t.delta.deleted.selectedElementIds??{}),i=Fe.mergeObjects(this.delta.inserted.selectedElementIds??{},t.delta.inserted.selectedElementIds??{}),s=Fe.mergeObjects(this.delta.deleted.selectedGroupIds??{},t.delta.deleted.selectedGroupIds??{}),r=Fe.mergeObjects(this.delta.inserted.selectedGroupIds??{},t.delta.inserted.selectedGroupIds??{}),o=Fe.mergeObjects(this.delta.deleted.lockedMultiSelections??{},t.delta.deleted.lockedMultiSelections??{}),a=Fe.mergeObjects(this.delta.inserted.lockedMultiSelections??{},t.delta.inserted.lockedMultiSelections??{}),l={},c={};return(Object.keys(n).length||Object.keys(i).length)&&(c.selectedElementIds=n,l.selectedElementIds=i),(Object.keys(s).length||Object.keys(r).length)&&(c.selectedGroupIds=s,l.selectedGroupIds=r),(Object.keys(o).length||Object.keys(a).length)&&(c.lockedMultiSelections=o,l.lockedMultiSelections=a),this.delta=Fe.merge(this.delta,t.delta,Fe.create(c,l)),this}applyTo(t,n){try{const{selectedElementIds:i={},selectedGroupIds:s={},lockedMultiSelections:r={}}=this.delta.deleted,{selectedElementIds:o={},selectedGroupIds:a={},lockedMultiSelections:l={},selectedLinearElement:c,...d}=this.delta.inserted,u=Fe.mergeObjects(t.selectedElementIds,o,i),f=Fe.mergeObjects(t.selectedGroupIds,a,s),h=Fe.mergeObjects(t.lockedMultiSelections,l,r),m=c&&n.has(c.elementId)?new ne(n.get(c.elementId),n,c.isEditing):null,p={...t,...d,selectedElementIds:u,selectedGroupIds:f,lockedMultiSelections:h,selectedLinearElement:typeof c<"u"?m:t.selectedLinearElement},U=this.filterInvisibleChanges(t,p,n);return[p,U]}catch(i){return console.error("Couldn't apply appstate change",i),[t,!1]}}isEmpty(){return Fe.isEmpty(this.delta)}filterInvisibleChanges(t,n,i){const s=Dh(t),r=Dh(n),o=Fe.isRightDifferent(Bn.stripElementsProps(s),Bn.stripElementsProps(r)),a=Fe.isRightDifferent(Bn.stripStandaloneProps(s),Bn.stripStandaloneProps(r));if(!o&&!a)return!1;const l={value:o};if(a){const c=Fe.getRightDifferences(Bn.stripStandaloneProps(s),Bn.stripStandaloneProps(r));let d=new Set;(c.includes("editingGroupId")||c.includes("selectedGroupIds"))&&(d=Cue(i));for(const u of c)switch(u){case"selectedElementIds":n[u]=Bn.filterSelectedElements(n[u],i,l);break;case"selectedGroupIds":n[u]=Bn.filterSelectedGroups(n[u],d,l);break;case"croppingElementId":{const y=n[u];if(!y)l.value=!0;else{const E=i.get(y);E&&!E.isDeleted?l.value=!0:n[u]=null}break}case"editingGroupId":const f=n[u];f?d.has(f)?l.value=!0:n[u]=null:l.value=!0;break;case"selectedLinearElement":const h=n[u];if(!h)l.value=!0;else{const y=i.get(h.elementId);y&&!y.isDeleted?l.value=!0:n[u]=null}break;case"lockedMultiSelections":const m=t[u]||{},p=n[u]||{};ki(m,p)||(l.value=!0);break;case"activeLockedId":const U=t[u]||null,b=n[u]||null;U!==b&&(l.value=!0);break;default:Ua(u,`Unknown ObservedElementsAppState's key "${u}"`,!0)}}return l.value}static filterSelectedElements(t,n,i){const s=Object.keys(t);if(!s.length)return i.value=!0,t;const r={...t};for(const o of s){const a=n.get(o);a&&!a.isDeleted?i.value=!0:delete r[o]}return r}static filterSelectedGroups(t,n,i){if(!Object.keys(t).length)return i.value=!0,t;const r={...t};for(const o of Object.keys(r))n.has(o)?i.value=!0:delete r[o];return r}static stripElementsProps(t){const{editingGroupId:n,selectedGroupIds:i,selectedElementIds:s,selectedLinearElement:r,croppingElementId:o,lockedMultiSelections:a,activeLockedId:l,...c}=t;return c}static stripStandaloneProps(t){const{name:n,viewBackgroundColor:i,...s}=t;return s}static postProcess(t,n){try{Fe.diffObjects(t,n,"selectedElementIds",i=>!0),Fe.diffObjects(t,n,"selectedGroupIds",i=>i??!1),Fe.diffObjects(t,n,"lockedMultiSelections",i=>i??{})}catch{console.error("Couldn't postprocess appstate change deltas.")}finally{return[t,n]}}static orderAppStateKeys(t){const n={};for(const i of Object.keys(t).sort())n[i]=t[i];return n}}const St=class St{constructor(t,n,i){this.added=t,this.removed=n,this.updated=i}static create(t,n,i,s={shouldRedistribute:!1}){let r;if(s.shouldRedistribute){const o={},a={},l={},c=[...Object.entries(t),...Object.entries(n),...Object.entries(i)];for(const[d,u]of c)this.satisfiesAddition(u)?o[d]=u:this.satisfiesRemoval(u)?a[d]=u:l[d]=u;r=new St(o,a,l)}else r=new St(t,n,i);return r}static restore(t){const{added:n,removed:i,updated:s}=t;return St.create(n,i,s)}static validate(t,n,i){for(const[s,r]of Object.entries(t[n]))if(!this.satisfiesCommmonInvariants(r)||!this.satisfiesUniqueInvariants(t,s)||!i(r))throw console.error(`Broken invariant for "${n}" delta, element "${s}", delta:`,r),new Error(`ElementsDelta invariant broken for element "${s}".`)}static calculate(t,n){if(t===n)return St.empty();const i={},s={},r={};for(const o of t.values())if(!n.get(o.id)){const l={...o},c={isDeleted:!0,version:o.version+1,versionNonce:to()},d=Fe.create(l,c,St.stripIrrelevantProps);o.isDeleted?r[o.id]=d:s[o.id]=d}for(const o of n.values()){const a=t.get(o.id);if(!a){const l={isDeleted:!0,version:o.version-1,versionNonce:to()},c={...o},d=Fe.create(l,c,St.stripIrrelevantProps);o.isDeleted?r[o.id]=d:i[o.id]=d;continue}if(a.versionNonce!==o.versionNonce){const l=Fe.calculate(a,o,St.stripIrrelevantProps,St.postProcess);if(typeof a.isDeleted=="boolean"&&typeof o.isDeleted=="boolean"&&a.isDeleted!==o.isDeleted){a.isDeleted&&!o.isDeleted?i[o.id]=l:s[o.id]=l;continue}r[o.id]=l}}return St.create(i,s,r)}static empty(){return St.create({},{},{})}inverse(){const t=r=>{const o={};for(const[a,{inserted:l,deleted:c}]of Object.entries(r))o[a]=Fe.create({...l},{...c});return o},n=t(this.added),i=t(this.removed),s=t(this.updated);return St.create(i,n,s)}isEmpty(){return Object.keys(this.added).length===0&&Object.keys(this.removed).length===0&&Object.keys(this.updated).length===0}applyLatestChanges(t,n,i){const s=(c,d)=>(u,f)=>{let h;switch(f){case"deleted":h=c;break;case"inserted":h=d;break}if(!h)return console.error("Element not found when trying to apply latest changes"),u;const m={};for(const p of Object.keys(u))switch(p){case"boundElements":m[p]=u[p];break;default:m[p]=h[p]}return m},r=c=>{const d={};for(const[u,f]of Object.entries(c)){const h=t.get(u),m=n.get(u);let p=null;h||m?p=Fe.create(f.deleted,f.inserted,s(h,m),i):p=f,Fe.isInnerDifferent(p.deleted,p.inserted)&&(d[u]=p)}return d},o=r(this.added),a=r(this.removed),l=r(this.updated);return St.create(o,a,l,{shouldRedistribute:!0})}applyTo(t,n=ra.empty().elements,i){let s=new Map(t),r;const o={containsVisibleDifference:!1,containsZindexDifference:!1,applyDirection:void 0};try{const a=St.createApplier(t,s,n,o,i),l=a(this.added),c=a(this.removed),d=a(this.updated),u=this.resolveConflicts(t,s,o.applyDirection);r=new Map([...l,...c,...d,...u])}catch(a){return console.error("Couldn't apply elements delta",a),[t,!0]}try{s=St.reorderElements(s,r,o),St.redrawElements(s,r)}catch(a){console.error("Couldn't mutate elements after applying elements change",a)}finally{return[s,o.containsVisibleDifference]}}squash(t){if(t.isEmpty())return this;const{added:n,removed:i,updated:s}=t,r=(o,a)=>{const l=Fe.mergeArrays(o.deleted.boundElements??[],a.deleted.boundElements??[],void 0,d=>d.id)??[],c=Fe.mergeArrays(o.inserted.boundElements??[],a.inserted.boundElements??[],void 0,d=>d.id)??[];if(!(!l.length&&!c.length))return Fe.create({boundElements:l},{boundElements:c})};for(const[o,a]of Object.entries(n)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.added[o]=a;else{const c=r(l,a);delete this.removed[o],delete this.updated[o],this.added[o]=Fe.merge(l,a,c)}}for(const[o,a]of Object.entries(i)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.removed[o]=a;else{const c=r(l,a);delete this.added[o],delete this.updated[o],this.removed[o]=Fe.merge(l,a,c)}}for(const[o,a]of Object.entries(s)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.updated[o]=a;else{const c=r(l,a),d=Fe.merge(l,a,c);l===this.added[o]?this.added[o]=d:l===this.removed[o]?this.removed[o]=d:this.updated[o]=d}}return this}static applyDelta(t,n,i,s){var o,a,l;const r={};for(const c of Object.keys(n.inserted)){if(c==="boundElements"||(o=s==null?void 0:s.excludedProperties)!=null&&o.has(c))continue;const d=n.inserted[c];Reflect.set(r,c,d)}if((a=n.deleted.boundElements)!=null&&a.length||(l=n.inserted.boundElements)!=null&&l.length){const c=Fe.mergeArrays(t.boundElements,n.inserted.boundElements,n.deleted.boundElements,d=>d.id);Object.assign(r,{boundElements:c})}if(!i.containsVisibleDifference){const{index:c,...d}=r,u=St.checkForVisibleDifference(t,d);i.containsVisibleDifference=u}return i.containsZindexDifference||(i.containsZindexDifference=n.deleted.index!==n.inserted.index),xe(t,r,!0)}static checkForVisibleDifference(t,n){return t.isDeleted&&n.isDeleted!==!1?!1:t.isDeleted&&n.isDeleted===!1||t.isDeleted===!1&&n.isDeleted?!0:Fe.isRightDifferent(t,n)}resolveConflicts(t,n,i="forward"){const s=new Map,r=(a,l)=>{const c=n.get(a.id);if(!c)return;const d=t.get(a.id),u=i==="forward"?c.version+1:c.version-1,f=l;let h;d===c?h=xe(c,{...f,version:u},!0):h=Dn(c,n,{...f,version:(d==null?void 0:d.version)!==c.version?c.version:u}),s.set(h.id,h),n.set(h.id,h)};for(const a of Object.keys(this.removed))St.unbindAffected(t,n,a,r);for(const a of Object.keys(this.added))St.rebindAffected(t,n,a,r);for(const[a]of Array.from(Object.entries(this.updated)).filter(([l,c])=>Object.keys({...c.deleted,...c.inserted}).find(d=>fue.has(d)))){const l=n.get(a);!l||l.isDeleted||St.rebindAffected(t,n,a,r)}const o=new Map(Array.from(t).filter(([a])=>s.has(a)));return this.squash(St.calculate(o,s)),s}static unbindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);hh.unbindAffected(n,r(),s),hh.unbindAffected(n,o(),s),gh.unbindAffected(n,r(),s),gh.unbindAffected(n,o(),s)}static rebindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);hh.unbindAffected(n,r(),s),hh.rebindAffected(n,o(),s),gh.unbindAffected(n,r(),(a,l)=>{he(a)&&s(a,l)}),gh.rebindAffected(n,o(),s)}static redrawElements(t,n){try{const i=new u5(t,{skipValidation:!0});St.redrawTextBoundingBoxes(i,n),St.redrawBoundArrows(i,n)}catch(i){console.error("Couldn't redraw elements",i)}finally{return t}}static redrawTextBoundingBoxes(t,n){const i=t.getNonDeletedElementsMap(),s=new Map;for(const r of n.values()){if(Vt(r)){const{containerId:o}=r,a=o?i.get(o):void 0;a&&s.set(a.id,{container:a,boundText:r})}if(Ki(r)){const o=va(r),a=o?i.get(o):void 0;a&&s.set(r.id,{container:r,boundText:a})}}for(const{container:r,boundText:o}of s.values())r.isDeleted||o.isDeleted||fs(o,r,t)}static redrawBoundArrows(t,n){for(const i of n.values())!i.isDeleted&&si(i)&&pi(i,t,{changedElements:n})}static reorderElements(t,n,i){if(!i.containsZindexDifference)return t;const s=Array.from(t.values()),r=RT([...s]),o=Fe.getRightDifferences(s,r,!0).reduce((a,l)=>{const c=s[Number(l)];return c&&n.has(c.id)&&a.set(c.id,c),a},new Map);return!i.containsVisibleDifference&&o.size&&(i.containsVisibleDifference=!0),we(Mo(r,o))}static postProcess(t,n){try{Fe.diffArrays(t,n,"boundElements",r=>r.id);const i=t.points??[],s=n.points??[];Fe.isDifferent(i,s)||(Reflect.deleteProperty(t,"points"),Reflect.deleteProperty(n,"points"))}catch{console.error("Couldn't postprocess elements delta.")}finally{return[t,n]}}static stripIrrelevantProps(t){const{id:n,updated:i,...s}=t;return s}};B(St,"satisfiesAddition",({deleted:t,inserted:n})=>t.isDeleted===!0&&!n.isDeleted),B(St,"satisfiesRemoval",({deleted:t,inserted:n})=>!t.isDeleted&&n.isDeleted===!0),B(St,"satisfiesUpdate",({deleted:t,inserted:n})=>!!t.isDeleted==!!n.isDeleted),B(St,"satisfiesCommmonInvariants",({deleted:t,inserted:n})=>!!(Number.isInteger(t.version)&&Number.isInteger(n.version)&&t.version>=0&&n.version>=0&&t.version!==n.version)),B(St,"satisfiesUniqueInvariants",(t,n)=>{const{added:i,removed:s,updated:r}=t;return[i[n],s[n],r[n]].filter(Boolean).length===1}),B(St,"createApplier",(t,n,i,s,r)=>o=>{const a=St.createGetter(n,i,s);return Object.entries(o).reduce((l,[c,d])=>{const u=a(c,d.inserted);if(u){const f=St.applyDelta(u,d,s,r);if(n.set(f.id,f),l.set(f.id,f),!s.applyDirection){const h=t.get(c);h&&(s.applyDirection=h.version>f.version?"backward":"forward")}}return l},new Map)}),B(St,"createGetter",(t,n,i)=>(s,r)=>{let o=t.get(s);return o||(o=n.get(s),o?(i.containsZindexDifference=!0,(!r.isDeleted||r.isDeleted&&!o.isDeleted)&&(i.containsVisibleDifference=!0)):o=xe({id:s,version:1},{...r})),o});let Zd=St;const _fe=(e,t,n,i,s)=>{const[r,o,a,l]=n.axis==="x"?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],c=Kr(e),d=qy(e,t,i).map(m=>[m,Kr(m)]).sort((m,p)=>m[1][o]-p[1][o]);let u=0;for(const m of d)u+=m[1][l];const f=(c[l]-u)/(d.length-1);if(f<0){const m=d.findIndex(y=>y[1][r]===c[r]),p=d.findIndex(y=>y[1][a]===c[a]),U=(d[p][1][o]-d[m][1][o])/(d.length-1);let b=d[m][1][o];return d.flatMap(([y,E],_)=>{const I={x:0,y:0};return _!==m&&_!==p&&(b+=U,I[n.axis]=b-E[o]),y.map(k=>{const w=s.mutateElement(k,{x:k.x+I.x,y:k.y+I.y});return pi(k,s,{simultaneouslyUpdated:y}),w})})}let h=c[r];return d.flatMap(([m,p])=>{const U={x:0,y:0};return U[n.axis]=h-p[r],h+=f,h+=p[l],m.map(b=>{const y=s.mutateElement(b,{x:b.x+U.x,y:b.y+U.y});return pi(b,s,{simultaneouslyUpdated:m}),y})})},wfe=(e,t,n,i,s,r)=>{if(t.length===1&&ve(t[0])&&(t[0].startBinding||t[0].endBinding))return;const o=t.filter(f=>{if(ve(f)&&f.startBinding&&f.endBinding){const h=t.find(p=>{var U;return p.id===((U=f.startBinding)==null?void 0:U.elementId)}),m=t.find(p=>{var U;return p.id===((U=f.endBinding)==null?void 0:U.elementId)});return h&&m}return!0}),a=new Set(o),l=o.filter(f=>_e(f)).map(f=>f.id);if(l.length>0)for(const f of i.getNonDeletedElements())f.frameId!==null&&l.includes(f.frameId)&&a.add(f);const c=[];for(const f of a){const h=e.originalElements.get(f.id);if(!h)return;c.push(h)}const d=Tfe(Et(c),n,s,r),u=new Set(Array.from(a,f=>f.id));a.forEach(f=>{const h=!Te(f),m=h||(f.startBinding?u.has(f.startBinding.elementId):!1),p=h||(f.endBinding?u.has(f.endBinding.elementId):!1);if(Te(f)){if(a.size>1||Math.max(Math.abs(d.x),Math.abs(d.y))>O0||!f.startBinding&&!f.endBinding){G3(e,f,i,d);const U=f.startBinding&&!m,b=f.endBinding&&!p;(U||b)&&(U&&Cs(f,"start",i),b&&Cs(f,"end",i))}}else{G3(e,f,i,d);const U=Ne(f,i.getNonDeletedElementsMap());U&&G3(e,U,i,d),pi(f,i,{simultaneouslyUpdated:Array.from(a)})}})},Tfe=(e,t,n,i)=>{const[s,r]=e;let o=s+t.x+n.x,a=r+t.y+n.y;if(n.x===0||n.y===0){const[l,c]=ci(s+t.x,r+t.y,i);n.x===0&&(o=l),n.y===0&&(a=c)}return{x:o-s,y:a-r}},G3=(e,t,n,i)=>{const s=e.originalElements.get(t.id)??t,r=s.x+i.x,o=s.y+i.y;n.mutateElement(t,{x:r,y:o})},Ife=(e,t,n)=>{const[i,s]=Et(e);return[t-i,n-s]},jk=({newElement:e,elementType:t,originX:n,originY:i,x:s,y:r,width:o,height:a,shouldMaintainAspectRatio:l,shouldResizeFromCenter:c,zoom:d,scene:u,widthAspectRatio:f=null,originOffset:h=null,informMutation:m=!0})=>{l&&e.type!=="selection"&&(f?a=o/f:(Math.abs(r-i)>Math.abs(s-n)?{width:o,height:a}=zk(t,a,s<n?-o:o):{width:o,height:a}=zk(t,o,r<i?-a:a),a<0&&(a=-a)));let p=s<n?n-o:n,U=r<i?i-a:i;c&&(o+=o,a+=a,p=n-o/2,U=i-a/2);let b=null;if(he(e)){a=e.height;const y=nT(_t({fontSize:e.fontSize,fontFamily:e.fontFamily}),e.lineHeight);o=Math.max(o,y),Math.abs(s-n)>Wne/d&&(b={autoResize:!1}),U=i,c&&(p=n-o/2)}if(o!==0&&a!==0){let y=null;xt(e)&&(y={initialWidth:o,initialHeight:a}),u.mutateElement(e,{x:p+((h==null?void 0:h.x)??0),y:U+((h==null?void 0:h.y)??0),width:o,height:a,...b,...y},{informMutation:m,isDragging:!1})}},LV=(e,t)=>{const n=window.location.href;try{const i=new URL(n);return i.searchParams.set(F6,e),Ur(i.toString())}catch(i){console.error(i)}return Ur(n)},PV=(e,t)=>{if(e.length>0&&f5(e)){if(e.length===1)return{id:e[0].id,type:"element"};if(e.length>1){const n=Object.keys(t.selectedGroupIds)[0];return n?{id:n,type:"group"}:{id:e[0].groupIds[0],type:"group"}}}return null},f5=e=>!!(e.length===1||e.length>1&&UT(e)),Lh=e=>{try{const t=new URL(e);return t.searchParams.has(F6)&&t.host===window.location.host}catch{return!1}},Sfe=e=>{try{const{searchParams:t}=new URL(e);if(t.has(F6))return t.get(F6)}catch{}return null},ko=(e,{x:t,y:n,strokeColor:i=En.strokeColor,backgroundColor:s=En.backgroundColor,fillStyle:r=En.fillStyle,strokeWidth:o=En.strokeWidth,strokeStyle:a=En.strokeStyle,roughness:l=En.roughness,opacity:c=En.opacity,width:d=0,height:u=0,angle:f=0,groupIds:h=[],frameId:m=null,index:p=null,roundness:U=null,boundElements:b=null,link:y=null,locked:E=En.locked,..._})=>((t<-1e6||t>1e6||n<-1e6||n>1e6||d<-1e6||d>1e6||u<-1e6||u>1e6)&&console.error("New element size or position is too large",{x:t,y:n,width:d,height:u,points:_.points}),{id:_.id||Li(),type:e,x:t,y:n,width:d,height:u,angle:f,strokeColor:i,backgroundColor:s,fillStyle:r,strokeWidth:o,strokeStyle:a,roughness:l,opacity:c,groupIds:h,frameId:m,index:p,roundness:U,seed:_.seed??to(),version:_.version||1,versionNonce:_.versionNonce??0,isDeleted:!1,boundElements:b,updated:Gg(),link:y,locked:E,customData:_.customData}),Ta=e=>ko(e.type,e),Yk=e=>ko("embeddable",e),Cfe=e=>({...ko("iframe",e)}),LT=e=>xe({...ko("frame",e),type:"frame",name:(e==null?void 0:e.name)||null},{}),X4=e=>xe({...ko("magicframe",e),type:"magicframe",name:(e==null?void 0:e.name)||null},{}),NV=(e,t)=>({x:e.textAlign==="center"?t.width/2:e.textAlign==="right"?t.width:0,y:e.verticalAlign==="middle"?t.height/2:0}),_r=e=>{const t=e.fontFamily||Td,n=e.fontSize||$l,i=e.lineHeight||id(t),s=fg(e.text),r=ri(s,_t({fontFamily:t,fontSize:n}),i),o=e.textAlign||$p,a=e.verticalAlign||L6,l=NV({textAlign:o,verticalAlign:a},r),c={...ko("text",e),text:s,fontSize:n,fontFamily:t,textAlign:o,verticalAlign:a,x:e.x-l.x,y:e.y-l.y,width:r.width,height:r.height,containerId:e.containerId||null,originalText:e.originalText??s,autoResize:e.autoResize??!0,lineHeight:i};return xe(c,{})},xfe=(e,t,n)=>{let{width:i,height:s}=ri(n,_t(e),e.lineHeight);e.autoResize||(i=e.width);const{textAlign:r,verticalAlign:o}=e;let a,l;if(r==="center"&&o===lr.MIDDLE&&!e.containerId&&e.autoResize){const c=ri(e.text,_t(e),e.lineHeight),d=NV(e,{width:i-c.width,height:s-c.height});a=e.x-d.x,l=e.y-d.y}else{const[c,d,u,f]=je(e,t),[h,m,p,U]=X0(e,i,s,!1),b=(c-h)/2,y=(d-m)/2,E=(u-p)/2,_=(f-U)/2;[a,l]=Afe({s:!0,e:r==="center"||r==="left",w:r==="center"||r==="right"},e.x,e.y,e.angle,b,y,E,_)}return{width:i,height:s,x:Number.isFinite(a)?a:e.x,y:Number.isFinite(l)?l:e.y}},Afe=(e,t,n,i,s,r,o,a)=>{const l=Math.cos(i),c=Math.sin(i);return e.e&&e.w?t+=s+o:e.e?(t+=s*(1+l),n+=s*c,t+=o*(1-l),n+=o*-c):e.w&&(t+=s*(1-l),n+=s*-c,t+=o*(1+l),n+=o*c),e.n&&e.s?n+=r+a:e.n?(t+=r*c,n+=r*(1-l),t+=a*-c,n+=a*(1+l)):(t+=r*-c,n+=r*(1+l),t+=a*c,n+=a*(1-l)),[t,n]},OV=(e,t,n,i=e.text)=>{if(e.isDeleted)return;(t||!e.autoResize)&&(i=Sd(i,_t(e),t?_a(t,e):e.width));const s=xfe(e,n,i);return{text:i,...s}},Mfe=e=>({...ko(e.type,e),points:e.points||[],pressures:e.pressures||[],simulatePressure:e.simulatePressure}),Hc=e=>{const t={...ko(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:null,endArrowhead:null};return cn(t)?{...t,polygon:e.polygon??!1}:t},Ph=e=>e.elbowed?{...ko(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!0,fixedSegments:e.fixedSegments||[],startIsSpecial:!1,endIsSpecial:!1}:{...ko(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!1},FV=e=>({...ko("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1],crop:e.crop??null}),Fo=new Map,kfe=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)/,Rfe=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}\.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,Dfe=/^https:\/\/(?:www\.)?figma\.com/,Wk=/^https:\/\/gist\.github\.com\/([\w_-]+)\/([\w_-]+)/,Lfe=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist\.github\.com\/.*?)\.js["']/i,Pfe=/^(?:https?:\/\/)?forms\.microsoft\.com\//,Kk=/(?:https?:\/\/)?(?:(?:w){3}\.)?(?:twitter|x)\.com\/[^/]+\/status\/(\d+)/,Nfe=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:twitter|x)\.com\/[^"']*)/i,Ofe=/^https:\/\/(?:www\.)?val\.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,Ffe=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,Zk=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,qk=/^(?:http(?:s)?:\/\/)?(?:www\.)?reddit\.com\/r\/([a-zA-Z0-9_]+)\/comments\/([a-zA-Z0-9_]+)\/([a-zA-Z0-9_]+)\/?(?:\?[^#\s]*)?(?:#[^\s]*)?$/,Bfe=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:www\.)?reddit\.com\/[^"']*)/i,zfe=e=>{let t;try{const o=new URL(e.startsWith("http")?e:`https://${e}`);t=o.searchParams.get("t")||o.searchParams.get("start")}catch{const a=e.match(/[?&#](?:t|start)=([^&#\s]+)/);t=a==null?void 0:a[1]}if(!t)return 0;if(/^\d+$/.test(t))return parseInt(t,10);const n=t.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/);if(!n)return 0;const[,i="0",s="0",r="0"]=n;return parseInt(i)*3600+parseInt(s)*60+parseInt(r)},j4=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","reddit.com","forms.microsoft.com"]),Qk=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","reddit.com","forms.microsoft.com"]),e0=e=>`<html><body>${e}</body></html>`,ph=e=>{if(!e)return null;if(Fo.has(e))return Fo.get(e);const t=e,n=Qk.has(Y4(e,Qk)||"");let i="generic",s={w:560,h:840};const r=e.match(kfe);if(r!=null&&r[2]){const c=zfe(t),d=c>0?`&start=${c}`:"",u=e.includes("shorts");switch(i="video",r[1]){case"embed/":case"watch?v=":case"shorts/":e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${d}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${r[2]}&enablejsapi=1${d}`;break;default:e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${d}`;break}return s=u?{w:315,h:560}:{w:560,h:315},Fo.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}}const o=e.match(Rfe);if(o!=null&&o[1]){const c=o==null?void 0:o[1],d=/^\d+$/.test(c)?void 0:new URIError("Invalid embed link format");return i="video",e=`https://player.vimeo.com/video/${c}?api=1`,s={w:560,h:315},Fo.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,error:d,sandbox:{allowSameOrigin:n}}}if(e.match(Dfe))return i="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,s={w:550,h:550},Fo.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};const l=e.match(Ofe);if(l)return e=l[1]==="embed"?l[0]:l[0].replace("/v","/embed"),Fo.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};if(Pfe.test(e)&&!e.includes("embed=true")&&(e+=e.includes("?")?"&embed=true":"?embed=true"),Kk.test(e)){const c=e.match(Kk)[1],d=Eb(`https://twitter.com/x/status/${c}`),u={type:"document",srcdoc:f=>e0(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${f}"><a href="${d}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Fo.set(t,u),u}if(qk.test(e)){const[,c,d,u]=e.match(qk),f=Eb(`https://reddit.com/r/${c}/comments/${d}/${u}`),h={type:"document",srcdoc:m=>e0(`<blockquote class="reddit-embed-bq" data-embed-theme="${m}"><a href="${f}"></a><br></blockquote><script async="" src="https://embed.reddit.com/widgets.js" charset="UTF-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Fo.set(t,h),h}if(Wk.test(e)){const[,c,d]=e.match(Wk),u=Eb(`https://gist.github.com/${c}/${d}`),f={type:"document",srcdoc:()=>e0(`
          <script src="${u}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720},sandbox:{allowSameOrigin:n}};return Fo.set(e,f),f}return Fo.set(e,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}},BV=e=>{let t;uc(e)?t="IFrame element":t=!e.link||(e==null?void 0:e.link)===""?"Empty Web-Embed":e.link;const n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),i=ct.Helvetica,s=_t({fontSize:n,fontFamily:i});return _r({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:e.strokeColor!=="transparent"?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:i,fontSize:n,text:Sd(t,s,e.width-20),textAlign:"center",verticalAlign:lr.MIDDLE,angle:e.angle??0})},Y4=(e,t)=>{try{const{hostname:n}=new URL(e),i=n.replace(/^www\./,"");if(t instanceof Set){if(j4.has(i))return i;const r=i.replace(/^([^.]+)/,"*");return j4.has(r)?r:null}const s=t.replace(/^www\./,"");if(i===s)return s}catch{}return null},Hfe=e=>{const t=e.match(Nfe);if(t&&t.length===2)return t[1];const n=e.match(Bfe);if(n&&n.length===2)return n[1];const i=e.match(Lfe);if(i&&i.length===2)return i[1];if(Zk.test(e))return`https://giphy.com/embed/${Zk.exec(e)[1]}`;const s=e.match(Ffe);return s&&s.length===2?s[1]:e},xb=(e,t)=>{if(!e)return!1;if(t!=null)if(typeof t=="function"){const n=t(e);if(typeof n=="boolean")return n}else{if(typeof t=="boolean")return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(const n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(Y4(e,n))return!0;return!1}}return!!Y4(e,j4)},Nh=100,nu=100,Jk=e=>{switch(e){case $.ARROW_UP:return"up";case $.ARROW_DOWN:return"down";case $.ARROW_RIGHT:return"right";case $.ARROW_LEFT:return"left";default:return"right"}},zV=(e,t,n,i)=>{const s=[...n.values()].reduce((r,o)=>{var l;let a;if(ve(o)&&(a=o[e==="predecessors"?"startBinding":"endBinding"])&&((l=o[e==="predecessors"?"endBinding":"startBinding"])==null?void 0:l.elementId)===t.id){const c=n.get(a.elementId);if(!c)return r;Ce(si(c),"not an ExcalidrawBindableElement");const d=e==="predecessors"?o.points[o.points.length-1]:[0,0],u=lT(t,qa(t,n),[d[0]+o.x,d[1]+o.y]);r.push({relative:c,heading:u})}return r},[]);switch(i){case"up":return s.filter(r=>ni(r.heading,bo)).map(r=>r.relative);case"down":return s.filter(r=>ni(r.heading,ws)).map(r=>r.relative);case"right":return s.filter(r=>ni(r.heading,ei)).map(r=>r.relative);case"left":return s.filter(r=>ni(r.heading,zr)).map(r=>r.relative)}},W4=(e,t,n)=>zV("successors",e,t,n),K4=(e,t,n)=>zV("predecessors",e,t,n),Vfe=(e,t,n)=>{const i=nu+e.width;if(n==="up"||n==="down"){const a=Nh+e.height,l=e.x,c=e.x+e.width;if(t.every(d=>d.x+d.width<l||d.x>c))return{x:0,y:a*(n==="up"?-1:1)}}else if(n==="right"||n==="left"){const a=e.y,l=e.y+e.height;if(t.every(c=>c.y+c.height<a||c.y>l))return{x:(nu+e.width)*(n==="left"?-1:1),y:0}}if(n==="up"||n==="down"){const a=Nh+e.height,l=(t.length===0,a),c=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*i:t.length/2*i*-1;return n==="up"?{x:c,y:l*-1}:{x:c,y:l}}const s=Nh+e.height,r=(t.length===0,nu+e.width),o=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*s:t.length/2*s*-1;return n==="left"?{x:r*-1,y:o}:{x:r,y:o}},$fe=(e,t,n,i)=>{const s=i.getNonDeletedElementsMap(),r=W4(e,s,n),o=K4(e,s,n),a=Vfe(e,[...r,...o],n),l=Ta({type:e.type,x:e.x+a.x,y:e.y+a.y,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});Ce(Wy(l),"not an ExcalidrawFlowchartNodeElement");const c=HV(e,l,n,t,i);return{nextNode:l,bindingArrow:c}},Gfe=(e,t,n,i,s)=>{const r=[];for(let o=0;o<s;o++){let a,l;if(n==="left"||n==="right"){const u=Nh*(s-1)+s*e.height,f=e.y+e.height/2-u/2;let h=nu+e.width;n==="left"&&(h*=-1),a=e.x+h;const m=(Nh+e.height)*o;l=f+m}else{const u=nu*(s-1)+s*e.width,f=e.x+e.width/2-u/2;let h=Nh+e.height;n==="up"&&(h*=-1),l=e.y+h;const m=(nu+e.width)*o;a=f+m}const c=Ta({type:e.type,x:a,y:l,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});Ce(Wy(c),"not an ExcalidrawFlowchartNodeElement");const d=HV(e,c,n,t,i);r.push(c),r.push(d)}return r},HV=(e,t,n,i,s)=>{let r,o;switch(n){case"up":{r=e.x+e.width/2,o=e.y-6;break}case"down":{r=e.x+e.width/2,o=e.y+e.height+6;break}case"right":{r=e.x+e.width+6,o=e.y+e.height/2;break}case"left":{r=e.x-6,o=e.y+e.height/2;break}}let l,c;switch(n){case"up":{l=t.x+t.width/2-r,c=t.y+t.height-o+6;break}case"down":{l=t.x+t.width/2-r,c=t.y-o-6;break}case"right":{l=t.x-r-6,c=t.y-o+t.height/2;break}case"left":{l=t.x+t.width-r+6,c=t.y-o+t.height/2;break}}const d=Ph({type:"arrow",x:r,y:o,startArrowhead:null,endArrowhead:i.currentItemEndArrowhead,strokeColor:e.strokeColor,strokeStyle:e.strokeStyle,strokeWidth:e.strokeWidth,opacity:e.opacity,roughness:e.roughness,points:[M(0,0),M(l,c)],elbowed:!0}),u=s.getNonDeletedElementsMap();Rl(d,e,"orbit","start",s),Rl(d,t,"orbit","end",s);const f=new Map;f.set(e.id,e),f.set(t.id,t),f.set(d.id,d),ne.movePoints(d,s,new Map([[1,{point:d.points[1]}]]));const h=Yg(d,new Map([...u.entries(),[e.id,e],[t.id,t],[d.id,d]]),{points:d.points});return{...d,...h}};class Xfe{constructor(){B(this,"isExploring",!1);B(this,"sameLevelNodes",[]);B(this,"sameLevelIndex",0);B(this,"direction",null);B(this,"visitedNodes",new Set)}clear(){this.isExploring=!1,this.sameLevelNodes=[],this.sameLevelIndex=0,this.direction=null,this.visitedNodes.clear()}exploreByDirection(t,n,i){if(!si(t))return null;if(i!==this.direction&&this.clear(),this.visitedNodes.has(t.id)||this.visitedNodes.add(t.id),this.isExploring&&i===this.direction&&this.sameLevelNodes.length>1)return this.sameLevelIndex=(this.sameLevelIndex+1)%this.sameLevelNodes.length,this.sameLevelNodes[this.sameLevelIndex].id;const s=[...W4(t,n,i),...K4(t,n,i)];if(s.length>0)return this.sameLevelIndex=0,this.isExploring=!0,this.sameLevelNodes=s,this.direction=i,this.visitedNodes.add(s[0].id),s[0].id;if(i===this.direction||!this.isExploring){this.isExploring||this.visitedNodes.add(t.id);const o=["up","right","down","left"].filter(a=>a!==i).map(a=>[...W4(t,n,a),...K4(t,n,a)]).flat().filter(a=>!this.visitedNodes.has(a.id));for(const a of o)if(!this.visitedNodes.has(a.id))return this.visitedNodes.add(a.id),this.isExploring=!0,this.direction=i,a.id}return null}}class jfe{constructor(){B(this,"isCreatingChart",!1);B(this,"numberOfNodes",0);B(this,"direction","right");B(this,"pendingNodes",null)}createNodes(t,n,i,s){const r=s.getNonDeletedElementsMap();if(i!==this.direction){const{nextNode:o,bindingArrow:a}=$fe(t,n,i,s);this.numberOfNodes=1,this.isCreatingChart=!0,this.direction=i,this.pendingNodes=[o,a]}else{this.numberOfNodes+=1;const o=Gfe(t,n,i,s,this.numberOfNodes);this.isCreatingChart=!0,this.direction=i,this.pendingNodes=o}if(t.frameId){const o=r.get(t.frameId);Ce(o&&OH(o),"not an ExcalidrawFrameElement"),o&&this.pendingNodes.every(a=>l2([a],o,r)||ad(a,o,r))&&(this.pendingNodes=this.pendingNodes.map(a=>Dn(a,r,{frameId:t.frameId})))}}clear(){this.isCreatingChart=!1,this.pendingNodes=null,this.direction=null,this.numberOfNodes=0}}const Yfe=(e,t)=>{var n,i;for(const[,s]of t)if(s.type==="arrow"&&(((n=s.startBinding)==null?void 0:n.elementId)===e.id||((i=s.endBinding)==null?void 0:i.elementId)===e.id))return!0;return!1},Z4=(e,t)=>e.frameId===t||e.id===t,VV=(e,t,n)=>{let i=[],s=[],r=null,o=-1;const a=we(n||Ze(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++o<e.length;){const l=e[o];a.get(l.id)?(s.length&&(i=i.concat(s),s=[]),i.push(o),r=o+1):l.isDeleted&&r===o?(r=o+1,s.push(o)):s=[]}return i},Wfe=e=>{let t=0;return e.reduce((n,i,s)=>(s>0&&e[s-1]!==i-1&&(t=++t),(n[t]||(n[t]=[])).push(i),n),[])},eR=(e,t,n,i)=>{var s,r;if("containerId"in e&&e.containerId){const o=i.getElement(e.containerId);if(o)return n==="left"?Math.min(t.indexOf(o),t.indexOf(e)):Math.max(t.indexOf(o),t.indexOf(e))}else{const o=(r=(s=e.boundElements)==null?void 0:s.find(a=>a.type!=="arrow"))==null?void 0:r.id;if(o){const a=i.getElement(o);if(a)return n==="left"?Math.min(t.indexOf(a),t.indexOf(e)):Math.max(t.indexOf(a),t.indexOf(e))}}},Kfe=(e,t)=>{let n=-1,i=-1;return e.forEach((s,r)=>{Z4(s,t)&&(n===-1&&(n=r),i=r)}),n===-1?[]:e.slice(n,i+1)},q4=(e,t,n,i,s,r)=>{const o=r||Bi(e,n,i);if(!o)return n;const a=Ne(o,i),l=he(o)?Gn(o,i):null,c=[o.id,a==null?void 0:a.id,l==null?void 0:l.id].filter(f=>!!f),d=n.findIndex(f=>c.includes(f.id)),u=n.findIndex(f=>f.id===t.id);if(u!==-1&&d!==-1&&u<d){const f=Array.from(n),h=f.splice(u,1)[0];f.splice(d,0,h),s.replaceAllElements(f)}return n},Zfe=(e,t,n,i,s,r)=>{const o=t[n],a=f=>f.isDeleted?!1:s?f.frameId===s:e.editingGroupId?f.groupIds.includes(e.editingGroupId):!0,l=i==="left"?qo(t,f=>a(f),Math.max(0,n-1)):Lz(t,f=>a(f),n+1),c=t[l];if(!c)return-1;if(e.editingGroupId){if((o==null?void 0:o.groupIds.join(""))===(c==null?void 0:c.groupIds.join("")))return eR(c,t,i,r)??l;if(!(c!=null&&c.groupIds.includes(e.editingGroupId)))return-1}if(!s&&(c.frameId||_e(c))){const f=Kfe(t,c.frameId||c.id);return i==="left"?t.indexOf(f[0]):t.indexOf(f[f.length-1])}if(!c.groupIds.length)return eR(c,t,i,r)??l;const d=e.editingGroupId?c.groupIds[c.groupIds.indexOf(e.editingGroupId)-1]:c.groupIds[c.groupIds.length-1],u=Ot(t,d);return u.length?i==="left"?t.indexOf(u[0]):t.indexOf(u[u.length-1]):l},$V=(e,t)=>t.reduce((n,i)=>{const s=e[i];return n.set(s.id,s),n},new Map),GV=(e,t,n,i)=>{const s=VV(e,t),r=$V(e,s);let o=Wfe(s);n==="right"&&(o=o.reverse());const a=new Set(s.filter(l=>_e(e[l])).map(l=>e[l].id));return o.forEach((l,c)=>{var E;const d=l[0],u=l[l.length-1],f=n==="left"?d:u,h=l.some(_=>{const I=e[_];return I.frameId&&a.has(I.frameId)})?null:(E=e[f])==null?void 0:E.frameId,m=Zfe(t,e,f,n,h,i);if(m===-1||f===m)return;const p=n==="left"?e.slice(0,m):e.slice(0,d),U=e.slice(d,u+1),b=n==="left"?e.slice(m,d):e.slice(u+1,m+1),y=n==="left"?e.slice(u+1):e.slice(m+1);e=n==="left"?[...p,...U,...b,...y]:[...p,...b,...U,...y]}),Mo(e,r),e},XV=(e,t,n,i,s)=>{const r=VV(e,t,s),o=$V(e,r),a=[];let l,c;if(n==="left"){if(i)l=Lz(e,m=>Z4(m,i));else if(t.editingGroupId){const m=Ot(e,t.editingGroupId);if(!m.length)return e;l=e.indexOf(m[0])}else l=0;c=r[r.length-1]}else{if(i)c=qo(e,m=>Z4(m,i));else if(t.editingGroupId){const m=Ot(e,t.editingGroupId);if(!m.length)return e;c=e.indexOf(m[m.length-1])}else c=e.length-1;l=r[0]}l===-1&&(l=0);for(let m=l;m<c+1;m++)r.includes(m)||a.push(e[m]);const d=Array.from(o.values()),u=e.slice(0,l),f=e.slice(c+1),h=n==="left"?[...u,...d,...a,...f]:[...u,...a,...d,...f];return Mo(h,o),h};function jV(e,t,n,i){const s=we(Ze(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),r={regularElements:[],frameChildren:new Map},o=new Set;for(const c of e)s.has(c.id)&&_e(c)&&o.add(c.id);for(const c of e)if(s.has(c.id))if(_e(c)||c.frameId&&o.has(c.frameId))r.regularElements.push(c);else if(!c.frameId)r.regularElements.push(c);else{const d=r.frameChildren.get(c.frameId)||[];d.push(c),r.frameChildren.set(c.frameId,d)}let a=e;const l=Array.from(r.frameChildren.entries());for(const[c,d]of l)a=i(e,t,n,c,d);return i(a,t,n,null,r.regularElements)}const qfe=(e,t,n)=>GV(e,t,"left",n),Qfe=(e,t,n)=>GV(e,t,"right",n),Jfe=(e,t)=>jV(e,t,"left",XV),ehe=(e,t)=>jV(e,t,"right",XV),j0=(e,t,n,i,s,r=!1)=>{var o;if(ve(t)||!or(s)||t.points.length!==2)return!1;if(!r){const a=((o=t.startBinding)==null?void 0:o.elementId)===n.id?0:t.points.length-1,l=ne.getPointAtIndexGlobalCoordinates(t,a,i);if(Qe(e,l)<Zy*1.5/s.zoom.value)return!1}return ol({element:n,elementsMap:i,point:e,threshold:sa(n,t),overrideShouldTestInside:!0})},the=(e,t,n,i,s,r,o)=>{const a=new Map,l=n?"startBinding":"endBinding",c=n?"endBinding":"startBinding";let d=e[l],u=e[c];if(d&&t){const f=t&&u&&d.elementId===u.elementId;o||f?d={...d,mode:"inside"}:d={...d,mode:"orbit"};const h=n?0:e.points.length-1,m=gl(e,l,d,t,i);m&&a.set(h,{point:m})}if(u&&u.mode==="orbit"){const f=i.get(u.elementId);if(f&&si(f)&&or(r)){const h=t&&u.elementId===t.id;o||h?u={...u,mode:"inside"}:u={...u,mode:"orbit"};const m=n?e.points.length-1:0,p=gl(e,c,u,f,i);p&&a.set(m,{point:p})}}a.size>0&&ne.movePoints(e,s,a,{[l]:d,[c]:u})},YV=(e,t,n,i,s,r,o)=>{var p,U,b;const a=ne.getElement(e.elementId,t);if(!a||!ln(a)||ve(a)||!e.hoveredFocusPointBinding||!e.draggedFocusPointBinding)return;const l=e.draggedFocusPointBinding==="start",c=l?a.startBinding:a.endBinding,{x:d,y:u}=e.pointerOffset,f=M(n.x-d,n.y-u),h=l?"startBinding":"endBinding",m=Fde(f,a,i.getNonDeletedElements(),t,vl(s.zoom));if(m&&or(s)){a[h]&&m.id!==(c==null?void 0:c.elementId)&&Cs(a,e.draggedFocusPointBinding,i);const y=o&&((p=a[h])==null?void 0:p.mode)==="orbit"?"inside":!o&&((U=a[h])==null?void 0:U.mode)==="inside"?"orbit":null;(!a[h]||y)&&Rl(a,m,y||"orbit",e.draggedFocusPointBinding,i,f),i.mutateElement(a,{[h]:{...a[h],elementId:m.id,mode:y||((b=a[h])==null?void 0:b.mode)||"orbit",...Nu(a,m,e.draggedFocusPointBinding,t,f)}})}else{const y=new Map,E=l?0:a.points.length-1;y.set(E,{point:ne.createPointAt(a,t,f[0],f[1],r)}),ne.movePoints(a,i,y),a[h]&&Cs(a,l?"start":"end",i)}the(a,m,l,t,i,s,o),m&&or(s)&&q4(f,a,i.getElementsIncludingDeleted(),t,i,m)},nhe=(e,t,n,i)=>{var o,a;const s=M(t.origin.x,t.origin.y),r=Zy*1.5/i.zoom.value;if((o=e.startBinding)!=null&&o.elementId){const l=n.get(e.startBinding.elementId);if(l&&si(l)&&!l.isDeleted){const c=Ss(e.startBinding.fixedPoint,l,n);if(j0(c,e,l,n,i)&&Qe(s,c)<=r)return{hitFocusPoint:"start",pointerOffset:{x:s[0]-c[0],y:s[1]-c[1]}}}}if((a=e.endBinding)!=null&&a.elementId){const l=n.get(e.endBinding.elementId);if(l&&si(l)&&!l.isDeleted){const c=Ss(e.endBinding.fixedPoint,l,n);if(j0(c,e,l,n,i)&&Qe(s,c)<=r)return{hitFocusPoint:"end",pointerOffset:{x:s[0]-c[0],y:s[1]-c[1]}}}}return{hitFocusPoint:null,pointerOffset:{x:0,y:0}}},ihe=(e,t)=>{var c,d,u,f;Ce(e.draggedFocusPointBinding,"Must have a dragged focus point at pointer release");const n=ne.getElement(e.elementId,t.getNonDeletedElementsMap());Ce(n,"Arrow must be in the scene");const i=e.draggedFocusPointBinding==="start"?"startBinding":"endBinding",s=e.draggedFocusPointBinding==="start"?"endBinding":"startBinding",r=(c=n[i])==null?void 0:c.elementId,o=(d=n[s])==null?void 0:d.elementId,a=r&&t.getNonDeletedElements().find(h=>{var m;return h.id!==r&&h.id!==o&&si(h)&&((m=h.boundElements)==null?void 0:m.find(({id:p})=>p===n.id))});a&&t.mutateElement(a,{boundElements:(u=a.boundElements)==null?void 0:u.filter(({id:h})=>h!==n.id)});const l=r&&t.getNonDeletedElementsMap().get(r);l&&t.mutateElement(l,{boundElements:[...(f=l.boundElements||[])==null?void 0:f.filter(({id:h})=>h!==n.id),{id:n.id,type:"arrow"}]})},she=(e,t,n,i,s)=>{var l,c;const r=i.getNonDeletedElementsMap(),o=M(t,n),a=Zy*1.5/s.zoom.value;if((l=e.startBinding)!=null&&l.elementId){const d=r.get(e.startBinding.elementId);if(d&&si(d)&&!d.isDeleted){const u=Ss(e.startBinding.fixedPoint,d,r);if(j0(u,e,d,r,s)&&Qe(o,u)<=a)return"start"}}if((c=e.endBinding)!=null&&c.elementId){const d=r.get(e.endBinding.elementId);if(d&&si(d)&&!d.isDeleted){const u=Ss(e.endBinding.fixedPoint,d,r);if(j0(u,e,d,r,s)&&Qe(o,u)<=a)return"end"}}return null},rhe=e=>new Promise((t,n)=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=s=>{n(s)},i.src=e}),WV=async({fileIds:e,files:t,imageCache:n})=>{const i=new Map,s=new Map;return await Promise.all(e.reduce((r,o)=>{const a=t[o];return a&&!i.has(o)?(i.set(o,!0),r.concat((async()=>{try{if(a.mimeType===Ee.binary)throw new Error("Only images can be added to ImageCache");const l=rhe(a.dataURL),c={image:l,mimeType:a.mimeType};n.set(o,c);const d=await l;n.set(o,{...c,image:d})}catch{s.set(o,!0)}})())):r},[])),{imageCache:n,updatedFiles:i,erroredFiles:s}},KV=e=>e.filter(t=>Jn(t)),ohe=e=>(e==null?void 0:e.nodeName.toLowerCase())==="svg",tR=e=>{const t=new DOMParser().parseFromString(e,Ee.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!ohe(n))throw new Error("Invalid SVG");{n.hasAttribute("xmlns")||n.setAttribute("xmlns",ht);let s=n.getAttribute("width"),r=n.getAttribute("height");(s!=null&&s.includes("%")||s==="auto")&&(s=null),(r!=null&&r.includes("%")||r==="auto")&&(r=null);const o=n.getAttribute("viewBox");if(!s||!r){if(s=s||"50",r=r||"50",o){const a=o.match(/\d+ +\d+ +(\d+(?:\.\d+)?) +(\d+(?:\.\d+)?)/);a&&([,s,r]=a)}n.setAttribute("width",s),n.setAttribute("height",r)}return o||n.setAttribute("viewBox",`0 0 ${s} ${r}`),n.outerHTML}},nR=(e,t,n,i=50)=>{if(!e||e.length===0)return[];const s=[],r=Array.isArray(e[0])?e:e.map(h=>[h]),o=r.length,a=Math.max(1,Math.ceil(Math.sqrt(o))),l=[];for(let h=0;h<o;h+=a)l.push(r.slice(h,h+a));let c=0;const d=l.map(h=>{let m=0,p=0;const U=h.map(b=>{const[y,E,_,I]=Et(b);return{elements:b,bounds:[y,E,_,I],width:_-y,height:I-E}});return U.forEach((b,y)=>{m+=b.width,y<U.length-1&&(m+=i),b.height>p&&(p=b.height)}),c+=p,{unitBounds:U,width:m,maxHeight:p}}),u=c+Math.max(0,l.length-1)*i;let f=n-u/2;return d.forEach(h=>{const{unitBounds:m,width:p,maxHeight:U}=h;let b=t-p/2;m.forEach(y=>{const[E,_]=y.bounds,I=b-E,k=f-_;y.elements.forEach(w=>{s.push(xe(w,{x:w.x+I,y:w.y+k}))}),b+=y.width+i}),f+=U+i}),s},ahe=(e,t,n,i,s,r,o,a,l,c,d)=>{const u=i.getNonDeletedElementsMap();if(n.length===1){const[f]=n;if(t==="rotation")ve(f)||(lhe(f,i,a,l,s),pi(f,i));else if(t){const h=n[0].id,m=u.get(h),p=e.get(h);if(m&&p){const{nextWidth:U,nextHeight:b}=ghe(m,p,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});Y0(U,b,m,p,e,i,t,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r})}}return he(f)&&pi(f,i),!0}else if(n.length>1){if(t==="rotation")return dhe(e,n,i,a,l,s,c,d),!0;if(t){const{nextWidth:f,nextHeight:h,flipByX:m,flipByY:p,originalBoundingBox:U}=mhe(n,e,u,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});return ZV(n,u,t,i,e,{shouldResizeFromCenter:r,shouldMaintainAspectRatio:o,flipByX:m,flipByY:p,nextWidth:f,nextHeight:h,originalBoundingBox:U}),!0}}return!1},lhe=(e,t,n,i,s)=>{const[r,o,a,l]=je(e,t.getNonDeletedElementsMap()),c=(r+a)/2,d=(o+l)/2;let u;_e(e)?u=0:(u=5*Math.PI/2+Math.atan2(i-d,n-c),s&&(u=u+ir/2,u=u-u%ir),u=wo(u));const f=va(e);let h={angle:u};if(ln(e)&&(h={...h},e.startBinding&&Cs(e,"start",t),e.endBinding&&Cs(e,"end",t)),t.mutateElement(e,h),f){const m=t.getElement(f);if(m&&!Te(e)){const{x:p,y:U}=Cd(e,m,t.getNonDeletedElementsMap());t.mutateElement(m,{angle:u,x:p,y:U})}}},PT=(e,t,n,i)=>De(e)||us(e)?{points:B6(0,t,B6(1,n,e.points,i),i)}:{},NT=(e,t,n)=>{let i=e.width;if(Vt(e)){const o=Gn(e,t);o&&(i=_a(o,e))}const r=e.fontSize*(n/i);return r<I9?null:{size:r}},che=(e,t,n,i,s,r,o)=>{const a=n.getNonDeletedElementsMap(),l=t.width*(o/t.height),c=NT(t,a,l);if(c!==null){if(i.includes("n")||i.includes("s")){const d=M(e.x,e.y),u=Q4(d,e.width,e.height,l,o,e.angle,i,!1,s);n.mutateElement(t,{fontSize:c.size,width:l,height:o,x:u.x,y:u.y});return}if(i==="e"||i==="w"){const d=nT(_t({fontSize:t.fontSize,fontFamily:t.fontFamily}),t.lineHeight),u=Math.max(d,r),f=Sd(t.originalText,_t(t),Math.abs(u)),h=ri(f,_t(t),t.lineHeight),m=h.height,p=M(e.x,e.y),U=Q4(p,e.width,e.height,u,m,t.angle,i,!1,s),b={width:Math.abs(u),height:Math.abs(h.height),x:U.x,y:U.y,text:f,autoResize:!1};n.mutateElement(t,b)}}},dhe=(e,t,n,i,s,r,o,a)=>{var u;const l=n.getNonDeletedElementsMap();let c=5*Math.PI/2+Math.atan2(s-a,i-o);r&&(c+=ir/2,c-=c%ir);const d=new Map(t.map(f=>[f.id,f]));for(const f of t)if(!_e(f)){const[h,m,p,U]=je(f,l),b=(h+p)/2,y=(m+U)/2,E=((u=e.get(f.id))==null?void 0:u.angle)??f.angle,[_,I]=Z(M(b,y),M(o,a),c+E-f.angle),k=ve(f)?{points:gue(f,l)}:{x:f.x+(_-b),y:f.y+(I-y),angle:wo(c+E)};n.mutateElement(f,k),pi(f,n,{simultaneouslyUpdated:t}),ln(f)&&(f.startBinding&&(d.has(f.startBinding.elementId)||Cs(f,"start",n)),f.endBinding&&(d.has(f.endBinding.elementId)||Cs(f,"end",n)));const w=Ne(f,l);if(w&&!Te(f)){const{x:T,y:A}=Cd(f,w,l);n.mutateElement(w,{x:T,y:A,angle:wo(c+E)})}}n.triggerUpdate()},uhe=(e,t,n,i,s)=>{const[r,o,a,l]=t.length===1?je(t[0],n):Et(t),c=(r+a)/2,d=(o+l)/2,u=t.length===1?t[0].angle:0;switch([i,s]=Z(M(i,s),M(c,d),-u),e){case"n":return Z(M(i-(r+a)/2,s-o),M(0,0),u);case"s":return Z(M(i-(r+a)/2,s-l),M(0,0),u);case"w":return Z(M(i-r,s-(o+l)/2),M(0,0),u);case"e":return Z(M(i-a,s-(o+l)/2),M(0,0),u);case"nw":return Z(M(i-r,s-o),M(0,0),u);case"ne":return Z(M(i-a,s-o),M(0,0),u);case"sw":return Z(M(i-r,s-l),M(0,0),u);case"se":return Z(M(i-a,s-l),M(0,0),u);default:return[0,0]}},fhe=(e,t)=>{const[,[n,i]]=t.points;return e==="nw"&&(n<0||i<0)||e==="ne"&&n>=0||e==="sw"&&n<=0||e==="se"&&(n>0||i>0)?"end":"origin"},hhe=(e,t,n)=>{if(n)return"center";if(t)switch(e){case"n":return"south-side";case"e":return"west-side";case"s":return"north-side";case"w":return"east-side";case"ne":return"bottom-left";case"nw":return"bottom-right";case"se":return"top-left";case"sw":return"top-right"}return["e","se","s"].includes(e)?"top-left":["n","nw","w"].includes(e)?"bottom-right":e==="ne"?"bottom-left":"top-right"},Q4=(e,t,n,i,s,r,o,a,l)=>{const c=hhe(o,a,l),[d,u]=e;switch(c){case"top-left":return{x:d+(t-i)/2+(i-t)/2*Math.cos(r)+(n-s)/2*Math.sin(r),y:u+(n-s)/2+(i-t)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"top-right":return{x:d+(t-i)/2*(Math.cos(r)+1)+(n-s)/2*Math.sin(r),y:u+(n-s)/2+(t-i)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"bottom-left":return{x:d+(t-i)/2*(1-Math.cos(r))+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)+(i-t)/2*Math.sin(r)};case"bottom-right":return{x:d+(t-i)/2*(Math.cos(r)+1)+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)+(t-i)/2*Math.sin(r)};case"center":return{x:d-(i-t)/2,y:u-(s-n)/2};case"east-side":return{x:d+(t-i)/2*(Math.cos(r)+1),y:u+(t-i)/2*Math.sin(r)+(n-s)/2};case"west-side":return{x:d+(t-i)/2*(1-Math.cos(r)),y:u+(i-t)/2*Math.sin(r)+(n-s)/2};case"north-side":return{x:d+(t-i)/2+(n-s)/2*Math.sin(r),y:u+(s-n)/2*(Math.cos(r)-1)};case"south-side":return{x:d+(t-i)/2+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)}}},Y0=(e,t,n,i,s,r,o,{shouldInformMutation:a=!0,shouldMaintainAspectRatio:l=!1,shouldResizeFromCenter:c=!1}={})=>{if(he(n)&&he(i))return che(i,n,r,o,c,e,t);let d={};const u=r.getNonDeletedElementsMap(),f=Ne(n,u);if(f){const U=s.get(f.id);if(U&&(d={fontSize:U.fontSize}),l){const b={...n,width:e},y=NT(f,u,_a(b,f));if(y===null)return;d={fontSize:y.size}}else{const b=jH(_t(f),f.lineHeight),y=YH(f.fontSize,f.lineHeight);e=Math.max(e,b),t=Math.max(t,y)}}const h=PT(i,e,t,!0);let m=M(i.x,i.y);if(De(i)){const[U,b]=Pn(i,s);m=M(U,b)}const p=Q4(m,i.width,i.height,e,t,i.angle,o,l,c);if(De(i)&&h.points){const U=i.x-m[0],b=i.y-m[1];p.x+=U,p.y+=b;const y=h.points[0][0],E=h.points[0][1];p.x+=y,p.y+=E,h.points=h.points.map(_=>M(_[0]-y,_[1]-E))}if(e<0&&(p.x=p.x+e),t<0&&(p.y=p.y+t),"scale"in n&&"scale"in i&&r.mutateElement(n,{scale:[(Math.sign(e)||i.scale[0])*i.scale[0],(Math.sign(t)||i.scale[1])*i.scale[1]]}),Te(n)&&f&&l){const U=e/n.width*f.fontSize;if(U<I9)return;d.fontSize=U}if(e!==0&&t!==0&&Number.isFinite(p.x)&&Number.isFinite(p.y)){let U={...p,width:Math.abs(e),height:Math.abs(t),...h};ln(n)&&(n.startBinding&&(U={...U},n.startBinding&&Cs(n,"start",r)),n.endBinding&&(U={...U,endBinding:null})),r.mutateElement(n,U,{informMutation:a,isDragging:!1}),f&&d!=null&&r.mutateElement(f,{fontSize:d.fontSize}),s2(n,r,o,l),pi(n,r)}},ghe=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1}={})=>{const[a,l,c,d]=X0(t,t.width,t.height,!0),u=M(a,l),f=M(c,d),h=x6(u,f),m=Z(M(i,s),h,-t.angle),[p,U,b,y]=X0(e,e.width,e.height,!0),E=b-p,_=y-U,I=f[0]-u[0],k=f[1]-u[1];let w=I/E,T=k/_;n.includes("e")&&(w=(m[0]-u[0])/E),n.includes("s")&&(T=(m[1]-u[1])/_),n.includes("w")&&(w=(f[0]-m[0])/E),n.includes("n")&&(T=(f[1]-m[1])/_);let A=e.width*w,S=e.height*T;if(o&&(A=2*A-t.width,S=2*S-t.height),r){const D=Math.abs(A)/t.width,N=Math.abs(S)/t.height;if(n.length===1&&(S*=D,A*=N),n.length===2){const L=Math.max(D,N);A=t.width*L*Math.sign(A),S=t.height*L*Math.sign(S)}}return{nextWidth:A,nextHeight:S}},mhe=(e,t,n,i,s,r,{shouldMaintainAspectRatio:o=!1,shouldResizeFromCenter:a=!1}={})=>{const l=e.map(L=>t.get(L.id)),c=l.reduce((L,j)=>{if(!De(j))return L;const Y=va(j);if(!Y)return L;const G=t.get(Y)??null;return Vt(G)?[...L,{...G,...ne.getBoundTextElementPosition(j,G,n)}]:L},[]),d=Kr(l.map(L=>L).concat(c)),{minX:u,minY:f,maxX:h,maxY:m,midX:p,midY:U}=d,b=h-u,y=m-f,E={ne:[u,m],se:[u,f],sw:[h,f],nw:[h,m],e:[u,f+y/2],w:[h,f+y/2],n:[u+b/2,m],s:[u+b/2,f]},[_,I]=a?[p,U]:E[i],k=a?2:1,w=Math.max(Math.abs(s-_)/b||0,Math.abs(r-I)/y||0)*k;let T=i.includes("e")||i.includes("w")?Math.abs(s-_)*k:b,A=i.includes("n")||i.includes("s")?Math.abs(r-I)*k:y;o&&(T=b*w*Math.sign(s-_),A=y*w*Math.sign(r-I));const S={ne:[s<_,r>I],se:[s<_,r<I],sw:[s>_,r<I],nw:[s>_,r>I],e:[s<_,!1],w:[s>_,!1],n:[!1,r>I],s:[!1,r<I]},[D,N]=S[i].map(L=>L);return{originalBoundingBox:d,nextWidth:T,nextHeight:A,flipByX:D,flipByY:N}},ZV=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1,flipByX:a=!1,flipByY:l=!1,nextHeight:c,nextWidth:d,originalBoundingBox:u}={})=>{if(d===void 0&&c===void 0&&a===void 0&&l===void 0||c===0||d===0)return;s||(s=t);const f=e.reduce((k,w)=>{const T=s.get(w.id);return T&&k.push({orig:T,latest:w}),k},[]);let h;if(u)h=u;else{const k=f.reduce((w,{orig:T})=>{if(!De(T))return w;const A=va(T);if(!A)return w;const S=s.get(A)??null;return Vt(S)?[...w,{...S,...ne.getBoundTextElementPosition(T,S,t)}]:w},[]);h=Kr(f.map(({orig:w})=>w).concat(k))}const{minX:m,minY:p,maxX:U,maxY:b,midX:y,midY:E}=h,_=U-m,I=b-p;if(d===void 0&&c===void 0&&(d=_,c=I),r&&(d===void 0?d=c*(_/I):c===void 0?c=d*(I/_):Math.abs(d/c-_/I)>.001&&(d=c*(_/I))),d&&c){let k=n.includes("e")||n.includes("w")?Math.abs(d)/_:1,w=n.includes("n")||n.includes("s")?Math.abs(c)/I:1,T;n.length===1?T=n.includes("e")||n.includes("w")?k:w:T=Math.max(Math.abs(d)/_||0,Math.abs(c)/I||0);const A={ne:[m,b],se:[m,p],sw:[U,p],nw:[U,b],e:[m,p+I/2],w:[U,p+I/2],n:[m+_/2,b],s:[m+_/2,p]},[S,D]=o?[y,E]:A[n],N=r||f.some(z=>z.latest.angle!==0||he(z.latest)||mg(z.latest));N&&(k=T,w=T);const[L,j]=[a?-1:1,l?-1:1],Y=[];for(const{orig:z,latest:H}of f){if(he(z)&&Vt(z))continue;const X=z.width*k,Q=z.height*w,re=wo(z.angle*L*j),ie=De(z)||us(z),me=z.x-S,ke=z.y-D,ye=a&&!ie?X:0,Ae=l&&!ie?Q:0,$e=S+L*(me*k+ye),et=D+j*(ke*w+Ae),Be=PT(z,X*L,Q*j,!1),We={x:$e,y:et,width:X,height:Q,angle:re,...Be};if(ve(z)&&(z.startBinding&&(We.startBinding={...z.startBinding,fixedPoint:[a?-z.startBinding.fixedPoint[0]+1:z.startBinding.fixedPoint[0],l?-z.startBinding.fixedPoint[1]+1:z.startBinding.fixedPoint[1]]}),z.endBinding&&(We.endBinding={...z.endBinding,fixedPoint:[a?-z.endBinding.fixedPoint[0]+1:z.endBinding.fixedPoint[0],l?-z.endBinding.fixedPoint[1]+1:z.endBinding.fixedPoint[1]]}),z.fixedSegments&&Be.points&&(We.fixedSegments=z.fixedSegments.map(Jt=>({...Jt,start:Be.points[Jt.index-1],end:Be.points[Jt.index]})))),xt(z)&&(We.scale=[z.scale[0]*L,z.scale[1]*j]),he(z)){const Jt=NT(z,t,X);if(!Jt)return;We.fontSize=Jt.size}const bn=s.get(va(z)??"");if(bn)if(N){const Jt=bn.fontSize*T;if(Jt<I9)return;We.boundTextFontSize=Jt}else We.boundTextFontSize=bn.fontSize;Y.push({element:H,update:We})}const G=Y.map(({element:z})=>z),O=new Map(Y.map(({element:z})=>[z.id,z]));for(const{element:z,update:{boundTextFontSize:H,...X}}of Y){const{angle:Q}=X;i.mutateElement(z,X),pi(z,i,{simultaneouslyUpdated:G}),ln(z)&&(z.startBinding&&(O.has(z.startBinding.elementId)||Cs(z,"start",i)),z.endBinding&&(O.has(z.endBinding.elementId)||Cs(z,"end",i)));const re=Ne(z,t);re&&H&&(i.mutateElement(re,{fontSize:H,angle:De(z)?void 0:Q}),s2(z,i,n,!0))}i.triggerUpdate()}},iR={mouse:8,pen:16,touch:28},phe=16,qV={e:!0,s:!0,n:!0,w:!0},sR={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},X3={e:!0,s:!0,n:!0,w:!0},Xa=(e,t,n,i,s,r,o)=>{const[a,l]=Z(M(e+n/2,t+i/2),M(s,r),o);return[a-n/2,l-i/2,n,i]},OT=e=>!(e.formFactor==="phone"&&e.userAgent.isMobileDevice),t0=e=>OT(e)?qV:{},FT=([e,t,n,i,s,r],o,a,l,c={},d=4,u=Cu)=>{const f=iR[l],h=f/a.value,m=f/a.value,p=f/a.value,U=f/a.value,b=n-e,y=i-t,E=d/a.value,_=(f-u*2)/(2*a.value),I={nw:c.nw?void 0:Xa(e-E-p+_,t-E-U+_,h,m,s,r,o),ne:c.ne?void 0:Xa(n+E-_,t-E-U+_,h,m,s,r,o),sw:c.sw?void 0:Xa(e-E-p+_,i+E-_,h,m,s,r,o),se:c.se?void 0:Xa(n+E-_,i+E-_,h,m,s,r,o),rotation:c.rotation?void 0:Xa(e+b/2-h/2,t-E-U+_-phe/a.value,h,m,s,r,o)},k=5*iR.mouse/a.value;return Math.abs(b)>k&&(c.n||(I.n=Xa(e+b/2-h/2,t-E-U+_,h,m,s,r,o)),c.s||(I.s=Xa(e+b/2-h/2,i+E-_,h,m,s,r,o))),Math.abs(y)>k&&(c.w||(I.w=Xa(e-E-p+_,t+y/2-m/2,h,m,s,r,o)),c.e||(I.e=Xa(n+E-_,t+y/2-m/2,h,m,s,r,o))),I},QV=(e,t,n,i="mouse",s=qV)=>{if(e.locked||ve(e))return{};if(e.type==="freedraw"||De(e)){if(e.points.length===2){const[,o]=e.points;o[0]===0||o[1]===0?s=X3:o[0]>0&&o[1]<0?s=sR:o[0]>0&&o[1]>0?s=X3:o[0]<0&&o[1]>0?s=sR:o[0]<0&&o[1]<0&&(s=X3)}}else _e(e)&&(s={...s,rotation:!0});const r=De(e)?Cu+8:xt(e)?0:Cu;return FT(je(e,n,!0),e.angle,t,i,s,r,xt(e)?0:void 0)},JV=(e,t,n)=>{var s,r;if((s=t.selectedLinearElement)!=null&&s.isEditing||(r=t.selectedLinearElement)!=null&&r.isDragging)return!1;if(e.length>1)return!0;const i=e[0];return ve(i)?!1:De(i)?i.points.length>2&&!n.userAgent.isMobileDevice:!0},J4=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],Uhe=(e,t,n,i,s,r,o,a)=>{if(!n.selectedElementIds[e.id])return!1;const{rotation:l,...c}=QV(e,r,t,o,t0(a));if(l&&J4(l,i,s))return"rotation";const d=Object.keys(c).filter(u=>{const f=c[u];return f?J4(f,i,s):!1});if(d.length>0)return d[0];if(OT(a)){const[u,f,h,m,p,U]=je(e,t);if(!(De(e)&&e.points.length<=2)){const b=xt(e)?0:P6/r.value,y=P6/r.value,E=e$(M(u-b,f-b),M(h+b,m+b),M(p,U),e.angle);for(const[_,I]of Object.entries(E))if(A6(M(i,s),I,y))return _}}return!1},rR=(e,t,n,i,s,r,o,a)=>e.reduce((l,c)=>{if(l)return l;const d=Uhe(c,o,t,n,i,s,r,a);return d?{element:c,transformHandleType:d}:null},null),oR=([e,t,n,i],s,r,o,a,l)=>{const c=FT([e,t,n,i,(e+n)/2,(t+i)/2],0,o,a,t0(l)),d=Object.keys(c).find(u=>{const f=c[u];return f&&J4(f,s,r)});if(d)return d;if(OT(l)){const u=(e+n)/2,f=(t+i)/2,h=P6/o.value,m=e$(M(e-h,t-h),M(n+h,i+h),M(u,f),0);for(const[p,U]of Object.entries(m))if(A6(M(s,r),U,h))return p}return!1},j3=["ns","nesw","ew","nwse"],bhe=(e,t)=>{const n=j3.indexOf(e);if(n>=0){const i=Math.round(t/(Math.PI/4));e=j3[(n+i)%j3.length]}return e},aR=e=>{const{element:t,transformHandleType:n}=e,i=t&&Math.sign(t.height)*Math.sign(t.width)===-1;let s=null;switch(n){case"n":case"s":s="ns";break;case"w":case"e":s="ew";break;case"nw":case"se":i?s="nesw":s="nwse";break;case"ne":case"sw":i?s="nwse":s="nesw";break;case"rotation":return"grab"}return s&&t&&(s=bhe(s,t.angle)),s?`${s}-resize`:""},e$=([e,t],[n,i],s,r)=>{const o=Z(M(e,t),s,r),a=Z(M(n,t),s,r),l=Z(M(e,i),s,r),c=Z(M(n,i),s,r);return{n:[o,a],e:[a,c],s:[c,l],w:[l,o]}},yhe=(e,t)=>{var n;return!!(!e.viewModeEnabled&&((n=e.openDialog)==null?void 0:n.name)!=="elementLinkSelector"&&(e.activeTool.type!=="custom"&&(e.editingTextElement||e.activeTool.type!=="selection"&&e.activeTool.type!=="lasso"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser")||Ze(t,e).length))},kU={width:100,height:0},Ic=100,Ehe=(e,t,n)=>{const i=_r({x:0,y:0,textAlign:B0.CENTER,verticalAlign:lr.MIDDLE,...t,containerId:e.id,strokeColor:t.strokeColor||e.strokeColor});return Object.assign(e,{boundElements:(e.boundElements||[]).concat({type:"text",id:i.id})}),fs(i,e,n),[e,i]},lR=(e,t,n,i,s)=>{let r,o;if(Object.assign(e,{startBinding:(e==null?void 0:e.startBinding)||null,endBinding:e.endBinding||null}),t){const d=(t==null?void 0:t.width)??Ic,u=(t==null?void 0:t.height)??Ic;let f;t.id&&(f=i.getElement(t.id),f||console.error(`No element for start binding with id ${t.id} found`));const h=t.x||e.x-d,m=t.y||e.y-u/2,p=f?f.type:t.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:t.type==="text"&&(U=t.text),U||console.error(`No text found for start binding text element for ${e.id}`),r=_r({x:h,y:m,type:"text",...f,...t,text:U}),Object.assign(r,{x:t.x||e.x-r.width,y:t.y||e.y-r.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{r=Ta({x:h,y:m,width:d,height:u,...f,...t,type:p});break}default:Ua(e,`Unhandled element start type "${t.type}"`,!0)}Rl(e,r,"orbit","start",s)}}if(n){const d=(n==null?void 0:n.height)??Ic,u=(n==null?void 0:n.width)??Ic;let f;n.id&&(f=i.getElement(n.id),f||console.error(`No element for end binding with id ${n.id} found`));const h=n.x||e.x+e.width,m=n.y||e.y-d/2,p=f?f.type:n.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:n.type==="text"&&(U=n.text),U||console.error(`No text found for end binding text element for ${e.id}`),o=_r({x:h,y:m,type:"text",...f,...n,text:U}),Object.assign(o,{y:n.y||e.y-o.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{o=Ta({x:h,y:m,width:u,height:d,...f,...n,type:p});break}default:Ua(e,`Unhandled element end type "${p}"`,!0)}Rl(e,o,"orbit","end",s)}}if(e.points.length<2)return{linearElement:e,startBoundElement:r,endBoundElement:o};const a=e.points.length-1,l=.5,c=ua(e.points);return e.points[a][0]>e.points[a-1][0]&&(c[0][0]=l,c[a][0]-=l),e.points[a][0]<e.points[a-1][0]&&(c[0][0]=-.5,c[a][0]+=l),e.points[a][1]>e.points[a-1][1]&&(c[0][1]=l,c[a][1]-=l),e.points[a][1]<e.points[a-1][1]&&(c[0][1]=-.5,c[a][1]+=l),Object.assign(e,ne.getNormalizeElementPointsAndCoords({...e,points:c})),{linearElement:e,startBoundElement:r,endBoundElement:o}};class vhe{constructor(){B(this,"excalidrawElements",new Map);B(this,"add",t=>{t&&this.excalidrawElements.set(t.id,t)});B(this,"getElements",()=>Ad(Array.from(this.excalidrawElements.values())));B(this,"getElementsMap",()=>we(this.getElements()));B(this,"getElement",t=>this.excalidrawElements.get(t))}}const e_=(e,t)=>{var l,c,d;if(!e)return[];const n=ua(e),i=new vhe,s=new Map,r=new Map;for(const u of n){let f;const h=u.id;switch((t==null?void 0:t.regenerateIds)!==!1&&Object.assign(u,{id:Li()}),u.type){case"rectangle":case"ellipse":case"diamond":{const p=(l=u==null?void 0:u.label)!=null&&l.text&&u.width===void 0?0:(u==null?void 0:u.width)||Ic,U=(c=u==null?void 0:u.label)!=null&&c.text&&u.height===void 0?0:(u==null?void 0:u.height)||Ic;f=Ta({...u,width:p,height:U});break}case"line":{const p=u.width||kU.width,U=u.height||kU.height;f=Hc({width:p,height:U,points:[M(0,0),M(p,U)],...u});break}case"arrow":{const p=u.width||kU.width,U=u.height||kU.height;f=Ph({width:p,height:U,endArrowhead:"arrow",points:[M(0,0),M(p,U)],...u,type:"arrow"}),Object.assign(f,sg(f.points));break}case"text":{const p=(u==null?void 0:u.fontFamily)||Td,U=(u==null?void 0:u.fontSize)||$l,b=(u==null?void 0:u.lineHeight)||id(p),y=u.text??"",E=fg(y),_=ri(E,_t({fontFamily:p,fontSize:U}),b);f=_r({width:_.width,height:_.height,fontFamily:p,fontSize:U,...u});break}case"image":{f=FV({width:(u==null?void 0:u.width)||Ic,height:(u==null?void 0:u.height)||Ic,...u});break}case"frame":{f=LT({x:0,y:0,...u});break}case"magicframe":{f=X4({x:0,y:0,...u});break}case"freedraw":case"iframe":case"embeddable":{f=u;break}default:f=u,Ua(u,`Unhandled element type "${u.type}"`,!0)}i.getElement(f.id)?console.error(`Duplicate id found for ${f.id}`):(i.add(f),s.set(f.id,u),h&&r.set(h,f.id))}const o=i.getElementsMap(),a=new u5(o);for(const[u,f]of s){const h=i.getElement(u);switch(f.type){case"rectangle":case"ellipse":case"diamond":case"arrow":{if((d=f.label)!=null&&d.text){let[m,p]=Ehe(h,f==null?void 0:f.label,a);if(i.add(m),i.add(p),Te(m)){const U=f.type==="arrow"?f==null?void 0:f.start:void 0,b=f.type==="arrow"?f==null?void 0:f.end:void 0;if(U&&U.id){const I=r.get(U.id);I&&Object.assign(U,{id:I})}if(b&&b.id){const I=r.get(b.id);I&&Object.assign(b,{id:I})}const{linearElement:y,startBoundElement:E,endBoundElement:_}=lR(m,U,b,i,a);m=y,i.add(y),i.add(E),i.add(_)}}else switch(f.type){case"arrow":{const{start:m,end:p}=f;if(m&&m.id){const E=r.get(m.id);Object.assign(m,{id:E})}if(p&&p.id){const E=r.get(p.id);Object.assign(p,{id:E})}const{linearElement:U,startBoundElement:b,endBoundElement:y}=lR(h,m,p,i,a);i.add(U),i.add(b),i.add(y);break}}break}}}for(const[u,f]of s){if(f.type!=="frame"&&f.type!=="magicframe")continue;const h=i.getElement(u);if(!h)throw new Error(`Excalidraw element with id ${u} doesn't exist`);const m=[];f.children.forEach(T=>{var D;const A=r.get(T);if(!A)throw new Error(`Element with ${T} wasn't mapped correctly`);const S=i.getElement(A);if(!S)throw new Error(`Frame element with id ${A} doesn't exist`);Object.assign(S,{frameId:h.id}),(D=S==null?void 0:S.boundElements)==null||D.forEach(N=>{const L=i.getElement(N.id);if(!L)throw new Error(`Bound element with id ${N.id} doesn't exist`);Object.assign(L,{frameId:h.id}),m.push(L)}),m.push(S)});let[p,U,b,y]=Et(m);const E=10;p=p-E,U=U-E,b=b+E,y=y+E;const _=(h==null?void 0:h.x)||p,I=(h==null?void 0:h.y)||U,k=(h==null?void 0:h.width)||b-p,w=(h==null?void 0:h.height)||y-U;Object.assign(h,{x:_,y:I,width:k,height:w})}return i.getElements()},RU=({app:e,event:t})=>{const n=e.state;if(n.selectedLinearElement&&e.lastPointerMoveCoords){if(n.selectedLinearElement.draggedFocusPointBinding)return YV(n.selectedLinearElement,e.scene.getNonDeletedElementsMap(),e.lastPointerMoveCoords,e.scene,n,e.getEffectiveGridSize(),t.altKey),!0;if(n.selectedLinearElement.hoverPointIndex!==null&&e.lastPointerMoveEvent&&n.selectedLinearElement.initialState.lastClickedPoint>=0&&n.selectedLinearElement.isDragging)return ne.handlePointDragging(e.lastPointerMoveEvent,e,e.lastPointerMoveCoords.x,e.lastPointerMoveCoords.y,n.selectedLinearElement),!0}return!1},yc=e=>e.reduce((t,n)=>t+n.version,0),t$=e=>{let t=5381;for(const n of cc(e))t=(t<<5)+t+n.versionNonce;return t>>>0},BT=e=>{let t=5381;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)+t+i}return t>>>0},_he=e=>e.filter(t=>!t.isDeleted&&!_l(t)),qt=e=>e.filter(t=>!t.isDeleted),t_=e=>!e.isDeleted,whe=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})};var Dl={};let The=0;function Nt(e,t){const n=`atom${++The}`,i={toString(){return(Dl?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=Ihe,i.write=She),i}function Ihe(e){return e(this)}function She(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const cR=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,n_=e=>"init"in e,Y3=e=>!!e.write,h5=new WeakMap,i_=e=>{var t;return s_(e)&&!((t=h5.get(e))!=null&&t[1])},Che=(e,t)=>{const n=h5.get(e);if(n)n[1]=!0,n[0].forEach(i=>i(t));else if((Dl?"production":void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},xhe=e=>{if(h5.has(e))return;const t=[new Set,!1];h5.set(e,t);const n=()=>{t[1]=!0};e.then(n,n),e.onCancel=i=>{t[0].add(i)}},s_=e=>typeof(e==null?void 0:e.then)=="function",dR=e=>"v"in e||"e"in e,DU=e=>{if("e"in e)throw e.e;if((Dl?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},n$=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},uR=(e,t,n,i,s)=>{var r;if((Dl?"production":void 0)!=="production"&&i===t)throw new Error("[Bug] atom cannot depend on itself");n.d.set(i,s.n),i_(n.v)&&n$(t,n.v,s),(r=s.m)==null||r.t.add(t),e&&Ahe(e,i,t)},Vm=()=>({D:new Map,H:new Set,M:new Set,L:new Set}),n0=(e,t,n)=>{e[t].add(n)},fR=(e,t,n)=>{e.D.has(t)||(e.D.set(t,new Set),n0(e,"M",()=>{var i;(i=n.m)==null||i.l.forEach(s=>n0(e,"M",s))}))},Ahe=(e,t,n)=>{const i=e.D.get(t);i&&i.add(n)},Mhe=(e,t)=>e.D.get(t),Bd=e=>{let t,n=!1;const i=s=>{try{s()}catch(r){n||(t=r,n=!0)}};for(;e.H.size||e.M.size||e.L.size;)e.D.clear(),e.H.forEach(i),e.H.clear(),e.M.forEach(i),e.M.clear(),e.L.forEach(i),e.L.clear();if(n)throw t},i$=(...[e,t,n,i])=>{const s=(b,y,E)=>{const _="v"in y,I=y.v,k=i_(y.v)?y.v:null;if(s_(E)){xhe(E);for(const w of y.d.keys())n$(b,E,e(w));y.v=E}else y.v=E;delete y.e,delete y.x,(!_||!Object.is(I,y.v))&&(++y.n,k&&Che(k,E))},r=(b,y)=>{var E;const _=e(y);if(dR(_)&&(_.m&&!_.x||Array.from(_.d).every(([S,D])=>r(b,S).n===D)))return _;_.d.clear();let I=!0;const k=S=>{if(cR(y,S)){const N=e(S);if(!dR(N))if(n_(S))s(S,N,S.init);else throw new Error("no atom init");return DU(N)}const D=r(b,S);try{return DU(D)}finally{if(I)uR(b,y,_,S,D);else{const N=Vm();uR(N,y,_,S,D),u(N,y,_),Bd(N)}}};let w,T;const A={get signal(){return w||(w=new AbortController),w.signal},get setSelf(){return(Dl?"production":void 0)!=="production"&&!Y3(y)&&console.warn("setSelf function cannot be used with read-only atom"),!T&&Y3(y)&&(T=(...S)=>{if((Dl?"production":void 0)!=="production"&&I&&console.warn("setSelf function cannot be called in sync"),!I)return d(y,...S)}),T}};try{const S=t(y,k,A);if(s(y,_,S),s_(S)){(E=S.onCancel)==null||E.call(S,()=>w==null?void 0:w.abort());const D=()=>{if(_.m){const N=Vm();u(N,y,_),Bd(N)}};S.then(D,D)}return _}catch(S){return delete _.v,_.e=S,delete _.x,++_.n,_}finally{I=!1}},o=b=>DU(r(void 0,b)),a=(b,y,E)=>{var _,I;const k=new Map;for(const w of((_=E.m)==null?void 0:_.t)||[]){const T=e(w);T.m&&k.set(w,T)}for(const w of E.p)k.set(w,e(w));return(I=Mhe(b,y))==null||I.forEach(w=>{k.set(w,e(w))}),k},l=(b,y,E)=>{const _=[],I=new Set,k=new Set,w=[[y,E]];for(;w.length>0;){const[T,A]=w[w.length-1];if(k.has(T)){w.pop();continue}if(I.has(T)){_.push([T,A,A.n]),k.add(T),A.x=!0,w.pop();continue}I.add(T);for(const[S,D]of a(b,T,A))T!==S&&!I.has(S)&&w.push([S,D])}n0(b,"H",()=>{const T=new Set([y]);for(let A=_.length-1;A>=0;--A){const[S,D,N]=_[A];let L=!1;for(const j of D.d.keys())if(j!==S&&T.has(j)){L=!0;break}L&&(r(b,S),u(b,S,D),N!==D.n&&(fR(b,S,D),T.add(S))),delete D.x}})},c=(b,y,...E)=>{let _=!0;const I=w=>DU(r(b,w)),k=(w,...T)=>{const A=e(w);try{if(cR(y,w)){if(!n_(w))throw new Error("atom not writable");const S=A.n,D=T[0];s(w,A,D),u(b,w,A),S!==A.n&&(fR(b,w,A),l(b,w,A));return}else return c(b,w,...T)}finally{_||Bd(b)}};try{return n(y,I,k,...E)}finally{_=!1}},d=(b,...y)=>{const E=Vm();try{return c(E,b,...y)}finally{Bd(E)}},u=(b,y,E)=>{if(E.m&&!i_(E.v)){for(const _ of E.d.keys())E.m.d.has(_)||(f(b,_,e(_)).t.add(y),E.m.d.add(_));for(const _ of E.m.d||[])if(!E.d.has(_)){E.m.d.delete(_);const I=h(b,_,e(_));I==null||I.t.delete(y)}}},f=(b,y,E)=>{if(!E.m){r(b,y);for(const _ of E.d.keys())f(b,_,e(_)).t.add(y);if(E.m={l:new Set,d:new Set(E.d.keys()),t:new Set},Y3(y)){const _=E.m;let I;const k=(w,T)=>{let A=!0;I=(...S)=>{try{return c(w,y,...S)}finally{A||Bd(w)}};try{return T()}finally{A=!1}};n0(b,"L",()=>{const w=k(b,()=>i(y,(...T)=>I(...T)));w&&(_.u=T=>k(T,w))})}}return E.m},h=(b,y,E)=>{if(E.m&&!E.m.l.size&&!Array.from(E.m.t).some(_=>{var I;return(I=e(_).m)==null?void 0:I.d.has(y)})){const _=E.m.u;_&&n0(b,"L",()=>_(b)),delete E.m;for(const I of E.d.keys()){const k=h(b,I,e(I));k==null||k.t.delete(y)}return}return E.m};return{get:o,set:d,sub:(b,y)=>{const E=Vm(),_=e(b),k=f(E,b,_).l;return k.add(y),Bd(E),()=>{k.delete(y);const w=Vm();h(w,b,_),Bd(w)}},unstable_derive:b=>i$(...b(e,t,n,i))}},khe=e=>{const t=new WeakMap,n=new Set;let i,s=0;const r=e.unstable_derive((l,c,d,u)=>(i=l,[f=>{let h=t.get(f);if(!h){const m=l(f);h=new Proxy(m,{set(p,U,b){return U==="m"&&n.add(f),Reflect.set(p,U,b)},deleteProperty(p,U){return U==="m"&&n.delete(f),Reflect.deleteProperty(p,U)}}),t.set(f,h)}return h},c,(f,h,m,...p)=>s?m(f,...p):d(f,h,m,...p),u])),o=r.set;return Object.assign(r,{dev4_get_internal_weak_map:()=>({get:l=>{const c=i(l);if(c.n!==0)return c}}),dev4_get_mounted_atoms:()=>n,dev4_restore_atoms:l=>{o({read:()=>null,write:(d,u)=>{++s;try{for(const[f,h]of l)n_(f)&&u(f,h)}finally{--s}}})}})},c2=()=>{const e=new WeakMap,n=i$(i=>{if((Dl?"production":void 0)!=="production"&&!i)throw new Error("Atom is undefined or null");let s=e.get(i);return s||(s={d:new Map,p:new Set,n:0},e.set(i,s)),s},(i,...s)=>i.read(...s),(i,...s)=>i.write(...s),(i,...s)=>{var r;return(r=i.onMount)==null?void 0:r.call(i,...s)});return(Dl?"production":void 0)!=="production"?khe(n):n};let $m;const Rhe=()=>($m||($m=c2(),(Dl?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=$m),globalThis.__JOTAI_DEFAULT_STORE__!==$m&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),$m);var s$={};const r$=C.createContext(void 0),iE=e=>{const t=C.useContext(r$);return(e==null?void 0:e.store)||t||Rhe()},Dhe=({children:e,store:t})=>{const n=C.useRef(void 0);return!t&&!n.current&&(n.current=c2()),C.createElement(r$.Provider,{value:t||n.current},e)},r_=e=>typeof(e==null?void 0:e.then)=="function",o$=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Lhe=de.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(o$(e),e)}),W3=new WeakMap,hR=e=>{let t=W3.get(e);return t||(t=new Promise((n,i)=>{let s=e;const r=l=>c=>{s===l&&n(c)},o=l=>c=>{s===l&&i(c)},a=l=>{"onCancel"in l&&typeof l.onCancel=="function"&&l.onCancel(c=>{if((s$?"production":void 0)!=="production"&&c===l)throw new Error("[Bug] p is not updated even after cancelation");r_(c)?(W3.set(c,t),s=c,c.then(r(c),o(c)),a(c)):n(c)})};e.then(r(e),o(e)),a(e)}),W3.set(e,t)),t};function Oh(e,t){const n=iE(t),[[i,s,r],o]=C.useReducer(c=>{const d=n.get(e);return Object.is(c[0],d)&&c[1]===n&&c[2]===e?c:[d,n,e]},void 0,()=>[n.get(e),n,e]);let a=i;(s!==n||r!==e)&&(o(),a=n.get(e));const l=t==null?void 0:t.delay;if(C.useEffect(()=>{const c=n.sub(e,()=>{if(typeof l=="number"){const d=n.get(e);r_(d)&&o$(hR(d)),setTimeout(o,l);return}o()});return o(),c},[n,e,l]),C.useDebugValue(a),r_(a)){const c=hR(a);return Lhe(c)}return a}function zT(e,t){const n=iE(t);return C.useCallback((...s)=>{if((s$?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...s)},[n,e])}function bg(e,t){return[Oh(e,t),zT(e,t)]}const gR=new WeakMap;function Phe(e,t){const n=iE(t),i=Nhe(n);for(const[s,r]of e)(!i.has(s)||t!=null&&t.dangerouslyForceHydrate)&&(i.add(s),n.set(s,r))}const Nhe=e=>{let t=gR.get(e);return t||(t=new WeakSet,gR.set(e,t)),t};function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Uh.apply(this,arguments)}function a$(){const e=C.createContext(null);function t({store:o,initialValues:a=[],children:l}){const c=C.useRef(o);return c.current||(c.current=c2()),Phe(a,{store:c.current}),g(e.Provider,{value:c.current,children:l})}const n=o=>{const a=C.useContext(e);if(!a)throw new Error("Missing Provider from createIsolation");return iE(Uh({store:a},o))};return{Provider:t,useStore:n,useAtom:(o,a)=>{const l=n();return bg(o,Uh({store:l},a))},useAtomValue:(o,a)=>{const l=n();return Oh(o,Uh({store:l},a))},useSetAtom:(o,a)=>{const l=n();return zT(o,Uh({store:l},a))}}}const{read:bDe,write:yDe}=Nt(null);C.createContext({scope:void 0,baseStore:void 0});const l$=a$(),{useAtom:dt,useSetAtom:d2,useAtomValue:HT,useStore:EDe}=l$,Ohe=l$.Provider,ar=c2(),c$={paste:"Paste",pasteAsPlaintext:"Paste as plaintext",pasteCharts:"Paste charts",selectAll:"Select all",multiSelect:"Add element to selection",moveCanvas:"Move canvas",cut:"Cut",copy:"Copy",copyAsPng:"Copy to clipboard as PNG",copyAsSvg:"Copy to clipboard as SVG",copyText:"Copy to clipboard as text",copySource:"Copy source to clipboard",convertToCode:"Convert to code",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",sendBackward:"Send backward",delete:"Delete",copyStyles:"Copy styles",pasteStyles:"Paste styles",stroke:"Stroke",changeStroke:"Change stroke color",background:"Background",changeBackground:"Change background color",fill:"Fill",strokeWidth:"Stroke width",strokeStyle:"Stroke style",strokeStyle_solid:"Solid",strokeStyle_dashed:"Dashed",strokeStyle_dotted:"Dotted",sloppiness:"Sloppiness",opacity:"Opacity",textAlign:"Text align",edges:"Edges",sharp:"Sharp",round:"Round",arrowheads:"Arrowheads",arrowhead_none:"None",arrowhead_arrow:"Arrow",arrowhead_bar:"Bar",arrowhead_circle:"Circle",arrowhead_circle_outline:"Circle (outline)",arrowhead_triangle:"Triangle",arrowhead_triangle_outline:"Triangle (outline)",arrowhead_diamond:"Diamond",arrowhead_diamond_outline:"Diamond (outline)",arrowhead_crowfoot_many:"Crow's foot (many)",arrowhead_crowfoot_one:"Crow's foot (one)",arrowhead_crowfoot_one_or_many:"Crow's foot (one or many)",more_options:"More options",arrowtypes:"Arrow type",arrowtype_sharp:"Sharp arrow",arrowtype_round:"Curved arrow",arrowtype_elbowed:"Elbow arrow",fontSize:"Font size",fontFamily:"Font family",addWatermark:'Add "Made with Excalidraw"',handDrawn:"Hand-drawn",normal:"Normal",code:"Code",small:"Small",medium:"Medium",large:"Large",veryLarge:"Very large",solid:"Solid",hachure:"Hachure",zigzag:"Zigzag",crossHatch:"Cross-hatch",thin:"Thin",bold:"Bold",left:"Left",center:"Center",right:"Right",extraBold:"Extra bold",architect:"Architect",artist:"Artist",cartoonist:"Cartoonist",fileTitle:"File name",colorPicker:"Color picker",canvasColors:"Used on canvas",canvasBackground:"Canvas background",drawingCanvas:"Drawing canvas",clearCanvas:"Clear canvas",layers:"Layers",actions:"Actions",language:"Language",liveCollaboration:"Live collaboration...",duplicateSelection:"Duplicate",untitled:"Untitled",name:"Name",yourName:"Your name",madeWithExcalidraw:"Made with Excalidraw",group:"Group selection",ungroup:"Ungroup selection",collaborators:"Collaborators",toggleGrid:"Toggle grid",addToLibrary:"Add to library",removeFromLibrary:"Remove from library",libraryLoadingMessage:"Loading library",libraries:"Browse libraries",loadingScene:"Loading scene",loadScene:"Load scene from file",align:"Align",alignTop:"Align top",alignBottom:"Align bottom",alignLeft:"Align left",alignRight:"Align right",centerVertically:"Center vertically",centerHorizontally:"Center horizontally",distributeHorizontally:"Distribute horizontally",distributeVertically:"Distribute vertically",flipHorizontal:"Flip horizontal",flipVertical:"Flip vertical",viewMode:"View mode",share:"Share",showStroke:"Show stroke color picker",showBackground:"Show background color picker",showFonts:"Show font picker",toggleTheme:"Toggle light/dark theme",theme:"Theme",personalLib:"Personal Library",excalidrawLib:"Excalidraw Library",decreaseFontSize:"Decrease font size",increaseFontSize:"Increase font size",unbindText:"Unbind text",bindText:"Bind text to the container",createContainerFromText:"Wrap text in a container",link:{edit:"Edit link",editEmbed:"Edit embeddable link",create:"Add link",label:"Link",labelEmbed:"Link & embed",empty:"No link is set",hint:"Type or paste your link here",goToElement:"Go to target element"},lineEditor:{edit:"Edit line",editArrow:"Edit arrow"},polygon:{breakPolygon:"Break polygon",convertToPolygon:"Convert to polygon"},elementLock:{lock:"Lock",unlock:"Unlock",lockAll:"Lock all",unlockAll:"Unlock all"},statusPublished:"Published",sidebarLock:"Keep sidebar open",selectAllElementsInFrame:"Select all elements in frame",removeAllElementsFromFrame:"Remove all elements from frame",eyeDropper:"Pick color from canvas",textToDiagram:"Text to diagram",prompt:"Prompt",followUs:"Follow us",discordChat:"Discord chat",zoomToFitViewport:"Zoom to fit in viewport",zoomToFitSelection:"Zoom to fit selection",zoomToFit:"Zoom to fit all elements",installPWA:"Install Excalidraw locally (PWA)",autoResize:"Enable text auto-resizing",imageCropping:"Image cropping",unCroppedDimension:"Uncropped dimension",copyElementLink:"Copy link to object",linkToElement:"Link to object",wrapSelectionInFrame:"Wrap selection in frame",tab:"Tab",shapeSwitch:"Switch shape",preferences:"Preferences",preferences_toolLock:"Tool lock"},d$={title:"Link to object",desc:"Click on a shape on canvas or paste a link.",notFound:"Linked object wasn't found on canvas."},u$={noItems:"No items added yet...",hint_emptyLibrary:"Select an item on canvas to add it here, or install a library from the public repository, below.",hint_emptyPrivateLibrary:"Select an item on canvas to add it here.",search:{inputPlaceholder:"Search library",heading:"Library matches",noResults:"No matching items found...",clearSearch:"Clear search"}},f$={title:"Find on canvas",noMatch:"No matches found...",singleResult:"result",multipleResults:"results",placeholder:"Find text on canvas...",frames:"Frames",texts:"Texts"},h$={clearReset:"Reset the canvas",exportJSON:"Export to file",exportImage:"Export image...",export:"Save to...",copyToClipboard:"Copy to clipboard",copyLink:"Copy link",save:"Save to current file",saveAs:"Save as",load:"Open",getShareableLink:"Get shareable link",close:"Close",selectLanguage:"Select language",scrollBackToContent:"Scroll back to content",zoomIn:"Zoom in",zoomOut:"Zoom out",resetZoom:"Reset zoom",menu:"Menu",done:"Done",edit:"Edit",undo:"Undo",redo:"Redo",resetLibrary:"Reset library",createNewRoom:"Create new room",fullScreen:"Full screen",darkMode:"Dark mode",lightMode:"Light mode",systemMode:"System mode",zenMode:"Zen mode",objectsSnapMode:"Snap to objects",exitZenMode:"Exit zen mode",cancel:"Cancel",saveLibNames:"Save name(s) and exit",clear:"Clear",remove:"Remove",embed:"Toggle embedding",publishLibrary:"Rename or publish",submit:"Submit",confirm:"Confirm",embeddableInteractionButton:"Click to interact"},g$={clearReset:"This will clear the whole canvas. Are you sure?",couldNotCreateShareableLink:"Couldn't create shareable link.",couldNotCreateShareableLinkTooBig:"Couldn't create shareable link: the scene is too big",couldNotLoadInvalidFile:"Couldn't load invalid file",importBackendFailed:"Importing from backend failed.",cannotExportEmptyCanvas:"Cannot export empty canvas.",couldNotCopyToClipboard:"Couldn't copy to clipboard.",decryptFailed:"Couldn't decrypt data.",uploadedSecurly:"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can't read the content.",loadSceneOverridePrompt:"Loading external drawing will replace your existing content. Do you wish to continue?",collabStopOverridePrompt:`Stopping the session will overwrite your previous, locally stored drawing. Are you sure?

(If you want to keep your local drawing, simply close the browser tab instead.)`,errorAddingToLibrary:"Couldn't add item to the library",errorRemovingFromLibrary:"Couldn't remove item from the library",confirmAddLibrary:"This will add {{numShapes}} shape(s) to your library. Are you sure?",imageDoesNotContainScene:"This image does not seem to contain any scene data. Have you enabled scene embedding during export?",cannotRestoreFromImage:"Scene couldn't be restored from this image file",invalidSceneUrl:"Couldn't import scene from the supplied URL. It's either malformed, or doesn't contain valid Excalidraw JSON data.",resetLibrary:"This will clear your library. Are you sure?",removeItemsFromsLibrary:"Delete {{count}} item(s) from library?",invalidEncryptionKey:"Encryption key must be of 22 characters. Live collaboration is disabled.",collabOfflineWarning:`No internet connection available.
Your changes will not be saved!`,localStorageQuotaExceeded:"Browser storage quota exceeded. Changes will not be saved."},m$={unsupportedFileType:"Unsupported file type.",imageInsertError:"Couldn't insert image. Try again later...",fileTooBig:"File is too big. Maximum allowed size is {{maxSize}}.",svgImageInsertError:"Couldn't insert SVG image. The SVG markup looks invalid.",failedToFetchImage:"Failed to fetch image.",cannotResolveCollabServer:"Couldn't connect to the collab server. Please reload the page and try again.",importLibraryError:"Couldn't load library",saveLibraryError:"Couldn't save library to storage. Please save your library to a file locally to make sure you don't lose changes.",collabSaveFailed:"Couldn't save to the backend database. If problems persist, you should save your file locally to ensure you don't lose your work.",collabSaveFailed_sizeExceeded:"Couldn't save to the backend database, the canvas seems to be too big. You should save the file locally to ensure you don't lose your work.",imageToolNotSupported:"Images are disabled.",brave_measure_text_error:{line1:"Looks like you are using Brave browser with the <bold>Aggressively Block Fingerprinting</bold> setting enabled.",line2:"This could result in breaking the <bold>Text Elements</bold> in your drawings.",line3:"We strongly recommend disabling this setting. You can follow <link>these steps</link> on how to do so.",line4:"If disabling this setting doesn't fix the display of text elements, please open an <issueLink>issue</issueLink> on our GitHub, or write us on <discordLink>Discord</discordLink>"},libraryElementTypeError:{embeddable:"Embeddable elements cannot be added to the library.",iframe:"IFrame elements cannot be added to the library.",image:"Support for adding images to the library coming soon!"},asyncPasteFailedOnRead:"Couldn't paste (couldn't read from system clipboard).",asyncPasteFailedOnParse:"Couldn't paste.",copyToSystemClipboardFailed:"Couldn't copy to clipboard."},p$={selection:"Selection",lasso:"Lasso selection",image:"Insert image",rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Draw",text:"Text",library:"Library",lock:"Keep selected tool active after drawing",penMode:"Pen mode - prevent touch",link:"Add / Update link for a selected shape",eraser:"Eraser",frame:"Frame tool",magicframe:"Wireframe to code",embeddable:"Web Embed",laser:"Laser pointer",hand:"Hand (panning tool)",extraTools:"More tools",mermaidToExcalidraw:"Mermaid to Excalidraw",convertElementType:"Toggle shape type"},U$={rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Freedraw",text:"Text",image:"Image",group:"Group",frame:"Frame",magicframe:"Wireframe to code",embeddable:"Web Embed",selection:"Selection",iframe:"IFrame"},b$={canvasActions:"Canvas actions",selectedShapeActions:"Selected shape actions",shapes:"Shapes"},y$={dismissSearch:"{{shortcut}} to dismiss search",canvasPanning:"To move canvas, hold {{shortcut_1}} or {{shortcut_2}} while dragging, or use the hand tool",linearElement:"Click to start multiple points, drag for single line",arrowTool:"Click to start multiple points, drag for single line. Press {{shortcut}} again to change arrow type.",arrowBindModifiers:"Hold {{shortcut_1}} to disable binding, or {{shortcut_2}} to bind at a fixed point",freeDraw:"Click and drag, release when you're finished",text:"Tip: you can also add text by double-clicking anywhere with the selection tool",embeddable:"Click-drag to create a website embed",text_selected:"Double-click or press {{shortcut}} to edit text",text_editing:"Press {{shortcut_1}} or {{shortcut_2}} to finish editing",linearElementMulti:"Click on last point or press {{shortcut_1}} or {{shortcut_2}} to finish",lockAngle:"You can constrain angle by holding {{shortcut}}",resize:`You can constrain proportions by holding {{shortcut_1}} while resizing,
hold {{shortcut_2}} to resize from the center`,resizeImage:`You can resize freely by holding {{shortcut_1}},
hold {{shortcut_2}} to resize from the center`,rotate:"You can constrain angles by holding {{shortcut}} while rotating",lineEditor_info:"Hold {{shortcut_1}} and Double-click or press {{shortcut_2}} to edit points",lineEditor_line_info:"Double-click or press {{shortcut}} to edit points",lineEditor_pointSelected:`Press {{shortcut_1}} to remove point(s),
{{shortcut_2}} to duplicate, or drag to move`,lineEditor_nothingSelected:`Select a point to edit (hold {{shortcut_1}} to select multiple),
or hold {{shortcut_2}} and click to add new points`,publishLibrary:"Publish your own library",bindTextToElement:"{{shortcut}} to add text",createFlowchart:"{{shortcut}} to create a flowchart",deepBoxSelect:"Hold {{shortcut}} to deep select, and to prevent dragging",eraserRevert:"Hold {{shortcut}} to revert the elements marked for deletion",firefox_clipboard_write:'This feature can likely be enabled by setting the "dom.events.asyncClipboard.clipboardItem" flag to "true". To change the browser flags in Firefox, visit the "about:config" page.',disableSnapping:"Hold {{shortcut}} to disable snapping",enterCropEditor:"Double click the image or press {{shortcut}} to crop the image",leaveCropEditor:"Click outside the image or press {{shortcut_1}} or {{shortcut_2}} to finish cropping"},E$={cannotShowPreview:"Cannot show preview",canvasTooBig:"The canvas may be too big.",canvasTooBigTip:"Tip: try moving the farthest elements a bit closer together."},v$={headingMain:"Encountered an error. Try <button>reloading the page</button>.",clearCanvasMessage:"If reloading doesn't work, try <button>clearing the canvas</button>.",clearCanvasCaveat:" This will result in loss of work ",trackedToSentry:"The error with identifier {{eventId}} was tracked on our system.",openIssueMessage:"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our <button>bug tracker</button>. Please include information below by copying and pasting into the GitHub issue.",sceneContent:"Scene content:"},_$={or:"Or"},w$={desc_intro:"Invite people to collaborate on your drawing.",desc_privacy:"Don't worry, the session is end-to-end encrypted, and fully private. Not even our server can see what you draw.",button_startSession:"Start session",button_stopSession:"Stop session",desc_inProgressIntro:"Live-collaboration session is now in progress.",desc_shareLink:"Share this link with anyone you want to collaborate with:",desc_exitSession:"Stopping the session will disconnect you from the room, but you'll be able to continue working with the scene, locally. Note that this won't affect other people, and they'll still be able to collaborate on their version.",shareTitle:"Join a live collaboration session on Excalidraw"},T$={title:"Error"},I$={disk_title:"Save to disk",disk_details:"Export the scene data to a file from which you can import later.",disk_button:"Save to file",link_title:"Shareable link",link_details:"Export as a read-only link.",link_button:"Export to Link",excalidrawplus_description:"Save the scene to your Excalidraw+ workspace.",excalidrawplus_button:"Export",excalidrawplus_exportError:"Couldn't export to Excalidraw+ at this moment..."},S$={blog:"Read our blog",click:"click",deepSelect:"Deep select",deepBoxSelect:"Deep select within box, and prevent dragging",createFlowchart:"Create a flowchart from a generic element",navigateFlowchart:"Navigate a flowchart",curvedArrow:"Curved arrow",curvedLine:"Curved line",documentation:"Documentation",doubleClick:"double-click",drag:"drag",editor:"Editor",editLineArrowPoints:"Edit line/arrow points",editText:"Edit text / add label",github:"Found an issue? Submit",howto:"Follow our guides",or:"or",preventBinding:"Prevent arrow binding",tools:"Tools",shortcuts:"Keyboard shortcuts",textFinish:"Finish editing (text editor)",textNewLine:"Add new line (text editor)",title:"Help",view:"View",zoomToFit:"Zoom to fit all elements",zoomToSelection:"Zoom to selection",toggleElementLock:"Lock/unlock selection",movePageUpDown:"Move page up/down",movePageLeftRight:"Move page left/right",cropStart:"Crop image",cropFinish:"Finish image cropping"},C$={title:"Clear canvas"},x$={title:"Publish library",itemName:"Item name",authorName:"Author name",githubUsername:"GitHub username",twitterUsername:"Twitter username",libraryName:"Library name",libraryDesc:"Library description",website:"Website",placeholder:{authorName:"Your name or username",libraryName:"Name of your library",libraryDesc:"Description of your library to help people understand its usage",githubHandle:"GitHub handle (optional), so you can edit the library once submitted for review",twitterHandle:"Twitter username (optional), so we know who to credit when promoting over Twitter",website:"Link to your personal website or elsewhere (optional)"},errors:{required:"Required",website:"Enter a valid URL"},noteDescription:"Submit your library to be included in the <link>public library repository</link> for other people to use in their drawings.",noteGuidelines:"The library needs to be manually approved first. Please read the <link>guidelines</link> before submitting. You will need a GitHub account to communicate and make changes if requested, but it is not strictly required.",noteLicense:"By submitting, you agree the library will be published under the <link>MIT License</link>, which in short means anyone can use them without restrictions.",noteItems:"Each library item must have its own name so it's filterable. The following library items will be included:",atleastOneLibItem:"Please select at least one library item to get started",republishWarning:"Note: some of the selected items are marked as already published/submitted. You should only resubmit items when updating an existing library or submission."},A$={title:"Library submitted",content:"Thank you {{authorName}}. Your library has been submitted for review. You can track the status <link>here</link>"},M$={resetLibrary:"Reset library",removeItemsFromLib:"Remove selected items from library"},k$={header:"Export image",label:{withBackground:"Background",onlySelected:"Only selected",darkMode:"Dark mode",embedScene:"Embed scene",scale:"Scale",padding:"Padding"},tooltip:{embedScene:`Scene data will be saved into the exported PNG/SVG file so that the scene can be restored from it.
Will increase exported file size.`},title:{exportToPng:"Export to PNG",exportToSvg:"Export to SVG",copyPngToClipboard:"Copy PNG to clipboard"},button:{exportToPng:"PNG",exportToSvg:"SVG",copyPngToClipboard:"Copy to clipboard"}},R$={tooltip:"Your drawings are end-to-end encrypted so Excalidraw's servers will never see them.",link:"Blog post on end-to-end encryption in Excalidraw"},D$={angle:"Angle",shapes:"Shapes",height:"Height",scene:"Scene",selected:"Selected",storage:"Storage",fullTitle:"Canvas & Shape properties",title:"Properties",generalStats:"General",elementProperties:"Shape properties",total:"Total",version:"Version",versionCopy:"Click to copy",versionNotAvailable:"Version not available",width:"Width"},L$={addedToLibrary:"Added to library",copyStyles:"Copied styles.",copyToClipboard:"Copied to clipboard.",copyToClipboardAsPng:`Copied {{exportSelection}} to clipboard as PNG
({{exportColorScheme}})`,copyToClipboardAsSvg:`Copied {{exportSelection}} to clipboard as SVG
({{exportColorScheme}})`,fileSaved:"File saved.",fileSavedToFilename:"Saved to {filename}",canvas:"canvas",selection:"selection",pasteAsSingleElement:`Use {{shortcut}} to paste as a single element,
or paste into an existing text editor`,unableToEmbed:"Embedding this url is currently not allowed. Raise an issue on GitHub to request the url whitelisted",unrecognizedLinkFormat:"The link you embedded does not match the expected format. Please try to paste the 'embed' string provided by the source site",elementLinkCopied:"Link copied to clipboard"},P$={transparent:"Transparent",black:"Black",white:"White",red:"Red",pink:"Pink",grape:"Grape",violet:"Violet",gray:"Gray",blue:"Blue",cyan:"Cyan",teal:"Teal",green:"Green",yellow:"Yellow",orange:"Orange",bronze:"Bronze"},N$={app:{center_heading:"Your drawings are saved in your browser's storage.",center_heading_line2:"Browser storage can be cleared unexpectedly.",center_heading_line3:"Save your work to a file regularly to avoid losing it.",center_heading_plus:"Did you want to go to the Excalidraw+ instead?",menuHint:"Export, preferences, languages, ..."},defaults:{menuHint:"Export, preferences, and more...",center_heading:"Diagrams. Made. Simple.",toolbarHint:"Pick a tool & Start drawing!",helpHint:"Shortcuts & help"}},O$={color:"Color",mostUsedCustomColors:"Most used custom colors",colors:"Colors",shades:"Shades",hexCode:"Hex code",noShades:"No shades available for this color"},F$={action:{exportToImage:{title:"Export as image",button:"Export as image",description:"Export the scene data as an image from which you can import later."},saveToDisk:{title:"Save to disk",button:"Save to disk",description:"Export the scene data to a file from which you can import later."},excalidrawPlus:{title:"Excalidraw+",button:"Export to Excalidraw+",description:"Save the scene to your Excalidraw+ workspace."}},modal:{loadFromFile:{title:"Load from file",button:"Load from file",description:"Loading from a file will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first using one of the options below."},shareableLink:{title:"Load from link",button:"Replace my content",description:"Loading external drawing will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first by using one of the options below."}}},B$={title:"Mermaid to Excalidraw",button:"Insert",description:"Currently only <flowchartLink>Flowchart</flowchartLink>,<sequenceLink> Sequence, </sequenceLink> and <classLink>Class </classLink>Diagrams are supported. The other types will be rendered as image in Excalidraw.",syntax:"Mermaid Syntax",preview:"Preview",label:"Mermaid",inputPlaceholder:"Write Mermaid diagram defintion here..."},z$={error:"Error!"},H$={inputPlaceholder:"Start typing your diagram idea here... ({{shortcut}} for new line)",inputPlaceholderWithMessages:"Continue refining your diagram...",generating:"Generating...",rateLimitRemaining:"{{count}} requests left today",role:{user:"You",assistant:"AI Assistant",system:"System"},aiBeta:"AI Beta",label:"Chat",menu:"Menu",newChat:"New Chat",deleteChat:"Delete chat",deleteMessage:"Delete message",viewAsMermaid:"View as Mermaid",placeholder:{title:"Let's design your diagram",description:"Describe the diagram you want to create, and we'll generate it for you.",hint:"At the moment we know Flowchart, Sequence, and Class diagrams."},preview:"Preview",insert:"Insert",retry:"Retry",errors:{promptTooShort:"Prompt is too short (min {{min}} characters)",promptTooLong:"Prompt is too long (max {{max}} characters)",generationFailed:"Generation failed",invalidDiagram:"Generated an invalid diagram :(. You may edit manually, retry with auto-fix, or try a different prompt.",fixInMermaid:"Edit Mermaid manually ",aiRepair:"Regenerate (auto-fix) ",requestAborted:"Request aborted",requestFailed:"Request failed",mermaidParseError:"Mermaid syntax error"},rateLimit:{messageLimit:"You've hit your AI limit on the free plan. Try out Excalidraw+ for more or come back tomorrow.",generalRateLimit:"Hold your horses, you're too fast for us! Please wait a moment before trying again.",messageLimitInputPlaceholder:"You've reached your message limit"},upsellBtnLabel:"Upgrade to Plus"},V$={placeholder:"Quick search"},$$={badge:{old:"old"},sceneFonts:"In this scene",availableFonts:"Available fonts",empty:"No fonts found"},G$={empty:"No users found",hint:{text:"Click on user to follow",followStatus:"You're currently following this user",inCall:"User is in a voice call",micMuted:"User's microphone is muted",isSpeaking:"User is speaking"}},X$={title:"Command palette",shortcuts:{select:"Select",confirm:"Confirm",close:"Close"},recents:"Recently used",search:{placeholder:"Search menus, commands, and discover hidden gems",noMatch:"No matching commands..."},itemNotAvailable:"Command is not available...",shortcutHint:"For Command palette, use {{shortcut}}"},j$={ctrl:"Ctrl",option:"Option",cmd:"Cmd",alt:"Alt",escape:"Esc",enter:"Enter",shift:"Shift",spacebar:"Space",delete:"Delete",mmb:"Scroll wheel"},VT={labels:c$,elementLink:d$,library:u$,search:f$,buttons:h$,alerts:g$,errors:m$,toolBar:p$,element:U$,headings:b$,hints:y$,canvasError:E$,errorSplash:v$,shareDialog:_$,roomDialog:w$,errorDialog:T$,exportDialog:I$,helpDialog:S$,clearCanvasDialog:C$,publishDialog:x$,publishSuccessDialog:A$,confirmDialog:M$,imageExportDialog:k$,encrypted:R$,stats:D$,toast:L$,colors:P$,welcomeScreen:N$,colorPicker:O$,overwriteConfirm:F$,mermaid:B$,ttd:z$,chat:H$,quickSearch:V$,fontList:$$,userList:G$,commandPalette:X$,keys:j$},Fhe=Object.freeze(Object.defineProperty({__proto__:null,alerts:g$,buttons:h$,canvasError:E$,chat:H$,clearCanvasDialog:C$,colorPicker:O$,colors:P$,commandPalette:X$,confirmDialog:M$,default:VT,element:U$,elementLink:d$,encrypted:R$,errorDialog:T$,errorSplash:v$,errors:m$,exportDialog:I$,fontList:$$,headings:b$,helpDialog:S$,hints:y$,imageExportDialog:k$,keys:j$,labels:c$,library:u$,mermaid:B$,overwriteConfirm:F$,publishDialog:x$,publishSuccessDialog:A$,quickSearch:V$,roomDialog:w$,search:f$,shareDialog:_$,stats:D$,toast:L$,toolBar:p$,ttd:z$,userList:G$,welcomeScreen:N$},Symbol.toStringTag,{value:"Module"})),Y$=100,W$=22,K$={"ar-SA":84,"az-AZ":25,"bg-BG":65,"bn-BD":39,"bn-IN":39,"ca-ES":84,"cs-CZ":76,"da-DK":28,"de-CH":85,"de-DE":85,"el-GR":80,en:Y$,"es-ES":85,"eu-ES":72,"fa-IR":84,"fi-FI":62,"fr-FR":92,"gl-ES":63,"he-IL":84,"hi-IN":86,"hu-HU":67,"id-ID":84,"it-IT":99,"ja-JP":81,kaa:W$,"kab-KAB":56,"kk-KZ":13,"km-KH":56,"ko-KR":75,"ku-TR":59,"lt-LT":35,"lv-LV":53,"mr-IN":84,"my-MM":25,"nb-NO":84,"nl-NL":99,"nn-NO":45,"oc-FR":79,"pa-IN":54,"pl-PL":93,"pt-BR":84,"pt-PT":84,"ro-RO":100,"ru-RU":99,"si-LK":70,"sk-SK":93,"sl-SI":84,"sv-SE":85,"ta-IN":81,"th-TH":59,"tr-TR":88,"uk-UA":84,"uz-UZ":0,"vi-VN":70,"zh-CN":93,"zh-HK":16,"zh-TW":84},Bhe=Object.freeze(Object.defineProperty({__proto__:null,default:K$,en:Y$,kaa:W$},Symbol.toStringTag,{value:"Module"})),zhe=85,af={code:"en",label:"English"},sE=[af,...[{code:"ar-SA",label:"",rtl:!0},{code:"bg-BG",label:""},{code:"ca-ES",label:"Catal"},{code:"cs-CZ",label:"esky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:""},{code:"es-ES",label:"Espaol"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Franais"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"",rtl:!0},{code:"hi-IN",label:""},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:""},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:" "},{code:"ko-KR",label:""},{code:"ku-TR",label:"Kurd"},{code:"lt-LT",label:"Lietuvi"},{code:"lv-LV",label:"Latvieu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokml"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:""},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Portugus Brasileiro"},{code:"pt-PT",label:"Portugus"},{code:"ro-RO",label:"Romn"},{code:"ru-RU",label:""},{code:"sk-SK",label:"Slovenina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenina"},{code:"tr-TR",label:"Trke"},{code:"uk-UA",label:""},{code:"zh-CN",label:""},{code:"zh-TW",label:""},{code:"vi-VN",label:"Ting Vit"},{code:"mr-IN",label:""}].filter(e=>K$[e.code]>=zhe).sort((e,t)=>e.label>t.label?1:-1)],Z$="__test__";let bh=af,Ab={};const q$=async e=>{if(bh=e,document.documentElement.dir=bh.rtl?"rtl":"ltr",document.documentElement.lang=bh.code,e.code.startsWith(Z$))Ab={};else try{Ab=await whe(Object.assign({"./locales/ar-SA.json":()=>Ue(()=>import("./locales/ar-SA.json-B0e8d-qe.js"),__vite__mapDeps([])),"./locales/az-AZ.json":()=>Ue(()=>import("./locales/az-AZ.json-DtyjPp_C.js"),__vite__mapDeps([])),"./locales/bg-BG.json":()=>Ue(()=>import("./locales/bg-BG.json-CqhOM8G4.js"),__vite__mapDeps([])),"./locales/bn-BD.json":()=>Ue(()=>import("./locales/bn-BD.json-CarEu6to.js"),__vite__mapDeps([])),"./locales/bn-IN.json":()=>Ue(()=>import("./locales/bn-IN.json-vhiIjuiP.js"),__vite__mapDeps([])),"./locales/ca-ES.json":()=>Ue(()=>import("./locales/ca-ES.json-DDTuZiJG.js"),__vite__mapDeps([])),"./locales/cs-CZ.json":()=>Ue(()=>import("./locales/cs-CZ.json-GJzW7TSE.js"),__vite__mapDeps([])),"./locales/da-DK.json":()=>Ue(()=>import("./locales/da-DK.json-Be0TzPzl.js"),__vite__mapDeps([])),"./locales/de-CH.json":()=>Ue(()=>import("./locales/de-CH.json-D69230kg.js"),__vite__mapDeps([])),"./locales/de-DE.json":()=>Ue(()=>import("./locales/de-DE.json-D69230kg.js"),__vite__mapDeps([])),"./locales/el-GR.json":()=>Ue(()=>import("./locales/el-GR.json-CHr149cq.js"),__vite__mapDeps([])),"./locales/en.json":()=>Ue(()=>Promise.resolve().then(()=>Fhe),void 0),"./locales/es-ES.json":()=>Ue(()=>import("./locales/es-ES.json-mElEeZ2D.js"),__vite__mapDeps([])),"./locales/eu-ES.json":()=>Ue(()=>import("./locales/eu-ES.json-CNw2jJEU.js"),__vite__mapDeps([])),"./locales/fa-IR.json":()=>Ue(()=>import("./locales/fa-IR.json-92JiA0KN.js"),__vite__mapDeps([])),"./locales/fi-FI.json":()=>Ue(()=>import("./locales/fi-FI.json-CdOAdcjo.js"),__vite__mapDeps([])),"./locales/fr-FR.json":()=>Ue(()=>import("./locales/fr-FR.json-Cl7dF38g.js"),__vite__mapDeps([])),"./locales/gl-ES.json":()=>Ue(()=>import("./locales/gl-ES.json-fzzZLZQ9.js"),__vite__mapDeps([])),"./locales/he-IL.json":()=>Ue(()=>import("./locales/he-IL.json-BAKkfUWM.js"),__vite__mapDeps([])),"./locales/hi-IN.json":()=>Ue(()=>import("./locales/hi-IN.json-CUCyTyWo.js"),__vite__mapDeps([])),"./locales/hu-HU.json":()=>Ue(()=>import("./locales/hu-HU.json-CV3SA8ex.js"),__vite__mapDeps([])),"./locales/id-ID.json":()=>Ue(()=>import("./locales/id-ID.json-DE2Cqq5b.js"),__vite__mapDeps([])),"./locales/it-IT.json":()=>Ue(()=>import("./locales/it-IT.json-2PLJraya.js"),__vite__mapDeps([])),"./locales/ja-JP.json":()=>Ue(()=>import("./locales/ja-JP.json-CQMoyVLC.js"),__vite__mapDeps([])),"./locales/kaa.json":()=>Ue(()=>import("./locales/kaa.json-Dh-4QROb.js"),__vite__mapDeps([])),"./locales/kab-KAB.json":()=>Ue(()=>import("./locales/kab-KAB.json-B6YUps6Z.js"),__vite__mapDeps([])),"./locales/kk-KZ.json":()=>Ue(()=>import("./locales/kk-KZ.json-1lyZ103-.js"),__vite__mapDeps([])),"./locales/km-KH.json":()=>Ue(()=>import("./locales/km-KH.json-YG2La45k.js"),__vite__mapDeps([])),"./locales/ko-KR.json":()=>Ue(()=>import("./locales/ko-KR.json-DQzg7NpQ.js"),__vite__mapDeps([])),"./locales/ku-TR.json":()=>Ue(()=>import("./locales/ku-TR.json-DulXJuPf.js"),__vite__mapDeps([])),"./locales/lt-LT.json":()=>Ue(()=>import("./locales/lt-LT.json-BI5PGxiE.js"),__vite__mapDeps([])),"./locales/lv-LV.json":()=>Ue(()=>import("./locales/lv-LV.json-Dd3uiNAK.js"),__vite__mapDeps([])),"./locales/mr-IN.json":()=>Ue(()=>import("./locales/mr-IN.json-CE3us3Fi.js"),__vite__mapDeps([])),"./locales/my-MM.json":()=>Ue(()=>import("./locales/my-MM.json-B-uNC5oj.js"),__vite__mapDeps([])),"./locales/nb-NO.json":()=>Ue(()=>import("./locales/nb-NO.json-B2a_ll4z.js"),__vite__mapDeps([])),"./locales/nl-NL.json":()=>Ue(()=>import("./locales/nl-NL.json-CfAX9f-w.js"),__vite__mapDeps([])),"./locales/nn-NO.json":()=>Ue(()=>import("./locales/nn-NO.json-CIGsfoKm.js"),__vite__mapDeps([])),"./locales/oc-FR.json":()=>Ue(()=>import("./locales/oc-FR.json-DfxVss9i.js"),__vite__mapDeps([])),"./locales/pa-IN.json":()=>Ue(()=>import("./locales/pa-IN.json-Cyd9VJab.js"),__vite__mapDeps([])),"./locales/percentages.json":()=>Ue(()=>Promise.resolve().then(()=>Bhe),void 0),"./locales/pl-PL.json":()=>Ue(()=>import("./locales/pl-PL.json-CB5UbRiG.js"),__vite__mapDeps([])),"./locales/pt-BR.json":()=>Ue(()=>import("./locales/pt-BR.json-GPJR67js.js"),__vite__mapDeps([])),"./locales/pt-PT.json":()=>Ue(()=>import("./locales/pt-PT.json-Cyhb98dc.js"),__vite__mapDeps([])),"./locales/ro-RO.json":()=>Ue(()=>import("./locales/ro-RO.json-DtuisOGY.js"),__vite__mapDeps([])),"./locales/ru-RU.json":()=>Ue(()=>import("./locales/ru-RU.json-C9d6W5vW.js"),__vite__mapDeps([])),"./locales/si-LK.json":()=>Ue(()=>import("./locales/si-LK.json-DWhqtTpr.js"),__vite__mapDeps([])),"./locales/sk-SK.json":()=>Ue(()=>import("./locales/sk-SK.json-Dp16EYYR.js"),__vite__mapDeps([])),"./locales/sl-SI.json":()=>Ue(()=>import("./locales/sl-SI.json-CXPYOnbI.js"),__vite__mapDeps([])),"./locales/sv-SE.json":()=>Ue(()=>import("./locales/sv-SE.json-DECpv7fU.js"),__vite__mapDeps([])),"./locales/ta-IN.json":()=>Ue(()=>import("./locales/ta-IN.json-5HNGLlpx.js"),__vite__mapDeps([])),"./locales/th-TH.json":()=>Ue(()=>import("./locales/th-TH.json-t8UcrCT-.js"),__vite__mapDeps([])),"./locales/tr-TR.json":()=>Ue(()=>import("./locales/tr-TR.json-DClzbz6u.js"),__vite__mapDeps([])),"./locales/uk-UA.json":()=>Ue(()=>import("./locales/uk-UA.json-DD2kmKOm.js"),__vite__mapDeps([])),"./locales/uz-UZ.json":()=>Ue(()=>import("./locales/uz-UZ.json-D78i0hec.js"),__vite__mapDeps([])),"./locales/vi-VN.json":()=>Ue(()=>import("./locales/vi-VN.json-DbtrA-ar.js"),__vite__mapDeps([])),"./locales/zh-CN.json":()=>Ue(()=>import("./locales/zh-CN.json-D8B0Xgmh.js"),__vite__mapDeps([])),"./locales/zh-HK.json":()=>Ue(()=>import("./locales/zh-HK.json-Bv007uRw.js"),__vite__mapDeps([])),"./locales/zh-TW.json":()=>Ue(()=>import("./locales/zh-TW.json-BvenwCxf.js"),__vite__mapDeps([]))}),`./locales/${bh.code}.json`)}catch(t){console.error(`Failed to load language ${e.code}:`,t.message),Ab=VT}ar.set(Q$,e.code)},W0=()=>bh,mR=(e,t)=>{for(let n=0;n<t.length;++n){const i=t[n];if(e[i]===void 0)return;e=e[i]}if(typeof e=="string")return e},x=(e,t,n)=>{if(bh.code.startsWith(Z$))return`[[${t?`${e}(${JSON.stringify(t).slice(1,-1)})`:e}]]`;const i=e.split(".");let s=mR(Ab,i)||mR(VT,i)||n;if(s===void 0){const r=`Can't find translation for ${e}`;return console.warn(r),""}if(t)for(const r in t)s=s.replace(`{{${r}}}`,String(t[r]));return s},Q$=Nt(af.code),Ft=()=>{const e=HT(Q$);return{t:x,langCode:e}},Hhe=(e,t)=>{const[n,i,s,r]=t,{x:o,y:a}=cr({sceneX:n,sceneY:i},e),{x:l,y:c}=cr({sceneX:s,sceneY:r},e);return l-o>e.width||c-a>e.height},J$=({scenePoint:e,viewportDimensions:t,zoom:n,offsets:i})=>{let s=(t.width-((i==null?void 0:i.right)??0))/2/n.value-e.x;s+=((i==null?void 0:i.left)??0)/2/n.value;let r=(t.height-((i==null?void 0:i.bottom)??0))/2/n.value-e.y;return r+=((i==null?void 0:i.top)??0)/2/n.value,{scrollX:s,scrollY:r}},K0=(e,t)=>{if(e=_he(e),!e.length)return{scrollX:0,scrollY:0};let[n,i,s,r]=Et(e);Hhe(t,[n,i,s,r])&&([n,i,s,r]=ife(e,zt({clientX:t.scrollX,clientY:t.scrollY},t)));const o=(n+s)/2,a=(i+r)/2;return J$({scenePoint:{x:o,y:a},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})},ml=e=>Ke(Ul(e,6),C9,x9),Vhe=e=>Ke(Math.round(e),1,100),eG=e=>Ke(Math.round(e),1,100),yo=e=>"var(--icon-fill-color)",tG=e=>e===be.LIGHT?"#fff":"#1e1e1e",W=(e,t=512)=>{const{width:n=512,height:i=n,mirror:s,style:r,...o}=typeof t=="number"?{width:t}:t;return g("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${i}`,className:ae({"rtl-mirror":s}),style:r,...o,children:typeof e=="string"?g("path",{fill:"currentColor",d:e}):e})},le={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},Ye={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"};W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:3,y:8,width:18,height:4,rx:1}),g("line",{x1:12,y1:8,x2:12,y2:21}),g("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),g("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),le);const nG=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),g("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),g("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),le),$he=W(P("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),le),Ghe=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"1"}),g("circle",{cx:"12",cy:"19",r:"1"}),g("circle",{cx:"12",cy:"5",r:"1"})]}),le),Xhe=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"})]}),le),jhe=W(P("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),g("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),g("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),le),pR=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M6.5 9.5l3.5 -3"}),g("path",{d:"M14 5.5l3 1.5"}),g("path",{d:"M18.5 10l-2.5 7"}),g("path",{d:"M13.5 17.5l-7 -5"})]}),le),rE=W(P("g",{children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:g("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),g("g",{mask:"url(#UnlockedIcon)",children:g("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),Ye),$T=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),g("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),Ye),Yhe=W(g("g",{fill:"currentColor",children:g("path",{d:"M12 2a5 5 0 0 1 5 5v3a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-10a3 3 0 0 1 -3 -3v-6a3 3 0 0 1 3 -3v-3a5 5 0 0 1 5 -5m0 12a2 2 0 0 0 -1.995 1.85l-.005 .15a2 2 0 1 0 2 -2m0 -10a3 3 0 0 0 -3 3v3h6v-3a3 3 0 0 0 -3 -3"})}),{width:24,height:24}),Whe=W(P(fe,{children:[g("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),g("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),Khe=W(P(fe,{children:[g("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),g("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),Zhe=W(P(fe,{children:[g("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),g("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"}),o_=W(g("g",{fill:"currentColor",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"}),oE=W(P("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),g("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),i0=W(P("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[g("path",{d:"M4.028 13.252c-.657 -.972 -1.028 -2.078 -1.028 -3.252c0 -3.866 4.03 -7 9 -7s9 3.134 9 7s-4.03 7 -9 7c-1.913 0 -3.686 -.464 -5.144 -1.255"}),g("path",{d:"M5 15m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 17c0 1.42 .316 2.805 1 4"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),GT=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),le),XT=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),le),jT=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"})]}),le),iG=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),le),YT=W(g("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),Ye),qhe=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),g("path",{d:"M16 7h4"}),g("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),le),u2=W(P("g",{strokeWidth:"1.25",children:[g("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),g("path",{d:"m11.25 5.417 3.333 3.333"})]}),Ye),Fh=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),g("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),g("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),g("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),g("polyline",{points:"5 20 11 4 13 4 20 20"})]}),le),Qhe=W(P("g",{stroke:"currentColor",strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),le),Mb=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M12.5 6.667h.01"}),g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),g("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),g("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),Ye),sG=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),g("path",{d:"M18 13.3l-6.3 -6.3"})]}),le),UR=W(g("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),Ye),bR=W(g("path",{d:"M5 10h10",strokeWidth:"1.25"}),Ye),Jhe=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 21l-6 -6"}),g("path",{d:"M3.268 12.043a7.017 7.017 0 0 0 6.634 4.957a7.012 7.012 0 0 0 7.043 -6.131a7 7 0 0 0 -5.314 -7.672a7.021 7.021 0 0 0 -8.241 4.403"}),g("path",{d:"M3 4v4h4"})]}),le),Ia=W(g("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),Ye),g5=W(P("g",{strokeWidth:"1.5",children:[g("polyline",{points:"12 16 18 10 12 4"}),g("polyline",{points:"8 4 2 10 8 16"})]}),Ye),a_=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),Ye),l_=W(g("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),Ye),c_=W(g("g",{stroke:"currentColor",strokeLinejoin:"round",children:g("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),{...Ye,strokeWidth:1.5}),ege=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),g("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),le),aE=W(g("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),Ye),WT=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),tge=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),yR=W(g("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),Ye),KT=W(g("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),Ye),rG=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),g("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),Ye),oG=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4l11.733 16h4.267l-11.733 -16z"}),g("path",{d:"M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"})]}),le),aG=W(g("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),m5=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),g("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),Ye),nge=W("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),ige=W("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),ZT=W(g("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),Ye);W("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512});W("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z");const K3=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 16l1.465 1.638a2 2 0 1 1 -3.015 .099l1.55 -1.737z"}),g("path",{d:"M13.737 9.737c2.299 -2.3 3.23 -5.095 2.081 -6.245c-1.15 -1.15 -3.945 -.217 -6.244 2.082c-2.3 2.299 -3.231 5.095 -2.082 6.244c1.15 1.15 3.946 .218 6.245 -2.081z"}),g("path",{d:"M7.492 11.818c.362 .362 .768 .676 1.208 .934l6.895 4.047c1.078 .557 2.255 -.075 3.692 -1.512c1.437 -1.437 2.07 -2.614 1.512 -3.692c-.372 -.718 -1.72 -3.017 -4.047 -6.895a6.015 6.015 0 0 0 -.934 -1.208"})]}),le),sge=W(g("g",{strokeWidth:1.5,children:g("path",{d:"M6 18l12 -12"})}),le),lG=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8h.01"}),g("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),g("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),g("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),g("path",{d:"M19 16v6"}),g("path",{d:"M22 19l-3 3l-3 -3"})]}),le),rge=W("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512});W("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});W("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});const oge=W("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z");W("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z");const ER=W(g("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),Ye),vR=W(g("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),Ye),age=W("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),qT=W(g("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),Ye),lge=W("M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"),cge=W("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),dge=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1"}),g("path",{d:"M12 14v-11"}),g("path",{d:"M9 6l3 -3l3 3"})]}),le),uge=W(P(fe,{children:[g("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),g("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64});W(g("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024});const cG=P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 10l0 10"}),g("path",{d:"M12 10l4 4"}),g("path",{d:"M12 10l-4 4"}),g("path",{d:"M4 4l16 0"})]}),dG=P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5l0 14"}),g("path",{d:"M16 9l-4 -4"}),g("path",{d:"M8 9l4 -4"})]}),_R=W(dG,le),wR=W(dG,{...le,style:{transform:"rotate(180deg)"}}),TR=W(cG,le),IR=W(cG,{...le,style:{transform:"rotate(180deg)"}}),SR=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),CR=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),xR=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),AR=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),fge=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),hge=W(P(fe,{children:[P("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),MR=W(P("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),g("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),Ye),kR=W(P("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),g("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),Ye),QT=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"9",cy:"7",r:"4"}),g("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),g("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),g("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),le);W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z");const gge=W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z"),lf=W(P(fe,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M15 5 5 15M5 5l10 10"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye);W("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0});const mge=W("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24});W("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512});const RR=de.memo(({theme:e})=>W(P(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:yo()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:yo(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:yo()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:yo(),strokeWidth:"2"}),P("g",{fill:tG(e),stroke:yo(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),DR=de.memo(({theme:e})=>W(P(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:yo()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:yo(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:yo()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:yo(),strokeWidth:"2"}),P("g",{fill:tG(e),stroke:yo(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),g("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),pge=W(g("g",{strokeWidth:1.25,children:g("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),Ye),Uge=W(P(fe,{children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),g("g",{mask:"url(#FillHachureIcon)",children:g("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),Ye),bge=W(P(fe,{children:[P("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:g("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("g",{mask:"url(#FillCrossHatchIcon)",children:g("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),yge=W(P(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...Ye,fill:"currentColor"}),uG=W(g(fe,{children:g("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Ye),Ege=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),Ye),vge=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),Ye);de.memo(({theme:e})=>W(g("path",{d:"M6 10H34",stroke:yo(),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20}));const _ge=W(P("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12h2"}),g("path",{d:"M17 12h2"}),g("path",{d:"M11 12h2"})]}),le),wge=W(P("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M8 12v.01"}),g("path",{d:"M12 12v.01"}),g("path",{d:"M16 12v.01"}),g("path",{d:"M20 12v.01"})]}),le),Tge=W(g("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),Ye),Ige=W(g("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),Ye),Sge=W(g("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),Ye),Cge=W(P("svg",{strokeWidth:"1.5",children:[g("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),g("path",{d:"M13.3333 3.33331V3.34331"}),g("path",{d:"M16.6667 3.33331V3.34331"}),g("path",{d:"M16.6667 6.66669V6.67669"}),g("path",{d:"M16.6667 10V10.01"}),g("path",{d:"M3.33334 13.3333V13.3433"}),g("path",{d:"M16.6667 13.3333V13.3433"}),g("path",{d:"M3.33334 16.6667V16.6767"}),g("path",{d:"M6.66666 16.6667V16.6767"}),g("path",{d:"M10 16.6667V16.6767"}),g("path",{d:"M13.3333 16.6667V16.6767"}),g("path",{d:"M16.6667 16.6667V16.6767"})]}),Ye),xge=W(P("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),g("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),g("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),g("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),g("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),g("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),g("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),g("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),g("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),g("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),g("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),g("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),le),Age=W(P("g",{stroke:"currentColor",opacity:.3,strokeWidth:2,children:[g("path",{d:"M12 12l9 0"}),g("path",{d:"M3 9l6 6"}),g("path",{d:"M3 15l6 -6"})]}),le),d_=de.memo(({flip:e=!1})=>W(P("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[g("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),g("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),Mge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),kge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[g("path",{d:"M26 10L6 10"}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),Rge=de.memo(({flip:e=!1})=>W(g("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",children:g("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),Dge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),Lge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[g("path",{d:"M6,9.5H27"}),g("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),Pge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),Nge=de.memo(({flip:e=!1})=>W(P("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),Oge=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),Fge=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,15 L15,5"})}),{width:40,height:20})),Bge=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,16 L15,4 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),zge=W(P(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),Hge=W(P(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),Vge=W(P(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Ye),$ge=W(g(fe,{children:g("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Ye),lE=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),le),Gge=W(g(fe,{children:P("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 12h10"}),g("path",{d:"M7 5v14"}),g("path",{d:"M17 5v14"}),g("path",{d:"M15 19h4"}),g("path",{d:"M15 5h4"}),g("path",{d:"M5 19h4"}),g("path",{d:"M5 5h4"})]})}),le),u_=W(g(fe,{children:g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),Ye),fG=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 8l-4 4l4 4"}),g("path",{d:"M17 8l4 4l-4 4"}),g("path",{d:"M14 4l-4 16"})]}),le),hG=fG,Xge=W(P("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),g("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),le),jge=W(P("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),g("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),le),Yge=W(P("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),le),Wge=de.memo(({theme:e})=>W(P("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),g("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),le)),Kge=de.memo(({theme:e})=>W(P("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),g("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),le)),Zge=de.memo(({theme:e})=>W(P("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),g("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),g("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),le)),gG=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 19h-18l9 -15"}),g("path",{d:"M20.615 15.171h.015"}),g("path",{d:"M19.515 11.771h.015"}),g("path",{d:"M17.715 8.671h.015"}),g("path",{d:"M15.415 5.971h.015"})]}),le),qge=W(g("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512});W(g("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"}));const mG=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),g("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),le),LR=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M7 11l5 5l5 -5"}),g("path",{d:"M12 4l0 12"})]}),le),f2=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),g("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),le),Qge=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M9.15 14.85l8.85 -10.85"}),g("path",{d:"M6 4l8.85 10.85"})]}),le),Jge=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),g("path",{d:"M12 17l0 .01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),eme=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 4v16l13 -8z"})]}),le),tme=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),le),nme=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12l5 5l10 -10"})]}),le),pG=W(P(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),g("path",{d:"M12 9v4"}),g("path",{d:"M12 17h.01"})]}),le),ime=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l6 6"}),g("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),le),f_=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l-4 7h8z"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),le),yu=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 7l16 0"}),g("path",{d:"M4 17l16 0"}),g("path",{d:"M7 4l0 16"}),g("path",{d:"M17 4l0 16"})]}),le),JT=W(g("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),sme=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"}),g("path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"})]}),le),rme=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 10l-2 1l8 4l8 -4l-2 -1"}),g("path",{d:"M4 15l8 4l8 -4"}),g("path",{d:"M12 4v7"}),g("path",{d:"M15 8l-3 3l-3 -3"})]}),le),cE=W(P("g",{strokeWidth:"1.25",children:[g("path",{d:"M4.16602 10H15.8327"}),g("path",{d:"M12.5 13.3333L15.8333 10"}),g("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),Ye),Z0=W(P("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[g("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),g("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),p5=W(P("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),le);W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),le);W(P("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),g("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),g("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),g("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),g("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),g("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),le);const ome=W(P("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),g("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),g("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),g("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),le),eI=W(P("g",{stroke:"currentColor",fill:"none",strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),g("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),le),ame=W(P("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),g("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),g("path",{d:"M3 3l18 18"})]}),le),lme=W(P("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),le),cme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),le),Fu=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),g("path",{d:"M21 21l-6 -6"})]}),le),dme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20.984 12.53a9 9 0 1 0 -7.552 8.355"}),g("path",{d:"M12 7v5l3 3"}),g("path",{d:"M19 16l-2 3h4l-2 3"})]}),le),ume=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 8l0 4l2 2"}),g("path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5"})]}),le),fme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z"}),g("path",{d:"M5 10a7 7 0 0 0 14 0"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),le),hme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 3l18 18"}),g("path",{d:"M9 5a3 3 0 0 1 6 0v5a3 3 0 0 1 -.13 .874m-2 2a3 3 0 0 1 -3.87 -2.872v-1"}),g("path",{d:"M5 10a7 7 0 0 0 10.846 5.85m2 -2a6.967 6.967 0 0 0 1.152 -3.85"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),le),h_=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]}),le),gme=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"}),g("path",{d:"M12 20v.01"}),g("path",{d:"M16 20v.01"}),g("path",{d:"M8 20v.01"}),g("path",{d:"M4 20v.01"}),g("path",{d:"M4 16v.01"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M4 8v.01"}),g("path",{d:"M4 4v.01"}),g("path",{d:"M8 4v.01"}),g("path",{d:"M12 4v.01"}),g("path",{d:"M16 4v.01"}),g("path",{d:"M20 4v.01"}),g("path",{d:"M20 8v.01"}),g("path",{d:"M20 12v.01"}),g("path",{d:"M20 16v.01"}),g("path",{d:"M20 20v.01"})]}),le),mme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3v18"}),g("path",{d:"M19 21v-18"}),g("path",{d:"M5 7h14"}),g("path",{d:"M5 15h14"}),g("path",{d:"M8 13v4"}),g("path",{d:"M11 13v4"}),g("path",{d:"M16 13v4"}),g("path",{d:"M14 5v4"}),g("path",{d:"M11 5v4"}),g("path",{d:"M8 5v4"}),g("path",{d:"M3 21h18"})]}),le),pme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 12l18 0"}),g("path",{d:"M7 16l10 0l-10 5l0 -5"}),g("path",{d:"M7 8l10 0l-10 -5l0 5"})]}),le),Ume=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l0 18"}),g("path",{d:"M16 7l0 10l5 0l-5 -10"}),g("path",{d:"M8 7l0 10l-5 0l5 -10"})]}),le),UG=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"}),g("path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2"}),g("path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"})]}),le),tI=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),g("path",{d:"M22 22l-3 -3"}),g("path",{d:"M6 18h-1a2 2 0 0 1 -2 -2v-1"}),g("path",{d:"M3 11v-1"}),g("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),g("path",{d:"M10 3h1"}),g("path",{d:"M15 3h1a2 2 0 0 1 2 2v1"})]}),le),bme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M4 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"}),g("path",{d:"M10 15l2 6l2 -6"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"})]}),le),yme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"}),g("path",{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"}),g("path",{d:"M11 21v-6l3 6v-6"})]}),le),Eme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 13v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a2 2 0 0 0 6 0v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a8 8 0 0 1 -16 0"}),g("path",{d:"M4 8l5 0"}),g("path",{d:"M15 8l4 0"})]}),le),vme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1"}),g("path",{d:"M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z"}),g("path",{d:"M16.746 16.726a3 3 0 1 0 .252 -5.555"})]}),le),_me=W(P("g",{stroke:"currentColor",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-16a1 1 0 0 1-1-1v-10zM7 20h10M9 16v4M15 16v4"})]}),{...le,strokeWidth:1.5}),bG=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M21 12h-13l3 -3"}),g("path",{d:"M11 15l-3 -3"})]}),le),yG=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M2 8a4 4 0 0 1 4 -4h12a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-12a4 4 0 0 1 -4 -4v-8z"}),g("path",{d:"M10 9l5 3l-5 3z"})]}),le),wme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 6h18"}),g("path",{d:"M3 12h18"}),g("path",{d:"M3 18h18"}),g("path",{d:"M6 3v18"}),g("path",{d:"M12 3v18"}),g("path",{d:"M18 3v18"})]}),le),Tme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M3 17m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M17 5c-6.627 0 -12 5.373 -12 12"})]}),le),nI=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 18l12 -12"}),g("path",{d:"M18 10v-4h-4"})]}),le),iI=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4,19L10,19C11.097,19 12,18.097 12,17L12,9C12,7.903 12.903,7 14,7L21,7"}),g("path",{d:"M18 4l3 3l-3 3"})]}),le),sI=W(P("g",{children:[g("path",{d:"M16,12L20,9L16,6"}),g("path",{d:"M6 20c0 -6.075 4.925 -11 11 -11h3"})]}),le),EG=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 9l6 6l6 -6"})]}),le),Ime=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),le),Sme=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),le),PR=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 5v10a1 1 0 0 0 1 1h10"}),g("path",{d:"M5 8h10a1 1 0 0 1 1 1v10"})]}),le),vG=W(P("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 7l0 10"}),g("path",{d:"M7 5l10 0"}),g("path",{d:"M7 19l10 0"}),g("path",{d:"M19 7l0 10"})]}),le);W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 11v8a1 1 0 0 0 1 1h8m-9 -14v-1a1 1 0 0 1 1 -1h1m5 0h2m5 0h1a1 1 0 0 1 1 1v1m0 5v2m0 5v1a1 1 0 0 1 -1 1h-1"}),g("path",{d:"M4 12h7a1 1 0 0 1 1 1v7"})]}),le);const Cme=W(P("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 6l8 0"}),g("path",{d:"M16 6l4 0"}),g("path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 12l2 0"}),g("path",{d:"M10 12l10 0"}),g("path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 18l11 0"}),g("path",{d:"M19 18l1 0"})]}),le),xme=W(P("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 10l4 -4 L6 14l8 -8 L6 18l12 -12 L10 18l8 -8 L14 18l4 -4"})]}),le),Ame=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"}),g("path",{d:"M13.5 6.5l4 4"})]}),le);W(P("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l-5 5l5 5"}),g("path",{d:"M17 7l-5 5l5 5"})]}),le);const Mme=W(P("g",{strokeWidth:"1.75",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"}),g("path",{d:"M15 4l0 16"})]}),le),kme=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1"})]}),le),Rme=W(P("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 4l18 0"}),g("path",{d:"M4 4v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-10"}),g("path",{d:"M12 16l0 4"}),g("path",{d:"M9 20l6 0"}),g("path",{d:"M8 12l3 -3l2 2l3 -3"})]}),le),Dme=g("div",{style:{width:"1rem",height:"1rem"}}),Lme=W(P("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("polyline",{points:"9 6 15 12 9 18"})]}),le),Pme=W(P("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 6l8 0"}),g("path",{d:"M16 6l4 0"}),g("path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 12l2 0"}),g("path",{d:"M10 12l10 0"}),g("path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 18l11 0"}),g("path",{d:"M19 18l1 0"})]}),le);class Nme extends Error{constructor(t="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=t}}class yg extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}}class iu extends Error{constructor(n="Image Scene Data Error",i="IMAGE_SCENE_DATA_ERROR"){super(n);B(this,"code");this.name="EncodingError",this.code=i}}class _G extends Error{constructor(n="Worker URL is not defined!",i="WORKER_URL_NOT_DEFINED"){super(n);B(this,"code");this.name="WorkerUrlNotDefinedError",this.code=i}}class wG extends Error{constructor(n="Worker has to be in a separate chunk!",i="WORKER_IN_THE_MAIN_CHUNK"){super(n);B(this,"code");this.name="WorkerInTheMainChunkError",this.code=i}}class vo extends Error{constructor(t){super(t),this.name="ExcalidrawError"}}class ja extends Error{constructor({message:n="Something went wrong",status:i=500,data:s}={}){super();B(this,"status");B(this,"data");this.name="RequestError",this.message=n,this.status=i,this.data=s}toObject(){return{name:this.name,status:this.status,message:this.message}}}const Sa=({size:e="1em",circleWidth:t=8,synchronized:n=!1,className:i=""})=>{const r=-(de.useRef(Date.now()).current%1600);return g("div",{className:`Spinner ${i}`,children:g("svg",{viewBox:"0 0 100 100",style:{width:e,height:e,"--spinner-delay":n?`${r}ms`:0},children:g("circle",{cx:"50",cy:"50",r:50-t/2,strokeWidth:t,fill:"none",strokeMiterlimit:"10"})})})},qe=de.forwardRef(({size:e="medium",visible:t=!0,className:n="",...i},s)=>{const{id:r}=Ws(),o=de.useRef(null);de.useImperativeHandle(s,()=>o.current);const a=`ToolIcon_size_${e}`,[l,c]=C.useState(!1),d=C.useRef(!0),u=async h=>{var p;const m="onClick"in i&&((p=i.onClick)==null?void 0:p.call(i,h));if(Wp(m))try{c(!0),await m}catch(U){if(U instanceof yg)console.warn(U);else throw U}finally{d.current&&c(!1)}};C.useEffect(()=>(d.current=!0,()=>{d.current=!1}),[]);const f=C.useRef(null);if(i.type==="button"||i.type==="icon"||i.type==="submit"){const h=i.type==="icon"?"button":i.type;return P("button",{className:ae("ToolIcon_type_button",a,n,t&&!i.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!i.hidden,"ToolIcon--selected":i.selected,"ToolIcon--plain":i.type==="icon"}),style:i.style,"data-testid":i["data-testid"],hidden:i.hidden,title:i.title,"aria-label":i["aria-label"],type:h,onClick:u,ref:o,disabled:l||i.isLoading||!!i.disabled,children:[(i.icon||i.label)&&P("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":!!i.disabled,children:[i.icon||i.label,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel}),i.isLoading&&g(Sa,{})]}),i.showAriaLabel&&P("div",{className:"ToolIcon__label",children:[i["aria-label"]," ",l&&g(Sa,{})]}),i.children]})}return P("label",{className:ae("ToolIcon",n),title:i.title,onPointerDown:h=>{var m;f.current=h.pointerType||null,(m=i.onPointerDown)==null||m.call(i,{pointerType:h.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{f.current=null})},children:[g("input",{className:`ToolIcon_type_radio ${a}`,type:"radio",name:i.name,"aria-label":i["aria-label"],"aria-keyshortcuts":i["aria-keyshortcuts"],"data-testid":i["data-testid"],id:`${r}-${i.id}`,onChange:()=>{var h;(h=i.onChange)==null||h.call(i,{pointerType:f.current})},checked:i.checked,ref:o}),P("div",{className:"ToolIcon__icon",children:[i.icon,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel})]})]})});qe.displayName="ToolButton";let g_=[];const ue=e=>(g_=g_.concat(e),e),Ome=(e,t,n)=>{const i=new Set(Ze(e.filter(d=>_e(d)),t).map(d=>d.id)),s={},r=n.scene.getNonDeletedElementsMap(),o=new Set;for(const d of i){const u=br(e,d);for(const f of u)if(!o.has(f.id)){if(Vt(f)){const h=Gn(f,r);h&&(s[h.id]=!0)}else s[f.id]=!0;o.add(f.id)}}let a=!0;const l=e.map(d=>{if(t.selectedElementIds[d.id]){const u=Vt(d)?Gn(d,r):null;return d.frameId&&i.has(d.frameId)?(a=!1,s[d.id]=!0,d):u!=null&&u.frameId&&i.has(u==null?void 0:u.frameId)?d:(d.boundElements&&d.boundElements.forEach(f=>{var m,p;const h=n.scene.getNonDeletedElementsMap().get(f.id);h&&ve(h)&&n.scene.mutateElement(h,{startBinding:d.id===((m=h.startBinding)==null?void 0:m.elementId)?null:h.startBinding,endBinding:d.id===((p=h.endBinding)==null?void 0:p.elementId)?null:h.endBinding})}),xe(d,{isDeleted:!0}))}return d.frameId&&i.has(d.frameId)?(a=!1,Vt(d)||(s[d.id]=!0),xe(d,{frameId:null})):Vt(d)&&t.selectedElementIds[d.containerId]?xe(d,{isDeleted:!0}):d});let c=t.editingGroupId;if(a&&t.editingGroupId){const d=Ot(l,t.editingGroupId).filter(u=>!u.isDeleted);if(d.length>1)d[0]&&(s[d[0].id]=!0);else{c=null,d[0]&&(s[d[0].id]=!0);const u=d[0];if(u){const f=u.groupIds.findIndex(m=>m===t.editingGroupId),h=u.groupIds[f+1];if(h){const m=Ot(l,h).filter(p=>!p.isDeleted);m.length>1&&(c=h,m.forEach(p=>{s[p.id]=!0}))}}}}return{elements:l,appState:{...t,...Fi({selectedElementIds:s,editingGroupId:c},l,t,null)}}},NR=(e,t)=>{if(e.editingGroupId){const n=Ot(qt(t),e.editingGroupId);if(n.length)return{...e,selectedElementIds:{[n[0].id]:!0}}}return e},TG=ue({name:"deleteSelectedElements",label:"labels.delete",icon:Ia,trackEvent:{category:"element",action:"delete"},perform:(e,t,n,i)=>{var o;if((o=t.selectedLinearElement)!=null&&o.isEditing){const{elementId:a,selectedPointsIndices:l}=t.selectedLinearElement,c=i.scene.getNonDeletedElementsMap(),d=ne.getElement(a,c);if(!d||l==null)return!1;if(l.length>=d.points.length){const u=e.map(h=>h.id===d.id?xe(h,{isDeleted:!0}):h),f=NR(t,u);return{elements:u,appState:{...f,selectedLinearElement:null},captureUpdate:q.IMMEDIATELY}}return ne.deletePoints(d,i,l),{elements:e,appState:{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:(l==null?void 0:l[0])>0?[l[0]-1]:[0]}},captureUpdate:q.IMMEDIATELY}}let{elements:s,appState:r}=Ome(e,t,i);return lV(s,s.filter(a=>a.isDeleted)),r=NR(r,s),{elements:s,appState:{...r,activeTool:sn(t,{type:i.state.preferredSelectionTool.type}),multiElement:null,newElement:null,activeEmbeddable:null,selectedLinearElement:null},captureUpdate:oi(qt(e),t)?q.IMMEDIATELY:q.EVENTUALLY}},keyTest:(e,t,n)=>(e.key===$.BACKSPACE||e.key===$.DELETE)&&!e[$.CTRL_OR_CMD],PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Na()==="mobile";return g(qe,{type:"button",icon:Ia,title:x("labels.delete"),"aria-label":x("labels.delete"),onClick:()=>n(null),disabled:!oi(qt(e),t),style:{...s&&t.openPopup!=="compactOtherProperties"?Gp:{}}})}}),J=e=>e.replace(/\b(Opt(?:ion)?|Alt)\b/i,x(Ao?"keys.option":"keys.alt")).replace(/\bShift\b/i,x("keys.shift")).replace(/\b(Enter|Return)\b/i,x("keys.enter")).replace(/\b(Ctrl|Cmd|Command|CtrlOrCmd)\b/gi,x(Ao?"keys.cmd":"keys.ctrl")).replace(/\b(Esc(?:ape)?)\b/i,x("keys.escape")).replace(/\b(Space(?:bar)?)\b/i,x("keys.spacebar")).replace(/\b(Del(?:ete)?)\b/i,x("keys.delete")),Fme=ue({name:"sendBackward",label:"labels.sendBackward",keywords:["move down","zindex","layer"],icon:wR,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:qfe(e,t,i.scene),appState:t,captureUpdate:q.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[$.CTRL_OR_CMD]&&!e.shiftKey&&e.code===ut.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${x("labels.sendBackward")}  ${J("CtrlOrCmd+[")}`,children:wR})}),Bme=ue({name:"bringForward",label:"labels.bringForward",keywords:["move up","zindex","layer"],icon:_R,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Qfe(e,t,i.scene),appState:t,captureUpdate:q.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[$.CTRL_OR_CMD]&&!e.shiftKey&&e.code===ut.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${x("labels.bringForward")}  ${J("CtrlOrCmd+]")}`,children:_R})}),zme=ue({name:"sendToBack",label:"labels.sendToBack",keywords:["move down","zindex","layer"],icon:IR,trackEvent:{category:"element"},perform:(e,t)=>({elements:Jfe(e,t),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>Ao?e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.BRACKET_LEFT:e[$.CTRL_OR_CMD]&&e.shiftKey&&e.code===ut.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${x("labels.sendToBack")}  ${J(Ao?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")}`,children:IR})}),Hme=ue({name:"bringToFront",label:"labels.bringToFront",keywords:["move up","zindex","layer"],icon:TR,trackEvent:{category:"element"},perform:(e,t)=>({elements:ehe(e,t),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>Ao?e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.BRACKET_RIGHT:e[$.CTRL_OR_CMD]&&e.shiftKey&&e.code===ut.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:n=>e(null),title:`${x("labels.bringToFront")}  ${J(Ao?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")}`,children:TR})}),Vme=ue({name:"selectAll",label:"labels.selectAll",icon:gme,trackEvent:{category:"canvas"},viewMode:!1,perform:(e,t,n,i)=>{var r;if((r=t.selectedLinearElement)!=null&&r.isEditing)return!1;const s=e.filter(o=>!o.isDeleted&&!(he(o)&&o.containerId)&&!o.locked).reduce((o,a)=>(o[a.id]=!0,o),{});return{appState:{...t,...Fi({editingGroupId:null,selectedElementIds:s},qt(e),t,i),selectedLinearElement:Object.keys(s).length===1&&De(e[0])?new ne(e[0],we(e)):null},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.A}),$me=ue({name:"duplicateSelection",label:"labels.duplicateSelection",icon:a_,trackEvent:{category:"element"},perform:(e,t,n,i)=>{var o;if(t.selectedElementsAreBeingDragged)return!1;if((o=t.selectedLinearElement)!=null&&o.isEditing)try{const a=ne.duplicateSelectedPoints(t,i.scene);return{elements:e,appState:a,captureUpdate:q.IMMEDIATELY}}catch{return!1}let{duplicatedElements:s,elementsWithDuplicates:r}=J1({type:"in-place",elements:e,idsOfElementsToDuplicate:we(Ze(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),appState:t,randomizeSeed:!0,overrides:({origElement:a,origIdToDuplicateId:l})=>{const c=a.frameId&&l.get(a.frameId);return{x:a.x+N6/2,y:a.y+N6/2,frameId:c??a.frameId}}});if(i.props.onDuplicate&&r){const a=i.props.onDuplicate(r,e);a&&(r=a)}return{elements:Mo(r,we(s)),appState:{...t,...gV(s,qt(r),t)},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.D,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Na()==="mobile";return g(qe,{type:"button",icon:a_,title:`${x("labels.duplicateSelection")}  ${J("CtrlOrCmd+D")}`,"aria-label":x("labels.duplicateSelection"),onClick:()=>n(null),disabled:!oi(qt(e),t),style:{...s&&t.openPopup!=="compactOtherProperties"?Gp:{}}})}});var Gme={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"https://oss-collab.excalidraw.com",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_ENABLE_TRACKING:"true",VITE_APP_PLUS_EXPORT_PUBLIC_KEY:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`,VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX:"false",VITE_APP_COLLAPSE_OVERLAY:"false",VITE_APP_ENABLE_ESLINT:"false",VITE_APP_GIT_SHA:"3a5ef4020d7515f34c96d179b631911bb8ef8a9f",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Xme=new Set(["command_palette","export"]),at=(e,t,n,i)=>{try{if(typeof window>"u"||Gme.VITE_WORKER_ID||!Xme.has(e))return;D9(),window.sa_event&&window.sa_event(t,{category:e,label:n,value:i})}catch(s){console.error("error during analytics",s)}},rI=C.forwardRef((e,t)=>{const{title:n,className:i,testId:s,active:r,standalone:o,icon:a,onClick:l}=e;return g("button",{type:"button",ref:t,title:n,"data-testid":s,className:ae(i,{standalone:o,active:r}),onClick:l,style:e.style,children:a},n)}),La=e=>g(fe,{children:e.options.map(t=>e.type==="button"?g(rI,{icon:t.icon,title:t.text,testId:t.testId,active:t.active??e.value===t.value,onClick:n=>e.onClick(t.value,n)},t.text):P("label",{className:ae({active:e.value===t.value}),title:t.text,children:[g("input",{type:"radio",name:e.group,onChange:()=>e.onChange(t.value),checked:e.value===t.value,"data-testid":t.testId}),t.icon]},t.text))});function OR(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function dE(...e){return t=>{let n=!1;const i=e.map(s=>{const r=OR(s,t);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let s=0;s<i.length;s++){const r=i[s];typeof r=="function"?r():OR(e[s],null)}}}}function hs(...e){return C.useCallback(dE(...e),e)}function q0(e){const t=jme(e),n=C.forwardRef((i,s)=>{const{children:r,...o}=i,a=C.Children.toArray(r),l=a.find(Wme);if(l){const c=l.props.children,d=a.map(u=>u===l?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:u);return g(t,{...o,ref:s,children:C.isValidElement(c)?C.cloneElement(c,void 0,d):null})}return g(t,{...o,ref:s,children:r})});return n.displayName=`${e}.Slot`,n}function jme(e){const t=C.forwardRef((n,i)=>{const{children:s,...r}=n;if(C.isValidElement(s)){const o=Zme(s),a=Kme(r,s.props);return s.type!==C.Fragment&&(a.ref=i?dE(i,o):o),C.cloneElement(s,a)}return C.Children.count(s)>1?C.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Yme=Symbol("radix.slottable");function Wme(e){return C.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Yme}function Kme(e,t){const n={...t};for(const i in t){const s=e[i],r=t[i];/^on[A-Z]/.test(i)?s&&r?n[i]=(...a)=>{const l=r(...a);return s(...a),l}:s&&(n[i]=s):i==="style"?n[i]={...s,...r}:i==="className"&&(n[i]=[s,r].filter(Boolean).join(" "))}return{...e,...n}}function Zme(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var qme=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],jn=qme.reduce((e,t)=>{const n=q0(`Primitive.${t}`),i=C.forwardRef((s,r)=>{const{asChild:o,...a}=s,l=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g(l,{...a,ref:r})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function IG(e,t){e&&tn.flushSync(()=>e.dispatchEvent(t))}function cf(e,t=[]){let n=[];function i(r,o){const a=C.createContext(o),l=n.length;n=[...n,o];const c=u=>{var b;const{scope:f,children:h,...m}=u,p=((b=f==null?void 0:f[e])==null?void 0:b[l])||a,U=C.useMemo(()=>m,Object.values(m));return g(p.Provider,{value:U,children:h})};c.displayName=r+"Provider";function d(u,f){var p;const h=((p=f==null?void 0:f[e])==null?void 0:p[l])||a,m=C.useContext(h);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${r}\``)}return[c,d]}const s=()=>{const r=n.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||r;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[i,Qme(s,...t)]}function Qme(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(r){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const u=l(r)[`__scope${c}`];return{...a,...u}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}function SG(e){const t=e+"CollectionProvider",[n,i]=cf(t),[s,r]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:U,children:b}=p,y=de.useRef(null),E=de.useRef(new Map).current;return g(s,{scope:U,itemMap:E,collectionRef:y,children:b})};o.displayName=t;const a=e+"CollectionSlot",l=q0(a),c=de.forwardRef((p,U)=>{const{scope:b,children:y}=p,E=r(a,b),_=hs(U,E.collectionRef);return g(l,{ref:_,children:y})});c.displayName=a;const d=e+"CollectionItemSlot",u="data-radix-collection-item",f=q0(d),h=de.forwardRef((p,U)=>{const{scope:b,children:y,...E}=p,_=de.useRef(null),I=hs(U,_),k=r(d,b);return de.useEffect(()=>(k.itemMap.set(_,{ref:_,...E}),()=>void k.itemMap.delete(_))),g(f,{[u]:"",ref:I,children:y})});h.displayName=d;function m(p){const U=r(e+"CollectionConsumer",p);return de.useCallback(()=>{const y=U.collectionRef.current;if(!y)return[];const E=Array.from(y.querySelectorAll(`[${u}]`));return Array.from(U.itemMap.values()).sort((k,w)=>E.indexOf(k.ref.current)-E.indexOf(w.ref.current))},[U.collectionRef,U.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},m,i]}function tt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}var dd=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},Jme=cO[" useInsertionEffect ".trim().toString()]||dd;function h2({prop:e,defaultProp:t,onChange:n=()=>{},caller:i}){const[s,r,o]=e1e({defaultProp:t,onChange:n}),a=e!==void 0,l=a?e:s;{const d=C.useRef(e!==void 0);C.useEffect(()=>{const u=d.current;u!==a&&console.warn(`${i} is changing from ${u?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,i])}const c=C.useCallback(d=>{var u;if(a){const f=t1e(d)?d(e):d;f!==e&&((u=o.current)==null||u.call(o,f))}else r(d)},[a,e,r,o]);return[l,c]}function e1e({defaultProp:e,onChange:t}){const[n,i]=C.useState(e),s=C.useRef(n),r=C.useRef(t);return Jme(()=>{r.current=t},[t]),C.useEffect(()=>{var o;s.current!==n&&((o=r.current)==null||o.call(r,n),s.current=n)},[n,s]),[n,i,r]}function t1e(e){return typeof e=="function"}function n1e(e,t){return C.useReducer((n,i)=>t[n][i]??n,e)}var df=e=>{const{present:t,children:n}=e,i=i1e(t),s=typeof n=="function"?n({present:i.isPresent}):C.Children.only(n),r=hs(i.ref,s1e(s));return typeof n=="function"||i.isPresent?C.cloneElement(s,{ref:r}):null};df.displayName="Presence";function i1e(e){const[t,n]=C.useState(),i=C.useRef(null),s=C.useRef(e),r=C.useRef("none"),o=e?"mounted":"unmounted",[a,l]=n1e(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=LU(i.current);r.current=a==="mounted"?c:"none"},[a]),dd(()=>{const c=i.current,d=s.current;if(d!==e){const f=r.current,h=LU(c);e?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(d&&f!==h?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),dd(()=>{if(t){let c;const d=t.ownerDocument.defaultView??window,u=h=>{const p=LU(i.current).includes(CSS.escape(h.animationName));if(h.target===t&&p&&(l("ANIMATION_END"),!s.current)){const U=t.style.animationFillMode;t.style.animationFillMode="forwards",c=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=U)})}},f=h=>{h.target===t&&(r.current=LU(i.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{d.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{i.current=c?getComputedStyle(c):null,n(c)},[])}}function LU(e){return(e==null?void 0:e.animationName)||"none"}function s1e(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var r1e=cO[" useId ".trim().toString()]||(()=>{}),o1e=0;function Bu(e){const[t,n]=C.useState(r1e());return dd(()=>{n(i=>i??String(o1e++))},[e]),e||(t?`radix-${t}`:"")}var a1e=C.createContext(void 0);function oI(e){const t=C.useContext(a1e);return e||t||"ltr"}function Ca(e){const t=C.useRef(e);return C.useEffect(()=>{t.current=e}),C.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function l1e(e,t=globalThis==null?void 0:globalThis.document){const n=Ca(e);C.useEffect(()=>{const i=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var c1e="DismissableLayer",m_="dismissableLayer.update",d1e="dismissableLayer.pointerDownOutside",u1e="dismissableLayer.focusOutside",FR,CG=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),aI=C.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:r,onInteractOutside:o,onDismiss:a,...l}=e,c=C.useContext(CG),[d,u]=C.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=C.useState({}),m=hs(t,w=>u(w)),p=Array.from(c.layers),[U]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(U),y=d?p.indexOf(d):-1,E=c.layersWithOutsidePointerEventsDisabled.size>0,_=y>=b,I=g1e(w=>{const T=w.target,A=[...c.branches].some(S=>S.contains(T));!_||A||(s==null||s(w),o==null||o(w),w.defaultPrevented||a==null||a())},f),k=m1e(w=>{const T=w.target;[...c.branches].some(S=>S.contains(T))||(r==null||r(w),o==null||o(w),w.defaultPrevented||a==null||a())},f);return l1e(w=>{y===c.layers.size-1&&(i==null||i(w),!w.defaultPrevented&&a&&(w.preventDefault(),a()))},f),C.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(FR=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),BR(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=FR)}},[d,f,n,c]),C.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),BR())},[d,c]),C.useEffect(()=>{const w=()=>h({});return document.addEventListener(m_,w),()=>document.removeEventListener(m_,w)},[]),g(jn.div,{...l,ref:m,style:{pointerEvents:E?_?"auto":"none":void 0,...e.style},onFocusCapture:tt(e.onFocusCapture,k.onFocusCapture),onBlurCapture:tt(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:tt(e.onPointerDownCapture,I.onPointerDownCapture)})});aI.displayName=c1e;var f1e="DismissableLayerBranch",h1e=C.forwardRef((e,t)=>{const n=C.useContext(CG),i=C.useRef(null),s=hs(t,i);return C.useEffect(()=>{const r=i.current;if(r)return n.branches.add(r),()=>{n.branches.delete(r)}},[n.branches]),g(jn.div,{...e,ref:s})});h1e.displayName=f1e;function g1e(e,t=globalThis==null?void 0:globalThis.document){const n=Ca(e),i=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const r=a=>{if(a.target&&!i.current){let l=function(){xG(d1e,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);i.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",r)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",r),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function m1e(e,t=globalThis==null?void 0:globalThis.document){const n=Ca(e),i=C.useRef(!1);return C.useEffect(()=>{const s=r=>{r.target&&!i.current&&xG(u1e,n,{originalEvent:r},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function BR(){const e=new CustomEvent(m_);document.dispatchEvent(e)}function xG(e,t,n,{discrete:i}){const s=n.originalEvent.target,r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),i?IG(s,r):s.dispatchEvent(r)}var Z3="focusScope.autoFocusOnMount",q3="focusScope.autoFocusOnUnmount",zR={bubbles:!1,cancelable:!0},p1e="FocusScope",lI=C.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:s,onUnmountAutoFocus:r,...o}=e,[a,l]=C.useState(null),c=Ca(s),d=Ca(r),u=C.useRef(null),f=hs(t,p=>l(p)),h=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(i){let p=function(E){if(h.paused||!a)return;const _=E.target;a.contains(_)?u.current=_:sc(u.current,{select:!0})},U=function(E){if(h.paused||!a)return;const _=E.relatedTarget;_!==null&&(a.contains(_)||sc(u.current,{select:!0}))},b=function(E){if(document.activeElement===document.body)for(const I of E)I.removedNodes.length>0&&sc(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",U);const y=new MutationObserver(b);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",U),y.disconnect()}}},[i,a,h.paused]),C.useEffect(()=>{if(a){VR.add(h);const p=document.activeElement;if(!a.contains(p)){const b=new CustomEvent(Z3,zR);a.addEventListener(Z3,c),a.dispatchEvent(b),b.defaultPrevented||(U1e(_1e(AG(a)),{select:!0}),document.activeElement===p&&sc(a))}return()=>{a.removeEventListener(Z3,c),setTimeout(()=>{const b=new CustomEvent(q3,zR);a.addEventListener(q3,d),a.dispatchEvent(b),b.defaultPrevented||sc(p??document.body,{select:!0}),a.removeEventListener(q3,d),VR.remove(h)},0)}}},[a,c,d,h]);const m=C.useCallback(p=>{if(!n&&!i||h.paused)return;const U=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,b=document.activeElement;if(U&&b){const y=p.currentTarget,[E,_]=b1e(y);E&&_?!p.shiftKey&&b===_?(p.preventDefault(),n&&sc(E,{select:!0})):p.shiftKey&&b===E&&(p.preventDefault(),n&&sc(_,{select:!0})):b===y&&p.preventDefault()}},[n,i,h.paused]);return g(jn.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});lI.displayName=p1e;function U1e(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(sc(i,{select:t}),document.activeElement!==n)return}function b1e(e){const t=AG(e),n=HR(t,e),i=HR(t.reverse(),e);return[n,i]}function AG(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const s=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||s?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function HR(e,t){for(const n of e)if(!y1e(n,{upTo:t}))return n}function y1e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function E1e(e){return e instanceof HTMLInputElement&&"select"in e}function sc(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&E1e(e)&&t&&e.select()}}var VR=v1e();function v1e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=$R(e,t),e.unshift(t)},remove(t){var n;e=$R(e,t),(n=e[0])==null||n.resume()}}}function $R(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function _1e(e){return e.filter(t=>t.tagName!=="A")}var w1e="Portal",MG=C.forwardRef((e,t)=>{var a;const{container:n,...i}=e,[s,r]=C.useState(!1);dd(()=>r(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?yJ.createPortal(g(jn.div,{...i,ref:t}),o):null});MG.displayName=w1e;var Q3=0;function kG(){C.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??GR()),document.body.insertAdjacentElement("beforeend",e[1]??GR()),Q3++,()=>{Q3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Q3--}},[])}function GR(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Jo=function(){return Jo=Object.assign||function(t){for(var n,i=1,s=arguments.length;i<s;i++){n=arguments[i];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jo.apply(this,arguments)};function RG(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n}function T1e(e,t,n){if(n||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var kb="right-scroll-bar-position",Rb="width-before-scroll-bar",I1e="with-scroll-bars-hidden",S1e="--removed-body-scroll-bar-size";function J3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function C1e(e,t){var n=C.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var s=n.value;s!==i&&(n.value=i,n.callback(i,s))}}}})[0];return n.callback=t,n.facade}var x1e=typeof window<"u"?C.useLayoutEffect:C.useEffect,XR=new WeakMap;function A1e(e,t){var n=C1e(null,function(i){return e.forEach(function(s){return J3(s,i)})});return x1e(function(){var i=XR.get(n);if(i){var s=new Set(i),r=new Set(e),o=n.current;s.forEach(function(a){r.has(a)||J3(a,null)}),r.forEach(function(a){s.has(a)||J3(a,o)})}XR.set(n,e)},[e]),n}function M1e(e){return e}function k1e(e,t){t===void 0&&(t=M1e);var n=[],i=!1,s={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(r){var o=t(r,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(r){for(i=!0;n.length;){var o=n;n=[],o.forEach(r)}n={push:function(a){return r(a)},filter:function(){return n}}},assignMedium:function(r){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(r),o=n}var l=function(){var d=o;o=[],d.forEach(r)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){o.push(d),c()},filter:function(d){return o=o.filter(d),n}}}};return s}function R1e(e){e===void 0&&(e={});var t=k1e(null);return t.options=Jo({async:!0,ssr:!1},e),t}var DG=function(e){var t=e.sideCar,n=RG(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return C.createElement(i,Jo({},n))};DG.isSideCarExport=!0;function D1e(e,t){return e.useMedium(t),DG}var LG=R1e(),e7=function(){},uE=C.forwardRef(function(e,t){var n=C.useRef(null),i=C.useState({onScrollCapture:e7,onWheelCapture:e7,onTouchMoveCapture:e7}),s=i[0],r=i[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,u=e.shards,f=e.sideCar,h=e.noIsolation,m=e.inert,p=e.allowPinchZoom,U=e.as,b=U===void 0?"div":U,y=e.gapMode,E=RG(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,I=A1e([n,t]),k=Jo(Jo({},E),s);return C.createElement(C.Fragment,null,d&&C.createElement(_,{sideCar:LG,removeScrollBar:c,shards:u,noIsolation:h,inert:m,setCallbacks:r,allowPinchZoom:!!p,lockRef:n,gapMode:y}),o?C.cloneElement(C.Children.only(a),Jo(Jo({},k),{ref:I})):C.createElement(b,Jo({},k,{className:l,ref:I}),a))});uE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};uE.classNames={fullWidth:Rb,zeroRight:kb};var L1e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function P1e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=L1e();return t&&e.setAttribute("nonce",t),e}function N1e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function O1e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var F1e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=P1e())&&(N1e(t,n),O1e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},B1e=function(){var e=F1e();return function(t,n){C.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},PG=function(){var e=B1e(),t=function(n){var i=n.styles,s=n.dynamic;return e(i,s),null};return t},z1e={left:0,top:0,right:0,gap:0},t7=function(e){return parseInt(e||"",10)||0},H1e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[t7(n),t7(i),t7(s)]},V1e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return z1e;var t=H1e(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},$1e=PG(),Bh="data-scroll-locked",G1e=function(e,t,n,i){var s=e.left,r=e.top,o=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(I1e,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(Bh,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(r,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(kb,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(Rb,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(kb," .").concat(kb,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(Rb," .").concat(Rb,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Bh,`] {
    `).concat(S1e,": ").concat(a,`px;
  }
`)},jR=function(){var e=parseInt(document.body.getAttribute(Bh)||"0",10);return isFinite(e)?e:0},X1e=function(){C.useEffect(function(){return document.body.setAttribute(Bh,(jR()+1).toString()),function(){var e=jR()-1;e<=0?document.body.removeAttribute(Bh):document.body.setAttribute(Bh,e.toString())}},[])},j1e=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,s=i===void 0?"margin":i;X1e();var r=C.useMemo(function(){return V1e(s)},[s]);return C.createElement($1e,{styles:G1e(r,!t,s,n?"":"!important")})},p_=!1;if(typeof window<"u")try{var PU=Object.defineProperty({},"passive",{get:function(){return p_=!0,!0}});window.addEventListener("test",PU,PU),window.removeEventListener("test",PU,PU)}catch{p_=!1}var Af=p_?{passive:!1}:!1,Y1e=function(e){return e.tagName==="TEXTAREA"},NG=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Y1e(e)&&n[t]==="visible")},W1e=function(e){return NG(e,"overflowY")},K1e=function(e){return NG(e,"overflowX")},YR=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var s=OG(e,i);if(s){var r=FG(e,i),o=r[1],a=r[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},Z1e=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},q1e=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},OG=function(e,t){return e==="v"?W1e(t):K1e(t)},FG=function(e,t){return e==="v"?Z1e(t):q1e(t)},Q1e=function(e,t){return e==="h"&&t==="rtl"?-1:1},J1e=function(e,t,n,i,s){var r=Q1e(e,window.getComputedStyle(t).direction),o=r*i,a=n.target,l=t.contains(a),c=!1,d=o>0,u=0,f=0;do{var h=FG(e,a),m=h[0],p=h[1],U=h[2],b=p-U-r*m;(m||b)&&OG(e,a)&&(u+=b,f+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(d&&Math.abs(u)<1||!d&&Math.abs(f)<1)&&(c=!0),c},NU=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},WR=function(e){return[e.deltaX,e.deltaY]},KR=function(e){return e&&"current"in e?e.current:e},e0e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t0e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},n0e=0,Mf=[];function i0e(e){var t=C.useRef([]),n=C.useRef([0,0]),i=C.useRef(),s=C.useState(n0e++)[0],r=C.useState(PG)[0],o=C.useRef(e);C.useEffect(function(){o.current=e},[e]),C.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var p=T1e([e.lockRef.current],(e.shards||[]).map(KR),!0).filter(Boolean);return p.forEach(function(U){return U.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),p.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=C.useCallback(function(p,U){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!o.current.allowPinchZoom;var b=NU(p),y=n.current,E="deltaX"in p?p.deltaX:y[0]-b[0],_="deltaY"in p?p.deltaY:y[1]-b[1],I,k=p.target,w=Math.abs(E)>Math.abs(_)?"h":"v";if("touches"in p&&w==="h"&&k.type==="range")return!1;var T=YR(w,k);if(!T)return!0;if(T?I=w:(I=w==="v"?"h":"v",T=YR(w,k)),!T)return!1;if(!i.current&&"changedTouches"in p&&(E||_)&&(i.current=I),!I)return!0;var A=i.current||I;return J1e(A,U,p,A==="h"?E:_)},[]),l=C.useCallback(function(p){var U=p;if(!(!Mf.length||Mf[Mf.length-1]!==r)){var b="deltaY"in U?WR(U):NU(U),y=t.current.filter(function(I){return I.name===U.type&&(I.target===U.target||U.target===I.shadowParent)&&e0e(I.delta,b)})[0];if(y&&y.should){U.cancelable&&U.preventDefault();return}if(!y){var E=(o.current.shards||[]).map(KR).filter(Boolean).filter(function(I){return I.contains(U.target)}),_=E.length>0?a(U,E[0]):!o.current.noIsolation;_&&U.cancelable&&U.preventDefault()}}},[]),c=C.useCallback(function(p,U,b,y){var E={name:p,delta:U,target:b,should:y,shadowParent:s0e(b)};t.current.push(E),setTimeout(function(){t.current=t.current.filter(function(_){return _!==E})},1)},[]),d=C.useCallback(function(p){n.current=NU(p),i.current=void 0},[]),u=C.useCallback(function(p){c(p.type,WR(p),p.target,a(p,e.lockRef.current))},[]),f=C.useCallback(function(p){c(p.type,NU(p),p.target,a(p,e.lockRef.current))},[]);C.useEffect(function(){return Mf.push(r),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Af),document.addEventListener("touchmove",l,Af),document.addEventListener("touchstart",d,Af),function(){Mf=Mf.filter(function(p){return p!==r}),document.removeEventListener("wheel",l,Af),document.removeEventListener("touchmove",l,Af),document.removeEventListener("touchstart",d,Af)}},[]);var h=e.removeScrollBar,m=e.inert;return C.createElement(C.Fragment,null,m?C.createElement(r,{styles:t0e(s)}):null,h?C.createElement(j1e,{gapMode:e.gapMode}):null)}function s0e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const r0e=D1e(LG,i0e);var cI=C.forwardRef(function(e,t){return C.createElement(uE,Jo({},e,{ref:t,sideCar:r0e}))});cI.classNames=uE.classNames;var o0e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},kf=new WeakMap,OU=new WeakMap,FU={},n7=0,BG=function(e){return e&&(e.host||BG(e.parentNode))},a0e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=BG(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},l0e=function(e,t,n,i){var s=a0e(t,Array.isArray(e)?e:[e]);FU[n]||(FU[n]=new WeakMap);var r=FU[n],o=[],a=new Set,l=new Set(s),c=function(u){!u||a.has(u)||(a.add(u),c(u.parentNode))};s.forEach(c);var d=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(f){if(a.has(f))d(f);else try{var h=f.getAttribute(i),m=h!==null&&h!=="false",p=(kf.get(f)||0)+1,U=(r.get(f)||0)+1;kf.set(f,p),r.set(f,U),o.push(f),p===1&&m&&OU.set(f,!0),U===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return d(t),a.clear(),n7++,function(){o.forEach(function(u){var f=kf.get(u)-1,h=r.get(u)-1;kf.set(u,f),r.set(u,h),f||(OU.has(u)||u.removeAttribute(i),OU.delete(u)),h||u.removeAttribute(n)}),n7--,n7||(kf=new WeakMap,kf=new WeakMap,OU=new WeakMap,FU={})}},zG=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),s=o0e(e);return s?(i.push.apply(i,Array.from(s.querySelectorAll("[aria-live]"))),l0e(i,s,n,"aria-hidden")):function(){return null}};function c0e(e){const[t,n]=C.useState(void 0);return dd(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const r=s[0];let o,a;if("borderBoxSize"in r){const l=r.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=e.offsetWidth,a=e.offsetHeight;n({width:o,height:a})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}const d0e=["top","right","bottom","left"],ud=Math.min,sr=Math.max,U5=Math.round,BU=Math.floor,ga=e=>({x:e,y:e}),u0e={left:"right",right:"left",bottom:"top",top:"bottom"},f0e={start:"end",end:"start"};function U_(e,t,n){return sr(e,ud(t,n))}function Ll(e,t){return typeof e=="function"?e(t):e}function Pl(e){return e.split("-")[0]}function Zg(e){return e.split("-")[1]}function dI(e){return e==="x"?"y":"x"}function uI(e){return e==="y"?"height":"width"}function fd(e){return["top","bottom"].includes(Pl(e))?"y":"x"}function fI(e){return dI(fd(e))}function h0e(e,t,n){n===void 0&&(n=!1);const i=Zg(e),s=fI(e),r=uI(s);let o=s==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=b5(o)),[o,b5(o)]}function g0e(e){const t=b5(e);return[b_(e),t,b_(t)]}function b_(e){return e.replace(/start|end/g,t=>f0e[t])}function m0e(e,t,n){const i=["left","right"],s=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:i:t?i:s;case"left":case"right":return t?r:o;default:return[]}}function p0e(e,t,n,i){const s=Zg(e);let r=m0e(Pl(e),n==="start",i);return s&&(r=r.map(o=>o+"-"+s),t&&(r=r.concat(r.map(b_)))),r}function b5(e){return e.replace(/left|right|bottom|top/g,t=>u0e[t])}function U0e(e){return{top:0,right:0,bottom:0,left:0,...e}}function HG(e){return typeof e!="number"?U0e(e):{top:e,right:e,bottom:e,left:e}}function y5(e){const{x:t,y:n,width:i,height:s}=e;return{width:i,height:s,top:n,left:t,right:t+i,bottom:n+s,x:t,y:n}}function ZR(e,t,n){let{reference:i,floating:s}=e;const r=fd(t),o=fI(t),a=uI(o),l=Pl(t),c=r==="y",d=i.x+i.width/2-s.width/2,u=i.y+i.height/2-s.height/2,f=i[a]/2-s[a]/2;let h;switch(l){case"top":h={x:d,y:i.y-s.height};break;case"bottom":h={x:d,y:i.y+i.height};break;case"right":h={x:i.x+i.width,y:u};break;case"left":h={x:i.x-s.width,y:u};break;default:h={x:i.x,y:i.y}}switch(Zg(t)){case"start":h[o]-=f*(n&&c?-1:1);break;case"end":h[o]+=f*(n&&c?-1:1);break}return h}const b0e=async(e,t,n)=>{const{placement:i="bottom",strategy:s="absolute",middleware:r=[],platform:o}=n,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:u}=ZR(c,i,l),f=i,h={},m=0;for(let p=0;p<a.length;p++){const{name:U,fn:b}=a[p],{x:y,y:E,data:_,reset:I}=await b({x:d,y:u,initialPlacement:i,placement:f,strategy:s,middlewareData:h,rects:c,platform:o,elements:{reference:e,floating:t}});d=y??d,u=E??u,h={...h,[U]:{...h[U],..._}},I&&m<=50&&(m++,typeof I=="object"&&(I.placement&&(f=I.placement),I.rects&&(c=I.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):I.rects),{x:d,y:u}=ZR(c,f,l)),p=-1)}return{x:d,y:u,placement:f,strategy:s,middlewareData:h}};async function Q0(e,t){var n;t===void 0&&(t={});const{x:i,y:s,platform:r,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:f=!1,padding:h=0}=Ll(t,e),m=HG(h),U=a[f?u==="floating"?"reference":"floating":u],b=y5(await r.getClippingRect({element:(n=await(r.isElement==null?void 0:r.isElement(U)))==null||n?U:U.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),y=u==="floating"?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,E=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),_=await(r.isElement==null?void 0:r.isElement(E))?await(r.getScale==null?void 0:r.getScale(E))||{x:1,y:1}:{x:1,y:1},I=y5(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:E,strategy:l}):y);return{top:(b.top-I.top+m.top)/_.y,bottom:(I.bottom-b.bottom+m.bottom)/_.y,left:(b.left-I.left+m.left)/_.x,right:(I.right-b.right+m.right)/_.x}}const y0e=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:s,rects:r,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=Ll(e,t)||{};if(c==null)return{};const u=HG(d),f={x:n,y:i},h=fI(s),m=uI(h),p=await o.getDimensions(c),U=h==="y",b=U?"top":"left",y=U?"bottom":"right",E=U?"clientHeight":"clientWidth",_=r.reference[m]+r.reference[h]-f[h]-r.floating[m],I=f[h]-r.reference[h],k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let w=k?k[E]:0;(!w||!await(o.isElement==null?void 0:o.isElement(k)))&&(w=a.floating[E]||r.floating[m]);const T=_/2-I/2,A=w/2-p[m]/2-1,S=ud(u[b],A),D=ud(u[y],A),N=S,L=w-p[m]-D,j=w/2-p[m]/2+T,Y=U_(N,j,L),G=!l.arrow&&Zg(s)!=null&&j!==Y&&r.reference[m]/2-(j<N?S:D)-p[m]/2<0,O=G?j<N?j-N:j-L:0;return{[h]:f[h]+O,data:{[h]:Y,centerOffset:j-Y-O,...G&&{alignmentOffset:O}},reset:G}}}),E0e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:s,middlewareData:r,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...U}=Ll(e,t);if((n=r.arrow)!=null&&n.alignmentOffset)return{};const b=Pl(s),y=fd(a),E=Pl(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=f||(E||!p?[b5(a)]:g0e(a)),k=m!=="none";!f&&k&&I.push(...p0e(a,p,m,_));const w=[a,...I],T=await Q0(t,U),A=[];let S=((i=r.flip)==null?void 0:i.overflows)||[];if(d&&A.push(T[b]),u){const j=h0e(s,o,_);A.push(T[j[0]],T[j[1]])}if(S=[...S,{placement:s,overflows:A}],!A.every(j=>j<=0)){var D,N;const j=(((D=r.flip)==null?void 0:D.index)||0)+1,Y=w[j];if(Y)return{data:{index:j,overflows:S},reset:{placement:Y}};let G=(N=S.filter(O=>O.overflows[0]<=0).sort((O,z)=>O.overflows[1]-z.overflows[1])[0])==null?void 0:N.placement;if(!G)switch(h){case"bestFit":{var L;const O=(L=S.filter(z=>{if(k){const H=fd(z.placement);return H===y||H==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(H=>H>0).reduce((H,X)=>H+X,0)]).sort((z,H)=>z[1]-H[1])[0])==null?void 0:L[0];O&&(G=O);break}case"initialPlacement":G=a;break}if(s!==G)return{reset:{placement:G}}}return{}}}};function qR(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function QR(e){return d0e.some(t=>e[t]>=0)}const v0e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...s}=Ll(e,t);switch(i){case"referenceHidden":{const r=await Q0(t,{...s,elementContext:"reference"}),o=qR(r,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:QR(o)}}}case"escaped":{const r=await Q0(t,{...s,altBoundary:!0}),o=qR(r,n.floating);return{data:{escapedOffsets:o,escaped:QR(o)}}}default:return{}}}}};async function _0e(e,t){const{placement:n,platform:i,elements:s}=e,r=await(i.isRTL==null?void 0:i.isRTL(s.floating)),o=Pl(n),a=Zg(n),l=fd(n)==="y",c=["left","top"].includes(o)?-1:1,d=r&&l?-1:1,u=Ll(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof m=="number"&&(h=a==="end"?m*-1:m),l?{x:h*d,y:f*c}:{x:f*c,y:h*d}}const w0e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:s,y:r,placement:o,middlewareData:a}=t,l=await _0e(t,e);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:r+l.y,data:{...l,placement:o}}}}},T0e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:s}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:U=>{let{x:b,y}=U;return{x:b,y}}},...l}=Ll(e,t),c={x:n,y:i},d=await Q0(t,l),u=fd(Pl(s)),f=dI(u);let h=c[f],m=c[u];if(r){const U=f==="y"?"top":"left",b=f==="y"?"bottom":"right",y=h+d[U],E=h-d[b];h=U_(y,h,E)}if(o){const U=u==="y"?"top":"left",b=u==="y"?"bottom":"right",y=m+d[U],E=m-d[b];m=U_(y,m,E)}const p=a.fn({...t,[f]:h,[u]:m});return{...p,data:{x:p.x-n,y:p.y-i,enabled:{[f]:r,[u]:o}}}}}},I0e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:s,rects:r,middlewareData:o}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Ll(e,t),d={x:n,y:i},u=fd(s),f=dI(u);let h=d[f],m=d[u];const p=Ll(a,t),U=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const E=f==="y"?"height":"width",_=r.reference[f]-r.floating[E]+U.mainAxis,I=r.reference[f]+r.reference[E]-U.mainAxis;h<_?h=_:h>I&&(h=I)}if(c){var b,y;const E=f==="y"?"width":"height",_=["top","left"].includes(Pl(s)),I=r.reference[u]-r.floating[E]+(_&&((b=o.offset)==null?void 0:b[u])||0)+(_?0:U.crossAxis),k=r.reference[u]+r.reference[E]+(_?0:((y=o.offset)==null?void 0:y[u])||0)-(_?U.crossAxis:0);m<I?m=I:m>k&&(m=k)}return{[f]:h,[u]:m}}}},S0e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:s,rects:r,platform:o,elements:a}=t,{apply:l=()=>{},...c}=Ll(e,t),d=await Q0(t,c),u=Pl(s),f=Zg(s),h=fd(s)==="y",{width:m,height:p}=r.floating;let U,b;u==="top"||u==="bottom"?(U=u,b=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=u,U=f==="end"?"top":"bottom");const y=p-d.top-d.bottom,E=m-d.left-d.right,_=ud(p-d[U],y),I=ud(m-d[b],E),k=!t.middlewareData.shift;let w=_,T=I;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(T=E),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(w=y),k&&!f){const S=sr(d.left,0),D=sr(d.right,0),N=sr(d.top,0),L=sr(d.bottom,0);h?T=m-2*(S!==0||D!==0?S+D:sr(d.left,d.right)):w=p-2*(N!==0||L!==0?N+L:sr(d.top,d.bottom))}await l({...t,availableWidth:T,availableHeight:w});const A=await o.getDimensions(a.floating);return m!==A.width||p!==A.height?{reset:{rects:!0}}:{}}}};function fE(){return typeof window<"u"}function qg(e){return VG(e)?(e.nodeName||"").toLowerCase():"#document"}function yr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Pa(e){var t;return(t=(VG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function VG(e){return fE()?e instanceof Node||e instanceof yr(e).Node:!1}function Ro(e){return fE()?e instanceof Element||e instanceof yr(e).Element:!1}function xa(e){return fE()?e instanceof HTMLElement||e instanceof yr(e).HTMLElement:!1}function JR(e){return!fE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof yr(e).ShadowRoot}function g2(e){const{overflow:t,overflowX:n,overflowY:i,display:s}=Do(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(s)}function C0e(e){return["table","td","th"].includes(qg(e))}function hE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function hI(e){const t=gI(),n=Ro(e)?Do(e):e;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function x0e(e){let t=hd(e);for(;xa(t)&&!Eg(t);){if(hI(t))return t;if(hE(t))return null;t=hd(t)}return null}function gI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Eg(e){return["html","body","#document"].includes(qg(e))}function Do(e){return yr(e).getComputedStyle(e)}function gE(e){return Ro(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function hd(e){if(qg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||JR(e)&&e.host||Pa(e);return JR(t)?t.host:t}function $G(e){const t=hd(e);return Eg(t)?e.ownerDocument?e.ownerDocument.body:e.body:xa(t)&&g2(t)?t:$G(t)}function J0(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=$G(e),r=s===((i=e.ownerDocument)==null?void 0:i.body),o=yr(s);if(r){const a=y_(o);return t.concat(o,o.visualViewport||[],g2(s)?s:[],a&&n?J0(a):[])}return t.concat(s,J0(s,[],n))}function y_(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function GG(e){const t=Do(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=xa(e),r=s?e.offsetWidth:n,o=s?e.offsetHeight:i,a=U5(n)!==r||U5(i)!==o;return a&&(n=r,i=o),{width:n,height:i,$:a}}function mI(e){return Ro(e)?e:e.contextElement}function zh(e){const t=mI(e);if(!xa(t))return ga(1);const n=t.getBoundingClientRect(),{width:i,height:s,$:r}=GG(t);let o=(r?U5(n.width):n.width)/i,a=(r?U5(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const A0e=ga(0);function XG(e){const t=yr(e);return!gI()||!t.visualViewport?A0e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function M0e(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==yr(e)?!1:t}function zu(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),r=mI(e);let o=ga(1);t&&(i?Ro(i)&&(o=zh(i)):o=zh(e));const a=M0e(r,n,i)?XG(r):ga(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,d=s.width/o.x,u=s.height/o.y;if(r){const f=yr(r),h=i&&Ro(i)?yr(i):i;let m=f,p=y_(m);for(;p&&i&&h!==m;){const U=zh(p),b=p.getBoundingClientRect(),y=Do(p),E=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*U.x,_=b.top+(p.clientTop+parseFloat(y.paddingTop))*U.y;l*=U.x,c*=U.y,d*=U.x,u*=U.y,l+=E,c+=_,m=yr(p),p=y_(m)}}return y5({width:d,height:u,x:l,y:c})}function pI(e,t){const n=gE(e).scrollLeft;return t?t.left+n:zu(Pa(e)).left+n}function jG(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=i.left+t.scrollLeft-(n?0:pI(e,i)),r=i.top+t.scrollTop;return{x:s,y:r}}function k0e(e){let{elements:t,rect:n,offsetParent:i,strategy:s}=e;const r=s==="fixed",o=Pa(i),a=t?hE(t.floating):!1;if(i===o||a&&r)return n;let l={scrollLeft:0,scrollTop:0},c=ga(1);const d=ga(0),u=xa(i);if((u||!u&&!r)&&((qg(i)!=="body"||g2(o))&&(l=gE(i)),xa(i))){const h=zu(i);c=zh(i),d.x=h.x+i.clientLeft,d.y=h.y+i.clientTop}const f=o&&!u&&!r?jG(o,l,!0):ga(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+f.x,y:n.y*c.y-l.scrollTop*c.y+d.y+f.y}}function R0e(e){return Array.from(e.getClientRects())}function D0e(e){const t=Pa(e),n=gE(e),i=e.ownerDocument.body,s=sr(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),r=sr(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+pI(e);const a=-n.scrollTop;return Do(i).direction==="rtl"&&(o+=sr(t.clientWidth,i.clientWidth)-s),{width:s,height:r,x:o,y:a}}function L0e(e,t){const n=yr(e),i=Pa(e),s=n.visualViewport;let r=i.clientWidth,o=i.clientHeight,a=0,l=0;if(s){r=s.width,o=s.height;const c=gI();(!c||c&&t==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:r,height:o,x:a,y:l}}function P0e(e,t){const n=zu(e,!0,t==="fixed"),i=n.top+e.clientTop,s=n.left+e.clientLeft,r=xa(e)?zh(e):ga(1),o=e.clientWidth*r.x,a=e.clientHeight*r.y,l=s*r.x,c=i*r.y;return{width:o,height:a,x:l,y:c}}function eD(e,t,n){let i;if(t==="viewport")i=L0e(e,n);else if(t==="document")i=D0e(Pa(e));else if(Ro(t))i=P0e(t,n);else{const s=XG(e);i={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return y5(i)}function YG(e,t){const n=hd(e);return n===t||!Ro(n)||Eg(n)?!1:Do(n).position==="fixed"||YG(n,t)}function N0e(e,t){const n=t.get(e);if(n)return n;let i=J0(e,[],!1).filter(a=>Ro(a)&&qg(a)!=="body"),s=null;const r=Do(e).position==="fixed";let o=r?hd(e):e;for(;Ro(o)&&!Eg(o);){const a=Do(o),l=hI(o);!l&&a.position==="fixed"&&(s=null),(r?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||g2(o)&&!l&&YG(e,o))?i=i.filter(d=>d!==o):s=a,o=hd(o)}return t.set(e,i),i}function O0e(e){let{element:t,boundary:n,rootBoundary:i,strategy:s}=e;const o=[...n==="clippingAncestors"?hE(t)?[]:N0e(t,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,d)=>{const u=eD(t,d,s);return c.top=sr(u.top,c.top),c.right=ud(u.right,c.right),c.bottom=ud(u.bottom,c.bottom),c.left=sr(u.left,c.left),c},eD(t,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function F0e(e){const{width:t,height:n}=GG(e);return{width:t,height:n}}function B0e(e,t,n){const i=xa(t),s=Pa(t),r=n==="fixed",o=zu(e,!0,r,t);let a={scrollLeft:0,scrollTop:0};const l=ga(0);if(i||!i&&!r)if((qg(t)!=="body"||g2(s))&&(a=gE(t)),i){const f=zu(t,!0,r,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else s&&(l.x=pI(s));const c=s&&!i&&!r?jG(s,a):ga(0),d=o.left+a.scrollLeft-l.x-c.x,u=o.top+a.scrollTop-l.y-c.y;return{x:d,y:u,width:o.width,height:o.height}}function i7(e){return Do(e).position==="static"}function tD(e,t){if(!xa(e)||Do(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Pa(e)===n&&(n=n.ownerDocument.body),n}function WG(e,t){const n=yr(e);if(hE(e))return n;if(!xa(e)){let s=hd(e);for(;s&&!Eg(s);){if(Ro(s)&&!i7(s))return s;s=hd(s)}return n}let i=tD(e,t);for(;i&&C0e(i)&&i7(i);)i=tD(i,t);return i&&Eg(i)&&i7(i)&&!hI(i)?n:i||x0e(e)||n}const z0e=async function(e){const t=this.getOffsetParent||WG,n=this.getDimensions,i=await n(e.floating);return{reference:B0e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function H0e(e){return Do(e).direction==="rtl"}const V0e={convertOffsetParentRelativeRectToViewportRelativeRect:k0e,getDocumentElement:Pa,getClippingRect:O0e,getOffsetParent:WG,getElementRects:z0e,getClientRects:R0e,getDimensions:F0e,getScale:zh,isElement:Ro,isRTL:H0e};function KG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $0e(e,t){let n=null,i;const s=Pa(e);function r(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const c=e.getBoundingClientRect(),{left:d,top:u,width:f,height:h}=c;if(a||t(),!f||!h)return;const m=BU(u),p=BU(s.clientWidth-(d+f)),U=BU(s.clientHeight-(u+h)),b=BU(d),E={rootMargin:-m+"px "+-p+"px "+-U+"px "+-b+"px",threshold:sr(0,ud(1,l))||1};let _=!0;function I(k){const w=k[0].intersectionRatio;if(w!==l){if(!_)return o();w?o(!1,w):i=setTimeout(()=>{o(!1,1e-7)},1e3)}w===1&&!KG(c,e.getBoundingClientRect())&&o(),_=!1}try{n=new IntersectionObserver(I,{...E,root:s.ownerDocument})}catch{n=new IntersectionObserver(I,E)}n.observe(e)}return o(!0),r}function G0e(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=mI(e),d=s||r?[...c?J0(c):[],...J0(t)]:[];d.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),r&&b.addEventListener("resize",n)});const u=c&&a?$0e(c,n):null;let f=-1,h=null;o&&(h=new ResizeObserver(b=>{let[y]=b;y&&y.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var E;(E=h)==null||E.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let m,p=l?zu(e):null;l&&U();function U(){const b=zu(e);p&&!KG(p,b)&&n(),p=b,m=requestAnimationFrame(U)}return n(),()=>{var b;d.forEach(y=>{s&&y.removeEventListener("scroll",n),r&&y.removeEventListener("resize",n)}),u==null||u(),(b=h)==null||b.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const X0e=w0e,j0e=T0e,Y0e=E0e,W0e=S0e,K0e=v0e,nD=y0e,Z0e=I0e,q0e=(e,t,n)=>{const i=new Map,s={platform:V0e,...n},r={...s.platform,_c:i};return b0e(e,t,{...s,platform:r})};var Db=typeof document<"u"?C.useLayoutEffect:C.useEffect;function E5(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!E5(e[i],t[i]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=n;i--!==0;){const r=s[i];if(!(r==="_owner"&&e.$$typeof)&&!E5(e[r],t[r]))return!1}return!0}return e!==e&&t!==t}function ZG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function iD(e,t){const n=ZG(e);return Math.round(t*n)/n}function s7(e){const t=C.useRef(e);return Db(()=>{t.current=e}),t}function Q0e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:s,elements:{reference:r,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[d,u]=C.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=C.useState(i);E5(f,i)||h(i);const[m,p]=C.useState(null),[U,b]=C.useState(null),y=C.useCallback(z=>{z!==k.current&&(k.current=z,p(z))},[]),E=C.useCallback(z=>{z!==w.current&&(w.current=z,b(z))},[]),_=r||m,I=o||U,k=C.useRef(null),w=C.useRef(null),T=C.useRef(d),A=l!=null,S=s7(l),D=s7(s),N=s7(c),L=C.useCallback(()=>{if(!k.current||!w.current)return;const z={placement:t,strategy:n,middleware:f};D.current&&(z.platform=D.current),q0e(k.current,w.current,z).then(H=>{const X={...H,isPositioned:N.current!==!1};j.current&&!E5(T.current,X)&&(T.current=X,tn.flushSync(()=>{u(X)}))})},[f,t,n,D,N]);Db(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,u(z=>({...z,isPositioned:!1})))},[c]);const j=C.useRef(!1);Db(()=>(j.current=!0,()=>{j.current=!1}),[]),Db(()=>{if(_&&(k.current=_),I&&(w.current=I),_&&I){if(S.current)return S.current(_,I,L);L()}},[_,I,L,S,A]);const Y=C.useMemo(()=>({reference:k,floating:w,setReference:y,setFloating:E}),[y,E]),G=C.useMemo(()=>({reference:_,floating:I}),[_,I]),O=C.useMemo(()=>{const z={position:n,left:0,top:0};if(!G.floating)return z;const H=iD(G.floating,d.x),X=iD(G.floating,d.y);return a?{...z,transform:"translate("+H+"px, "+X+"px)",...ZG(G.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:H,top:X}},[n,a,G.floating,d.x,d.y]);return C.useMemo(()=>({...d,update:L,refs:Y,elements:G,floatingStyles:O}),[d,L,Y,G,O])}const J0e=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:s}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?nD({element:i.current,padding:s}).fn(n):{}:i?nD({element:i,padding:s}).fn(n):{}}}},epe=(e,t)=>({...X0e(e),options:[e,t]}),tpe=(e,t)=>({...j0e(e),options:[e,t]}),npe=(e,t)=>({...Z0e(e),options:[e,t]}),ipe=(e,t)=>({...Y0e(e),options:[e,t]}),spe=(e,t)=>({...W0e(e),options:[e,t]}),rpe=(e,t)=>({...K0e(e),options:[e,t]}),ope=(e,t)=>({...J0e(e),options:[e,t]});var ape="Arrow",qG=C.forwardRef((e,t)=>{const{children:n,width:i=10,height:s=5,...r}=e;return g(jn.svg,{...r,ref:t,width:i,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:g("polygon",{points:"0,0 30,0 15,10"})})});qG.displayName=ape;var lpe=qG,UI="Popper",[QG,mE]=cf(UI),[cpe,JG]=QG(UI),eX=e=>{const{__scopePopper:t,children:n}=e,[i,s]=C.useState(null);return g(cpe,{scope:t,anchor:i,onAnchorChange:s,children:n})};eX.displayName=UI;var tX="PopperAnchor",nX=C.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...s}=e,r=JG(tX,n),o=C.useRef(null),a=hs(t,o),l=C.useRef(null);return C.useEffect(()=>{const c=l.current;l.current=(i==null?void 0:i.current)||o.current,c!==l.current&&r.onAnchorChange(l.current)}),i?null:g(jn.div,{...s,ref:a})});nX.displayName=tX;var bI="PopperContent",[dpe,upe]=QG(bI),iX=C.forwardRef((e,t)=>{var Ae,$e,et,Be,We,bn;const{__scopePopper:n,side:i="bottom",sideOffset:s=0,align:r="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:u="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=e,U=JG(bI,n),[b,y]=C.useState(null),E=hs(t,Jt=>y(Jt)),[_,I]=C.useState(null),k=c0e(_),w=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,A=i+(r!=="center"?"-"+r:""),S=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(c)?c:[c],N=D.length>0,L={padding:S,boundary:D.filter(hpe),altBoundary:N},{refs:j,floatingStyles:Y,placement:G,isPositioned:O,middlewareData:z}=Q0e({strategy:"fixed",placement:A,whileElementsMounted:(...Jt)=>G0e(...Jt,{animationFrame:h==="always"}),elements:{reference:U.anchor},middleware:[epe({mainAxis:s+T,alignmentAxis:o}),l&&tpe({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?npe():void 0,...L}),l&&ipe({...L}),spe({...L,apply:({elements:Jt,rects:Pi,availableWidth:Yn,availableHeight:Sr})=>{const{width:wt,height:vi}=Pi.reference,Rs=Jt.floating.style;Rs.setProperty("--radix-popper-available-width",`${Yn}px`),Rs.setProperty("--radix-popper-available-height",`${Sr}px`),Rs.setProperty("--radix-popper-anchor-width",`${wt}px`),Rs.setProperty("--radix-popper-anchor-height",`${vi}px`)}}),_&&ope({element:_,padding:a}),gpe({arrowWidth:w,arrowHeight:T}),f&&rpe({strategy:"referenceHidden",...L})]}),[H,X]=oX(G),Q=Ca(m);dd(()=>{O&&(Q==null||Q())},[O,Q]);const re=(Ae=z.arrow)==null?void 0:Ae.x,ie=($e=z.arrow)==null?void 0:$e.y,me=((et=z.arrow)==null?void 0:et.centerOffset)!==0,[ke,ye]=C.useState();return dd(()=>{b&&ye(window.getComputedStyle(b).zIndex)},[b]),g("div",{ref:j.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:O?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ke,"--radix-popper-transform-origin":[(Be=z.transformOrigin)==null?void 0:Be.x,(We=z.transformOrigin)==null?void 0:We.y].join(" "),...((bn=z.hide)==null?void 0:bn.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:g(dpe,{scope:n,placedSide:H,onArrowChange:I,arrowX:re,arrowY:ie,shouldHideArrow:me,children:g(jn.div,{"data-side":H,"data-align":X,...p,ref:E,style:{...p.style,animation:O?void 0:"none"}})})})});iX.displayName=bI;var sX="PopperArrow",fpe={top:"bottom",right:"left",bottom:"top",left:"right"},rX=C.forwardRef(function(t,n){const{__scopePopper:i,...s}=t,r=upe(sX,i),o=fpe[r.placedSide];return g("span",{ref:r.onArrowChange,style:{position:"absolute",left:r.arrowX,top:r.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[r.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[r.placedSide],visibility:r.shouldHideArrow?"hidden":void 0},children:g(lpe,{...s,ref:n,style:{...s.style,display:"block"}})})});rX.displayName=sX;function hpe(e){return e!==null}var gpe=e=>({name:"transformOrigin",options:e,fn(t){var U,b,y;const{placement:n,rects:i,middlewareData:s}=t,o=((U=s.arrow)==null?void 0:U.centerOffset)!==0,a=o?0:e.arrowWidth,l=o?0:e.arrowHeight,[c,d]=oX(n),u={start:"0%",center:"50%",end:"100%"}[d],f=(((b=s.arrow)==null?void 0:b.x)??0)+a/2,h=(((y=s.arrow)==null?void 0:y.y)??0)+l/2;let m="",p="";return c==="bottom"?(m=o?u:`${f}px`,p=`${-l}px`):c==="top"?(m=o?u:`${f}px`,p=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,p=o?u:`${h}px`):c==="left"&&(m=`${i.floating.width+l}px`,p=o?u:`${h}px`),{data:{x:m,y:p}}}});function oX(e){const[t,n="center"]=e.split("-");return[t,n]}var yI=eX,EI=nX,aX=iX,lX=rX,r7="rovingFocusGroup.onEntryFocus",mpe={bubbles:!1,cancelable:!0},m2="RovingFocusGroup",[E_,cX,ppe]=SG(m2),[Upe,pE]=cf(m2,[ppe]),[bpe,ype]=Upe(m2),dX=C.forwardRef((e,t)=>g(E_.Provider,{scope:e.__scopeRovingFocusGroup,children:g(E_.Slot,{scope:e.__scopeRovingFocusGroup,children:g(Epe,{...e,ref:t})})}));dX.displayName=m2;var Epe=C.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:s=!1,dir:r,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...u}=e,f=C.useRef(null),h=hs(t,f),m=oI(r),[p,U]=h2({prop:o,defaultProp:a??null,onChange:l,caller:m2}),[b,y]=C.useState(!1),E=Ca(c),_=cX(n),I=C.useRef(!1),[k,w]=C.useState(0);return C.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(r7,E),()=>T.removeEventListener(r7,E)},[E]),g(bpe,{scope:n,orientation:i,dir:m,loop:s,currentTabStopId:p,onItemFocus:C.useCallback(T=>U(T),[U]),onItemShiftTab:C.useCallback(()=>y(!0),[]),onFocusableItemAdd:C.useCallback(()=>w(T=>T+1),[]),onFocusableItemRemove:C.useCallback(()=>w(T=>T-1),[]),children:g(jn.div,{tabIndex:b||k===0?-1:0,"data-orientation":i,...u,ref:h,style:{outline:"none",...e.style},onMouseDown:tt(e.onMouseDown,()=>{I.current=!0}),onFocus:tt(e.onFocus,T=>{const A=!I.current;if(T.target===T.currentTarget&&A&&!b){const S=new CustomEvent(r7,mpe);if(T.currentTarget.dispatchEvent(S),!S.defaultPrevented){const D=_().filter(G=>G.focusable),N=D.find(G=>G.active),L=D.find(G=>G.id===p),Y=[N,L,...D].filter(Boolean).map(G=>G.ref.current);hX(Y,d)}}I.current=!1}),onBlur:tt(e.onBlur,()=>y(!1))})})}),uX="RovingFocusGroupItem",fX=C.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:s=!1,tabStopId:r,children:o,...a}=e,l=Bu(),c=r||l,d=ype(uX,n),u=d.currentTabStopId===c,f=cX(n),{onFocusableItemAdd:h,onFocusableItemRemove:m,currentTabStopId:p}=d;return C.useEffect(()=>{if(i)return h(),()=>m()},[i,h,m]),g(E_.ItemSlot,{scope:n,id:c,focusable:i,active:s,children:g(jn.span,{tabIndex:u?0:-1,"data-orientation":d.orientation,...a,ref:t,onMouseDown:tt(e.onMouseDown,U=>{i?d.onItemFocus(c):U.preventDefault()}),onFocus:tt(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:tt(e.onKeyDown,U=>{if(U.key==="Tab"&&U.shiftKey){d.onItemShiftTab();return}if(U.target!==U.currentTarget)return;const b=wpe(U,d.orientation,d.dir);if(b!==void 0){if(U.metaKey||U.ctrlKey||U.altKey||U.shiftKey)return;U.preventDefault();let E=f().filter(_=>_.focusable).map(_=>_.ref.current);if(b==="last")E.reverse();else if(b==="prev"||b==="next"){b==="prev"&&E.reverse();const _=E.indexOf(U.currentTarget);E=d.loop?Tpe(E,_+1):E.slice(_+1)}setTimeout(()=>hX(E))}}),children:typeof o=="function"?o({isCurrentTabStop:u,hasTabStop:p!=null}):o})})});fX.displayName=uX;var vpe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function _pe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function wpe(e,t,n){const i=_pe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return vpe[i]}function hX(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function Tpe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var gX=dX,mX=fX,v_=["Enter"," "],Ipe=["ArrowDown","PageUp","Home"],pX=["ArrowUp","PageDown","End"],Spe=[...Ipe,...pX],Cpe={ltr:[...v_,"ArrowRight"],rtl:[...v_,"ArrowLeft"]},xpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},p2="Menu",[ep,Ape,Mpe]=SG(p2),[uf,UX]=cf(p2,[Mpe,mE,pE]),U2=mE(),bX=pE(),[yX,ff]=uf(p2),[kpe,b2]=uf(p2),EX=e=>{const{__scopeMenu:t,open:n=!1,children:i,dir:s,onOpenChange:r,modal:o=!0}=e,a=U2(t),[l,c]=C.useState(null),d=C.useRef(!1),u=Ca(r),f=oI(s);return C.useEffect(()=>{const h=()=>{d.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>d.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),g(yI,{...a,children:g(yX,{scope:t,open:n,onOpenChange:u,content:l,onContentChange:c,children:g(kpe,{scope:t,onClose:C.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:d,dir:f,modal:o,children:i})})})};EX.displayName=p2;var Rpe="MenuAnchor",vI=C.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,s=U2(n);return g(EI,{...s,...i,ref:t})});vI.displayName=Rpe;var Dpe="MenuPortal",[vDe,vX]=uf(Dpe,{forceMount:void 0}),Zr="MenuContent",[Lpe,_I]=uf(Zr),_X=C.forwardRef((e,t)=>{const n=vX(Zr,e.__scopeMenu),{forceMount:i=n.forceMount,...s}=e,r=ff(Zr,e.__scopeMenu),o=b2(Zr,e.__scopeMenu);return g(ep.Provider,{scope:e.__scopeMenu,children:g(df,{present:i||r.open,children:g(ep.Slot,{scope:e.__scopeMenu,children:o.modal?g(Ppe,{...s,ref:t}):g(Npe,{...s,ref:t})})})})}),Ppe=C.forwardRef((e,t)=>{const n=ff(Zr,e.__scopeMenu),i=C.useRef(null),s=hs(t,i);return C.useEffect(()=>{const r=i.current;if(r)return zG(r)},[]),g(wI,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:tt(e.onFocusOutside,r=>r.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Npe=C.forwardRef((e,t)=>{const n=ff(Zr,e.__scopeMenu);return g(wI,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Ope=q0("MenuContent.ScrollLock"),wI=C.forwardRef((e,t)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:f,onDismiss:h,disableOutsideScroll:m,...p}=e,U=ff(Zr,n),b=b2(Zr,n),y=U2(n),E=bX(n),_=Ape(n),[I,k]=C.useState(null),w=C.useRef(null),T=hs(t,w,U.onContentChange),A=C.useRef(0),S=C.useRef(""),D=C.useRef(0),N=C.useRef(null),L=C.useRef("right"),j=C.useRef(0),Y=m?cI:C.Fragment,G=m?{as:Ope,allowPinchZoom:!0}:void 0,O=H=>{var Ae,$e;const X=S.current+H,Q=_().filter(et=>!et.disabled),re=document.activeElement,ie=(Ae=Q.find(et=>et.ref.current===re))==null?void 0:Ae.textValue,me=Q.map(et=>et.textValue),ke=Kpe(me,X,ie),ye=($e=Q.find(et=>et.textValue===ke))==null?void 0:$e.ref.current;(function et(Be){S.current=Be,window.clearTimeout(A.current),Be!==""&&(A.current=window.setTimeout(()=>et(""),1e3))})(X),ye&&setTimeout(()=>ye.focus())};C.useEffect(()=>()=>window.clearTimeout(A.current),[]),kG();const z=C.useCallback(H=>{var Q,re;return L.current===((Q=N.current)==null?void 0:Q.side)&&qpe(H,(re=N.current)==null?void 0:re.area)},[]);return g(Lpe,{scope:n,searchRef:S,onItemEnter:C.useCallback(H=>{z(H)&&H.preventDefault()},[z]),onItemLeave:C.useCallback(H=>{var X;z(H)||((X=w.current)==null||X.focus(),k(null))},[z]),onTriggerLeave:C.useCallback(H=>{z(H)&&H.preventDefault()},[z]),pointerGraceTimerRef:D,onPointerGraceIntentChange:C.useCallback(H=>{N.current=H},[]),children:g(Y,{...G,children:g(lI,{asChild:!0,trapped:s,onMountAutoFocus:tt(r,H=>{var X;H.preventDefault(),(X=w.current)==null||X.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:g(aI,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:f,onDismiss:h,children:g(gX,{asChild:!0,...E,dir:b.dir,orientation:"vertical",loop:i,currentTabStopId:I,onCurrentTabStopIdChange:k,onEntryFocus:tt(l,H=>{b.isUsingKeyboardRef.current||H.preventDefault()}),preventScrollOnEntryFocus:!0,children:g(aX,{role:"menu","aria-orientation":"vertical","data-state":BX(U.open),"data-radix-menu-content":"",dir:b.dir,...y,...p,ref:T,style:{outline:"none",...p.style},onKeyDown:tt(p.onKeyDown,H=>{const Q=H.target.closest("[data-radix-menu-content]")===H.currentTarget,re=H.ctrlKey||H.altKey||H.metaKey,ie=H.key.length===1;Q&&(H.key==="Tab"&&H.preventDefault(),!re&&ie&&O(H.key));const me=w.current;if(H.target!==me||!Spe.includes(H.key))return;H.preventDefault();const ye=_().filter(Ae=>!Ae.disabled).map(Ae=>Ae.ref.current);pX.includes(H.key)&&ye.reverse(),Ype(ye)}),onBlur:tt(e.onBlur,H=>{H.currentTarget.contains(H.target)||(window.clearTimeout(A.current),S.current="")}),onPointerMove:tt(e.onPointerMove,tp(H=>{const X=H.target,Q=j.current!==H.clientX;if(H.currentTarget.contains(X)&&Q){const re=H.clientX>j.current?"right":"left";L.current=re,j.current=H.clientX}}))})})})})})})});_X.displayName=Zr;var Fpe="MenuGroup",TI=C.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return g(jn.div,{role:"group",...i,ref:t})});TI.displayName=Fpe;var Bpe="MenuLabel",wX=C.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return g(jn.div,{...i,ref:t})});wX.displayName=Bpe;var v5="MenuItem",sD="menu.itemSelect",UE=C.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:i,...s}=e,r=C.useRef(null),o=b2(v5,e.__scopeMenu),a=_I(v5,e.__scopeMenu),l=hs(t,r),c=C.useRef(!1),d=()=>{const u=r.current;if(!n&&u){const f=new CustomEvent(sD,{bubbles:!0,cancelable:!0});u.addEventListener(sD,h=>i==null?void 0:i(h),{once:!0}),IG(u,f),f.defaultPrevented?c.current=!1:o.onClose()}};return g(TX,{...s,ref:l,disabled:n,onClick:tt(e.onClick,d),onPointerDown:u=>{var f;(f=e.onPointerDown)==null||f.call(e,u),c.current=!0},onPointerUp:tt(e.onPointerUp,u=>{var f;c.current||(f=u.currentTarget)==null||f.click()}),onKeyDown:tt(e.onKeyDown,u=>{const f=a.searchRef.current!=="";n||f&&u.key===" "||v_.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});UE.displayName=v5;var TX=C.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:i=!1,textValue:s,...r}=e,o=_I(v5,n),a=bX(n),l=C.useRef(null),c=hs(t,l),[d,u]=C.useState(!1),[f,h]=C.useState("");return C.useEffect(()=>{const m=l.current;m&&h((m.textContent??"").trim())},[r.children]),g(ep.ItemSlot,{scope:n,disabled:i,textValue:s??f,children:g(mX,{asChild:!0,...a,focusable:!i,children:g(jn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...r,ref:c,onPointerMove:tt(e.onPointerMove,tp(m=>{i?o.onItemLeave(m):(o.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:tt(e.onPointerLeave,tp(m=>o.onItemLeave(m))),onFocus:tt(e.onFocus,()=>u(!0)),onBlur:tt(e.onBlur,()=>u(!1))})})})}),zpe="MenuCheckboxItem",IX=C.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:i,...s}=e;return g(MX,{scope:e.__scopeMenu,checked:n,children:g(UE,{role:"menuitemcheckbox","aria-checked":_5(n)?"mixed":n,...s,ref:t,"data-state":CI(n),onSelect:tt(s.onSelect,()=>i==null?void 0:i(_5(n)?!0:!n),{checkForDefaultPrevented:!1})})})});IX.displayName=zpe;var SX="MenuRadioGroup",[Hpe,Vpe]=uf(SX,{value:void 0,onValueChange:()=>{}}),CX=C.forwardRef((e,t)=>{const{value:n,onValueChange:i,...s}=e,r=Ca(i);return g(Hpe,{scope:e.__scopeMenu,value:n,onValueChange:r,children:g(TI,{...s,ref:t})})});CX.displayName=SX;var xX="MenuRadioItem",AX=C.forwardRef((e,t)=>{const{value:n,...i}=e,s=Vpe(xX,e.__scopeMenu),r=n===s.value;return g(MX,{scope:e.__scopeMenu,checked:r,children:g(UE,{role:"menuitemradio","aria-checked":r,...i,ref:t,"data-state":CI(r),onSelect:tt(i.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});AX.displayName=xX;var II="MenuItemIndicator",[MX,$pe]=uf(II,{checked:!1}),kX=C.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:i,...s}=e,r=$pe(II,n);return g(df,{present:i||_5(r.checked)||r.checked===!0,children:g(jn.span,{...s,ref:t,"data-state":CI(r.checked)})})});kX.displayName=II;var Gpe="MenuSeparator",RX=C.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return g(jn.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});RX.displayName=Gpe;var Xpe="MenuArrow",DX=C.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,s=U2(n);return g(lX,{...s,...i,ref:t})});DX.displayName=Xpe;var SI="MenuSub",[jpe,LX]=uf(SI),PX=e=>{const{__scopeMenu:t,children:n,open:i=!1,onOpenChange:s}=e,r=ff(SI,t),o=U2(t),[a,l]=C.useState(null),[c,d]=C.useState(null),u=Ca(s);return C.useEffect(()=>(r.open===!1&&u(!1),()=>u(!1)),[r.open,u]),g(yI,{...o,children:g(yX,{scope:t,open:i,onOpenChange:u,content:c,onContentChange:d,children:g(jpe,{scope:t,contentId:Bu(),triggerId:Bu(),trigger:a,onTriggerChange:l,children:n})})})};PX.displayName=SI;var p1="MenuSubTrigger",NX=C.forwardRef((e,t)=>{const n=ff(p1,e.__scopeMenu),i=b2(p1,e.__scopeMenu),s=LX(p1,e.__scopeMenu),r=_I(p1,e.__scopeMenu),o=C.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=r,c={__scopeMenu:e.__scopeMenu},d=C.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return C.useEffect(()=>d,[d]),C.useEffect(()=>{const u=a.current;return()=>{window.clearTimeout(u),l(null)}},[a,l]),g(vI,{asChild:!0,...c,children:g(TX,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":BX(n.open),...e,ref:dE(t,s.onTriggerChange),onClick:u=>{var f;(f=e.onClick)==null||f.call(e,u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:tt(e.onPointerMove,tp(u=>{r.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!n.open&&!o.current&&(r.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:tt(e.onPointerLeave,tp(u=>{var h,m;d();const f=(h=n.content)==null?void 0:h.getBoundingClientRect();if(f){const p=(m=n.content)==null?void 0:m.dataset.side,U=p==="right",b=U?-5:5,y=f[U?"left":"right"],E=f[U?"right":"left"];r.onPointerGraceIntentChange({area:[{x:u.clientX+b,y:u.clientY},{x:y,y:f.top},{x:E,y:f.top},{x:E,y:f.bottom},{x:y,y:f.bottom}],side:p}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>r.onPointerGraceIntentChange(null),300)}else{if(r.onTriggerLeave(u),u.defaultPrevented)return;r.onPointerGraceIntentChange(null)}})),onKeyDown:tt(e.onKeyDown,u=>{var h;const f=r.searchRef.current!=="";e.disabled||f&&u.key===" "||Cpe[i.dir].includes(u.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),u.preventDefault())})})})});NX.displayName=p1;var OX="MenuSubContent",FX=C.forwardRef((e,t)=>{const n=vX(Zr,e.__scopeMenu),{forceMount:i=n.forceMount,...s}=e,r=ff(Zr,e.__scopeMenu),o=b2(Zr,e.__scopeMenu),a=LX(OX,e.__scopeMenu),l=C.useRef(null),c=hs(t,l);return g(ep.Provider,{scope:e.__scopeMenu,children:g(df,{present:i||r.open,children:g(ep.Slot,{scope:e.__scopeMenu,children:g(wI,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var u;o.isUsingKeyboardRef.current&&((u=l.current)==null||u.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:tt(e.onFocusOutside,d=>{d.target!==a.trigger&&r.onOpenChange(!1)}),onEscapeKeyDown:tt(e.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:tt(e.onKeyDown,d=>{var h;const u=d.currentTarget.contains(d.target),f=xpe[o.dir].includes(d.key);u&&f&&(r.onOpenChange(!1),(h=a.trigger)==null||h.focus(),d.preventDefault())})})})})})});FX.displayName=OX;function BX(e){return e?"open":"closed"}function _5(e){return e==="indeterminate"}function CI(e){return _5(e)?"indeterminate":e?"checked":"unchecked"}function Ype(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Wpe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}function Kpe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,r=n?e.indexOf(n):-1;let o=Wpe(e,Math.max(r,0));s.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function Zpe(e,t){const{x:n,y:i}=e;let s=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const a=t[r],l=t[o],c=a.x,d=a.y,u=l.x,f=l.y;d>i!=f>i&&n<(u-c)*(i-d)/(f-d)+c&&(s=!s)}return s}function qpe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Zpe(n,t)}function tp(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Qpe=EX,Jpe=vI,e2e=_X,t2e=TI,n2e=wX,i2e=UE,s2e=IX,r2e=CX,o2e=AX,a2e=kX,l2e=RX,c2e=DX,d2e=PX,u2e=NX,f2e=FX,bE="DropdownMenu",[h2e,_De]=cf(bE,[UX]),ks=UX(),[g2e,zX]=h2e(bE),HX=e=>{const{__scopeDropdownMenu:t,children:n,dir:i,open:s,defaultOpen:r,onOpenChange:o,modal:a=!0}=e,l=ks(t),c=C.useRef(null),[d,u]=h2({prop:s,defaultProp:r??!1,onChange:o,caller:bE});return g(g2e,{scope:t,triggerId:Bu(),triggerRef:c,contentId:Bu(),open:d,onOpenChange:u,onOpenToggle:C.useCallback(()=>u(f=>!f),[u]),modal:a,children:g(Qpe,{...l,open:d,onOpenChange:u,dir:i,modal:a,children:n})})};HX.displayName=bE;var VX="DropdownMenuTrigger",$X=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...s}=e,r=zX(VX,n),o=ks(n);return g(Jpe,{asChild:!0,...o,children:g(jn.button,{type:"button",id:r.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":r.open?r.contentId:void 0,"data-state":r.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...s,ref:dE(t,r.triggerRef),onPointerDown:tt(e.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(r.onOpenToggle(),r.open||a.preventDefault())}),onKeyDown:tt(e.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&r.onOpenToggle(),a.key==="ArrowDown"&&r.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});$X.displayName=VX;var GX="DropdownMenuContent",XX=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=zX(GX,n),r=ks(n),o=C.useRef(!1);return g(e2e,{id:s.contentId,"aria-labelledby":s.triggerId,...r,...i,ref:t,onCloseAutoFocus:tt(e.onCloseAutoFocus,a=>{var l;o.current||(l=s.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:tt(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;(!s.modal||d)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});XX.displayName=GX;var m2e="DropdownMenuGroup",p2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(t2e,{...s,...i,ref:t})});p2e.displayName=m2e;var U2e="DropdownMenuLabel",b2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(n2e,{...s,...i,ref:t})});b2e.displayName=U2e;var y2e="DropdownMenuItem",jX=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(i2e,{...s,...i,ref:t})});jX.displayName=y2e;var E2e="DropdownMenuCheckboxItem",v2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(s2e,{...s,...i,ref:t})});v2e.displayName=E2e;var _2e="DropdownMenuRadioGroup",w2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(r2e,{...s,...i,ref:t})});w2e.displayName=_2e;var T2e="DropdownMenuRadioItem",I2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(o2e,{...s,...i,ref:t})});I2e.displayName=T2e;var S2e="DropdownMenuItemIndicator",C2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(a2e,{...s,...i,ref:t})});C2e.displayName=S2e;var x2e="DropdownMenuSeparator",A2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(l2e,{...s,...i,ref:t})});A2e.displayName=x2e;var M2e="DropdownMenuArrow",k2e=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(c2e,{...s,...i,ref:t})});k2e.displayName=M2e;var R2e=e=>{const{__scopeDropdownMenu:t,children:n,open:i,onOpenChange:s,defaultOpen:r}=e,o=ks(t),[a,l]=h2({prop:i,defaultProp:r??!1,onChange:s,caller:"DropdownMenuSub"});return g(d2e,{...o,open:a,onOpenChange:l,children:n})},D2e="DropdownMenuSubTrigger",YX=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(u2e,{...s,...i,ref:t})});YX.displayName=D2e;var L2e="DropdownMenuSubContent",WX=C.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,s=ks(n);return g(f2e,{...s,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});WX.displayName=L2e;var P2e=HX,N2e=$X,O2e=XX,KX=jX,F2e=R2e,B2e=YX,z2e=WX,yE="Popover",[ZX,wDe]=cf(yE,[mE]),y2=mE(),[H2e,Md]=ZX(yE),qX=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:s,onOpenChange:r,modal:o=!1}=e,a=y2(t),l=C.useRef(null),[c,d]=C.useState(!1),[u,f]=h2({prop:i,defaultProp:s??!1,onChange:r,caller:yE});return g(yI,{...a,children:g(H2e,{scope:t,contentId:Bu(),triggerRef:l,open:u,onOpenChange:f,onOpenToggle:C.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:c,onCustomAnchorAdd:C.useCallback(()=>d(!0),[]),onCustomAnchorRemove:C.useCallback(()=>d(!1),[]),modal:o,children:n})})};qX.displayName=yE;var QX="PopoverAnchor",V2e=C.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=Md(QX,n),r=y2(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return C.useEffect(()=>(o(),()=>a()),[o,a]),g(EI,{...r,...i,ref:t})});V2e.displayName=QX;var JX="PopoverTrigger",ej=C.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=Md(JX,n),r=y2(n),o=hs(t,s.triggerRef),a=g(jn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":oj(s.open),...i,ref:o,onClick:tt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:g(EI,{asChild:!0,...r,children:a})});ej.displayName=JX;var xI="PopoverPortal",[$2e,G2e]=ZX(xI,{forceMount:void 0}),tj=e=>{const{__scopePopover:t,forceMount:n,children:i,container:s}=e,r=Md(xI,t);return g($2e,{scope:t,forceMount:n,children:g(df,{present:n||r.open,children:g(MG,{asChild:!0,container:s,children:i})})})};tj.displayName=xI;var vg="PopoverContent",nj=C.forwardRef((e,t)=>{const n=G2e(vg,e.__scopePopover),{forceMount:i=n.forceMount,...s}=e,r=Md(vg,e.__scopePopover);return g(df,{present:i||r.open,children:r.modal?g(j2e,{...s,ref:t}):g(Y2e,{...s,ref:t})})});nj.displayName=vg;var X2e=q0("PopoverContent.RemoveScroll"),j2e=C.forwardRef((e,t)=>{const n=Md(vg,e.__scopePopover),i=C.useRef(null),s=hs(t,i),r=C.useRef(!1);return C.useEffect(()=>{const o=i.current;if(o)return zG(o)},[]),g(cI,{as:X2e,allowPinchZoom:!0,children:g(ij,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:tt(e.onCloseAutoFocus,o=>{var a;o.preventDefault(),r.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:tt(e.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;r.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:tt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Y2e=C.forwardRef((e,t)=>{const n=Md(vg,e.__scopePopover),i=C.useRef(!1),s=C.useRef(!1);return g(ij,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:r=>{var o,a;(o=e.onCloseAutoFocus)==null||o.call(e,r),r.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),r.preventDefault()),i.current=!1,s.current=!1},onInteractOutside:r=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,r),r.defaultPrevented||(i.current=!0,r.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=r.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&r.preventDefault(),r.detail.originalEvent.type==="focusin"&&s.current&&r.preventDefault()}})}),ij=C.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:r,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=e,f=Md(vg,n),h=y2(n);return kG(),g(lI,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:s,onUnmountAutoFocus:r,children:g(aI,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:g(aX,{"data-state":oj(f.open),role:"dialog",id:f.contentId,...h,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),sj="PopoverClose",W2e=C.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=Md(sj,n);return g(jn.button,{type:"button",...i,ref:t,onClick:tt(e.onClick,()=>s.onOpenChange(!1))})});W2e.displayName=sj;var K2e="PopoverArrow",rj=C.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=y2(n);return g(lX,{...s,...i,ref:t})});rj.displayName=K2e;function oj(e){return e?"open":"closed"}var Gl=qX,Xl=ej,Z2e=tj,EE=nj,aj=rj,vE="Tabs",[q2e,TDe]=cf(vE,[pE]),lj=pE(),[Q2e,AI]=q2e(vE),cj=C.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:s,defaultValue:r,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=e,d=oI(a),[u,f]=h2({prop:i,onChange:s,defaultProp:r??"",caller:vE});return g(Q2e,{scope:n,baseId:Bu(),value:u,onValueChange:f,orientation:o,dir:d,activationMode:l,children:g(jn.div,{dir:d,"data-orientation":o,...c,ref:t})})});cj.displayName=vE;var dj="TabsList",uj=C.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...s}=e,r=AI(dj,n),o=lj(n);return g(gX,{asChild:!0,...o,orientation:r.orientation,dir:r.dir,loop:i,children:g(jn.div,{role:"tablist","aria-orientation":r.orientation,...s,ref:t})})});uj.displayName=dj;var fj="TabsTrigger",hj=C.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:s=!1,...r}=e,o=AI(fj,n),a=lj(n),l=pj(o.baseId,i),c=Uj(o.baseId,i),d=i===o.value;return g(mX,{asChild:!0,...a,focusable:!s,active:d,children:g(jn.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...r,ref:t,onMouseDown:tt(e.onMouseDown,u=>{!s&&u.button===0&&u.ctrlKey===!1?o.onValueChange(i):u.preventDefault()}),onKeyDown:tt(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&o.onValueChange(i)}),onFocus:tt(e.onFocus,()=>{const u=o.activationMode!=="manual";!d&&!s&&u&&o.onValueChange(i)})})})});hj.displayName=fj;var gj="TabsContent",mj=C.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:s,children:r,...o}=e,a=AI(gj,n),l=pj(a.baseId,i),c=Uj(a.baseId,i),d=i===a.value,u=C.useRef(d);return C.useEffect(()=>{const f=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(f)},[]),g(df,{present:s||d,children:({present:f})=>g(jn.div,{"data-state":d?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:f&&r})})});mj.displayName=gj;function pj(e,t){return`${e}-trigger-${t}`}function Uj(e,t){return`${e}-content-${t}`}var bj=cj,yj=uj,Ej=hj,vj=mj;const _j=()=>g("div",{style:{width:1,height:"1rem",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),wj=de.createContext(null),Qt=()=>de.useContext(wj),Tj=e=>{const[t,n]=C.useState(null),i=Nn(),{theme:s}=Qt(),{container:r}=Ws();return C.useLayoutEffect(()=>{var o;t&&(t.className="",t.classList.add("excalidraw",...((o=e==null?void 0:e.className)==null?void 0:o.split(/\s+/))||[]),t.classList.toggle("excalidraw--mobile",i.formFactor==="phone"),t.classList.toggle("theme--dark",s===be.DARK))},[t,s,i.formFactor,e==null?void 0:e.className]),C.useLayoutEffect(()=>{const o=e!=null&&e.parentSelector?r==null?void 0:r.querySelector(e.parentSelector):document.body;if(!o)return;const a=document.createElement("div");return o.appendChild(a),n(a),()=>{o.removeChild(a)}},[r,e==null?void 0:e.parentSelector]),t};function MI(e,t,n){C.useEffect(()=>{function i(s){const r=s;if(!e.current)return;const o=n==null?void 0:n(r,e.current);if(o===!0)return;if(o===!1)return t(r);e.current.contains(r.target)||!document.documentElement.contains(r.target)||r.target.closest("[data-radix-portal]")||r.target===document.documentElement&&document.body.style.pointerEvents==="none"||r.target.closest("[data-prevent-outside-click]")||t(r)}return document.addEventListener(te.POINTER_DOWN,i),document.addEventListener(te.TOUCH_START,i),()=>{document.removeEventListener(te.POINTER_DOWN,i),document.removeEventListener(te.TOUCH_START,i)}},[e,t,n])}const _E=e=>{const t=C.useRef(e);return Object.assign(t.current,e),t.current},wE=Nt(null),J2e=({onCancel:e,onChange:t,onSelect:n,colorPickerType:i})=>{const s=Tj({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),r=Qt(),o=n8(),a=Ir(),l=Ze(o,r),c=_E({app:a,onCancel:e,onChange:t,onSelect:n,selectedElements:l}),{container:d}=Ws();C.useEffect(()=>{const f=u.current;if(!f||!a.canvas||!s)return;let h=!1;const m=a.canvas.getContext("2d"),p=({clientX:k,clientY:w})=>{const T=m.getImageData((k-r.offsetLeft)*window.devicePixelRatio,(w-r.offsetTop)*window.devicePixelRatio,1,1).data;return lz(T[0],T[1],T[2])},U=({clientX:k,clientY:w,altKey:T})=>{f.style.top=`${w+20}px`,f.style.left=`${k+20}px`;const A=p({clientX:k,clientY:w});h&&c.onChange(i,A,c.selectedElements,{altKey:T}),f.style.background=A},b=()=>{c.onCancel()},y=(k,w)=>{c.onSelect(k,w)},E=k=>{h=!0,k.stopImmediatePropagation()},_=k=>{h=!1,d==null||d.focus(),k.stopImmediatePropagation(),k.preventDefault(),y(p(k),k)},I=k=>{k.key===$.ESCAPE&&(k.preventDefault(),k.stopImmediatePropagation(),b())};return s.tabIndex=-1,s.focus(),U({clientX:c.app.lastViewportPosition.x,clientY:c.app.lastViewportPosition.y,altKey:!1}),s.addEventListener(te.KEYDOWN,I),s.addEventListener(te.POINTER_DOWN,E),s.addEventListener(te.POINTER_UP,_),window.addEventListener("pointermove",U,{passive:!0}),window.addEventListener(te.BLUR,b),()=>{h=!1,s.removeEventListener(te.KEYDOWN,I),s.removeEventListener(te.POINTER_DOWN,E),s.removeEventListener(te.POINTER_UP,_),window.removeEventListener("pointermove",U),window.removeEventListener(te.BLUR,b)}},[c,a.canvas,s,i,d,r.offsetLeft,r.offsetTop]);const u=C.useRef(null);return MI(u,()=>{e()},f=>!!f.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),s?tn.createPortal(g("div",{ref:u,className:"excalidraw-eye-dropper-preview"}),s):null},fr=de.forwardRef(({children:e,padding:t,className:n,style:i},s)=>g("div",{className:ae("Island",n),style:{"--padding":t,...i},ref:s,children:e})),Qg=de.forwardRef(({className:e,container:t,children:n,style:i,onClose:s,onKeyDown:r,onFocusOutside:o,onPointerLeave:a,onPointerDownOutside:l,preventAutoFocusOnTouch:c=!1},d)=>{const u=Nn(),f=u.formFactor==="phone"&&!u.isLandscape;return g(Z2e,{container:t,children:P(EE,{ref:d,className:ae("focus-visible-none",e),"data-prevent-outside-click":!0,side:f?"bottom":"right",align:f?"center":"start",alignOffset:-16,sideOffset:20,collisionBoundary:t??void 0,style:{zIndex:"var(--zIndex-ui-styles-popup)",marginLeft:u.formFactor==="phone"?"0.5rem":void 0},onPointerLeave:a,onKeyDown:r,onFocusOutside:o,onPointerDownOutside:l,onOpenAutoFocus:h=>{c&&u.isTouchScreen&&h.preventDefault()},onCloseAutoFocus:h=>{h.stopPropagation(),h.preventDefault(),t&&!Vie(document.activeElement)&&t.focus(),s()},children:[g(fr,{padding:3,style:i,children:n}),g(aj,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})}),TE=()=>document.querySelector(".excalidraw-wysiwyg"),kI=()=>{const e=TE();return e?{start:e.selectionStart,end:e.selectionEnd}:null},RI=e=>{setTimeout(()=>{const t=TE();t&&(t.focus(),e&&(t.selectionStart=e.start,t.selectionEnd=e.end))},0)},IE=(e,t,n,i)=>{t&&i&&i();const s=t&&n?kI():null;e(),t&&n&&RI(s)},eUe=()=>{const[e,t]=C.useState(null),n=C.useCallback(()=>{const r=kI();t(r)},[]),i=C.useCallback(()=>{setTimeout(()=>{const r=TE();r&&(r.focus(),e&&(r.selectionStart=e.start,r.selectionEnd=e.end,t(null)))},0)},[e]),s=C.useCallback(()=>{t(null)},[]);return{saveCaretPosition:n,restoreCaretPosition:i,clearSavedPosition:s,hasSavedPosition:!!e}},tUe=(e=100)=>{const t=TE();if(t){const n=t.onblur;t.onblur=null,setTimeout(()=>{t.onblur=n},e)}},SE=({palette:e,color:t})=>{if(!t)return null;for(const[n,i]of Object.entries(e))if(Array.isArray(i)){const s=i.indexOf(t);if(s>-1)return{colorName:n,shade:s}}else if(i===t)return{colorName:n,shade:null};return null},__=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),Ij=({color:e,palette:t})=>!Object.values(t).flat().includes(e),nUe=(e,t,n)=>{const i={elementBackground:"backgroundColor",elementStroke:"strokeColor"},s=e.filter(o=>{if(o.isDeleted)return!1;const a=o[i[t]];return Ij({color:a,palette:n})}),r=new Map;return s.forEach(o=>{const a=o[i[t]];r.has(a)?r.set(a,r.get(a)+1):r.set(a,1)}),[...r.entries()].sort((o,a)=>a[1]-o[1]).map(o=>o[0]).slice(0,Hne)},Jg=Nt(null),iUe=({color:e,onChange:t,label:n,colorPickerType:i,placeholder:s})=>{const r=Nn(),[o,a]=C.useState(e),[l,c]=dt(Jg);C.useEffect(()=>{a(e)},[e]);const d=C.useCallback(p=>{const U=p.toLowerCase(),b=Yne(U);b&&t(b),a(U)},[t]),u=C.useRef(null),f=C.useRef(null);C.useEffect(()=>{u.current&&u.current.focus()},[l]);const[h,m]=dt(wE);return C.useEffect(()=>()=>{m(null)},[m]),P("div",{className:"color-picker__input-label",children:[g("div",{className:"color-picker__input-hash",children:"#"}),g("input",{ref:l==="hex"?u:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:p=>{d(p.target.value)},value:(o||"").replace(/^#/,""),onBlur:()=>{a(e)},tabIndex:-1,onFocus:()=>c("hex"),onKeyDown:p=>{var U;p.key!==$.TAB&&(p.key===$.ESCAPE&&((U=f.current)==null||U.focus()),p.stopPropagation())},placeholder:s}),r.formFactor!=="phone"&&P(fe,{children:[g("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),g("div",{ref:f,className:ae("excalidraw-eye-dropper-trigger",{selected:h}),onClick:()=>m(p=>p?null:{keepOpenOnAlt:!1,onSelect:U=>t(U),colorPickerType:i}),title:`${x("labels.eyeDropper")}  ${$.I.toLocaleUpperCase()} or ${J("Alt")} `,children:ime})]})]})},DI=({color:e,keyLabel:t,isShade:n=!1})=>P("div",{className:"color-picker__button__hotkey-label",style:{color:D6(e)?"#fff":"#000"},children:[n&&"",t]}),sUe=({colors:e,color:t,onChange:n,label:i})=>{const[s,r]=dt(Jg),o=C.useRef(null);return C.useEffect(()=>{o.current&&o.current.focus()},[t,s]),g("div",{className:"color-picker-content--default",children:e.map((a,l)=>P("button",{ref:t===a?o:void 0,tabIndex:-1,type:"button",className:ae("color-picker__button color-picker__button--large has-outline",{active:t===a,"is-transparent":a==="transparent"||!a}),onClick:()=>{n(a),r("custom")},title:a,"aria-label":i,style:{"--swatch-color":a},children:[g("div",{className:"color-picker__button-outline"}),g(DI,{color:a,keyLabel:l+1})]},l))})},rUe=({palette:e,color:t,onChange:n,activeShade:i,showHotKey:s=!0})=>{const r=SE({color:t,palette:e}),[o,a]=dt(Jg),l=C.useRef(null);return C.useEffect(()=>{l.current&&o==="baseColors"&&l.current.focus()},[r==null?void 0:r.colorName,o]),g("div",{className:"color-picker-content--default",children:Object.entries(e).map(([c,d],u)=>{const f=(Array.isArray(d)?d[i]:d)||"transparent",h=__[u],m=x(`colors.${c.replace(/\d+/,"")}`,null,"");return P("button",{ref:(r==null?void 0:r.colorName)===c?l:void 0,tabIndex:-1,type:"button",className:ae("color-picker__button color-picker__button--large has-outline",{active:(r==null?void 0:r.colorName)===c,"is-transparent":f==="transparent"||!1}),onClick:()=>{n(f),a("baseColors")},title:`${m}${f.startsWith("#")?` ${f}`:""}  ${h}`,"aria-label":`${m}  ${h}`,style:{"--swatch-color":f},"data-testid":`color-${c}`,children:[g("div",{className:"color-picker__button-outline"}),s&&g(DI,{color:f,keyLabel:h})]},c)})})},Lb=({children:e})=>g("div",{className:"color-picker__heading",children:e}),oUe=({color:e,onChange:t,palette:n,showHotKey:i})=>{const s=SE({color:e||"transparent",palette:n}),[r,o]=dt(Jg),a=C.useRef(null);if(C.useEffect(()=>{a.current&&r==="shades"&&a.current.focus()},[s,r]),s){const{colorName:l,shade:c}=s,d=n[l];if(Array.isArray(d))return g("div",{className:"color-picker-content--default shades",children:d.map((u,f)=>P("button",{ref:f===c&&r==="shades"?a:void 0,tabIndex:-1,type:"button",className:ae("color-picker__button color-picker__button--large has-outline",{active:f===c}),"aria-label":"Shade",title:`${l} - ${f+1}`,style:u?{"--swatch-color":u}:void 0,onClick:()=>{t(u),o("shades")},children:[g("div",{className:"color-picker__button-outline"}),i&&g(DI,{color:u,keyLabel:f+1,isShade:!0})]},f))})}return P("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[g("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),g("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:x("colorPicker.noShades")})]})},o7=(e,t,n)=>{const i=Math.ceil(n/zf);switch(t=t??-1,e){case"ArrowLeft":{const s=t-1;return s<0?n-1:s}case"ArrowRight":return(t+1)%n;case"ArrowDown":{const s=t+zf;return s>=n?t%zf:s}case"ArrowUp":{const s=t-zf,r=s<0?zf*i+s:s;return r>=n?void 0:r}}},aUe=({e,colorObj:t,onChange:n,palette:i,customColors:s,setActiveColorPickerSection:r,activeShade:o})=>{if((t==null?void 0:t.shade)!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(e.code)&&e.shiftKey){const a=Number(e.code.slice(-1))-1;return n(i[t.colorName][a]),r("shades"),!0}if(["1","2","3","4","5"].includes(e.key)&&s[Number(e.key)-1])return n(s[Number(e.key)-1]),r("custom"),!0;if(__.includes(e.key)){const a=__.indexOf(e.key),l=Object.keys(i)[a],c=i[l],d=Array.isArray(c)?c[o]:c;return n(d),r("baseColors"),!0}return!1},lUe=({event:e,activeColorPickerSection:t,palette:n,color:i,onChange:s,customColors:r,setActiveColorPickerSection:o,updateData:a,activeShade:l,onEyeDropperToggle:c,onEscape:d})=>{if(e[$.CTRL_OR_CMD])return!1;if(e.key===$.ESCAPE)return d(e),!0;if(e.key===$.ALT)return c(!0),!0;if(e.key===$.I)return c(),!0;const u=SE({color:i,palette:n});if(e.key===$.TAB){const f={custom:!!r.length,baseColors:!0,shades:(u==null?void 0:u.shade)!=null,hex:!0},h=Object.entries(f).reduce((y,[E,_])=>(_&&y.push(E),y),[]),m=h.indexOf(t),p=e.shiftKey?-1:1,U=m+p>h.length-1?0:m+p<0?h.length-1:m+p,b=h[U];return b&&o(b),b==="custom"?s(r[0]):b==="baseColors"&&(Object.entries(n).find(([E,_])=>Array.isArray(_)?_.includes(i):_===i?E:null)||s(Je.black)),e.preventDefault(),e.stopPropagation(),!0}if(aUe({e,colorObj:u,onChange:s,palette:n,customColors:r,setActiveColorPickerSection:o,activeShade:l}))return!0;if(t==="shades"&&u){const{shade:f}=u,h=o7(e.key,f,zf);if(h!==void 0)return s(n[u.colorName][h]),!0}if(t==="baseColors"&&u){const{colorName:f}=u,h=Object.keys(n),m=h.indexOf(f),p=o7(e.key,m,h.length);if(p!==void 0){const U=h[p],b=n[U];return s(Array.isArray(b)?b[l]:b),!0}}if(t==="custom"){const f=i!=null?r.indexOf(i):0,h=o7(e.key,f,r.length);if(h!==void 0){const m=r[h];return s(m),!0}}return!1},cUe=de.forwardRef(({color:e,onChange:t,type:n,elements:i,palette:s,updateData:r,children:o,showTitle:a,onEyeDropperToggle:l,onEscape:c,showHotKey:d=!0},u)=>{const f=a?n==="elementStroke"?x("labels.stroke"):n==="elementBackground"?x("labels.background"):null:null,[h]=de.useState(()=>n==="canvasBackground"?[]:nUe(i,n,s)),[m,p]=dt(Jg),U=SE({color:e,palette:s});C.useEffect(()=>{if(!m){const _=!!e&&Ij({color:e,palette:s}),I=_&&!h.includes(e);p(I?null:_?"custom":(U==null?void 0:U.shade)!=null?"shades":"baseColors")}},[m,e,s,p,U,h]);const[b,y]=C.useState((U==null?void 0:U.shade)??(n==="elementBackground"?u1:d1));C.useEffect(()=>{(U==null?void 0:U.shade)!=null&&y(U.shade);const _=I=>{I.key===$.ALT&&l(!1)};return document.addEventListener(te.KEYUP,_,{capture:!0}),()=>{document.removeEventListener(te.KEYUP,_,{capture:!0})}},[U,l]);const E=de.useRef(null);return C.useImperativeHandle(u,()=>E.current),C.useEffect(()=>{var _;(_=E==null?void 0:E.current)==null||_.focus()},[]),g("div",{role:"dialog","aria-modal":"true","aria-label":x("labels.colorPicker"),children:P("div",{ref:E,onKeyDown:_=>{lUe({event:_,activeColorPickerSection:m,palette:s,color:e,onChange:t,onEyeDropperToggle:l,customColors:h,setActiveColorPickerSection:p,updateData:r,activeShade:b,onEscape:c})&&(_.preventDefault(),_.stopPropagation())},className:"color-picker-content properties-content",tabIndex:-1,children:[f&&g("div",{className:"color-picker__title",children:f}),!!h.length&&P("div",{children:[g(Lb,{children:x("colorPicker.mostUsedCustomColors")}),g(sUe,{colors:h,color:e,label:x("colorPicker.mostUsedCustomColors"),onChange:t})]}),P("div",{children:[g(Lb,{children:x("colorPicker.colors")}),g(rUe,{color:e,palette:s,onChange:t,activeShade:b,showHotKey:d})]}),P("div",{children:[g(Lb,{children:x("colorPicker.shades")}),g(oUe,{color:e,onChange:t,palette:s,showHotKey:d})]}),o]})})}),dUe=({onChange:e,type:t,activeColor:n,topPicks:i})=>{let s;return t==="elementStroke"&&(s=rz),t==="elementBackground"&&(s=oz),t==="canvasBackground"&&(s=az),i&&(s=i),s?g("div",{className:"color-picker__top-picks",children:s.map(r=>g("button",{className:ae("color-picker__button",{active:r===n,"is-transparent":r==="transparent"||!r,"has-outline":!D6(r,c4)}),style:{"--swatch-color":r},type:"button",title:r,onClick:()=>e(r),"data-testid":`color-top-pick-${r}`,children:g("div",{className:"color-picker__button-outline"})},r))}):(console.error("Invalid type for TopPicks"),null)},uUe=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Je,updateData:o,getOpenPopup:a,appState:l})=>{const{container:c}=Ws(),d=Na(),u=d!=="full",f=d==="mobile",[,h]=dt(Jg),[m,p]=dt(wE),U=P("div",{children:[g(Lb,{children:x("colorPicker.hexCode")}),g(iUe,{color:t||"",label:i,onChange:E=>{n(E)},colorPickerType:e,placeholder:x("colorPicker.color")})]}),b=C.useRef(null),y=()=>{var E;(E=b.current)==null||E.focus()};return g(Qg,{container:c,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!l.editingTextElement,onFocusOutside:E=>{rl(E.target)||y(),E.preventDefault()},onPointerDownOutside:E=>{m&&E.preventDefault()},onClose:()=>{a()===e&&o({openPopup:null}),h(null),l.editingTextElement&&setTimeout(()=>{const E=document.querySelector(".excalidraw-wysiwyg");E&&E.focus()},0)},children:r?g(cUe,{ref:b,palette:r,color:t,onChange:E=>{const _=l.editingTextElement?kI():null;n(E),l.editingTextElement&&_&&RI(_)},onEyeDropperToggle:E=>{p(_=>E?(_=_||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:e},_.keepOpenOnAlt=!0,_):E===!1||_?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:e})},onEscape:E=>{m?p(null):o({openPopup:null})},type:e,elements:s,updateData:o,showTitle:u,showHotKey:!f,children:U}):U})},fUe=({label:e,color:t,type:n,mode:i="background",onToggle:s,editingTextElement:r})=>{const o=Na(),a=o!=="full",l=o==="mobile",c=d=>{d.preventDefault(),d.stopPropagation(),r&&tUe(),s()};return P(Xl,{type:"button",className:ae("color-picker__button active-color properties-trigger",{"is-transparent":!t||t==="transparent","has-outline":!t||!D6(t,c4),"compact-sizing":a,"mobile-border":l}),"aria-label":e,style:t?{"--swatch-color":t}:void 0,title:x(n==="elementStroke"?"labels.showStroke":"labels.showBackground"),"data-openpopup":n,onClick:c,children:[g("div",{className:"color-picker__button-outline",children:!t&&sge}),a&&t&&i==="stroke"&&g("div",{className:"color-picker__button-background",children:g("span",{style:{color:t&&D6(t,c4)?"#fff":"#111"},children:xme})})]})},LI=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Je,topPicks:o,updateData:a,appState:l})=>{const c=C.useRef(l.openPopup);C.useEffect(()=>{c.current=l.openPopup},[l.openPopup]);const u=Na()!=="full";return g("div",{children:P("div",{role:"dialog","aria-modal":"true",className:ae("color-picker-container",{"color-picker-container--no-top-picks":u}),children:[!u&&g(dUe,{activeColor:t,onChange:n,type:e,topPicks:o}),!u&&g(_j,{}),P(Gl,{open:l.openPopup===e,onOpenChange:f=>{f&&a({openPopup:e})},children:[g(fUe,{color:t,label:i,type:e,mode:e==="elementStroke"?"stroke":"background",editingTextElement:!!l.editingTextElement,onToggle:()=>{l.openPopup===e?a({openPopup:null}):l.openPopup?a({openPopup:e}):a({openPopup:e})}}),l.openPopup===e&&g(uUe,{type:e,color:t,onChange:n,label:i,elements:s,palette:r,updateData:a,getOpenPopup:()=>c.current,appState:l})]})]})})},hUe="/fonts/CascadiaCode/CascadiaCode-Regular.woff2",gUe=[{uri:hUe}],mUe="/fonts/ComicShanns/ComicShanns-Regular-279a7b317d12eb88de06167bd672b4b4.woff2",pUe="/fonts/ComicShanns/ComicShanns-Regular-6e066e8de2ac57ea9283adb9c24d7f0c.woff2",UUe="/fonts/ComicShanns/ComicShanns-Regular-dc6a8806fa96795d7b3be5026f989a17.woff2",bUe="/fonts/ComicShanns/ComicShanns-Regular-fcb0fc02dcbee4c9846b3e2508668039.woff2",yUe=[{uri:mUe,descriptors:{unicodeRange:"U+20-7e,U+a1-a6,U+a8,U+ab-ac,U+af-b1,U+b4,U+b8,U+bb-bc,U+bf-cf,U+d1-d7,U+d9-de,U+e0-ef,U+f1-f7,U+f9-ff,U+131,U+152-153,U+2c6,U+2da,U+2dc,U+2013-2014,U+2018-201a,U+201c-201d,U+2020-2022,U+2026,U+2039-203a,U+2044,U+20ac,U+2191,U+2193,U+2212"}},{uri:bUe,descriptors:{unicodeRange:"U+100-10f,U+112-125,U+128-130,U+134-137,U+139-13c,U+141-148,U+14c-151,U+154-161,U+164-165,U+168-17f,U+1bf,U+1f7,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+a75b"}},{uri:UUe,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+315,U+2190,U+2192,U+2200,U+2203-2204,U+2264-2265,U+f6c3"}},{uri:pUe,descriptors:{unicodeRange:"U+3bb"}}],EUe=[{uri:M9}];class vUe{constructor(t){B(this,"instance");B(this,"debounceTerminate");this.instance=new Worker(t,{type:"module"})}}class PI{constructor(t,n){B(this,"idleWorkers",new Set);B(this,"workerUrl");B(this,"workerTTL");this.workerUrl=t,this.workerTTL=n.ttl||1e3}static create(t,n={}){if(!t)throw new _G;if(!import.meta.url||t.toString()===import.meta.url)throw new wG;return new PI(t,n)}async postMessage(t,n){let i;const s=Array.from(this.idleWorkers).shift();return s?(this.idleWorkers.delete(s),i=s):i=await this.createWorker(),new Promise((r,o)=>{i.instance.onmessage=this.onMessageHandler(i,r),i.instance.onerror=this.onErrorHandler(i,o),i.instance.postMessage(t,n),i.debounceTerminate(()=>o(new Error(`Active worker did not respond for ${this.workerTTL}ms!`)))})}async clear(){for(const t of this.idleWorkers)t.debounceTerminate.cancel(),t.instance.terminate();this.idleWorkers.clear()}async createWorker(){const t=new vUe(this.workerUrl);return t.debounceTerminate=Al(n=>{t.instance.terminate(),this.idleWorkers.has(t)?(this.idleWorkers.delete(t),console.debug("Job finished! Idle worker has been released from the pool.")):n?n():console.error("Worker has been terminated!")},this.workerTTL),t}onMessageHandler(t,n){return i=>{t.debounceTerminate(),this.idleWorkers.add(t),n(i.data)}}onErrorHandler(t,n){return i=>{t.debounceTerminate(()=>n(i)),t.debounceTerminate.flush(),this.clear()}}}let rD=typeof Worker<"u";const _Ue=async(e,t)=>{const{Commands:n,subsetToBase64:i,toBase64:s}=await TUe();return rD?sd(async()=>{try{const r=await IUe(),o=e.slice(0),a=await r.postMessage({command:n.Subset,arrayBuffer:o,codePoints:t},{transfer:[o]});return s(a)}catch(r){return rD=!1,nse()&&(r instanceof _G||r instanceof wG)||console.error("Failed to use workers for subsetting, falling back to the main thread.",r),i(e,t)}}):i(e,t)};let a7=null,l7=null;const wUe=async()=>(a7||(a7=Ue(()=>import("./subset-worker.chunk-CVR6pt27.js"),__vite__mapDeps([0,1]))),a7),TUe=async()=>(l7||(l7=Ue(()=>import("./subset-shared.chunk-D3ioWSie.js"),__vite__mapDeps([]))),l7);let c7=null;const IUe=()=>(c7||(c7=sd(async()=>{const{WorkerUrl:e}=await wUe();return PI.create(e)})),c7);var d7={};const Eh=class Eh{constructor(t,n,i){B(this,"urls");B(this,"fontFace");this.urls=Eh.createUrls(n);const s=this.urls.map(r=>`url(${r}) ${Eh.getFormat(r)}`).join(", ");this.fontFace=new FontFace(t,s,{display:"swap",style:"normal",weight:"400",...i})}toCSS(t){if(!this.getUnicodeRangeRegex().test(t))return;const n=Array.from(t).map(i=>i.codePointAt(0));return this.getContent(n).then(i=>`@font-face { font-family: ${this.fontFace.family}; src: url(${i}); }`)}async getContent(t){let n=0;const i=[];for(;n<this.urls.length;){const s=this.urls[n];try{const r=await this.fetchFont(s);return await _Ue(r,t)}catch(r){i.push(`"${s.toString()}" returned error "${r}"`)}n++}return console.error(`Failed to fetch font family "${this.fontFace.family}"`,JSON.stringify(i,void 0,2)),this.urls.length?this.urls[this.urls.length-1].toString():""}fetchFont(t){return sd(async()=>{const n=await fetch(t,{cache:"force-cache",headers:{Accept:"font/woff2"}});if(!n.ok){const s=t instanceof URL?t.toString():"dataurl";throw new Error(`Failed to fetch "${s}": ${n.statusText}`)}return await n.arrayBuffer()})}getUnicodeRangeRegex(){const t=this.fontFace.unicodeRange.split(/,\s*/).map(n=>{const[i,s]=n.replace("U+","").split("-");return s?`\\u{${i}}-\\u{${s}}`:`\\u{${i}}`}).join("");return new RegExp(`[${t}]`,"u")}static createUrls(t){if(t.startsWith("data"))return[t];if(t.startsWith(M9))return[];if(t.startsWith("http"))return[new URL(t)];const n=t.replace(/^\/+/,""),i=[];if(typeof window.EXCALIDRAW_ASSET_PATH=="string"){const s=this.normalizeBaseUrl(window.EXCALIDRAW_ASSET_PATH);i.push(new URL(n,s))}else Array.isArray(window.EXCALIDRAW_ASSET_PATH)&&window.EXCALIDRAW_ASSET_PATH.forEach(s=>{const r=this.normalizeBaseUrl(s);i.push(new URL(n,r))});return i.push(new URL(n,Eh.ASSETS_FALLBACK_URL)),i}static getFormat(t){if(!(t instanceof URL))return"";try{const n=new URL(t).pathname.split(".");return n.length===1?"":`format('${n.pop()}')`}catch{return""}}static normalizeBaseUrl(t){var i;let n=t;return/^\.?\//.test(n)&&(n=new URL(n.replace(/^\.?\/+/,""),(i=window==null?void 0:window.location)==null?void 0:i.origin).toString()),n=`${n.replace(/\/+$/,"")}/`,n}};B(Eh,"ASSETS_FALLBACK_URL",`https://esm.sh/${d7.PKG_NAME?`${d7.PKG_NAME}@${d7.PKG_VERSION}`:"@excalidraw/excalidraw"}/dist/prod/`);let w_=Eh;const SUe="/fonts/Excalifont/Excalifont-Regular-349fac6ca4700ffec595a7150a0d1e1d.woff2",CUe="/fonts/Excalifont/Excalifont-Regular-3f2c5db56cc93c5a6873b1361d730c16.woff2",xUe="/fonts/Excalifont/Excalifont-Regular-41b173a47b57366892116a575a43e2b6.woff2",AUe="/fonts/Excalifont/Excalifont-Regular-623ccf21b21ef6b3a0d87738f77eb071.woff2",MUe="/fonts/Excalifont/Excalifont-Regular-a88b72a24fb54c9f94e3b5fdaa7481c9.woff2",kUe="/fonts/Excalifont/Excalifont-Regular-b9dcf9d2e50a1eaf42fc664b50a3fd0d.woff2",RUe="/fonts/Excalifont/Excalifont-Regular-be310b9bcd4f1a43f571c46df7809174.woff2",DUe=[{uri:MUe,descriptors:{unicodeRange:"U+20-7e,U+a0-a3,U+a5-a6,U+a8-ab,U+ad-b1,U+b4,U+b6-b8,U+ba-ff,U+131,U+152-153,U+2bc,U+2c6,U+2da,U+2dc,U+304,U+308,U+2013-2014,U+2018-201a,U+201c-201e,U+2020,U+2022,U+2024-2026,U+2030,U+2039-203a,U+20ac,U+2122,U+2212"}},{uri:RUe,descriptors:{unicodeRange:"U+100-130,U+132-137,U+139-149,U+14c-151,U+154-17e,U+192,U+1fc-1ff,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+2113"}},{uri:kUe,descriptors:{unicodeRange:"U+400-45f,U+490-491,U+2116"}},{uri:xUe,descriptors:{unicodeRange:"U+37e,U+384-38a,U+38c,U+38e-393,U+395-3a1,U+3a3-3a8,U+3aa-3cf,U+3d7"}},{uri:CUe,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+302,U+306-307,U+30a-30c,U+326-328,U+212e,U+2211,U+fb01-fb02"}},{uri:SUe,descriptors:{unicodeRange:"U+462-463,U+472-475,U+4d8-4d9,U+4e2-4e3,U+4e6-4e9,U+4ee-4ef"}},{uri:AUe,descriptors:{unicodeRange:"U+300-301,U+303"}}],LUe=[{uri:M9}],PUe="/fonts/LiberationSans/LiberationSans-Regular.woff2",NUe=[{uri:PUe}],OUe="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYE98RXi4EwSsbg.woff2",FUe="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYEF8RXi4EwQ.woff2",BUe=[{uri:OUe,descriptors:{unicodeRange:Kd.LATIN_EXT}},{uri:FUe,descriptors:{unicodeRange:Kd.LATIN}}],zUe="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTA3j6zbXWjgevT5.woff2",HUe="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTQ3j6zbXWjgeg.woff2",VUe="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTk3j6zbXWjgevT5.woff2",$Ue="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTo3j6zbXWjgevT5.woff2",GUe="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTs3j6zbXWjgevT5.woff2",XUe=[{uri:VUe,descriptors:{unicodeRange:Kd.CYRILIC_EXT,weight:"500"}},{uri:zUe,descriptors:{unicodeRange:Kd.CYRILIC,weight:"500"}},{uri:GUe,descriptors:{unicodeRange:Kd.VIETNAMESE,weight:"500"}},{uri:$Ue,descriptors:{unicodeRange:Kd.LATIN_EXT,weight:"500"}},{uri:HUe,descriptors:{unicodeRange:Kd.LATIN,weight:"500"}}],jUe="/fonts/Virgil/Virgil-Regular.woff2",YUe=[{uri:jUe}],WUe="/fonts/Xiaolai/Xiaolai-Regular-019d66dcad46dc156b162d267f981c20.woff2",KUe="/fonts/Xiaolai/Xiaolai-Regular-04b718e5623574919c8b0dea5f301444.woff2",ZUe="/fonts/Xiaolai/Xiaolai-Regular-069e77aac84590e2e991d0a0176d34f2.woff2",qUe="/fonts/Xiaolai/Xiaolai-Regular-06c77b8c66e51ed6c63ccb502dd8b8af.woff2",QUe="/fonts/Xiaolai/Xiaolai-Regular-08e0dc436ad0ad61ba5558db0674d762.woff2",JUe="/fonts/Xiaolai/Xiaolai-Regular-093b9ef39a46ceae95a1df18a0a3a326.woff2",ebe="/fonts/Xiaolai/Xiaolai-Regular-095c169f3314805276f603a362766abd.woff2",tbe="/fonts/Xiaolai/Xiaolai-Regular-09850c4077f3fffe707905872e0e2460.woff2",nbe="/fonts/Xiaolai/Xiaolai-Regular-41521fade99856108931b4768b1b2648.woff2",ibe="/fonts/Xiaolai/Xiaolai-Regular-544fc28abe2c5c30e62383fd4dac255f.woff2",sbe="/fonts/Xiaolai/Xiaolai-Regular-60a3089806700d379f11827ee9843b6b.woff2",rbe="/fonts/Xiaolai/Xiaolai-Regular-7eb9fffd1aa890d07d0f88cc82e6cfe4.woff2",obe="/fonts/Xiaolai/Xiaolai-Regular-6fe5c5973cc06f74b2387a631ea36b88.woff2",abe="/fonts/Xiaolai/Xiaolai-Regular-a4c34be6d42152e64b0df90bc4607f64.woff2",lbe="/fonts/Xiaolai/Xiaolai-Regular-b96d9226ce77ec94ceca043d712182e6.woff2",cbe="/fonts/Xiaolai/Xiaolai-Regular-6ae5b42180ad70b971c91e7eefb8eba2.woff2",dbe="/fonts/Xiaolai/Xiaolai-Regular-c69f61a4ab18d0488c8d1fc12e7028e8.woff2",ube="/fonts/Xiaolai/Xiaolai-Regular-cb17fc3db95f6d139afc9d31a8e93293.woff2",fbe="/fonts/Xiaolai/Xiaolai-Regular-e3fcf5180fd466c8915c4e8069491054.woff2",hbe="/fonts/Xiaolai/Xiaolai-Regular-c1f94158256bb1f3bf665b053d895af9.woff2",gbe="/fonts/Xiaolai/Xiaolai-Regular-7197d6fda6cba7c3874c53d6381ca239.woff2",mbe="/fonts/Xiaolai/Xiaolai-Regular-70c2eb8d64e71a42a834eb857ea9df51.woff2",pbe="/fonts/Xiaolai/Xiaolai-Regular-a004ddfcb26e67bd6e678c8ed19e25ce.woff2",Ube="/fonts/Xiaolai/Xiaolai-Regular-7e4bde7e9c7f84cd34d8a845e384c746.woff2",bbe="/fonts/Xiaolai/Xiaolai-Regular-23686f7f29da6e8008c36dd3a80c83d6.woff2",ybe="/fonts/Xiaolai/Xiaolai-Regular-69c09cc5fa3e55c74fc4821f76909cc3.woff2",Ebe="/fonts/Xiaolai/Xiaolai-Regular-25b7f38e18f035f96cb5e547bd2bd08c.woff2",vbe="/fonts/Xiaolai/Xiaolai-Regular-ba3de316d63c7e339987b16f41a0b879.woff2",_be="/fonts/Xiaolai/Xiaolai-Regular-12b52b58eb3df36804b9a654ec9ee194.woff2",wbe="/fonts/Xiaolai/Xiaolai-Regular-b1220a3c61f85cc0408deedb4c5f57a2.woff2",Tbe="/fonts/Xiaolai/Xiaolai-Regular-4535823663ad81405188a528d8f2b1a2.woff2",Ibe="/fonts/Xiaolai/Xiaolai-Regular-3eaa538115d76932653c21d8dc28f207.woff2",Sbe="/fonts/Xiaolai/Xiaolai-Regular-7e929f262f30c8ee78bf398150b1a7cd.woff2",Cbe="/fonts/Xiaolai/Xiaolai-Regular-73e309718fd16cea44b4d54a33581811.woff2",xbe="/fonts/Xiaolai/Xiaolai-Regular-9eb5a99df4e76ac3363453ac9ca288b1.woff2",Abe="/fonts/Xiaolai/Xiaolai-Regular-3e63ed8162808a9e425ed80a8bc79114.woff2",Mbe="/fonts/Xiaolai/Xiaolai-Regular-c8b71798409ccc126ee264a00aadcf21.woff2",kbe="/fonts/Xiaolai/Xiaolai-Regular-11c345711937f0ba4b8f7b6b919c8440.woff2",Rbe="/fonts/Xiaolai/Xiaolai-Regular-e480d9c614742d05f0e78f274f1e69e6.woff2",Dbe="/fonts/Xiaolai/Xiaolai-Regular-95429962233afd82db1c27df1500a28c.woff2",Lbe="/fonts/Xiaolai/Xiaolai-Regular-2cf96d082d35ea3d8106851223ad0d16.woff2",Pbe="/fonts/Xiaolai/Xiaolai-Regular-2d43040e86ff03ba677f6f9c04cd0805.woff2",Nbe="/fonts/Xiaolai/Xiaolai-Regular-2a26d20a23b00898ce82f09d2ee47c3f.woff2",Obe="/fonts/Xiaolai/Xiaolai-Regular-a365e82ed54697a52f27adcea1315fe8.woff2",Fbe="/fonts/Xiaolai/Xiaolai-Regular-e4bca6cfa53e499cae0a6be4894a90e9.woff2",Bbe="/fonts/Xiaolai/Xiaolai-Regular-e51ef413167c6e14e0c0fdcc585f2fc9.woff2",zbe="/fonts/Xiaolai/Xiaolai-Regular-e5f453bb04da18eed01675eeebd88bf8.woff2",Hbe="/fonts/Xiaolai/Xiaolai-Regular-e656f091b9dc4709722c9f4b84d3c797.woff2",Vbe="/fonts/Xiaolai/Xiaolai-Regular-f0f13b5c60e0af5553bd359f5513be1b.woff2",$be="/fonts/Xiaolai/Xiaolai-Regular-f5d079153c99a25b9be5b8583c4cc8a7.woff2",Gbe="/fonts/Xiaolai/Xiaolai-Regular-10a7ae9a371830a80c3d844acf1c02d7.woff2",Xbe="/fonts/Xiaolai/Xiaolai-Regular-60a41c7e1c68f22424e6d22df544bc82.woff2",jbe="/fonts/Xiaolai/Xiaolai-Regular-7ab2bed91166a9dca83a5ebfbe2a7f38.woff2",Ybe="/fonts/Xiaolai/Xiaolai-Regular-670ba603758d94268e8606f240a42e12.woff2",Wbe="/fonts/Xiaolai/Xiaolai-Regular-15dc6d811c9cd078f9086a740d5a1038.woff2",Kbe="/fonts/Xiaolai/Xiaolai-Regular-8c2f33cee3993174f7e87c28e4bf42ee.woff2",Zbe="/fonts/Xiaolai/Xiaolai-Regular-761d05e3cd968cf574166867998ef06a.woff2",qbe="/fonts/Xiaolai/Xiaolai-Regular-642b26e2e5f5fb780b51b593dbc8c851.woff2",Qbe="/fonts/Xiaolai/Xiaolai-Regular-5572b3513ba8df57a3d5d7303ee6b11b.woff2",Jbe="/fonts/Xiaolai/Xiaolai-Regular-3c9de2ae0ea4bc91a510942dfa4be8d2.woff2",e6e="/fonts/Xiaolai/Xiaolai-Regular-671a2c20b1eb9e4ef8a192833940e319.woff2",t6e="/fonts/Xiaolai/Xiaolai-Regular-4dc6d5f188d5c96d44815cd1e81aa885.woff2",n6e="/fonts/Xiaolai/Xiaolai-Regular-ce4884f96f11589608b76b726a755803.woff2",i6e="/fonts/Xiaolai/Xiaolai-Regular-8f476c4c99813d57cbe6eca4727388ad.woff2",s6e="/fonts/Xiaolai/Xiaolai-Regular-5935a5775af3d5c6307ac667bd9ae74e.woff2",r6e="/fonts/Xiaolai/Xiaolai-Regular-79f007c1c6d07557120982951ea67998.woff2",o6e="/fonts/Xiaolai/Xiaolai-Regular-bafff7a14c27403dcc6cf1432e8ea836.woff2",a6e="/fonts/Xiaolai/Xiaolai-Regular-543fa46ace099a7099dad69123399400.woff2",l6e="/fonts/Xiaolai/Xiaolai-Regular-4ddc14ed3eb0c3e46364317dfc0144a3.woff2",c6e="/fonts/Xiaolai/Xiaolai-Regular-0fa55a080fcd0f9dc2e0b0058b793df8.woff2",d6e="/fonts/Xiaolai/Xiaolai-Regular-66493ba5a8367f2928812f446f47b56a.woff2",u6e="/fonts/Xiaolai/Xiaolai-Regular-57862b464a55b18c7bf234ce22907d73.woff2",f6e="/fonts/Xiaolai/Xiaolai-Regular-8d3bcabb847b56243b16afe62adaaf21.woff2",h6e="/fonts/Xiaolai/Xiaolai-Regular-2b77e8ebfb2367ab2662396a60e7d320.woff2",g6e="/fonts/Xiaolai/Xiaolai-Regular-0b5d723fdc4e249c140f0909e87d03b4.woff2",m6e="/fonts/Xiaolai/Xiaolai-Regular-cdbce89e82cc1ab53a2decbf5819278f.woff2",p6e="/fonts/Xiaolai/Xiaolai-Regular-739bc1a567439c7cffcd1614644593d2.woff2",U6e="/fonts/Xiaolai/Xiaolai-Regular-72252d73220fa3cd856677888cee1635.woff2",b6e="/fonts/Xiaolai/Xiaolai-Regular-cf6ff4e0f491ca0cf3038187a997b9b4.woff2",y6e="/fonts/Xiaolai/Xiaolai-Regular-9cfb2a77a4e45025105ad29a1748b90d.woff2",E6e="/fonts/Xiaolai/Xiaolai-Regular-450da755d5bcb70906e1295e559b9602.woff2",v6e="/fonts/Xiaolai/Xiaolai-Regular-0986d134c05864f5025962eef9f994a0.woff2",_6e="/fonts/Xiaolai/Xiaolai-Regular-1ee544f0f1dac422545c505baa788992.woff2",w6e="/fonts/Xiaolai/Xiaolai-Regular-4806e761d750087c2d734fc64596eaff.woff2",T6e="/fonts/Xiaolai/Xiaolai-Regular-33432927cd87d40cfe393c7482bf221f.woff2",I6e="/fonts/Xiaolai/Xiaolai-Regular-be549ab72f0719d606a5c01e2c0219b6.woff2",S6e="/fonts/Xiaolai/Xiaolai-Regular-b5c1596551c256e0e9cf02028595b092.woff2",C6e="/fonts/Xiaolai/Xiaolai-Regular-cf2cc71752631e579e35b0e423bf2638.woff2",x6e="/fonts/Xiaolai/Xiaolai-Regular-6f3256af8454371776bc46670d33cc65.woff2",A6e="/fonts/Xiaolai/Xiaolai-Regular-23f228f3999c01983860012330e4be08.woff2",M6e="/fonts/Xiaolai/Xiaolai-Regular-21430ee05a1248901da8d0de08744d47.woff2",k6e="/fonts/Xiaolai/Xiaolai-Regular-5330a2119a716e4e7224ed108b085dac.woff2",R6e="/fonts/Xiaolai/Xiaolai-Regular-cd145ce4a0ea18469358df53c207bc1b.woff2",D6e="/fonts/Xiaolai/Xiaolai-Regular-36925dfe329a45086cbb7fc5c20d45ac.woff2",L6e="/fonts/Xiaolai/Xiaolai-Regular-4bfaa8ffa64c5ee560aa2daba7c9cbd3.woff2",P6e="/fonts/Xiaolai/Xiaolai-Regular-112c051027b2d766c19a519f6ee1f4f7.woff2",N6e="/fonts/Xiaolai/Xiaolai-Regular-5b0ed6971aaab9c8ad563230bd5471a7.woff2",O6e="/fonts/Xiaolai/Xiaolai-Regular-98f2ad84457de7f3740d9920b8fa8667.woff2",F6e="/fonts/Xiaolai/Xiaolai-Regular-733171b4ffcd17ea1fe1c0ba627173bf.woff2",B6e="/fonts/Xiaolai/Xiaolai-Regular-684d65f1793cac449dde5d59cb3c47fb.woff2",z6e="/fonts/Xiaolai/Xiaolai-Regular-cbaaefaaf326668277aa24dfa93c4d28.woff2",H6e="/fonts/Xiaolai/Xiaolai-Regular-58fd02350d0bc52cf1ca3bb32ce9766e.woff2",V6e="/fonts/Xiaolai/Xiaolai-Regular-7ccce86603f80a099ddb0cb21d4ae3e3.woff2",$6e="/fonts/Xiaolai/Xiaolai-Regular-3717077e38f98d89eae729b6c14e56dc.woff2",G6e="/fonts/Xiaolai/Xiaolai-Regular-dbea1af6dcd9860be40c3d18254338f5.woff2",X6e="/fonts/Xiaolai/Xiaolai-Regular-4a0fdb40036e87b40aa08dd30584cb85.woff2",j6e="/fonts/Xiaolai/Xiaolai-Regular-0f626226ba1272e832aea87bafd9720e.woff2",Y6e="/fonts/Xiaolai/Xiaolai-Regular-938d90c10ff8c20386af7f242c05d6b0.woff2",W6e="/fonts/Xiaolai/Xiaolai-Regular-b6d128682ee29e471486354d486a1b90.woff2",K6e="/fonts/Xiaolai/Xiaolai-Regular-9d81066dd2b337c938df6e90380a00dc.woff2",Z6e="/fonts/Xiaolai/Xiaolai-Regular-20e7bf72fa05de9adf7dbcc7bf51dde6.woff2",q6e="/fonts/Xiaolai/Xiaolai-Regular-4095eb84ef3874e2600247bee0b04026.woff2",Q6e="/fonts/Xiaolai/Xiaolai-Regular-4ee10ae43505e2e0bc62656ced49c0fa.woff2",J6e="/fonts/Xiaolai/Xiaolai-Regular-7494dc504ae00ee9cd0505f990f88c5d.woff2",e5e="/fonts/Xiaolai/Xiaolai-Regular-8de5b863cb50dfefdd07cb11c774d579.woff2",t5e="/fonts/Xiaolai/Xiaolai-Regular-3e1f8f654357353bf0e04ba5c34b5f7f.woff2",n5e="/fonts/Xiaolai/Xiaolai-Regular-2e33e8dc771ef5e1d9127d60a6b73679.woff2",i5e="/fonts/Xiaolai/Xiaolai-Regular-173945821411c09f70c95f98d590e697.woff2",s5e="/fonts/Xiaolai/Xiaolai-Regular-b358f7a51ece39a3247942b1feabdb29.woff2",r5e="/fonts/Xiaolai/Xiaolai-Regular-23ad2d71b280f00b1363b95b7bea94eb.woff2",o5e="/fonts/Xiaolai/Xiaolai-Regular-5882ffa04f32584d26109137e2da4352.woff2",a5e="/fonts/Xiaolai/Xiaolai-Regular-a203b91dad570bf05a58c3c3ddb529bf.woff2",l5e="/fonts/Xiaolai/Xiaolai-Regular-bd77e3c7f9e0b072d96af37f73d1aa32.woff2",c5e="/fonts/Xiaolai/Xiaolai-Regular-5a45d991244d4c7140217e1e5f5ca4f4.woff2",d5e="/fonts/Xiaolai/Xiaolai-Regular-f56414bf9bced67990def8660e306759.woff2",u5e="/fonts/Xiaolai/Xiaolai-Regular-583d166e56ba0de4b77eabb47ef67839.woff2",f5e="/fonts/Xiaolai/Xiaolai-Regular-7f855356ab893b0d2b9c1c83b8116f0e.woff2",h5e="/fonts/Xiaolai/Xiaolai-Regular-b57aaedfd8ebdf3931f25119dc6a5eb2.woff2",g5e="/fonts/Xiaolai/Xiaolai-Regular-b6fd38ca30869792244804b04bc058da.woff2",m5e="/fonts/Xiaolai/Xiaolai-Regular-452225341522a7942f0f6aab1a5c91a3.woff2",p5e="/fonts/Xiaolai/Xiaolai-Regular-866fa7613df6b3fd272bcfd4530c0bb9.woff2",U5e="/fonts/Xiaolai/Xiaolai-Regular-52a84a22fd1369bffeaf21da2d6158dc.woff2",b5e="/fonts/Xiaolai/Xiaolai-Regular-829615148e6357d826b9242eb7fbbd1e.woff2",y5e="/fonts/Xiaolai/Xiaolai-Regular-c99eda15fc26a2941579560f76c3a5cf.woff2",E5e="/fonts/Xiaolai/Xiaolai-Regular-395c35dd584b56b0789f58a0559beaf1.woff2",v5e="/fonts/Xiaolai/Xiaolai-Regular-203b0e569e3b14aac86a003dc3fa523e.woff2",_5e="/fonts/Xiaolai/Xiaolai-Regular-51a0e808bbc8361236ac521a119758a3.woff2",w5e="/fonts/Xiaolai/Xiaolai-Regular-6e092f71c1e634059ada0e52abadce67.woff2",T5e="/fonts/Xiaolai/Xiaolai-Regular-0f7fb1e0d5015bb1371343153ecf7ce3.woff2",I5e="/fonts/Xiaolai/Xiaolai-Regular-d0cf73942fea1c74edbdf0b3011f4656.woff2",S5e="/fonts/Xiaolai/Xiaolai-Regular-968cffdc8ee679da094e77ebf50f58ef.woff2",C5e="/fonts/Xiaolai/Xiaolai-Regular-7a07ddc0f0c0f5f4a9bad6ee3dda66b5.woff2",x5e="/fonts/Xiaolai/Xiaolai-Regular-ec181b795ac1fb5a50d700b6e996d745.woff2",A5e="/fonts/Xiaolai/Xiaolai-Regular-cfb211578629b7e8153b37240de6a9d5.woff2",M5e="/fonts/Xiaolai/Xiaolai-Regular-59e9ff77b0efaf684bc09274fb6908c9.woff2",k5e="/fonts/Xiaolai/Xiaolai-Regular-2adbc89c11e65905393d3dfc468b9d5b.woff2",R5e="/fonts/Xiaolai/Xiaolai-Regular-70e811fd7994e61f408c923de6ddd078.woff2",D5e="/fonts/Xiaolai/Xiaolai-Regular-c4a687ac4f0c2766eefc9f77ed99cddf.woff2",L5e="/fonts/Xiaolai/Xiaolai-Regular-51502f1206be09c565f1547c406e9558.woff2",P5e="/fonts/Xiaolai/Xiaolai-Regular-1fdc0c67ed57263a80fd108c1f6ccf24.woff2",N5e="/fonts/Xiaolai/Xiaolai-Regular-e11567fd2accf9957cd0d3c2be937d87.woff2",O5e="/fonts/Xiaolai/Xiaolai-Regular-20cc1bbf50e7efb442756cb605672c1f.woff2",F5e="/fonts/Xiaolai/Xiaolai-Regular-5d2898fbc097a7e24c6f38d80587621e.woff2",B5e="/fonts/Xiaolai/Xiaolai-Regular-ac9ceb44437becc3e9c4dbfebab7fc2d.woff2",z5e="/fonts/Xiaolai/Xiaolai-Regular-c16ed9740b85badf16e86ea782a3062f.woff2",H5e="/fonts/Xiaolai/Xiaolai-Regular-aa0d470430e6391eca720c7cfa44446f.woff2",V5e="/fonts/Xiaolai/Xiaolai-Regular-f2b54d4e7be0eaefe1c2c56836fa5368.woff2",$5e="/fonts/Xiaolai/Xiaolai-Regular-99a16ef6a64934d5781933dbd9c46b2e.woff2",G5e="/fonts/Xiaolai/Xiaolai-Regular-c40533fdf4cc57177b12803598af7e59.woff2",X5e="/fonts/Xiaolai/Xiaolai-Regular-91ddb2969bf2d31ba02ad82998d1314c.woff2",j5e="/fonts/Xiaolai/Xiaolai-Regular-774d4f764a1299da5d28ec2f2ffe0d69.woff2",Y5e="/fonts/Xiaolai/Xiaolai-Regular-7718fe60986d8b42b1be9c5ace5ccf25.woff2",W5e="/fonts/Xiaolai/Xiaolai-Regular-aa5c9ca6cf4fba00433b7aa3fa10671a.woff2",K5e="/fonts/Xiaolai/Xiaolai-Regular-4f50e5136e136527280bc902c5817561.woff2",Z5e="/fonts/Xiaolai/Xiaolai-Regular-a0ca5df4258213d7fc9fce80f65ce760.woff2",q5e="/fonts/Xiaolai/Xiaolai-Regular-d2666cbed13462c5dc36fa2f15c202ca.woff2",Q5e="/fonts/Xiaolai/Xiaolai-Regular-1e6fd68f1f3902ce48ce8c69df385622.woff2",J5e="/fonts/Xiaolai/Xiaolai-Regular-87599f94b6cc129d505b375798d0d751.woff2",eye="/fonts/Xiaolai/Xiaolai-Regular-13ae07ed2e272d26d59bc0691cd7117a.woff2",tye="/fonts/Xiaolai/Xiaolai-Regular-353f33792a8f60dc69323ddf635a269e.woff2",nye="/fonts/Xiaolai/Xiaolai-Regular-0facdf1ea213ba40261022f5d5ed4493.woff2",iye="/fonts/Xiaolai/Xiaolai-Regular-f6032fc06eb20480f096199713f70885.woff2",sye="/fonts/Xiaolai/Xiaolai-Regular-f8ee5d36068a42b51d0e4a1116cfcec1.woff2",rye="/fonts/Xiaolai/Xiaolai-Regular-79d494361ae093b69e74ee9dbe65bfd4.woff2",oye="/fonts/Xiaolai/Xiaolai-Regular-74e2263a91439c25b91d5132ce9f4d62.woff2",aye="/fonts/Xiaolai/Xiaolai-Regular-ee8bae97908d5147b423f77ad0d3c1bb.woff2",lye="/fonts/Xiaolai/Xiaolai-Regular-56467a5c8840c4d23a60b2f935114848.woff2",cye="/fonts/Xiaolai/Xiaolai-Regular-145aa02cdd91946e67dc934e1acffe75.woff2",dye="/fonts/Xiaolai/Xiaolai-Regular-54acdfc2166ad7fcbd074f75fd4a56ba.woff2",uye="/fonts/Xiaolai/Xiaolai-Regular-29cec36cd205b211da97acabaa62f055.woff2",fye="/fonts/Xiaolai/Xiaolai-Regular-3756e81d3e149cf6099163ee79944fec.woff2",hye="/fonts/Xiaolai/Xiaolai-Regular-8e9f97f01034820170065b2921b4fb5e.woff2",gye="/fonts/Xiaolai/Xiaolai-Regular-13d2887ec8ee73c43acdabc52a05af7b.woff2",mye="/fonts/Xiaolai/Xiaolai-Regular-72536a3d71b694a0d53dd90ddceae41e.woff2",pye="/fonts/Xiaolai/Xiaolai-Regular-603aefd23e350ba7eb124273e3c9bcf1.woff2",Uye="/fonts/Xiaolai/Xiaolai-Regular-9544732d2e62d1a429674f8ee41b5d3a.woff2",bye="/fonts/Xiaolai/Xiaolai-Regular-d3716376641d615e2995605b29bca7b6.woff2",yye="/fonts/Xiaolai/Xiaolai-Regular-5a1ce3117cfe90c48e8fb4a9a00f694d.woff2",Eye="/fonts/Xiaolai/Xiaolai-Regular-b7d203b051eff504ff59ddca7576b6a9.woff2",vye="/fonts/Xiaolai/Xiaolai-Regular-4a38cc3e9cf104e69ba246d37f8cf135.woff2",_ye="/fonts/Xiaolai/Xiaolai-Regular-982b630266d87db93d2539affb1275c6.woff2",wye="/fonts/Xiaolai/Xiaolai-Regular-9592bfc861f07bcb8d75c196b370e548.woff2",Tye="/fonts/Xiaolai/Xiaolai-Regular-a7accba310e821da5505f71c03b76bdb.woff2",Iye="/fonts/Xiaolai/Xiaolai-Regular-dac48066b5883d8b4551fc584f0c2a3e.woff2",Sye="/fonts/Xiaolai/Xiaolai-Regular-a1f916d6039285c4ffb900cd654e418f.woff2",Cye="/fonts/Xiaolai/Xiaolai-Regular-95bfd249da4902577b4b7d76ebdd0b44.woff2",xye="/fonts/Xiaolai/Xiaolai-Regular-93fc8f28a33234bcadf1527cafabd502.woff2",Aye="/fonts/Xiaolai/Xiaolai-Regular-903bb6865f3452e2fda42e3a25547bc5.woff2",Mye="/fonts/Xiaolai/Xiaolai-Regular-4aca6a43e59aceee2166b0c7e4e85ef1.woff2",kye="/fonts/Xiaolai/Xiaolai-Regular-24476a126f129212beb33f66853ea151.woff2",Rye="/fonts/Xiaolai/Xiaolai-Regular-1b611157cd46bb184d4fa4dae2d6a2b8.woff2",Dye="/fonts/Xiaolai/Xiaolai-Regular-56a32a7689abd0326e57c10c6c069bb4.woff2",Lye="/fonts/Xiaolai/Xiaolai-Regular-3cc70dbb64df5b21f1326cc24dee2195.woff2",Pye="/fonts/Xiaolai/Xiaolai-Regular-e2ead7ea7da0437f085f42ffc05f8d13.woff2",Nye="/fonts/Xiaolai/Xiaolai-Regular-97f7f48ce90c9429bf32ae51469db74d.woff2",Oye="/fonts/Xiaolai/Xiaolai-Regular-24a21c1e4449222e8d1898d69ff3a404.woff2",Fye="/fonts/Xiaolai/Xiaolai-Regular-726303e0774b4e678bff8c2deb6ca603.woff2",Bye="/fonts/Xiaolai/Xiaolai-Regular-5a7fac4b8b23a6e4e5ba0c9bf1756c91.woff2",zye="/fonts/Xiaolai/Xiaolai-Regular-2b7441d46298788ac94e610ffcc709b6.woff2",Hye=[{uri:tbe,descriptors:{unicodeRange:"U+f9b8-fa6d,U+fe32,U+fe45-fe4f,U+ff02-ff0b,U+ff0d-ff1e,U+ff20-ff2a"}},{uri:rbe,descriptors:{unicodeRange:"U+20dd-20de,U+25ef,U+ff2b-ffbe,U+ffc2-ffc7,U+ffca-ffcf,U+ffd2-ffd7,U+ffda-ffdc,U+ffe0-ffe6,U+ffe8-ffee"}},{uri:sbe,descriptors:{unicodeRange:"U+d7eb-d7fb,U+f900-f9b7"}},{uri:obe,descriptors:{unicodeRange:"U+d6f2-d7a3,U+d7b0-d7c6,U+d7cb-d7ea"}},{uri:lbe,descriptors:{unicodeRange:"U+d609-d6f1"}},{uri:cbe,descriptors:{unicodeRange:"U+d520-d608"}},{uri:abe,descriptors:{unicodeRange:"U+d437-d51f"}},{uri:dbe,descriptors:{unicodeRange:"U+d34e-d436"}},{uri:fbe,descriptors:{unicodeRange:"U+d265-d34d"}},{uri:hbe,descriptors:{unicodeRange:"U+d17c-d264"}},{uri:ibe,descriptors:{unicodeRange:"U+d093-d17b"}},{uri:gbe,descriptors:{unicodeRange:"U+cfaa-d092"}},{uri:mbe,descriptors:{unicodeRange:"U+cec1-cfa9"}},{uri:ZUe,descriptors:{unicodeRange:"U+cdd8-cec0"}},{uri:nbe,descriptors:{unicodeRange:"U+ccf1-cdd7"}},{uri:pbe,descriptors:{unicodeRange:"U+cc08-ccf0"}},{uri:KUe,descriptors:{unicodeRange:"U+cb43-cc07"}},{uri:Ube,descriptors:{unicodeRange:"U+ca83-cb42"}},{uri:bbe,descriptors:{unicodeRange:"U+c9a1-ca82"}},{uri:ybe,descriptors:{unicodeRange:"U+c8b8-c9a0"}},{uri:Ebe,descriptors:{unicodeRange:"U+c7cf-c8b7"}},{uri:vbe,descriptors:{unicodeRange:"U+c6e6-c7ce"}},{uri:_be,descriptors:{unicodeRange:"U+c5fd-c6e5"}},{uri:wbe,descriptors:{unicodeRange:"U+c514-c5fc"}},{uri:Tbe,descriptors:{unicodeRange:"U+c42b-c513"}},{uri:Ibe,descriptors:{unicodeRange:"U+c341-c34e,U+c350-c42a"}},{uri:Sbe,descriptors:{unicodeRange:"U+c258-c340"}},{uri:Cbe,descriptors:{unicodeRange:"U+c16f-c257"}},{uri:xbe,descriptors:{unicodeRange:"U+c086-c16e"}},{uri:Abe,descriptors:{unicodeRange:"U+bf9d-c085"}},{uri:ube,descriptors:{unicodeRange:"U+beb4-bf9c"}},{uri:Mbe,descriptors:{unicodeRange:"U+bdcb-beb3"}},{uri:kbe,descriptors:{unicodeRange:"U+bce2-bdca"}},{uri:Rbe,descriptors:{unicodeRange:"U+bbf9-bce1"}},{uri:Dbe,descriptors:{unicodeRange:"U+bb10-bbf8"}},{uri:Lbe,descriptors:{unicodeRange:"U+ba27-bb0f"}},{uri:Pbe,descriptors:{unicodeRange:"U+b93e-ba26"}},{uri:Nbe,descriptors:{unicodeRange:"U+b855-b93d"}},{uri:Obe,descriptors:{unicodeRange:"U+b76c-b854"}},{uri:$be,descriptors:{unicodeRange:"U+b683-b76b"}},{uri:Gbe,descriptors:{unicodeRange:"U+b59a-b682"}},{uri:Fbe,descriptors:{unicodeRange:"U+b4b1-b599"}},{uri:Xbe,descriptors:{unicodeRange:"U+11fb-11ff,U+b3cd-b4b0"}},{uri:jbe,descriptors:{unicodeRange:"U+11e6-11fa,U+b2f9-b3cc"}},{uri:Ybe,descriptors:{unicodeRange:"U+11d1-11e5,U+b225-b2f8"}},{uri:Hbe,descriptors:{unicodeRange:"U+11bc-11d0,U+b151-b224"}},{uri:Wbe,descriptors:{unicodeRange:"U+11a7-11bb,U+b07d-b150"}},{uri:Vbe,descriptors:{unicodeRange:"U+1191-11a6,U+afaa-b07c"}},{uri:Kbe,descriptors:{unicodeRange:"U+117c-1190,U+aed6-afa9"}},{uri:Zbe,descriptors:{unicodeRange:"U+1167-117b,U+ae02-aed5"}},{uri:qbe,descriptors:{unicodeRange:"U+1152-115e,U+1160-1166,U+ad2d-ae01"}},{uri:Qbe,descriptors:{unicodeRange:"U+113d-1151,U+ac59-ad2c"}},{uri:Jbe,descriptors:{unicodeRange:"U+1100-113c,U+9f95-9f98,U+9f9c-9f9e,U+9fa1-9fce,U+9fd0,U+a960-a97c,U+ac00-ac58"}},{uri:e6e,descriptors:{unicodeRange:"U+9771-9772,U+9775,U+9777-977b,U+977d-9784,U+9786-978a,U+978c,U+978e-9790,U+9793,U+9795-9797,U+9799-979f,U+97a1-97a2,U+97a4-97aa,U+97ac,U+97ae,U+97b0-97b1,U+97b3,U+97b5-97e5,U+97e8,U+97ee-97f2,U+97f4,U+97f7-982d"}},{uri:t6e,descriptors:{unicodeRange:"U+9491,U+9496,U+9498,U+94c7,U+94cf,U+94d3-94d4,U+94da,U+94e6,U+94fb,U+951c,U+9520,U+9527,U+9533,U+953d,U+9543,U+9548,U+954b,U+9555,U+955a,U+9560,U+956e,U+9574-9575,U+9577-957e,U+9580-95e7,U+95ec,U+95ff,U+9607,U+9613,U+9618,U+961b,U+961e,U+9620,U+9623-9629,U+962b-962d,U+962f-9630,U+9637-963a,U+963e,U+9641,U+9643,U+964a,U+964e-964f,U+9651-9653,U+9656-965a,U+965c-965e,U+9660,U+9663,U+9665-9666,U+966b,U+966d-9671,U+9673,U+9678-9684,U+9687,U+9689-968a,U+968c,U+968e,U+9691-9693"}},{uri:n6e,descriptors:{unicodeRange:"U+923c-9273,U+9275-928d,U+928f-92ad,U+92af-92c7,U+92c9-92ee"}},{uri:i6e,descriptors:{unicodeRange:"U+9159,U+915b-915c,U+915f-9160,U+9166-9168,U+916b,U+916d,U+9173,U+917a-917c,U+9180-9184,U+9186,U+9188,U+918a,U+918e-918f,U+9193-9199,U+919c-91a1,U+91a4-91a9,U+91ab-91ac,U+91b0-91b3,U+91b6-91b9,U+91bb-91c6,U+91c8,U+91cb,U+91d0,U+91d2-91db,U+91dd-923b"}},{uri:s6e,descriptors:{unicodeRange:"U+902b-902c,U+9030-9034,U+9037,U+9039-903a,U+903d,U+903f-9040,U+9043,U+9045-9046,U+9048-904c,U+904e,U+9054-9056,U+9059-905a,U+905c-9061,U+9064,U+9066-9067,U+9069-906c,U+906f-9073,U+9076-907c,U+907e,U+9081,U+9084-9087,U+9089-908a,U+908c-9090,U+9092,U+9094,U+9096,U+9098,U+909a,U+909c,U+909e-90a0,U+90a4-90a5,U+90a7-90a9,U+90ab,U+90ad,U+90b2,U+90b7,U+90bc-90bd,U+90bf-90c0,U+90c2-90c3,U+90c6,U+90c8-90c9,U+90cb-90cd,U+90d2,U+90d4-90d6,U+90d8-90da,U+90de-90e0,U+90e3-90e5,U+90e9-90ea,U+90ec,U+90ee,U+90f0-90f3,U+90f5-90f7,U+90f9-90fc,U+90ff-9101,U+9103,U+9105-9118,U+911a-911d,U+911f-9121,U+9124-912e,U+9130,U+9132-9138,U+913a-9142,U+9144-9145,U+9147-9148,U+9151,U+9153-9156,U+9158"}},{uri:r6e,descriptors:{unicodeRange:"U+8f03-8f65,U+8f6a,U+8f80,U+8f8c,U+8f92,U+8f9d,U+8fa0-8fa2,U+8fa4-8fa7,U+8faa,U+8fac-8faf,U+8fb2-8fb5,U+8fb7-8fb8,U+8fba-8fbc,U+8fbf-8fc0,U+8fc3,U+8fc6,U+8fc9-8fcd,U+8fcf,U+8fd2,U+8fd6-8fd7,U+8fda,U+8fe0-8fe1,U+8fe3,U+8fe7,U+8fec,U+8fef,U+8ff1-8ff2,U+8ff4-8ff6,U+8ffa-8ffc,U+8ffe-8fff,U+9007-9008,U+900c,U+900e,U+9013,U+9015,U+9018-9019,U+901c,U+9023-9025,U+9027-902a"}},{uri:o6e,descriptors:{unicodeRange:"U+8d03-8d1c,U+8d20,U+8d51-8d52,U+8d57,U+8d5f,U+8d65,U+8d68-8d6a,U+8d6c,U+8d6e-8d6f,U+8d71-8d72,U+8d78-8d80,U+8d82-8d83,U+8d86-8d89,U+8d8c-8d90,U+8d92-8d93,U+8d95-8d9e,U+8da0-8da2,U+8da4-8db0,U+8db2,U+8db6-8db7,U+8db9,U+8dbb,U+8dbd,U+8dc0-8dc2,U+8dc5,U+8dc7-8dca,U+8dcd,U+8dd0,U+8dd2-8dd5,U+8dd8-8dd9,U+8ddc,U+8de0-8de2,U+8de5-8de7,U+8de9,U+8ded-8dee,U+8df0-8df2,U+8df4,U+8df6,U+8dfc,U+8dfe-8e04,U+8e06-8e08,U+8e0b,U+8e0d-8e0e,U+8e10-8e13,U+8e15-8e1c,U+8e20-8e21,U+8e24-8e28,U+8e2b,U+8e2d,U+8e30,U+8e32-8e34,U+8e36-8e38,U+8e3b-8e3c,U+8e3e-8e3f,U+8e43,U+8e45-8e46"}},{uri:a6e,descriptors:{unicodeRange:"U+8bea,U+8c09,U+8c1e,U+8c38-8c40,U+8c42-8c45,U+8c48,U+8c4a-8c4b,U+8c4d-8c54,U+8c56-8c59,U+8c5b-8c60,U+8c63-8c69,U+8c6c-8c72,U+8c74-8c77,U+8c7b-8c81,U+8c83-8c84,U+8c86-8c88,U+8c8b,U+8c8d-8c93,U+8c95-8c97,U+8c99-8d02"}},{uri:l6e,descriptors:{unicodeRange:"U+8a64-8a78,U+8a7a-8a88,U+8a8b-8a92,U+8a94-8b06,U+8b08-8b1b"}},{uri:c6e,descriptors:{unicodeRange:"U+8987-89c0,U+89c3,U+89cd,U+89d3-89d5,U+89d7-89d9,U+89db,U+89dd,U+89df-89e2,U+89e4,U+89e7-89ea,U+89ec-89ee,U+89f0-89f2,U+89f4-89ff,U+8a01-8a06,U+8a08-8a3d,U+8a3f-8a47,U+8a49-8a63"}},{uri:d6e,descriptors:{unicodeRange:"U+87e3-87e4,U+87e6-87e9,U+87eb-87ed,U+87ef-87f8,U+87fa-87fd,U+87ff-8802,U+8804-8809,U+880b-8812,U+8814,U+8817-881a,U+881c-8820,U+8823-8831,U+8833-8838,U+883a-883b,U+883d-883f,U+8841-8843,U+8846-884b,U+884e-8853,U+8855-8856,U+8858,U+885a-8860,U+8866-8867,U+886a,U+886d,U+886f,U+8871,U+8873-8876,U+8878-887c,U+8880,U+8883,U+8886-8887,U+8889-888a,U+888c,U+888e-8891,U+8893-8895,U+8897-889b,U+889d-88a1,U+88a3,U+88a5-88aa,U+88ac,U+88ae-88b0,U+88b2-88b6,U+88b8-88bb"}},{uri:u6e,descriptors:{unicodeRange:"U+86e7-86e8,U+86ea-86ec,U+86ef,U+86f5-86f7,U+86fa-86fd,U+86ff,U+8701,U+8704-8706,U+870b-870c,U+870e-8711,U+8714,U+8716,U+8719,U+871b,U+871d,U+871f-8720,U+8724,U+8726-8728,U+872a-872d,U+872f-8730,U+8732-8733,U+8735-8736,U+8738-873a,U+873c-873d,U+8740-8746,U+874a-874b,U+874d,U+874f-8752,U+8754-8756,U+8758,U+875a-875f,U+8761-8762,U+8766-876d,U+876f,U+8771-8773,U+8775,U+8777-877a,U+877f-8781,U+8784,U+8786-8787,U+8789-878a,U+878c,U+878e-8792,U+8794-8796,U+8798-879e,U+87a0-87a7,U+87a9-87aa,U+87ae,U+87b0-87b2,U+87b4,U+87b6-87b9,U+87bb-87bc,U+87be-87bf,U+87c1-87c5,U+87c7-87c9,U+87cc-87d0,U+87d4-87da,U+87dc-87df,U+87e1-87e2"}},{uri:f6e,descriptors:{unicodeRange:"U+8604,U+8606-8610,U+8612-8615,U+8617-8626,U+8628,U+862a-8637,U+8639-863b,U+863d-864c,U+8652-8653,U+8655-8659,U+865b-865d,U+865f-8661,U+8663-866a,U+866d,U+866f-8670,U+8672-8678,U+8683-8689,U+868e-8692,U+8694,U+8696-869b,U+869e-86a2,U+86a5-86a6,U+86ab,U+86ad-86ae,U+86b2-86b3,U+86b7-86b9,U+86bb-86bf,U+86c1-86c3,U+86c5,U+86c8,U+86cc-86cd,U+86d2-86d3,U+86d5-86d7,U+86da,U+86dc-86dd,U+86e0-86e3,U+86e5-86e6"}},{uri:h6e,descriptors:{unicodeRange:"U+8456,U+8458,U+845d-8460,U+8462,U+8464-8468,U+846a,U+846e-8470,U+8472,U+8474,U+8477,U+8479,U+847b-8481,U+8483-8486,U+848a,U+848d,U+848f-8496,U+8498,U+849a-849b,U+849d-84a0,U+84a2-84ae,U+84b0-84b1,U+84b3,U+84b5-84b7,U+84bb-84bc,U+84be,U+84c0,U+84c2-84c3,U+84c5-84c8,U+84cb-84cc,U+84ce-84cf,U+84d2,U+84d4-84d5,U+84d7-84dc,U+84de,U+84e1-84e2,U+84e4,U+84e7-84eb,U+84ed-84ef,U+84f1-84fb,U+84fd-84fe,U+8500-850b,U+850d-8510,U+8512,U+8514-8516,U+8518-8519,U+851b-851e,U+8520,U+8522-852a,U+852d-8536,U+853e-8542,U+8544-8547,U+854b-854f"}},{uri:g6e,descriptors:{unicodeRange:"U+82c2-82c3,U+82c5-82c6,U+82c9,U+82d0,U+82d6,U+82d9-82da,U+82dd,U+82e2,U+82e7-82ea,U+82ec-82ee,U+82f0,U+82f2-82f3,U+82f5-82f6,U+82f8,U+82fa,U+82fc-8300,U+830a-830b,U+830d,U+8310,U+8312-8313,U+8316,U+8318-8319,U+831d-8326,U+8329-832a,U+832e,U+8330,U+8332,U+8337,U+833b,U+833d-833f,U+8341-8342,U+8344-8345,U+8348,U+834a-834e,U+8353,U+8355-8359,U+835d,U+8362,U+8370-8376,U+8379-837a,U+837e-8384,U+8387-8388,U+838a-838d,U+838f-8391,U+8394-8397,U+8399-839a,U+839d,U+839f,U+83a1-83a7,U+83ac-83af,U+83b5,U+83bb,U+83be-83bf,U+83c2-83c4,U+83c6,U+83c8-83c9,U+83cb,U+83cd-83ce,U+83d0-83d3,U+83d5,U+83d7,U+83d9-83db,U+83de,U+83e2-83e4,U+83e6-83e8,U+83eb-83ef,U+83f3-83f7,U+83fa-83fc,U+83fe-8400,U+8402,U+8405,U+8407-840a,U+8410,U+8412-8417,U+8419-841b,U+841e-8423,U+8429-8430,U+8432-8437,U+8439-843b,U+843e-8445,U+8447-8450,U+8452-8455"}},{uri:m6e,descriptors:{unicodeRange:"U+81a4-81a5,U+81a7,U+81a9,U+81ab-81b2,U+81b4-81b9,U+81bc-81bf,U+81c4-81c5,U+81c7-81c9,U+81cb,U+81cd-81e2,U+81e4-81e6,U+81e8-81e9,U+81eb,U+81ee-81f2,U+81f5-81fa,U+81fd,U+81ff,U+8203,U+8207-820b,U+820e-820f,U+8211,U+8213,U+8215-821a,U+821d,U+8220,U+8224-8227,U+8229,U+822e,U+8232,U+823a,U+823c-823d,U+823f-8243,U+8245-8246,U+8248,U+824a,U+824c-824e,U+8250-8257,U+8259,U+825b-825e,U+8260-8267,U+8269-826d,U+8271,U+8275-8278,U+827b-827c,U+8280-8281,U+8283,U+8285-8287,U+8289,U+828c,U+8290,U+8293-8296,U+829a-829b,U+829e,U+82a0,U+82a2-82a3,U+82a7,U+82b2,U+82b5-82b6,U+82ba-82bc,U+82bf-82c0"}},{uri:p6e,descriptors:{unicodeRange:"U+8059,U+805b-8068,U+806b-8070,U+8072-807e,U+8081-8082,U+8085,U+8088,U+808a,U+808d-8092,U+8094-8095,U+8097,U+8099,U+809e,U+80a3,U+80a6-80a8,U+80ac,U+80b0,U+80b3,U+80b5-80b6,U+80b8-80b9,U+80bb,U+80c5,U+80c7-80cb,U+80cf-80d5,U+80d8,U+80df-80e0,U+80e2-80e3,U+80e6,U+80ee,U+80f5,U+80f7,U+80f9,U+80fb,U+80fe-8101,U+8103-8105,U+8107-8108,U+810b-810c,U+8115,U+8117,U+8119,U+811b-811d,U+811f-812b,U+812d-812e,U+8130,U+8133-8135,U+8137,U+8139-813d,U+813f-8145,U+8147,U+8149,U+814d-814f,U+8152,U+8156-8158,U+815b-815f,U+8161-8164,U+8166,U+8168,U+816a-816c,U+816f,U+8172-8173,U+8175-8178,U+8181,U+8183-8187,U+8189,U+818b-818e,U+8190,U+8192-8197,U+8199-819a,U+819e-81a2"}},{uri:U6e,descriptors:{unicodeRange:"U+7f3c-7f41,U+7f43,U+7f46-7f4f,U+7f52-7f53,U+7f56,U+7f59,U+7f5b-7f5e,U+7f60,U+7f63-7f67,U+7f6b-7f6d,U+7f6f-7f70,U+7f73,U+7f75-7f78,U+7f7a-7f7d,U+7f7f-7f80,U+7f82-7f89,U+7f8b,U+7f8d,U+7f8f-7f93,U+7f95-7f99,U+7f9b-7f9c,U+7fa0,U+7fa2-7fa3,U+7fa5-7fa6,U+7fa8-7fae,U+7fb1,U+7fb3-7fb7,U+7fba-7fbb,U+7fbe,U+7fc0,U+7fc2-7fc4,U+7fc6-7fc9,U+7fcb,U+7fcd,U+7fcf-7fd3,U+7fd6-7fd7,U+7fd9-7fde,U+7fe2-7fe4,U+7fe7-7fe8,U+7fea-7fed,U+7fef,U+7ff2,U+7ff4-7ffa,U+7ffd-7fff,U+8002,U+8007-800a,U+800e-800f,U+8011,U+8013,U+801a-801b,U+801d-801f,U+8021,U+8023-8024,U+802b-8030,U+8032,U+8034,U+8039-803a,U+803c,U+803e,U+8040-8041,U+8044-8045,U+8047-8049,U+804e-8051,U+8053,U+8055-8057"}},{uri:QUe,descriptors:{unicodeRange:"U+7cd8,U+7cda-7cdb,U+7cdd-7cde,U+7ce1-7ce7,U+7ce9-7cee,U+7cf0-7cf7,U+7cf9-7cfa,U+7cfc-7d09,U+7d0b-7d1f,U+7d21,U+7d23-7d26,U+7d28-7d2a,U+7d2c-7d2e,U+7d30-7d6d,U+7d6f-7d76,U+7d78-7d94"}},{uri:b6e,descriptors:{unicodeRange:"U+7afe,U+7b00-7b02,U+7b05,U+7b07,U+7b09,U+7b0c-7b0e,U+7b10,U+7b12-7b13,U+7b16-7b18,U+7b1a,U+7b1c-7b1d,U+7b1f,U+7b21-7b23,U+7b27,U+7b29,U+7b2d,U+7b2f-7b30,U+7b32,U+7b34-7b37,U+7b39,U+7b3b,U+7b3d,U+7b3f-7b44,U+7b46,U+7b48,U+7b4a,U+7b4d-7b4e,U+7b53,U+7b55,U+7b57,U+7b59,U+7b5c,U+7b5e-7b5f,U+7b61,U+7b63-7b6d,U+7b6f-7b70,U+7b73-7b74,U+7b76,U+7b78,U+7b7a,U+7b7c-7b7d,U+7b7f,U+7b81-7b84,U+7b86-7b8c,U+7b8e-7b8f,U+7b91-7b93,U+7b96,U+7b98-7b9b,U+7b9e-7ba0,U+7ba3-7ba5,U+7bae-7bb0,U+7bb2-7bb3,U+7bb5-7bb7,U+7bb9-7bc0,U+7bc2-7bc5,U+7bc8-7bcb,U+7bcd-7bd0,U+7bd2,U+7bd4-7bd8,U+7bdb-7bdc,U+7bde-7be0,U+7be2-7be4,U+7be7-7be9,U+7beb-7bed,U+7bef-7bf0,U+7bf2-7bf6,U+7bf8-7bfb,U+7bfd,U+7bff-7c06,U+7c08-7c0a,U+7c0d-7c0e,U+7c10-7c13"}},{uri:y6e,descriptors:{unicodeRange:"U+7a10-7a13,U+7a15-7a16,U+7a18-7a19,U+7a1b-7a1d,U+7a1f,U+7a21-7a22,U+7a24-7a32,U+7a34-7a36,U+7a38,U+7a3a,U+7a3e,U+7a40-7a45,U+7a47-7a50,U+7a52-7a56,U+7a58-7a6f,U+7a71-7a73,U+7a75,U+7a7b-7a7e,U+7a82,U+7a85,U+7a87,U+7a89-7a8c,U+7a8e-7a90,U+7a93-7a94,U+7a99-7a9b,U+7a9e,U+7aa1-7aa4,U+7aa7,U+7aa9-7aab,U+7aae-7ab2,U+7ab4-7abe,U+7ac0-7aca,U+7acc-7ad5,U+7ad7-7ad8,U+7ada-7add,U+7ae1-7ae2,U+7ae4,U+7ae7-7aec,U+7aee,U+7af0-7af8,U+7afb-7afc"}},{uri:E6e,descriptors:{unicodeRange:"U+790d-7912,U+7914-791d,U+791f-7923,U+7925-7933,U+7935-7939,U+793d,U+793f,U+7942-7945,U+7947,U+794a-7952,U+7954-7955,U+7958-7959,U+7961,U+7963-7964,U+7966,U+7969-796c,U+796e,U+7970-7976,U+7979,U+797b-797f,U+7982-7983,U+7986-7989,U+798b-798e,U+7990-7999,U+799b-79a6,U+79a8-79b2,U+79b4-79b8,U+79bc,U+79bf,U+79c2,U+79c4-79c5,U+79c7-79c8,U+79ca,U+79cc,U+79ce-79d0,U+79d3-79d4,U+79d6-79d7,U+79d9-79de,U+79e0-79e2,U+79e5,U+79e8,U+79ea,U+79ec,U+79ee,U+79f1-79f7,U+79f9-79fa,U+79fc,U+79fe-79ff,U+7a01,U+7a04-7a05,U+7a07-7a0a,U+7a0c,U+7a0f"}},{uri:v6e,descriptors:{unicodeRange:"U+77d8-77da,U+77dd-77e1,U+77e4,U+77e6,U+77e8,U+77ea,U+77ef-77f2,U+77f4-77f5,U+77f7,U+77f9-77fc,U+7803-7808,U+780a-780b,U+780e-7810,U+7813,U+7815,U+7819,U+781b,U+781e,U+7820-7822,U+7824,U+7828,U+782a-782b,U+782e-782f,U+7831-7833,U+7835-7836,U+783d,U+783f,U+7841-7844,U+7846,U+7848-784b,U+784d,U+784f,U+7851,U+7853-7854,U+7858-785c,U+785e-7869,U+786f-7876,U+7878-787b,U+787d-7886,U+7888,U+788a-788b,U+788f-7890,U+7892,U+7894-7896,U+7899,U+789d-789e,U+78a0,U+78a2,U+78a4,U+78a6,U+78a8-78af,U+78b5-78b8,U+78ba-78bd,U+78bf-78c0,U+78c2-78c4,U+78c6-78c8,U+78cc-78cf,U+78d1-78d3,U+78d6-78d8,U+78da-78e7,U+78e9-78eb,U+78ed-78f1,U+78f3,U+78f5-78f6,U+78f8-78f9,U+78fb-7900,U+7902-7904,U+7906-790c"}},{uri:_6e,descriptors:{unicodeRange:"U+76af-76b0,U+76b3,U+76b5-76be,U+76c0-76c1,U+76c3-76c4,U+76c7,U+76c9,U+76cb-76cc,U+76d3,U+76d5,U+76d9-76da,U+76dc-76de,U+76e0-76e4,U+76e6-76ed,U+76f0,U+76f3,U+76f5-76f7,U+76fa-76fb,U+76fd,U+76ff-7703,U+7705-7706,U+770a,U+770c,U+770e-7718,U+771b-771e,U+7721,U+7723-7725,U+7727,U+772a-772c,U+772e,U+7730-7734,U+7739,U+773b,U+773d-773f,U+7742,U+7744-7746,U+7748-774f,U+7752-7759,U+775c-7760,U+7764,U+7767,U+7769-776a,U+776d-7778,U+777a-777c,U+7781-7783,U+7786-778b,U+778f-7790,U+7793-779e,U+77a1,U+77a3-77a4,U+77a6,U+77a8,U+77ab,U+77ad-77af,U+77b1-77b2,U+77b4,U+77b6-77ba,U+77bc,U+77be,U+77c0-77cc,U+77ce-77d6"}},{uri:w6e,descriptors:{unicodeRange:"U+7589-758a,U+758c-758e,U+7590,U+7593,U+7595,U+7598,U+759b-759c,U+759e,U+75a2,U+75a6-75aa,U+75ad,U+75b6-75b7,U+75ba-75bb,U+75bf-75c1,U+75c6,U+75cb-75cc,U+75ce-75d1,U+75d3,U+75d7,U+75d9-75da,U+75dc-75dd,U+75df-75e1,U+75e5,U+75e9,U+75ec-75ef,U+75f2-75f3,U+75f5-75f8,U+75fa-75fb,U+75fd-75fe,U+7602,U+7604,U+7606-7609,U+760b,U+760d-760f,U+7611-7614,U+7616,U+761a,U+761c-761e,U+7621,U+7623,U+7627-7628,U+762c,U+762e-762f,U+7631-7632,U+7636-7637,U+7639-763b,U+763d,U+7641-7642,U+7644-764b,U+764e-7653,U+7655,U+7657-765b,U+765d,U+765f-7662,U+7664-766a,U+766c-766e,U+7670-7677,U+7679-767a,U+767c,U+767f-7681,U+7683,U+7685,U+7689-768a,U+768c-768d,U+768f-7690,U+7692,U+7694-7695,U+7697-7698,U+769a-76a3,U+76a5-76ad"}},{uri:T6e,descriptors:{unicodeRange:"U+7492-749b,U+749d,U+749f-74a6,U+74aa-74b9,U+74bb-74d1,U+74d3-74db,U+74dd,U+74df,U+74e1,U+74e5,U+74e7-74ed,U+74f0-74f3,U+74f5,U+74f8-74fe,U+7500-7503,U+7505-750c,U+750e,U+7510,U+7512,U+7514-7517,U+751b,U+751d-751e,U+7520-7524,U+7526-7527,U+752a,U+752e,U+7534,U+7536,U+7539,U+753c-753d,U+753f,U+7541-7544,U+7546-7547,U+7549-754a,U+754d,U+7550-7553,U+7555-7558,U+755d-7564,U+7567-7569,U+756b-7571,U+7573,U+7575-7577,U+757a-757e,U+7580-7582,U+7584-7585,U+7587-7588"}},{uri:I6e,descriptors:{unicodeRange:"U+7372-737d,U+737f-7383,U+7385-7386,U+7388,U+738a,U+738c-738d,U+738f-7390,U+7392-7395,U+7397-739a,U+739c-739e,U+73a0-73a1,U+73a3-73a8,U+73aa,U+73ac-73ad,U+73b1,U+73b4-73b6,U+73b8-73b9,U+73bc-73bf,U+73c1,U+73c3-73c7,U+73cb-73cc,U+73ce,U+73d2-73d8,U+73da-73dd,U+73df,U+73e1-73e4,U+73e6,U+73e8,U+73ea-73ec,U+73ee-73f1,U+73f3-7402,U+7404,U+7407-7408,U+740b-740e,U+7411-7419,U+741c-7421,U+7423-7424,U+7427,U+7429,U+742b,U+742d,U+742f,U+7431-7432,U+7437-743b,U+743d-7440,U+7442-7454,U+7456,U+7458,U+745d,U+7460-746c,U+746e-746f,U+7471-7475,U+7478-747d,U+747f,U+7482,U+7484-7486,U+7488-748a,U+748c-748d,U+748f,U+7491"}},{uri:WUe,descriptors:{unicodeRange:"U+7054-705d,U+705f-706a,U+706e,U+7071-7074,U+7077,U+7079-707b,U+707d,U+7081-7084,U+7086-7088,U+708b-708d,U+708f-7091,U+7093,U+7097-7098,U+709a-709b,U+709e-70aa,U+70b0,U+70b2,U+70b4-70b6,U+70ba,U+70be-70bf,U+70c4-70c7,U+70c9,U+70cb-70d7,U+70da,U+70dc-70de,U+70e0-70e3,U+70e5,U+70ea,U+70ee,U+70f0-70f6,U+70f8,U+70fa-70fc,U+70fe-7108,U+710b-710f,U+7111-7112,U+7114,U+7117,U+711b-7125,U+7127-712e,U+7132-7135,U+7137-7144,U+7146-7149,U+714b,U+714d,U+714f-715b,U+715d,U+715f-7163,U+7165,U+7169-716d,U+716f-7171,U+7174-7177"}},{uri:S6e,descriptors:{unicodeRange:"U+722e-722f,U+7232-7234,U+723a,U+723c,U+723e,U+7240-7246,U+7249-724b,U+724e-7251,U+7253-7255,U+7257-7258,U+725a,U+725c,U+725e,U+7260,U+7263-7265,U+7268,U+726a-726d,U+7270-7271,U+7273-7274,U+7276-7278,U+727b-727d,U+7282-7283,U+7285-7289,U+728c,U+728e,U+7290-7291,U+7293-729e,U+72a0-72ab,U+72ae,U+72b1-72b3,U+72b5,U+72ba-72c0,U+72c5-72c7,U+72c9-72cc,U+72cf,U+72d1,U+72d3-72d6,U+72d8,U+72da-72dd,U+72df,U+72e2-72e7,U+72ea-72eb,U+72f5-72f6,U+72f9,U+72fd-7300,U+7302,U+7304-7309,U+730b-730d,U+730f-7312,U+7314,U+7318-731a,U+731f-7320,U+7323-7324,U+7326-7328,U+732d,U+732f-7330,U+7332-7333,U+7335-7336,U+733a-733d,U+7340-734c,U+734e-734f,U+7351,U+7353-7356,U+7358-735f,U+7361-736b,U+736e,U+7370-7371"}},{uri:zbe,descriptors:{unicodeRange:"U+6ec5-6ec6,U+6ec8-6eca,U+6ecc-6ece,U+6ed0,U+6ed2,U+6ed6,U+6ed8-6ed9,U+6edb-6edd,U+6ee3,U+6ee7,U+6eea-6ef3,U+6ef5-6ef8,U+6efa-6f01,U+6f03-6f05,U+6f07-6f08,U+6f0a-6f0e,U+6f10-6f12,U+6f16-6f1f,U+6f21-6f23,U+6f25-6f28,U+6f2c,U+6f2e,U+6f30,U+6f32,U+6f34-6f35,U+6f37-6f3d,U+6f3f-6f45,U+6f48-6f4a,U+6f4c,U+6f4e-6f57,U+6f59-6f5b,U+6f5d,U+6f5f-6f61,U+6f63-6f65,U+6f67-6f6c,U+6f6f-6f71,U+6f73,U+6f75-6f77,U+6f79,U+6f7b,U+6f7d-6f83,U+6f85-6f87,U+6f8a-6f8b,U+6f8f-6f9b,U+6f9d-6fa0,U+6fa2-6fa6,U+6fa8-6fb1"}},{uri:C6e,descriptors:{unicodeRange:"U+6d73,U+6d75-6d76,U+6d79-6d7b,U+6d7d-6d81,U+6d83-6d84,U+6d86-6d87,U+6d8a-6d8b,U+6d8d,U+6d8f-6d90,U+6d92,U+6d96-6d9a,U+6d9c,U+6da2,U+6da5,U+6dac-6dad,U+6db0-6db1,U+6db3-6db4,U+6db6-6db7,U+6db9-6dbe,U+6dc1-6dc3,U+6dc8-6dca,U+6dcd-6dd0,U+6dd2-6dd5,U+6dd7,U+6dda-6ddc,U+6ddf,U+6de2-6de3,U+6de5,U+6de7-6dea,U+6ded,U+6def-6df0,U+6df2,U+6df4-6df6,U+6df8,U+6dfa,U+6dfd-6e04,U+6e06-6e09,U+6e0b,U+6e0f,U+6e12-6e13,U+6e15,U+6e18-6e19,U+6e1b-6e1c,U+6e1e-6e1f,U+6e22,U+6e26-6e28,U+6e2a,U+6e2c,U+6e2e,U+6e30-6e31,U+6e33,U+6e35-6e37,U+6e39,U+6e3b-6e42,U+6e45-6e4c,U+6e4f-6e52,U+6e55,U+6e57,U+6e59-6e5a,U+6e5c-6e5e,U+6e60-6e6a,U+6e6c-6e6d,U+6e6f-6e7d,U+6e80-6e82,U+6e84,U+6e87-6e88,U+6e8a-6e8e,U+6e91-6e97,U+6e99-6e9b,U+6e9d-6e9e,U+6ea0-6ea1,U+6ea3-6ea4,U+6ea6,U+6ea8-6ea9,U+6eab-6eae,U+6eb0,U+6eb3,U+6eb5,U+6eb8-6eb9,U+6ebc,U+6ebe-6ec0,U+6ec3-6ec4"}},{uri:x6e,descriptors:{unicodeRange:"U+6bbb-6bbe,U+6bc0,U+6bc3-6bc4,U+6bc6-6bca,U+6bcc,U+6bce,U+6bd0-6bd1,U+6bd8,U+6bda,U+6bdc-6be0,U+6be2-6be9,U+6bec-6bee,U+6bf0-6bf2,U+6bf4,U+6bf6-6bf8,U+6bfa-6bfc,U+6bfe-6c04,U+6c08-6c0c,U+6c0e,U+6c12,U+6c17,U+6c1c-6c1e,U+6c20,U+6c23,U+6c25,U+6c2b-6c2d,U+6c31,U+6c33,U+6c36-6c37,U+6c39-6c3c,U+6c3e-6c3f,U+6c43-6c45,U+6c48,U+6c4b-6c4f,U+6c51-6c53,U+6c56,U+6c58-6c5a,U+6c62-6c63,U+6c65-6c67,U+6c6b-6c6f,U+6c71,U+6c73,U+6c75,U+6c77-6c78,U+6c7a-6c7c,U+6c7f-6c80,U+6c84,U+6c87,U+6c8a-6c8b,U+6c8d-6c8e,U+6c91-6c92,U+6c95-6c98,U+6c9a,U+6c9c-6c9e,U+6ca0,U+6ca2,U+6ca8,U+6cac,U+6caf-6cb0,U+6cb4-6cb7,U+6cba,U+6cc0-6cc3,U+6cc6-6cc8,U+6ccb,U+6ccd-6ccf,U+6cd1-6cd2,U+6cd8-6cda,U+6cdc-6cdd,U+6cdf,U+6ce4,U+6ce6-6ce7,U+6ce9,U+6cec-6ced,U+6cf2,U+6cf4,U+6cf9,U+6cff-6d00,U+6d02-6d03,U+6d05-6d06,U+6d08-6d0a,U+6d0d,U+6d0f-6d11,U+6d13-6d16,U+6d18,U+6d1c-6d1d,U+6d1f-6d24,U+6d26,U+6d28-6d29,U+6d2c-6d2d,U+6d2f-6d30,U+6d34,U+6d36-6d38,U+6d3a,U+6d3f-6d40,U+6d42,U+6d44,U+6d49,U+6d4c,U+6d50,U+6d55-6d58,U+6d5b,U+6d5d,U+6d5f,U+6d61-6d62,U+6d64-6d65,U+6d67-6d68,U+6d6b-6d6d,U+6d70-6d72"}},{uri:A6e,descriptors:{unicodeRange:"U+6967-696a,U+696c-696d,U+696f-6970,U+6972-6976,U+697a-697b,U+697d-697f,U+6981,U+6983,U+6985,U+698a-698c,U+698e-6993,U+6996-6997,U+6999-699a,U+699d-69a6,U+69a9-69aa,U+69ac,U+69ae-69b0,U+69b2-69b3,U+69b5-69b6,U+69b8-69ba,U+69bc-69c0,U+69c2-69c9,U+69cb,U+69cd,U+69cf,U+69d1-69d3,U+69d5-69da,U+69dc-69de,U+69e1-69ec,U+69ee-69f1,U+69f3-69fc,U+69fe,U+6a00-6a09,U+6a0b-6a16,U+6a19-6a1e,U+6a20,U+6a22-6a27,U+6a29,U+6a2b-6a2e,U+6a30,U+6a32-6a34,U+6a36-6a3c,U+6a3f-6a43,U+6a45-6a46,U+6a48-6a4a"}},{uri:M6e,descriptors:{unicodeRange:"U+6830-6831,U+6834-6836,U+683a-683b,U+683f,U+6847,U+684b,U+684d,U+684f,U+6852,U+6856-685f,U+686a,U+686c-6873,U+6875,U+6878-6880,U+6882,U+6884,U+6887-688e,U+6890-6892,U+6894-6896,U+6898-68a1,U+68a3-68a5,U+68a9-68ac,U+68ae,U+68b1-68b2,U+68b4,U+68b6-68bf,U+68c1,U+68c3-68c8,U+68ca,U+68cc,U+68ce-68d1,U+68d3-68d4,U+68d6-68d7,U+68d9,U+68db-68df,U+68e1-68e2,U+68e4-68ed,U+68ef,U+68f2-68f4,U+68f6-68f8,U+68fb,U+68fd-6900,U+6902-6904,U+6906-690a,U+690c,U+690f,U+6911,U+6913-691e,U+6921-6923,U+6925-692c,U+692e-692f,U+6931-6933,U+6935-6938,U+693a-693c,U+693e,U+6940-6941,U+6943-6953,U+6955-6956,U+6958-6959,U+695b-695c,U+695f,U+6961-6962,U+6964-6965"}},{uri:k6e,descriptors:{unicodeRange:"U+66b8,U+66ba-66bd,U+66bf-66d8,U+66da,U+66de-66e5,U+66e7-66e8,U+66ea-66ef,U+66f1,U+66f5-66f6,U+66f8,U+66fa-66fb,U+66fd,U+6701-6707,U+670c,U+670e-670f,U+6711-6713,U+6716,U+6718-671a,U+671c,U+671e,U+6720-6725,U+6727,U+6729,U+672e,U+6730,U+6732-6733,U+6736-6739,U+673b-673c,U+673e-673f,U+6741,U+6744-6745,U+6747,U+674a-674b,U+674d,U+6752,U+6754-6755,U+6757-675b,U+675d,U+6762-6764,U+6766-6767,U+676b-676c,U+676e,U+6771,U+6774,U+6776,U+6778-677b,U+677d,U+6780,U+6782-6783,U+6785-6786,U+6788,U+678a,U+678c-678f,U+6791-6794,U+6796,U+6799,U+679b,U+679f-67a1,U+67a4,U+67a6,U+67a9,U+67ac,U+67ae,U+67b1-67b2,U+67b4,U+67b9-67c0,U+67c2,U+67c5-67ce,U+67d5-67d7,U+67db,U+67df,U+67e1,U+67e3-67e4,U+67e6-67e8,U+67ea-67eb,U+67ed-67ee,U+67f2,U+67f5-67fc,U+67fe,U+6801-6804,U+6806,U+680d,U+6810,U+6812,U+6814-6815,U+6818-681c,U+681e-6820,U+6822-6828,U+682b-682f"}},{uri:R6e,descriptors:{unicodeRange:"U+6569-656a,U+656d-656f,U+6571,U+6573,U+6575-6576,U+6578-6586,U+6588-658a,U+658d-658f,U+6592,U+6594-6596,U+6598,U+659a,U+659d-659e,U+65a0,U+65a2-65a3,U+65a6,U+65a8,U+65aa,U+65ac,U+65ae,U+65b1-65b8,U+65ba-65bb,U+65be-65c0,U+65c2,U+65c7-65ca,U+65cd,U+65d0-65d1,U+65d3-65d5,U+65d8-65df,U+65e1,U+65e3-65e4,U+65ea-65eb,U+65f2-65f5,U+65f8-65f9,U+65fb-65ff,U+6601,U+6604-6605,U+6607-6609,U+660b,U+660d,U+6610-6612,U+6616-6618,U+661a-661c,U+661e,U+6621-6624,U+6626,U+6629-662c,U+662e,U+6630,U+6632-6633,U+6637-663b,U+663d,U+663f-6640,U+6642,U+6644-664a,U+664d-664e,U+6650-6651,U+6658-6659,U+665b-665e,U+6660,U+6662-6663,U+6665,U+6667,U+6669-666d,U+6671-6673,U+6675,U+6678-6679,U+667b-667d,U+667f-6681,U+6683,U+6685-6686,U+6688-668b,U+668d-6690,U+6692-6695,U+6698-669c,U+669e-66a6,U+66a9-66ad,U+66af-66b3,U+66b5-66b7"}},{uri:D6e,descriptors:{unicodeRange:"U+5f30,U+5f32-5f38,U+5f3b,U+5f3d-5f3f,U+5f41-5f4f,U+5f51,U+5f54,U+5f59-5f5c,U+5f5e-5f60,U+5f63,U+5f65,U+5f67-5f68,U+5f6b,U+5f6e-5f6f,U+5f72,U+5f74-5f76,U+5f78,U+5f7a,U+5f7d-5f7f,U+5f83,U+5f86,U+5f8d-5f8f,U+5f91,U+5f93-5f94,U+5f96,U+5f9a-5f9b,U+5f9d-5fa0,U+5fa2-5fa7,U+5fa9,U+5fab-5fac,U+5faf-5fb4,U+5fb6,U+5fb8-5fbb,U+5fbe-5fc2,U+5fc7-5fc8,U+5fca-5fcb,U+5fce,U+5fd3-5fd5,U+5fda-5fdc,U+5fde-5fdf,U+5fe2-5fe3,U+5fe5-5fe6,U+5fe8-5fe9,U+5fec,U+5fef-5ff0,U+5ff2-5ff4,U+5ff6-5ff7,U+5ff9-5ffa,U+5ffc,U+6007-6009,U+600b-600c,U+6010-6011,U+6013,U+6017-6018,U+601a,U+601e-601f,U+6022-6024,U+602c-602e,U+6030-6034,U+6036-603a,U+603d-603e,U+6040,U+6044-604a,U+604c,U+604e-604f,U+6051,U+6053-6054,U+6056-6058,U+605b-605c,U+605e-6061,U+6065-6066,U+606e,U+6071-6072,U+6074-6075,U+6077,U+607e,U+6080-6082,U+6085-6088,U+608a-608b,U+608e-6091,U+6093,U+6095,U+6097-6099,U+609c,U+609e,U+60a1-60a2,U+60a4-60a5,U+60a7,U+60a9-60aa,U+60ae,U+60b0,U+60b3,U+60b5-60b7,U+60b9-60ba,U+60bd-60c4,U+60c7-60c9,U+60cc"}},{uri:L6e,descriptors:{unicodeRange:"U+635a-635d,U+6360,U+6364-6366,U+6368,U+636a-636c,U+636f-6370,U+6372-6375,U+6378-6379,U+637c-637f,U+6381,U+6383-6386,U+638b,U+638d,U+6391,U+6393-6395,U+6397,U+6399-639f,U+63a1,U+63a4,U+63a6,U+63ab,U+63af,U+63b1-63b2,U+63b5-63b6,U+63b9,U+63bb,U+63bd,U+63bf-63c3,U+63c5,U+63c7-63c8,U+63ca-63cc,U+63d1,U+63d3-63d5,U+63d7-63dd,U+63df,U+63e2,U+63e4-63e8,U+63eb-63ec,U+63ee-63f1,U+63f3,U+63f5,U+63f7,U+63f9-63fc,U+63fe,U+6403-6404,U+6406-640a,U+640d-640e,U+6411-6412,U+6415-641a,U+641d,U+641f,U+6422-6425,U+6427-6429,U+642b,U+642e-6433,U+6435-6439,U+643b-643c,U+643e,U+6440,U+6442-6443,U+6449,U+644b-6451,U+6453,U+6455-6457,U+6459-645d,U+645f-6466,U+6468,U+646a-646c,U+646e-6477,U+647b-6481,U+6483,U+6486,U+6488-648f"}},{uri:P6e,descriptors:{unicodeRange:"U+61c5-61c7,U+61c9,U+61cc-61d0,U+61d3,U+61d5-61e5,U+61e7-61f4,U+61f6-61fe,U+6200-6205,U+6207,U+6209,U+6213-6214,U+6219,U+621c-621e,U+6220,U+6223,U+6226-6229,U+622b,U+622d,U+622f-6232,U+6235-6236,U+6238-623c,U+6242,U+6244-6246,U+624a,U+624f-6250,U+6255-6257,U+6259-625a,U+625c-6262,U+6264-6265,U+6268,U+6271-6272,U+6274-6275,U+6277-6278,U+627a-627b,U+627d,U+6281-6283,U+6285-6288,U+628b-6290,U+6294,U+6299,U+629c-629e,U+62a3,U+62a6-62a7,U+62a9-62aa,U+62ad-62b0,U+62b2-62b4,U+62b6-62b8,U+62ba,U+62be,U+62c0-62c1,U+62c3,U+62cb,U+62cf,U+62d1,U+62d5,U+62dd-62de,U+62e0-62e1,U+62e4,U+62ea-62eb,U+62f0,U+62f2,U+62f5,U+62f8-62fb,U+6300,U+6303-6306,U+630a-630d,U+630f-6310,U+6312-6315,U+6317-6319,U+631c,U+6326-6327,U+6329,U+632c-632e,U+6330-6331,U+6333-6338,U+633b-633c,U+633e-6341,U+6344,U+6347-6348,U+634a,U+6351-6354,U+6356-6359"}},{uri:N6e,descriptors:{unicodeRange:"U+5dd0-5dda,U+5ddc,U+5ddf-5de0,U+5de3-5de4,U+5dea,U+5dec-5ded,U+5df0,U+5df5-5df6,U+5df8-5dfc,U+5dff-5e00,U+5e04,U+5e07,U+5e09-5e0b,U+5e0d-5e0e,U+5e12-5e13,U+5e17,U+5e1e-5e25,U+5e28-5e2c,U+5e2f-5e30,U+5e32-5e36,U+5e39-5e3a,U+5e3e-5e41,U+5e43,U+5e46-5e4b,U+5e4d-5e53,U+5e56-5e5a,U+5e5c-5e5d,U+5e5f-5e60,U+5e63-5e71,U+5e75,U+5e77,U+5e79,U+5e7e,U+5e81-5e83,U+5e85,U+5e88-5e89,U+5e8c-5e8e,U+5e92,U+5e98,U+5e9b,U+5e9d,U+5ea1-5ea4,U+5ea8-5eac,U+5eae-5eb2,U+5eb4,U+5eba-5ebd,U+5ebf-5ec8,U+5ecb-5ed0,U+5ed4-5ed5,U+5ed7-5eda,U+5edc-5ee7,U+5ee9,U+5eeb-5ef3,U+5ef5,U+5ef8-5ef9,U+5efb-5efd,U+5f05-5f07,U+5f09,U+5f0c-5f0e,U+5f10,U+5f12,U+5f14,U+5f16,U+5f19-5f1a,U+5f1c-5f1e,U+5f21-5f24,U+5f28,U+5f2b-5f2c,U+5f2e"}},{uri:O6e,descriptors:{unicodeRange:"U+60cd-60d0,U+60d2-60d4,U+60d6-60d7,U+60d9,U+60db,U+60de,U+60e1-60e5,U+60ea,U+60f1-60f2,U+60f5,U+60f7-60f8,U+60fb-60ff,U+6102-6105,U+6107,U+610a-610c,U+6110-6114,U+6116-6119,U+611b-611e,U+6121-6122,U+6125,U+6128-612a,U+612c-613e,U+6140-6147,U+6149,U+614b,U+614d,U+614f-6150,U+6152-6154,U+6156-615c,U+615e-6161,U+6163-6166,U+6169-616f,U+6171-6174,U+6176,U+6178-618a,U+618c-618d,U+618f-6193,U+6195-619c,U+619e-61a6,U+61aa-61ab,U+61ad-61b6,U+61b8-61bd,U+61bf-61c1,U+61c3-61c4"}},{uri:F6e,descriptors:{unicodeRange:"U+5cf4-5cfa,U+5cfc-5d01,U+5d04-5d05,U+5d08-5d0d,U+5d0f-5d13,U+5d15,U+5d17-5d1a,U+5d1c-5d1d,U+5d1f-5d23,U+5d25,U+5d28,U+5d2a-5d2c,U+5d2f-5d33,U+5d35-5d3c,U+5d3f-5d46,U+5d48-5d49,U+5d4d-5d57,U+5d59-5d5a,U+5d5c,U+5d5e-5d68,U+5d6a,U+5d6d-5d6e,U+5d70-5d73,U+5d75-5d81,U+5d83-5d98,U+5d9a-5d9c,U+5d9e-5db6,U+5db8-5dc4,U+5dc6-5dcc,U+5dce-5dcf"}},{uri:B6e,descriptors:{unicodeRange:"U+5b52,U+5b56,U+5b5e,U+5b60-5b61,U+5b67-5b68,U+5b6b,U+5b6d-5b6f,U+5b72,U+5b74,U+5b76-5b79,U+5b7b-5b7c,U+5b7e-5b7f,U+5b82,U+5b86,U+5b8a,U+5b8d-5b8e,U+5b90-5b92,U+5b94,U+5b96,U+5b9f,U+5ba7-5ba9,U+5bac-5baf,U+5bb1-5bb2,U+5bb7,U+5bba-5bbc,U+5bc0-5bc1,U+5bc3,U+5bc8-5bcb,U+5bcd-5bcf,U+5bd1,U+5bd4-5bdc,U+5be0,U+5be2-5be3,U+5be6-5be7,U+5be9-5bed,U+5bef,U+5bf1-5bf7,U+5bfd-5bfe,U+5c00,U+5c02-5c03,U+5c05,U+5c07-5c08,U+5c0b-5c0e,U+5c10,U+5c12-5c13,U+5c17,U+5c19,U+5c1b,U+5c1e-5c21,U+5c23,U+5c26,U+5c28-5c2b,U+5c2d-5c30,U+5c32-5c33,U+5c35-5c37,U+5c43-5c44,U+5c46-5c47,U+5c4c-5c4d,U+5c52-5c54,U+5c56-5c58,U+5c5a-5c5d,U+5c5f,U+5c62,U+5c64,U+5c67-5c6d,U+5c70,U+5c72-5c78,U+5c7b-5c7e,U+5c80,U+5c83-5c87,U+5c89-5c8b,U+5c8e-5c8f,U+5c92-5c93,U+5c95,U+5c9d-5ca1,U+5ca4-5ca8,U+5caa,U+5cae-5cb0,U+5cb2,U+5cb4,U+5cb6,U+5cb9-5cbc,U+5cbe,U+5cc0,U+5cc2-5cc3,U+5cc5-5cca,U+5ccc-5cd1,U+5cd3-5cd8,U+5cda-5ce0,U+5ce2-5ce3,U+5ce7,U+5ce9,U+5ceb-5cec,U+5cee-5cef,U+5cf1-5cf3"}},{uri:z6e,descriptors:{unicodeRange:"U+593b,U+593d-5940,U+5943,U+5945-5946,U+594a,U+594c-594d,U+5950,U+5952-5953,U+5959,U+595b-595f,U+5961,U+5963-5964,U+5966-5972,U+5975,U+5977,U+597a-597c,U+597e-5980,U+5985,U+5989,U+598b-598c,U+598e-5991,U+5994-5995,U+5998,U+599a-599d,U+599f-59a2,U+59a6-59a7,U+59ac-59ad,U+59b0-59b1,U+59b3-59b8,U+59ba,U+59bc-59bd,U+59bf-59c5,U+59c7-59c9,U+59cc-59cf,U+59d5-59d6,U+59d9,U+59db,U+59de-59e2,U+59e4,U+59e6-59e7,U+59e9-59eb,U+59ed-59f8,U+59fa,U+59fc-59fe,U+5a00,U+5a02,U+5a0a-5a0b,U+5a0d-5a10,U+5a12,U+5a14-5a17,U+5a19-5a1b,U+5a1d-5a1e,U+5a21-5a22,U+5a24,U+5a26-5a28,U+5a2a-5a30,U+5a33,U+5a35,U+5a37-5a3b,U+5a3d-5a3f,U+5a41-5a45,U+5a47-5a48,U+5a4b-5a54,U+5a56-5a59,U+5a5b-5a61,U+5a63-5a66,U+5a68-5a69,U+5a6b-5a73,U+5a78-5a79,U+5a7b-5a7e,U+5a80-5a90"}},{uri:H6e,descriptors:{unicodeRange:"U+5a91,U+5a93-5a99,U+5a9c-5aa9,U+5aab-5ab1,U+5ab4,U+5ab6-5ab7,U+5ab9-5abd,U+5abf-5ac0,U+5ac3-5ac8,U+5aca-5acb,U+5acd-5ad1,U+5ad3,U+5ad5,U+5ad7,U+5ad9-5adb,U+5add-5adf,U+5ae2,U+5ae4-5ae5,U+5ae7-5ae8,U+5aea,U+5aec-5af0,U+5af2-5b08,U+5b0a-5b15,U+5b18-5b31,U+5b33,U+5b35-5b36,U+5b38-5b3f,U+5b41-5b4f"}},{uri:V6e,descriptors:{unicodeRange:"U+5843,U+5845-584b,U+584e-5850,U+5852-5853,U+5855-5857,U+5859-585d,U+585f-5864,U+5866-586a,U+586d-587d,U+587f,U+5882,U+5884,U+5886-5888,U+588a-5891,U+5894-5898,U+589b-589d,U+58a0-58a7,U+58aa-58bb,U+58bd-58c0,U+58c2-58c4,U+58c6-58d0,U+58d2-58d4,U+58d6-58e3,U+58e5-58ea,U+58ed,U+58ef,U+58f1-58f2,U+58f4-58f5,U+58f7-58f8,U+58fa-5901,U+5903,U+5905-5906,U+5908-590c,U+590e,U+5910-5913,U+5917-5918,U+591b,U+591d-591e,U+5920-5923,U+5926,U+5928,U+592c,U+5930,U+5932-5933,U+5935-5936"}},{uri:$6e,descriptors:{unicodeRange:"U+56d0-56d3,U+56d5-56d6,U+56d8-56d9,U+56dc,U+56e3,U+56e5-56ea,U+56ec,U+56ee-56ef,U+56f2-56f3,U+56f6-56f8,U+56fb-56fc,U+5700-5702,U+5705,U+5707,U+570b-571b,U+571d-571e,U+5720-5722,U+5724-5727,U+572b,U+5731-5732,U+5734-5738,U+573c-573d,U+573f,U+5741,U+5743-5746,U+5748-5749,U+574b,U+5752-5756,U+5758-5759,U+5762-5763,U+5765,U+5767,U+576c,U+576e,U+5770-5772,U+5774-5775,U+5778-577a,U+577d-5781,U+5787-578a,U+578d-5791,U+5794-579a,U+579c-579f,U+57a5,U+57a8,U+57aa,U+57ac,U+57af-57b1,U+57b3,U+57b5-57b7,U+57b9-57c1,U+57c4-57ca,U+57cc-57cd,U+57d0-57d1,U+57d3,U+57d6-57d7,U+57db-57dc,U+57de,U+57e1-57e3,U+57e5-57ec,U+57ee,U+57f0-57f3,U+57f5-57f7,U+57fb-57fc,U+57fe-57ff,U+5801,U+5803-5805,U+5808-580a,U+580c,U+580e-5810,U+5812-5814,U+5816-5818,U+581a-581d,U+581f,U+5822-5823,U+5825-5829,U+582b-582f,U+5831-5834,U+5836-5842"}},{uri:G6e,descriptors:{unicodeRange:"U+55f9-55fc,U+55ff,U+5602-5607,U+560a-560b,U+560d,U+5610-5617,U+5619-561a,U+561c-561d,U+5620-5622,U+5625-5626,U+5628-562b,U+562e-5630,U+5633,U+5635,U+5637-5638,U+563a,U+563c-563e,U+5640-564b,U+564f-5653,U+5655-5656,U+565a-565b,U+565d-5661,U+5663,U+5665-5667,U+566d-5670,U+5672-5675,U+5677-567a,U+567d-5684,U+5687-568d,U+5690-5692,U+5694-56a2,U+56a4-56ae,U+56b0-56b6,U+56b8-56bb,U+56bd-56c9,U+56cb-56cf"}},{uri:X6e,descriptors:{unicodeRange:"U+5286-5287,U+5289-528f,U+5291-5292,U+5294-529a,U+529c,U+52a4-52a7,U+52ae-52b0,U+52b4-52bd,U+52c0-52c2,U+52c4-52c6,U+52c8,U+52ca,U+52cc-52cf,U+52d1,U+52d3-52d5,U+52d7,U+52d9-52de,U+52e0-52e3,U+52e5-52ef,U+52f1-52f8,U+52fb-52fd,U+5301-5304,U+5307,U+5309-530c,U+530e,U+5311-5314,U+5318,U+531b-531c,U+531e-531f,U+5322,U+5324-5325,U+5327-5329,U+532b-532d,U+532f-5338,U+533c-533d,U+5340,U+5342,U+5344,U+5346,U+534b-534d,U+5350,U+5354,U+5358-5359,U+535b,U+535d,U+5365,U+5368,U+536a,U+536c-536d,U+5372,U+5376,U+5379,U+537b-537e,U+5380-5381,U+5383,U+5387-5388,U+538a,U+538e-5394,U+5396-5397,U+5399,U+539b-539c,U+539e,U+53a0-53a1,U+53a4,U+53a7,U+53aa-53ad,U+53af-53b5,U+53b7-53ba,U+53bc-53be,U+53c0,U+53c3-53c7,U+53ce-53d0,U+53d2-53d3,U+53d5,U+53da,U+53dc-53de,U+53e1-53e2,U+53e7,U+53f4,U+53fa,U+53fe-5400,U+5402,U+5405,U+5407,U+540b,U+5414,U+5418-541a,U+541c,U+5422,U+5424-5425,U+542a,U+5430,U+5433,U+5436-5437,U+543a"}},{uri:j6e,descriptors:{unicodeRange:"U+5101-5105,U+5108-510a,U+510c-5111,U+5113-5120,U+5122-513e,U+5142,U+5147,U+514a,U+514c,U+514e-5150,U+5152-5153,U+5157-5159,U+515b,U+515d-5161,U+5163-5164,U+5166-5167,U+5169-516a,U+516f,U+5172,U+517a,U+517e-517f,U+5183-5184,U+5186-5187,U+518a-518b,U+518e-5191,U+5193-5194,U+5198,U+519a,U+519d-519f,U+51a1,U+51a3,U+51a6-51aa,U+51ad-51ae,U+51b4,U+51b8-51ba,U+51be-51bf,U+51c1-51c3,U+51c5,U+51c8,U+51ca,U+51cd-51ce,U+51d0,U+51d2-51da,U+51dc,U+51de-51df,U+51e2-51e3,U+51e5-51ea,U+51ec,U+51ee,U+51f1-51f2,U+51f4,U+51f7,U+51fe,U+5204-5205,U+5209,U+520b-520c,U+520f-5210,U+5213-5215,U+521c,U+521e-521f,U+5221-5223,U+5225-5227,U+522a,U+522c,U+522f,U+5231-5232,U+5234-5235,U+523c,U+523e,U+5244-5249,U+524b,U+524e-524f,U+5252-5253,U+5255,U+5257-525b,U+525d,U+525f-5260,U+5262-5264,U+5266,U+5268,U+526b-526e,U+5270-5271,U+5273-527c,U+527e,U+5280,U+5283-5285"}},{uri:Y6e,descriptors:{unicodeRange:"U+543d,U+543f,U+5441-5442,U+5444-5445,U+5447,U+5449,U+544c-544f,U+5451,U+545a,U+545d-5461,U+5463,U+5465,U+5467,U+5469-5470,U+5474,U+5479-547a,U+547e-547f,U+5481,U+5483,U+5485,U+5487-548a,U+548d,U+5491,U+5493,U+5497-5498,U+549c,U+549e-54a2,U+54a5,U+54ae,U+54b0,U+54b2,U+54b5-54b7,U+54b9-54ba,U+54bc,U+54be,U+54c3,U+54c5,U+54ca-54cb,U+54d6,U+54d8,U+54db,U+54e0-54e4,U+54eb-54ec,U+54ef-54f1,U+54f4-54f9,U+54fb,U+54fe,U+5500,U+5502-5505,U+5508,U+550a-550e,U+5512-5513,U+5515-551a,U+551c-551f,U+5521,U+5525-5526,U+5528-5529,U+552b,U+552d,U+5532,U+5534-5536,U+5538-553b,U+553d,U+5540,U+5542,U+5545,U+5547-5548,U+554b-554f,U+5551-5554,U+5557-555b,U+555d-5560,U+5562-5563,U+5568-5569,U+556b,U+556f-5574,U+5579-557a,U+557d,U+557f,U+5585-5586,U+558c-558e,U+5590,U+5592-5593,U+5595-5597,U+559a-559b,U+559e,U+55a0-55a6,U+55a8-55b0,U+55b2,U+55b4,U+55b6,U+55b8,U+55ba,U+55bc,U+55bf-55c3,U+55c6-55c8,U+55ca-55cb,U+55ce-55d0,U+55d5,U+55d7-55db,U+55de,U+55e0,U+55e2,U+55e7,U+55e9,U+55ed-55ee,U+55f0-55f1,U+55f4,U+55f6,U+55f8"}},{uri:W6e,descriptors:{unicodeRange:"U+4fe0,U+4fe2,U+4fe4-4fe5,U+4fe7,U+4feb-4fec,U+4ff0,U+4ff2,U+4ff4-4ff7,U+4ff9,U+4ffb-4ffd,U+4fff-500b,U+500e,U+5010-5011,U+5013,U+5015-5017,U+501b,U+501d-501e,U+5020,U+5022-5024,U+5027,U+502b,U+502f-5039,U+503b,U+503d,U+503f-5042,U+5044-5046,U+5049-504b,U+504d,U+5050-5054,U+5056-5059,U+505b,U+505d-5064,U+5066-506b,U+506d-5075,U+5078-507a,U+507c-507d,U+5081-5084,U+5086-5087,U+5089-508c,U+508e-50a2,U+50a4,U+50a6,U+50aa-50ab,U+50ad-50b1,U+50b3-50b9,U+50bc-50ce,U+50d0-50d5,U+50d7-50d9,U+50db-50e5,U+50e8-50eb,U+50ef-50f2,U+50f4,U+50f6-50fa,U+50fc-5100"}},{uri:Bbe,descriptors:{unicodeRange:"U+49d5-4a77"}},{uri:K6e,descriptors:{unicodeRange:"U+4dac-4dad,U+4daf-4db5,U+4e02,U+4e04-4e06,U+4e0f,U+4e12,U+4e17,U+4e1f-4e21,U+4e23,U+4e26,U+4e29,U+4e2e-4e2f,U+4e31,U+4e33,U+4e35,U+4e37,U+4e3c,U+4e40-4e42,U+4e44,U+4e46,U+4e4a,U+4e51,U+4e55,U+4e57,U+4e5a-4e5b,U+4e62-4e65,U+4e67-4e68,U+4e6a-4e6f,U+4e72,U+4e74-4e7d,U+4e7f-4e85,U+4e87,U+4e8a,U+4e90,U+4e96-4e97,U+4e99,U+4e9c-4e9e,U+4ea3,U+4eaa,U+4eaf-4eb1,U+4eb4,U+4eb6-4eb9,U+4ebc-4ebe,U+4ec8,U+4ecc,U+4ecf-4ed0,U+4ed2,U+4eda-4edc,U+4ee0,U+4ee2,U+4ee6-4ee7,U+4ee9,U+4eed-4eef,U+4ef1,U+4ef4,U+4ef8-4efa,U+4efc,U+4efe,U+4f00,U+4f02-4f08,U+4f0b-4f0c,U+4f12-4f16,U+4f1c-4f1d,U+4f21,U+4f23,U+4f28-4f29,U+4f2c-4f2e,U+4f31,U+4f33,U+4f35,U+4f37,U+4f39,U+4f3b,U+4f3e-4f42,U+4f44-4f45,U+4f47-4f4c,U+4f52,U+4f54,U+4f56,U+4f61-4f62,U+4f66,U+4f68,U+4f6a-4f6b,U+4f6d-4f6e,U+4f71-4f72,U+4f75,U+4f77-4f7a,U+4f7d,U+4f80-4f82,U+4f85-4f87,U+4f8a,U+4f8c,U+4f8e,U+4f90,U+4f92-4f93,U+4f95-4f96,U+4f98-4f9a,U+4f9c,U+4f9e-4f9f,U+4fa1-4fa2,U+4fa4,U+4fab,U+4fad,U+4fb0-4fb4,U+4fb6-4fbe,U+4fc0-4fc2,U+4fc6-4fc9,U+4fcb-4fcd,U+4fd2-4fd6,U+4fd9,U+4fdb"}},{uri:Z6e,descriptors:{unicodeRange:"U+4933-49d4"}},{uri:q6e,descriptors:{unicodeRange:"U+487a-4932"}},{uri:Q6e,descriptors:{unicodeRange:"U+47d2-4879,U+2ce7c,U+2ce88,U+2ce93"}},{uri:J6e,descriptors:{unicodeRange:"U+4756-47d1,U+2ca02,U+2ca0e,U+2ca7d,U+2caa9,U+2cb29,U+2cb2e,U+2cb31,U+2cb38-2cb39,U+2cb3f,U+2cb41,U+2cb4e,U+2cb5a,U+2cb64,U+2cb69,U+2cb6c,U+2cb6f,U+2cb76,U+2cb78,U+2cb7c,U+2cbb1,U+2cbbf-2cbc0,U+2cbce,U+2cc5f,U+2ccf5-2ccf6,U+2ccfd,U+2ccff,U+2cd02-2cd03,U+2cd0a,U+2cd8b,U+2cd8d,U+2cd8f-2cd90,U+2cd9f-2cda0,U+2cda8,U+2cdad-2cdae,U+2cdd5,U+2ce18,U+2ce1a,U+2ce23,U+2ce26,U+2ce2a"}},{uri:e5e,descriptors:{unicodeRange:"U+46c3-4755,U+2c488,U+2c494,U+2c497,U+2c542,U+2c613,U+2c618,U+2c621,U+2c629,U+2c62b-2c62d,U+2c62f,U+2c642,U+2c64a-2c64b,U+2c72c,U+2c72f,U+2c79f,U+2c7c1,U+2c7fd,U+2c8d9,U+2c8de,U+2c8e1,U+2c8f3,U+2c907,U+2c90a,U+2c91d"}},{uri:t5e,descriptors:{unicodeRange:"U+4629-46c2,U+2bdf7,U+2be29,U+2c029-2c02a,U+2c0a9,U+2c0ca,U+2c1d5,U+2c1d9,U+2c1f9,U+2c27c,U+2c288,U+2c2a4,U+2c317,U+2c35b,U+2c361,U+2c364"}},{uri:n5e,descriptors:{unicodeRange:"U+458e-4628,U+2b7a9,U+2b7c5,U+2b7e6,U+2b7f9,U+2b806,U+2b80a,U+2b81c,U+2b8b8,U+2bac7,U+2bb5f,U+2bb62,U+2bb7c,U+2bb83,U+2bc1b,U+2bd77,U+2bd87"}},{uri:i5e,descriptors:{unicodeRange:"U+4449-4511,U+2afa2,U+2b127-2b128,U+2b137-2b138,U+2b1ed"}},{uri:s5e,descriptors:{unicodeRange:"U+439b-4448,U+2a437,U+2a5f1,U+2a602,U+2a61a,U+2a6b2,U+2a7dd,U+2a8fb,U+2a917,U+2aa30,U+2aa36,U+2aa58"}},{uri:r5e,descriptors:{unicodeRange:"U+4275-430d,U+298c6,U+29a72,U+29d98,U+29ddb,U+29e15,U+29e3d,U+29e49"}},{uri:o5e,descriptors:{unicodeRange:"U+4132-41de,U+28bef,U+28c47,U+28c4f,U+28c51,U+28c54,U+28d10,U+28d71,U+28dfb,U+28e1f,U+28e36,U+28e89,U+28e99,U+28eeb,U+28f32,U+28ff8,U+292a0"}},{uri:a5e,descriptors:{unicodeRange:"U+41df-4274,U+292b1,U+29490,U+295cf,U+2967f,U+296f0,U+29719,U+29750"}},{uri:l5e,descriptors:{unicodeRange:"U+408e-4131,U+285c8-285c9,U+28678,U+28695,U+286d7,U+286fa,U+287e0,U+28946,U+28949,U+2896b,U+28987-28988,U+289ba-289bb,U+28a1e,U+28a29,U+28a43,U+28a71,U+28a99,U+28acd,U+28add,U+28ae4,U+28b49,U+28bc1"}},{uri:c5e,descriptors:{unicodeRange:"U+3e83-3f2f,U+27139,U+273da-273db,U+273fe,U+27410,U+27449,U+27614-27615,U+27631,U+27684,U+27693,U+2770e,U+27723,U+27752"}},{uri:d5e,descriptors:{unicodeRange:"U+3f30-3fdb,U+27985,U+27a84,U+27bb3,U+27bbe,U+27bc7,U+27cb8,U+27da0,U+27e10"}},{uri:u5e,descriptors:{unicodeRange:"U+3fdc-408d,U+27fb7,U+27ff9,U+2808a,U+280bb,U+2815d,U+28277,U+28282,U+282e2,U+282f3,U+283cd,U+28408,U+2840c,U+28455,U+28468,U+2856b"}},{uri:f5e,descriptors:{unicodeRange:"U+3dd2-3e82,U+26a58,U+26a8c,U+26ab7,U+26aff,U+26b5c,U+26c21,U+26c29,U+26c73,U+26cdd,U+26e40,U+26e65,U+26f94,U+26ff6-26ff8,U+270f4,U+2710d"}},{uri:h5e,descriptors:{unicodeRange:"U+3d34-3dd1,U+2648d,U+26676,U+2667e,U+266b0,U+2671d,U+2677c,U+267cc,U+268dd,U+268ea,U+26951,U+2696f,U+269dd,U+269fa,U+26a1e"}},{uri:g5e,descriptors:{unicodeRange:"U+3c76-3d33,U+25d0a,U+25da1,U+25e2e,U+25e56,U+25e62,U+25e65,U+25ec2,U+25ed7-25ed8,U+25ee8,U+25f23,U+25f5c,U+25fd4,U+25fe0,U+25ffb,U+2600c,U+26017,U+26060,U+260ed,U+26221,U+26270,U+26286,U+2634c,U+26402"}},{uri:m5e,descriptors:{unicodeRange:"U+3bda-3c75,U+25771,U+257a9,U+257b4,U+259c4,U+259d4,U+25ae3-25ae4,U+25af1,U+25bb2,U+25c14,U+25c4b,U+25c64"}},{uri:p5e,descriptors:{unicodeRange:"U+3b25-3bd9,U+2504a,U+25055,U+25122,U+2512b,U+251a9,U+251cd,U+251e5,U+2521e,U+2524c,U+2542e,U+2548e,U+254d9,U+2550e,U+25532,U+25562,U+255a7-255a8"}},{uri:U5e,descriptors:{unicodeRange:"U+3a6b-3b24,U+24896,U+249db,U+24a4d,U+24a7d,U+24ac9,U+24b56,U+24b6f,U+24c16,U+24d14,U+24dea,U+24e0e,U+24e37,U+24e6a,U+24e8b,U+24eaa"}},{uri:b5e,descriptors:{unicodeRange:"U+39a9-3a6a,U+24096,U+24103,U+241ac,U+241c6,U+241fe,U+243bc,U+243f8,U+244d3,U+24629,U+246a5,U+247f1"}},{uri:y5e,descriptors:{unicodeRange:"U+38e3-39a8,U+23a98,U+23c7f,U+23c97-23c98,U+23cfe,U+23d00,U+23d0e,U+23d40,U+23dd3,U+23df9-23dfa,U+23e23,U+23f7e"}},{uri:E5e,descriptors:{unicodeRange:"U+3760-382a,U+22ab8,U+22b43,U+22b46,U+22b4f-22b50,U+22ba6,U+22bca,U+22c1d,U+22c24,U+22c55,U+22d4c,U+22de1"}},{uri:v5e,descriptors:{unicodeRange:"U+382b-38e2,U+231b6,U+231c3-231c4,U+231f5,U+23350,U+23372,U+233d0,U+233d2-233d3,U+233d5,U+233da,U+233df,U+233e4,U+2344a-2344b,U+23451,U+23465,U+234e4,U+2355a,U+23594,U+235c4,U+235cb,U+23638-2363a,U+23647,U+2370c,U+2371c,U+2373f,U+23763-23764,U+237e7,U+237ff,U+23824,U+2383d"}},{uri:_5e,descriptors:{unicodeRange:"U+3698-375f,U+22218,U+2231e,U+223ad,U+224dc,U+226f3,U+2285b,U+228ab,U+2298f"}},{uri:w5e,descriptors:{unicodeRange:"U+35e6-3697,U+21c56,U+21cde,U+21d2d,U+21d45,U+21d62,U+21d78,U+21d92,U+21d9c,U+21da1,U+21db7,U+21de0,U+21e33-21e34,U+21f1e,U+21f76,U+21ffa,U+2217b"}},{uri:T5e,descriptors:{unicodeRange:"U+3444-350e,U+20ad3,U+20b1d,U+20b9f,U+20c41,U+20cbf,U+20cd0,U+20d45,U+20de1,U+20e64,U+20e6d,U+20e95,U+20e9d,U+20ea2,U+20f5f,U+210c1,U+21201,U+2123d,U+21255,U+21274,U+2127b"}},{uri:I5e,descriptors:{unicodeRange:"U+350f-35e5,U+212d7,U+212e4,U+212fd,U+2131b,U+21336,U+21344,U+2139a,U+213c4,U+21413,U+2146d-2146e,U+215d7,U+21647,U+216b4,U+21706,U+21742,U+218bd,U+219c3"}},{uri:S5e,descriptors:{unicodeRange:"U+336d-3443,U+2032b,U+20371,U+20381,U+203f9,U+2044a,U+20509,U+20547,U+205d6,U+20628,U+20676,U+2074f,U+20779,U+20807,U+2083a,U+20895,U+208b9,U+2097c,U+2099d"}},{uri:C5e,descriptors:{unicodeRange:"U+328b-336c,U+2000b,U+20089,U+200a2,U+200a4,U+20164,U+201a2,U+20213"}},{uri:x5e,descriptors:{unicodeRange:"U+3192-31ba,U+31c0-31e3,U+31f0-321e,U+3220-328a,U+1f250-1f251"}},{uri:A5e,descriptors:{unicodeRange:"U+2f74-2fd5,U+3000,U+3003-3007,U+3012-3013,U+3018-301c,U+3020-3029,U+302f-303f,U+3041-3096,U+3099-30a1"}},{uri:M5e,descriptors:{unicodeRange:"U+30a2-30ff,U+3105-312f,U+3131-318e,U+3190-3191"}},{uri:k5e,descriptors:{unicodeRange:"U+4e36,U+4ea0,U+4f74,U+4f91,U+4f94,U+4fc5,U+507e,U+50ed,U+5182,U+51f5,U+525e,U+5282,U+52f9,U+5326,U+537a,U+53a3,U+5423,U+5459,U+54b4,U+54d9,U+55c9,U+57f4,U+580b,U+5902,U+5925,U+5a08,U+5ab5,U+5b84,U+5be4,U+5c22,U+5cb5,U+5cbd,U+5d3e,U+5e31,U+5e5e,U+5e80,U+5ee8,U+5f82,U+5fc9,U+5fed,U+600a,U+605d,U+609b,U+609d,U+60dd,U+6243,U+6322,U+63ce,U+640c,U+643f,U+6445,U+64d7,U+6534,U+6549,U+656b,U+6603,U+674c,U+680a,U+6864,U+69d4,U+6a65,U+6c2a,U+6c46,U+6c5c,U+6d0e,U+6d48,U+6e2b,U+6eb2,U+6eb7,U+6f89,U+706c,U+70b1,U+7113,U+71d4,U+727f,U+72f3,U+7303,U+7321,U+736c,U+736f,U+74a9,U+74de,U+750d,U+7513,U+7592,U+75c4,U+7605,U+760a,U+761b,U+7625,U+762d,U+7643,U+7707,U+7747,U+77b5,U+7839,U+784e,U+78a5,U+7924,U+793b,U+798a,U+7a03,U+7a06,U+7a78,U+7a80,U+7aad,U+7ba8,U+7be5,U+7cc8,U+7ec1,U+7f0b,U+7f0f,U+7f12,U+7f68,U+7f9d,U+8025,U+809c,U+80ad,U+80b7,U+80e8,U+811e,U+8204,U+8223,U+822d,U+823b,U+824b,U+825a,U+827d,U+827f,U+828f,U+82c8,U+8307,U+831b,U+8347,U+837d,U+839b,U+83a9,U+83f9,U+84b9,U+8579,U+864d,U+867f,U+86b0,U+86d1,U+86d8,U+86f2,U+8764,U+8770,U+8788,U+8797,U+87ac-87ad,U+87b5,U+881b,U+8844,U+88bc,U+88fc,U+8930,U+89cf,U+89d6,U+8ba0,U+8bd4,U+8c02,U+8c2b,U+8c85,U+8e23,U+8f81-8f82,U+8fd5,U+90b6,U+90db,U+914e,U+9164,U+91ad,U+943e,U+94b7-94b8,U+94eb,U+950d,U+9514,U+9516,U+9518,U+9529,U+9538,U+953f,U+954e,U+955f,U+95fc,U+9667,U+96b3,U+9792,U+97b2,U+98a1,U+9969,U+9987,U+9998,U+9a80,U+9a92,U+9a96,U+9adf,U+9cb4,U+9cbd,U+9cd0,U+9cd4,U+9e31,U+9e3a,U+9e71,U+9ee5,U+9eea,U+9ef9,U+9fa0"}},{uri:R5e,descriptors:{unicodeRange:"U+4e0c,U+4e28,U+4e3f,U+4ec2,U+502e,U+50ba,U+5155,U+5181,U+522d,U+5281,U+5290,U+5369,U+53b6,U+54d5,U+54dc,U+54ff,U+552a,U+553c,U+5588,U+55b5,U+5686,U+570a,U+5776,U+5786,U+57a4,U+5820,U+5865,U+58bc,U+5b32,U+5b65,U+5c1c,U+5c66,U+5c6e,U+5c8d,U+5ddb,U+5f2a,U+5f50,U+5f61,U+6067,U+614a,U+615d,U+619d,U+61d4,U+620b,U+6224-6225,U+6343,U+63ad,U+63f2,U+640b,U+6420,U+6434,U+6496,U+64d0,U+6509,U+652e,U+67a8,U+6833,U+6844,U+684a,U+6920,U+6957,U+6971,U+6a8e,U+6a91,U+6aa0,U+6b43,U+6bea,U+6bf5,U+6c15,U+6cd0,U+6ee0,U+6f24,U+6f2d,U+70c0,U+721d,U+728b,U+72c3,U+72e8,U+730a,U+7338-7339,U+734d,U+746d,U+752f,U+754e,U+770d,U+7735,U+778d,U+77a2,U+77e7,U+7857,U+786d,U+78c9,U+78f2,U+791e,U+7953,U+7b58,U+7b9d,U+7bda,U+7cd7,U+7f32-7f33,U+8022,U+8028-8029,U+8035,U+804d,U+8080,U+80c2,U+80e9,U+80ec,U+80f2,U+810e,U+8221,U+8274,U+82b0,U+82e0,U+83b0,U+8487-8488,U+848e,U+84cd,U+84d0,U+8539,U+857a,U+85a8,U+85b7,U+867c,U+871e,U+8723,U+877e,U+878b,U+8793,U+8803,U+88d2,U+8966,U+89cc,U+89eb,U+8b26,U+8c8a,U+8c98,U+8d33,U+8d47,U+8d55,U+8dbc,U+8e40,U+8e94,U+8f77,U+8f79,U+9058,U+91a2,U+91b5,U+928e,U+9494,U+94b6,U+94de,U+94f4,U+94f9,U+950a,U+950e,U+951e,U+952b,U+953c,U+953e,U+9544,U+9561,U+9564,U+9569,U+95f6,U+9603,U+960d,U+963d,U+9674,U+9794,U+97ab,U+98a5,U+9a9f,U+9ab1,U+9ad1,U+9b0f,U+9b2f,U+9c92,U+9c95,U+9cba,U+9cbc,U+9cc6,U+9ccb,U+9cd8,U+9e32,U+9e38,U+9e5b,U+9e7e,U+9eb4,U+9efb-9efc,U+9f3d"}},{uri:D5e,descriptors:{unicodeRange:"U+2e3b,U+2e80-2e99,U+2e9b-2ef3,U+2f00-2f73,U+ffffd"}},{uri:L5e,descriptors:{unicodeRange:"U+4e69,U+4f1b,U+4f67,U+4f7e,U+4fdc,U+50e6,U+5196,U+5202,U+5233,U+523f,U+52a2,U+536e,U+5476,U+54ad,U+54cf,U+5537,U+561e,U+56dd,U+56df,U+5709,U+572c,U+57cf,U+57f8,U+580d,U+5881,U+589a,U+5941,U+59b2,U+5c25,U+5d24,U+5d74,U+5e42,U+5e8b,U+5eb3,U+5ed2,U+5fad,U+6003,U+603c,U+6083,U+6100,U+6126,U+6206,U+62ca,U+638e,U+63b4,U+6426,U+646d,U+6535,U+65c4,U+66db,U+6715,U+6769,U+6798,U+67c3,U+6861,U+698d,U+69ca,U+69ed,U+69f2,U+69ff,U+6a18,U+6b39,U+6bb3,U+6c0d,U+6cb2,U+6cd6,U+6cf7,U+6cfa,U+6d33,U+6e16,U+6e53-6e54,U+6ebb,U+6fb6,U+709d,U+72ad,U+72f7,U+72fb,U+7313,U+739f,U+74ba,U+754b,U+755b,U+758b,U+75ac,U+75d6,U+7617,U+7635,U+7640,U+76a4,U+76b2,U+775a,U+77bd,U+781f,U+79b3,U+7b2b,U+7b31,U+7b3e,U+7b6e,U+7b9c,U+7c0b,U+7c9e,U+7cc1,U+7ce8,U+7ea5,U+7f21,U+7f27,U+7f74,U+7fb0,U+8031,U+8071,U+80ea,U+8114,U+8160,U+81a6,U+81c1,U+829f,U+82a4,U+82fb,U+831a,U+8333,U+836c,U+83b6,U+83f8,U+8411,U+841c,U+8489,U+848c,U+85a4,U+8627,U+8629,U+866e,U+86b5,U+872e,U+8731,U+877b,U+877d,U+87ea,U+8813,U+8816,U+8864,U+88ce,U+88e5,U+897b,U+89cb,U+89f3,U+8bfc,U+8c35,U+8d46,U+8d4d,U+8dba,U+8e3a,U+8f75,U+8f7e,U+8fd3,U+9161,U+9179,U+917e,U+91a3,U+94ac,U+94d7,U+94e5,U+952a,U+952c,U+9545,U+9565,U+9568,U+956a,U+961d,U+96e0,U+972a,U+9730,U+989f,U+98e7,U+990d,U+9967,U+9993,U+9aa3,U+9ac0,U+9ae1,U+9aeb,U+9af9,U+9c86,U+9c8b,U+9ca0-9ca1,U+9ca3,U+9ce2,U+9e48,U+9e6a,U+9e87,U+9ee2,U+9ee9,U+9f17,U+9f19,U+9f2c,U+9f80"}},{uri:P5e,descriptors:{unicodeRange:"U+4ef3,U+50d6,U+50ec,U+51ab,U+51b1,U+52d6,U+54a9,U+54da,U+55be,U+55cd,U+564d,U+572f,U+574c,U+576b,U+57d8,U+57fd,U+5844,U+59d2,U+5ae0,U+5b16,U+5b37,U+5b5b,U+5b80,U+5d1e,U+5d6b,U+5efe,U+5f11,U+5f56,U+5f58,U+5f73,U+5f8c,U+5fc4,U+5fe4,U+602b,U+6106,U+610d,U+63de,U+63f8,U+641b,U+64e4,U+6634,U+676a,U+67b5,U+681d,U+6883,U+69b1,U+69e0,U+6b37,U+6b9b,U+6d7c,U+6ed7,U+6f36,U+6f72,U+6f8c,U+7035,U+7039,U+7173,U+7178,U+7228,U+728f,U+72b4,U+72ef,U+72f4,U+7331,U+7481,U+74e0,U+7540,U+75c3,U+75e6,U+763c,U+764d,U+76cd,U+7704,U+7743,U+7780,U+7847,U+786a,U+78b9,U+7962,U+7a02,U+7aac,U+7ab3,U+7b0a,U+7b4c,U+7b7b,U+7bfc,U+7c0f,U+7c16,U+7c40,U+7ca2,U+7cc7,U+7cf8,U+7d77,U+7e3b,U+7ea1,U+7ea9,U+7ef2,U+7f02,U+7f07,U+7f0c,U+7f23,U+7f2f,U+7fbc,U+8016,U+8020,U+812c,U+8136,U+8182,U+822f,U+8233,U+825f,U+8268,U+8284,U+8288,U+8291,U+8308,U+8311,U+835b,U+836d,U+83dd,U+8406,U+840f,U+845c,U+84b4,U+84e3,U+850c,U+855e,U+863c,U+86ba,U+86c4,U+86de,U+86f1,U+873e,U+87bd,U+87db,U+880a,U+883c,U+887f,U+88f0,U+890a,U+892b,U+895e,U+89ef,U+8a48,U+8bdc,U+8c18,U+8c33,U+8c94,U+8db1,U+8dcf,U+8dd6,U+8de3,U+8e6f,U+8e90,U+8f7a,U+8fb6,U+902d,U+90be,U+91af,U+936a,U+948b,U+94d8,U+9513,U+953a,U+956c,U+963c,U+9654,U+966c,U+9688,U+97b4,U+996b,U+9a75,U+9a7a,U+9aba,U+9aed,U+9b08,U+9b43,U+9c8e,U+9c94,U+9c9a,U+9e2b,U+9e36,U+9e4b,U+9e4e,U+9e55,U+9e63,U+9e68-9e69,U+9ebd,U+9ec9,U+9f0d,U+9f37,U+9f51"}},{uri:N5e,descriptors:{unicodeRange:"U+50a7,U+5240,U+5261,U+52ac,U+531a,U+5363,U+5432,U+5452,U+5456,U+5472,U+5478,U+553f,U+5575,U+5581,U+55cc,U+55fe,U+5601,U+572e,U+57d2,U+57ef,U+581e,U+5924,U+5981,U+5997,U+59a3,U+5aaa,U+5ab8,U+5b34,U+5d5d,U+5def,U+5e11,U+5e91,U+5ed1,U+5ef4,U+5f40,U+600d,U+6019,U+601b,U+605a,U+6092,U+60ab,U+6217,U+623d,U+6369,U+65d2,U+6661,U+670a,U+6753,U+67a7,U+6855,U+68f9,U+6939,U+696e,U+6980,U+6a7c,U+6aab,U+6b82,U+6bf3,U+6bf9,U+6c05,U+6c19-6c1a,U+6ca9,U+6cf6,U+6d1a,U+6dab,U+6f74,U+7085,U+7198,U+71b5,U+7256,U+725d,U+727e,U+72fa,U+7322,U+738e,U+73e5,U+750f,U+755a,U+7594,U+75b3,U+760c,U+7615,U+7630,U+763f,U+77ec,U+7817,U+78a1,U+78d9,U+7905,U+7b2a,U+7b2e,U+7b62,U+7b85,U+7bcc,U+7bea,U+7c26,U+7c74,U+7c9c-7c9d,U+7e47,U+7e9b,U+7e9f,U+7ee0,U+7ee8,U+7ef1,U+7f01,U+7f11,U+7f17,U+7f36,U+7f7e,U+7fee,U+802a,U+80cd,U+8112,U+8169,U+8234,U+8279,U+8298,U+82ca,U+82d8,U+82e1,U+83c0,U+83d4,U+83df,U+8401,U+8451,U+845a,U+8476,U+8478,U+84ba,U+84bd,U+84e0,U+851f,U+8548,U+8556,U+8585,U+868d,U+86e9,U+86f4,U+86f8,U+8765,U+8785,U+87ab,U+87ee,U+8832,U+8872,U+88b7,U+88e2-88e3,U+89da,U+8bce,U+8bd3,U+8bd6,U+8bf9,U+8c16,U+8c73,U+8d5c,U+8dde,U+8f6d,U+8f94,U+8fe8,U+9011,U+915e,U+9185,U+918c,U+94ab,U+94d1,U+94f3,U+9515,U+951d,U+9558,U+9567,U+96ce,U+96e9,U+9785,U+9878,U+987c,U+9883,U+98d1,U+9954,U+9963,U+9a93,U+9ac1,U+9acc,U+9b1f,U+9b49,U+9b4d,U+9b51,U+9ca7,U+9cae,U+9cce,U+9cd3,U+9e37,U+9e39,U+9e41,U+9e46,U+9f22,U+9f2f,U+9f39,U+9f85"}},{uri:O5e,descriptors:{unicodeRange:"U+4e5c,U+4edf,U+4f25,U+4f32,U+4f5e,U+4f76,U+4faa,U+4fe6,U+5028,U+5048,U+5250,U+535f,U+538d,U+53c1,U+5412,U+5443,U+54d4,U+54dd,U+5541,U+5550,U+5577,U+55dd,U+55f3,U+560f,U+562c,U+5657-5658,U+5664,U+56af,U+575c,U+577c,U+57b2,U+57da,U+5800,U+5a62,U+5aeb,U+5c3b,U+5ca3,U+5d26,U+5d9d,U+5f01,U+5fb5,U+5fdd,U+5ff8,U+6029,U+6041,U+6079,U+60b1,U+6222,U+629f,U+6332,U+63bc,U+63e0,U+6485,U+65ab,U+65c3,U+65c6,U+668c,U+669d,U+66be,U+67fd,U+6800,U+68fc,U+690b,U+6924,U+6978,U+69a7,U+6a3e,U+6a50,U+6a5b,U+6a97,U+6b24,U+6b8d,U+6baa,U+6c10,U+6c54,U+6ceb,U+6d04,U+6d4d,U+6eb1,U+6ebd,U+7110,U+71b3,U+71f9,U+7230,U+728d,U+7292,U+72b8,U+72d2,U+7360,U+73a2,U+7511,U+75a0,U+75c8,U+779f,U+7826,U+7877,U+7a39,U+7aa8,U+7ae6,U+7b04,U+7b0f,U+7baa,U+7bac,U+7c1f,U+7ccd,U+7ecb,U+7ed4,U+7ed7,U+7efb,U+7f0d,U+7f5f,U+7faf,U+7fd5,U+7fe5,U+8027,U+80bc,U+80dd,U+80fc,U+8132,U+815a,U+8167,U+816d,U+81ca,U+8228,U+82a1,U+82a9,U+82ab,U+82cc,U+8351,U+8368,U+83b8,U+83d8,U+83ea,U+83f0,U+8497,U+84c1,U+858f,U+85ff,U+867b,U+86a8-86a9,U+870a,U+8722,U+876e,U+877c,U+87e5,U+8888,U+88df,U+8919,U+8bcc,U+8bdf,U+8be8,U+8bee,U+8c20,U+8c2f,U+8d36,U+8df8,U+8e05,U+8e2f,U+8f9a,U+9021,U+908b,U+90b4,U+90ba,U+90d0,U+90eb,U+90fe,U+91aa,U+933e,U+9486-9487,U+948d,U+9490,U+94ad,U+94bd,U+94d6,U+94d9,U+9507,U+9546,U+955e,U+956b,U+95e9,U+9604,U+960b,U+9612,U+9615,U+9617,U+96b9,U+989a-989b,U+989e,U+9a78,U+9a7d,U+9aa0,U+9aa2,U+9ac2,U+9b23,U+9b3b,U+9c82,U+9cca,U+9cd9,U+9e28,U+9e5a,U+9e5e,U+9e6c,U+9efe,U+9f0b"}},{uri:F5e,descriptors:{unicodeRange:"U+4e47,U+4e8d,U+4f65,U+4f89,U+50ee,U+520e,U+5416,U+5454,U+54bb,U+54c2,U+54d3,U+54de,U+5591,U+55e5,U+560c,U+566b,U+5769,U+578c,U+5793,U+57e4,U+5889,U+593c,U+59ab,U+5ad4,U+5ad8,U+5af1,U+5b53,U+5ba5,U+5c59,U+5c63,U+5d5b,U+5e0f,U+5e14,U+5edb,U+5fbc,U+6004,U+60ad,U+610e,U+61b7,U+624c,U+634c,U+647a,U+64ba,U+65f0,U+6600,U+66f7,U+67e2,U+67f0,U+680c,U+686b,U+6874,U+691f,U+6989,U+6a17,U+6b81,U+6b84,U+6c06-6c07,U+6c3d,U+6d07,U+6d27,U+6d2b,U+6d91,U+6e6b,U+6e8f,U+6fde,U+70bb,U+723b,U+726e,U+72b0,U+72ce,U+72f2,U+7301,U+731e,U+737e,U+7477,U+748e,U+74ff,U+7633,U+7654,U+771a,U+7726,U+7765,U+7768,U+781c,U+7829,U+78d4,U+7913,U+7957,U+79d5,U+79eb,U+7a70,U+7a86,U+7b25,U+7b38,U+7b47,U+7b72,U+7ba6-7ba7,U+7dae,U+7ee1,U+7efe,U+7f26,U+7f31,U+7f35,U+801c,U+8043,U+809f,U+80ab,U+80d7,U+8118,U+8188,U+81cc,U+823e,U+8244,U+824f,U+82b4,U+82c1,U+82e4,U+82f4,U+8306,U+833a,U+835c,U+839c,U+83b3,U+83bc,U+846d,U+867a,U+868b,U+8734,U+87ca,U+886e,U+887e,U+88a2,U+88c9,U+8921,U+8bb5,U+8bf3,U+8c04,U+8c17,U+8c1d,U+8c25,U+8c36,U+8c55,U+8c78,U+8d3d,U+8d40,U+8d59,U+8d67,U+8d91,U+8dbf,U+8deb-8dec,U+8dfd,U+8e14,U+8e41,U+8f8e,U+900b,U+9044,U+9062,U+90cf,U+9123,U+9146,U+9162,U+9172,U+918d,U+9190,U+92c8,U+93ca,U+948c,U+94aa,U+94b2,U+94c8,U+94ca,U+94d5,U+94df,U+94e9-94ea,U+94f7,U+94fc-94fd,U+951b,U+954f,U+9554,U+9559,U+9566,U+9571-9572,U+95f1,U+9608,U+960f,U+97af,U+988f,U+98d5,U+992e,U+9955,U+9ab0,U+9b32,U+9c90,U+9c9e,U+9ca5,U+9ca9,U+9cad,U+9cb1,U+9cc3,U+9e47,U+9ee7,U+9f87"}},{uri:B5e,descriptors:{unicodeRange:"U+4e93,U+4ec4,U+4ef5,U+4f27,U+4f7b,U+4fe3,U+5080,U+5121,U+51eb,U+5208,U+52f0,U+53f5,U+5453,U+5466,U+54a6,U+54bf,U+54d0,U+5533,U+5549,U+5556,U+556d,U+558f,U+55f2,U+55f5,U+5627,U+567b,U+56d4,U+571c,U+5739,U+57b4,U+5807,U+58c5,U+59a4,U+59af,U+59d8,U+5a09,U+5a0c,U+5a4a,U+5ad2,U+5b6c,U+5ca2,U+5cac,U+5d03,U+5d6c,U+5db7,U+5ebe,U+5f2d,U+5fea,U+6042,U+6120,U+6175,U+6221,U+623e,U+6339,U+638a,U+643d,U+64b8,U+64e2,U+66e9,U+67b3,U+67c1,U+67d2,U+6832,U+6877,U+68f0,U+6934,U+6966,U+6987,U+6998,U+69c1,U+69ce,U+6a3d,U+6a84,U+6aa9,U+6b87,U+6bd6,U+6c16,U+6c18,U+6cd4,U+6cee,U+6de0,U+6e0c,U+6ecf,U+6f4b,U+70b7,U+7168,U+72d9,U+7352,U+73b3,U+73d0,U+7441,U+74d2,U+75a5,U+75e7-75e8,U+7610,U+7619,U+765e,U+772d,U+7812,U+782c,U+784c,U+7850,U+7856,U+789b,U+78f4,U+7a51,U+7b15,U+7b1e,U+7b24,U+7b5a,U+7bb8,U+7bc1,U+7bd9,U+7ed0,U+7ee6,U+7efa,U+7f1b,U+7f1f,U+7f22,U+7f45,U+7f71,U+7fa7,U+7fbf,U+7ff3,U+8052,U+80b1,U+80db,U+80f4,U+81bb,U+81ec,U+8202,U+8210,U+8249,U+828a,U+828e,U+82e3,U+8315,U+8369,U+8378,U+83a8,U+83aa,U+83b4,U+83e1,U+84fc,U+8538,U+853b,U+859c,U+85ae,U+86b4,U+86c9,U+86cf,U+8725,U+879f,U+87b3,U+887d,U+88fe,U+8a8a,U+8ba7,U+8c07,U+8c14,U+8c30,U+8c47,U+8db5,U+8dd7,U+8e1f,U+8e69,U+8e70,U+8e85,U+8f78,U+8f87,U+8f8b,U+8f8f,U+90c4,U+9143,U+917d,U+948f,U+94cd,U+94d2,U+94ef,U+954a,U+9609-960a,U+96d2,U+9708,U+9765,U+97ea,U+9880,U+98a7,U+996c,U+9980,U+9991,U+9a88,U+9ab6,U+9afb,U+9b47,U+9c87,U+9c9b,U+9cb5,U+9cc7,U+9e2c,U+9e42,U+9e58,U+9ecd,U+9ecf,U+9f8a,U+9f8c"}},{uri:z5e,descriptors:{unicodeRange:"U+4ebb,U+4edd,U+4fa9,U+502c,U+50a5,U+51c7,U+51fc,U+523d,U+5241,U+530f,U+5464,U+549d,U+54a3,U+5514,U+5527,U+555c,U+556e,U+5576,U+55b1,U+55b9,U+55eb,U+5624,U+564c,U+5671,U+5685,U+568f,U+56d7,U+56e1,U+57a1,U+57d9,U+5942,U+5a67,U+5c50,U+5c7a,U+5c98,U+5d06,U+5d27,U+5d6f,U+5df3,U+5dfd,U+5e19,U+5ea0,U+5eb9,U+5eea,U+5ffe,U+600f,U+606b,U+6215,U+622c,U+6266,U+62bb,U+62bf,U+6308,U+6387,U+63b8,U+63c4,U+63c6,U+63f6,U+6441,U+6555,U+659b,U+6677,U+66a7,U+6775,U+678b,U+679e,U+6840,U+6849,U+6860,U+68c2,U+6910,U+6a28,U+6a2f,U+6a79,U+6b92-6b93,U+6bc2,U+6bfd,U+6c29,U+6c32,U+6c86,U+6cc5,U+6d0c,U+6d60,U+6da0,U+6ddd,U+6e86,U+6ed3,U+6edf,U+6fb9,U+6fd1,U+6fef,U+7023,U+7080,U+70ca,U+712f,U+7145,U+7284,U+732c,U+73c8,U+73d9,U+740a,U+7457,U+7596,U+759d,U+75a3,U+75d8,U+75e3-75e4,U+75ff,U+7622,U+7688,U+76b4,U+76e5,U+7818,U+7887,U+789a,U+78b2,U+7b08,U+7b33,U+7c2a,U+7ccc,U+7ea8,U+7ec0,U+7fe6,U+8012,U+8084,U+8093,U+80e4,U+80ef,U+8297,U+82a8,U+82be,U+8331,U+8366,U+83c5,U+83fd,U+8473,U+84a1,U+84ca,U+84d1,U+857b,U+85c1,U+85d3,U+8605,U+8662,U+86aa,U+86b1,U+86d4,U+86ed,U+86f3,U+8709,U+8748,U+874c,U+8763,U+89c7,U+89de,U+89e5,U+8a3e,U+8ba6,U+8c00,U+8c21,U+8c49,U+8c7a,U+8d30,U+8df9,U+8e51,U+8e59,U+8f6b,U+8f73,U+8ff3,U+9016,U+9026,U+902f,U+9099,U+909b,U+90c7,U+914a,U+91ae,U+91ba,U+9495,U+94a3,U+94af,U+94ba,U+94bf,U+94cc,U+94e1,U+94f0,U+9531,U+955d,U+95f3,U+9697,U+96bc,U+975b,U+977c,U+98a2,U+998a,U+9994-9995,U+9a9b,U+9ab7,U+9ac5,U+9c91,U+9ccf,U+9cd5,U+9e29,U+9edc,U+9edf,U+9f83,U+9f88-9f89"}},{uri:H5e,descriptors:{unicodeRange:"U+4ee8,U+4f22,U+4f43,U+4f57,U+4f5d,U+4f6f,U+4ff8,U+502d,U+507b,U+5345,U+53df,U+53fb,U+544b,U+5482,U+54a7,U+54cc,U+550f,U+5544,U+5555,U+5594,U+55e8,U+55ec,U+55ef,U+564e,U+56f9,U+5704,U+576d,U+5785,U+57ad,U+5914,U+5958,U+599e,U+59aa,U+59be,U+5a06,U+5abe,U+5ae1,U+5b40,U+5bee,U+5cbf,U+5cc4,U+5ccb,U+5d47,U+603f,U+6078,U+607d,U+607f,U+608c,U+609a,U+60fa,U+61ff,U+621b,U+622e,U+626a,U+6371,U+63ae,U+63cd,U+63d6,U+6410,U+6414,U+6421,U+6448,U+64d8,U+6710,U+6748,U+6772,U+680e,U+6954,U+69ab,U+6c68,U+6c8f,U+6ca4,U+6d2e,U+6e4e,U+6e98,U+6fe0,U+7094,U+70e9,U+7116,U+7119,U+723f,U+73c9,U+74e4,U+753e,U+7548,U+75bd,U+75cd,U+7618,U+7634,U+76c5,U+76f1,U+7708,U+7719,U+777e,U+7791,U+77b3,U+7823,U+7827,U+7830,U+7889,U+7893,U+7949,U+795c,U+79e3,U+7a14,U+7a88,U+7a95,U+7aa0,U+7afd,U+7b90,U+7bd1,U+7bfe,U+7da6,U+7ec2,U+7eef,U+7f03-7f04,U+7f08,U+7f58,U+7f61,U+7f9f,U+8174,U+8200,U+828d,U+82c4,U+82d5,U+82dc,U+82f7,U+832d,U+835a,U+840b,U+8438,U+852b,U+869d,U+86ac,U+86d0,U+86f0,U+8782,U+87a8,U+87d1-87d2,U+87e0,U+8839,U+8913,U+891b,U+8934,U+8941,U+89ca,U+89ce,U+8a07,U+8ba3,U+8bc5,U+8bcb,U+8bdb,U+8c11,U+8c15,U+8c29,U+8c32,U+8dc4,U+8dce,U+8ddb,U+8dfa,U+8e09,U+8e1d,U+8e39,U+8e42,U+8e49,U+8e4b,U+8e8f,U+8f71-8f72,U+9004,U+9036,U+9097,U+90dc,U+90e2,U+90e6,U+90ef,U+9104,U+919a,U+91b4,U+938f,U+9497,U+950f,U+9557,U+9562-9563,U+9573,U+9606,U+9649,U+972d,U+973e,U+97a3,U+97eb,U+988c,U+9894,U+98a6,U+9974,U+9977,U+997d,U+9a90,U+9a9d,U+9aef,U+9ca2,U+9ccd,U+9cdf,U+9e20,U+9e4c,U+9e6b,U+9f3e"}},{uri:V5e,descriptors:{unicodeRange:"U+4ede,U+4ee1,U+4eeb,U+4fda,U+4ffe,U+5025,U+506c,U+50f3,U+5106,U+520d,U+525c,U+52ad,U+530d,U+5310,U+539d,U+53a9,U+53fc,U+5421,U+5477,U+54e7,U+551b,U+5530,U+557e,U+5599,U+55c4,U+55d1,U+55d4,U+55df,U+55e4,U+55ea,U+5623,U+562d,U+5654,U+56eb,U+56f5,U+57a7,U+57d5,U+57dd,U+584d,U+5880,U+58ec,U+59dd,U+5a32,U+5a55,U+5a75,U+5b51,U+5b71,U+5b73,U+5cd2,U+5ce4,U+5e5b,U+5e96,U+5fd2,U+607b,U+61d1,U+634b,U+636d,U+63b3,U+63ff,U+64c0,U+661d,U+6657,U+66dc,U+67a5,U+6841,U+6867,U+6901,U+699b,U+6a47,U+6b46,U+6c21,U+6c24,U+6c35,U+6c4a,U+6c94,U+6ca3,U+6d39,U+6d63,U+6d6f,U+6d94,U+705e,U+71e7,U+726f,U+72cd,U+72de,U+72f0,U+7325,U+7350,U+7391,U+741a,U+757f,U+7583,U+75b1,U+75b4,U+75b8,U+75c2,U+75f1,U+766f,U+7699,U+7751,U+789c,U+7a17,U+7be6,U+7cb2,U+7ea3,U+7eb0,U+7ebe,U+7eeb,U+7f25,U+7f2c,U+7fb8,U+8026,U+8037,U+8153,U+8171,U+8191,U+8214,U+821b,U+8222,U+826e,U+82eb,U+830c,U+8314,U+8334,U+83d6,U+8418,U+843c,U+84ff,U+8564,U+8572,U+8616,U+866c,U+8693,U+86a3,U+86a7,U+86af,U+86b6,U+86c6,U+86ca,U+8708,U+870d,U+8759,U+8760,U+87af,U+87c6,U+8869,U+88c6,U+89d0,U+8b07,U+8baa-8bab,U+8bc2,U+8be4,U+8bf0,U+8c2a,U+8c62,U+8c89,U+8d49,U+8d6d,U+8d84,U+8d94,U+8db8,U+8dc6,U+8e2e,U+8e3d,U+8e47,U+8e7f,U+9005,U+9051,U+907d,U+9082,U+9088,U+90b0,U+90d3,U+9150,U+949c,U+94a4,U+94b9,U+94cb,U+94e0,U+9509,U+9512,U+951f,U+9534,U+9552-9553,U+965f,U+96b0,U+9791,U+9889,U+9990,U+9a9c,U+9aa7,U+9c88,U+9cb2-9cb3,U+9cb6-9cb7,U+9cc5,U+9cdc,U+9e22,U+9e2a,U+9e57,U+9e67,U+9e73,U+9e82,U+9eb8,U+9ee0,U+9f9b"}},{uri:$5e,descriptors:{unicodeRange:"U+4eb5,U+4f09,U+4f5a,U+4f8f,U+4fce,U+4fdf,U+4fea,U+4ff3,U+500c,U+500f,U+504e,U+5088,U+52be,U+5420,U+5457,U+5499,U+549b,U+54c6,U+54d2,U+558b,U+559f,U+55bd,U+55d6,U+565c,U+567c,U+568e,U+5768,U+577b,U+57a9,U+57ed,U+59f9,U+5a11,U+5a40,U+5ae6,U+5b6a,U+5b93,U+5bb8,U+5c15,U+5c99,U+5c9c,U+5cc1,U+5d2e,U+5d4b,U+5d99,U+5e54,U+5e61,U+5fcf-5fd1,U+6002,U+6006,U+6014,U+60af,U+60c6,U+60da,U+60f4,U+621f,U+62c8,U+631b,U+631e,U+63e9,U+64b5,U+655d,U+6619,U+6635,U+6641,U+67ad,U+67b0,U+67b7,U+67e9,U+684e,U+688f,U+695d,U+696b,U+69b7,U+6a58,U+6c26,U+6d35,U+6d43,U+6d9e,U+6dd9,U+6dec,U+6e11,U+6e6e,U+6e9f,U+6ec2,U+6ee2,U+6ef9,U+6f09,U+6f66,U+6f8d,U+6fc2,U+6fc9,U+729f,U+72c8,U+73de,U+7430,U+7566,U+7579,U+75c9,U+75e2,U+75fc,U+762a,U+7638,U+7678,U+76c2,U+76f9,U+778c,U+77cd,U+77dc,U+7800,U+781d,U+782d,U+783b-783c,U+78a3,U+78ec,U+7980,U+7a23,U+7b95,U+7bdd,U+7c0c,U+7c41,U+7c91,U+7cb3,U+7cc5,U+7ecc,U+7f19,U+7fca,U+8006,U+8069,U+807f,U+80bd,U+80ed,U+814b,U+8198,U+82cb,U+82d2,U+834f,U+8360,U+847a,U+84d6,U+84e5,U+8537,U+85d0,U+8671,U+86a4,U+86ce,U+86f9,U+8703,U+8707,U+8737,U+873b,U+8815,U+8936,U+8bc3,U+8bcf,U+8bd2,U+8bd8,U+8be9,U+8c0c,U+8c0f,U+8c4c,U+8d45,U+8d5d,U+8d73,U+8e31,U+8e6d,U+8e76,U+8fe4,U+9041,U+90d7,U+9169,U+92ae,U+94a1,U+94c4,U+94c9,U+94db,U+94e7,U+9503,U+9506,U+9517,U+9528,U+9537,U+9542,U+9549,U+95fe,U+9616,U+961a,U+96c9,U+96f3,U+9701,U+970e,U+9739,U+9753,U+9798,U+98d2-98d3,U+98d9-98da,U+9968,U+996f,U+9984,U+9997,U+9acb,U+9b03,U+9c85,U+9ca8,U+9cab,U+9e49,U+9e51,U+9e66,U+9f10"}},{uri:G5e,descriptors:{unicodeRange:"U+4e15,U+4e1e,U+4e2b,U+4eb3,U+4ec9,U+4f0e,U+4f64,U+501c,U+50a9,U+510b,U+51a2,U+51bc,U+527d,U+52d0,U+53fd,U+5429,U+542e,U+5486,U+54af,U+5506,U+5511,U+5522,U+552c,U+556c,U+55b3,U+55d2,U+55e6,U+55fd,U+561f,U+5639,U+5659,U+5662,U+5693,U+572a,U+5892,U+598a,U+5992,U+59a9,U+5a20,U+5ae3,U+5b17,U+5b7d,U+5d34,U+5d3d,U+5d4a,U+5d82,U+5e1a-5e1b,U+5ea5,U+5f0b,U+5f77,U+5fd6,U+5fff,U+6026,U+6035,U+6063,U+60b4,U+60bb,U+60ee,U+612b,U+6194,U+61ca,U+61e6,U+61f5,U+620a,U+6248,U+62a1,U+62d7,U+6376,U+637b,U+652b,U+65bc,U+65cc,U+65ce,U+65d6,U+664c,U+665f,U+6666,U+6684,U+66b9,U+6773,U+6777,U+6787,U+67de,U+6845,U+693d,U+6994,U+6a35,U+6d54,U+6d5c,U+6d8e,U+6dd6,U+6eb4,U+6f2a,U+6f78,U+704f,U+70ec,U+7118,U+714a,U+7172,U+71b9,U+724d,U+728a,U+7337,U+733e,U+7396,U+73b7,U+73cf,U+7428,U+742c,U+742e,U+74ee,U+74f4,U+7525,U+753a,U+7572,U+75d4,U+765c,U+768e,U+7762,U+777d,U+77fd,U+7825,U+7837,U+78b4,U+795f,U+79ed,U+7a1e,U+7b06,U+7b20,U+7ba9,U+7bab,U+7c7c,U+7cbd,U+7cdc,U+7ec9,U+7ef6,U+7f30,U+7f42,U+7f44,U+7f54,U+7f94,U+8004,U+800b,U+8019,U+809b,U+80ae,U+80c4,U+80f1,U+8146,U+816e,U+817c,U+81c0,U+81fc,U+81fe,U+822b,U+830f,U+832f,U+8340,U+8365,U+8385,U+8392,U+83a0,U+8424,U+84af,U+869c,U+8713,U+8717-8718,U+87c0,U+87cb,U+87fe,U+8821,U+8902,U+89d1,U+8bb9,U+8c12,U+8d32,U+8d53,U+8df7,U+8e7c,U+8f7c,U+8f95,U+8fab,U+9052,U+905b,U+9095,U+909d,U+90c5,U+911e,U+9122,U+916a,U+919b,U+948e,U+9492,U+949a,U+94b5,U+94bc,U+94c6,U+94f1,U+9502,U+9511,U+9536,U+956f-9570,U+9602,U+9621,U+9631,U+998b,U+99a5,U+9a81,U+9a9e,U+9ebe,U+9f8b"}},{uri:X5e,descriptors:{unicodeRange:"U+4f2b,U+4f3d,U+4fac,U+5043,U+5055,U+5140,U+5156,U+51cb,U+5243,U+531d,U+536f,U+53a5,U+53ae,U+53f1,U+541d,U+5431,U+547b,U+5492,U+5494,U+54a4,U+54aa,U+54ce,U+54fd,U+5509,U+5520,U+553e,U+557b,U+55c5,U+55e1,U+55f7,U+5608,U+5636,U+563b,U+5773,U+57a0,U+5811,U+587e,U+58d5,U+59e3,U+5a29,U+5a6a,U+5a76,U+5a7a,U+5ac9,U+5b62,U+5b95,U+5c49,U+5c8c,U+5cab,U+5cb7,U+5d02,U+5d58,U+5e44,U+5e7a,U+5eff,U+5f29,U+5f89,U+5f9c,U+5fa8,U+6005,U+6043,U+60b8,U+60d8,U+60ec,U+60f0,U+6115,U+618e,U+630e,U+637a,U+6390,U+63ac,U+63b0,U+64de,U+6525,U+6538,U+65ee-65ef,U+6631,U+6636,U+6654,U+677c,U+67b8,U+67d8,U+683e,U+6886,U+68b5,U+692d,U+6963,U+6979,U+6988,U+6b59,U+6b9a,U+6c69,U+6c74,U+6cae,U+6ce0,U+6cef,U+6d95,U+6dc5,U+6dde,U+6de6,U+6dfc,U+6ea7,U+6f15,U+6f29,U+7096,U+70c3,U+7131,U+715c,U+7166,U+7266,U+7317,U+731d,U+7329,U+73e9,U+7425,U+7455,U+7490,U+74ef,U+7519,U+75b5,U+75b9,U+75de,U+7656,U+7663,U+7691,U+7729,U+77fe,U+783e,U+787c,U+795a,U+7a79,U+7abf,U+7b3a,U+7b4f,U+7b60,U+7b75,U+7b8d,U+7bb4,U+7bd3,U+7be1,U+7cbc,U+7edb,U+7f1c,U+7f8c,U+7fb2,U+7fb9,U+7fce,U+7ff1,U+810d,U+81c6,U+82a5,U+82aa,U+82de,U+8317,U+8343,U+835e,U+8364,U+836a,U+853a,U+8543,U+854a,U+8559,U+8568,U+85b0,U+85b9,U+864f,U+86e4,U+8715,U+8845,U+8884,U+88e8,U+88f1,U+8983,U+8be1,U+8c1f,U+8c27,U+8c5a,U+8c82,U+8d58,U+8dbe,U+8f98,U+9035,U+9074,U+90a1,U+9149,U+9157,U+93d6,U+949d,U+94c2,U+94e3-94e4,U+95eb,U+95f0,U+9611,U+9619,U+9642,U+968d,U+9706,U+970f,U+97ed,U+988a,U+9893,U+98e8,U+9a77,U+9a87,U+9aa1,U+9abc,U+9cdd,U+9e2f,U+9e33,U+9e44,U+9e5c,U+9e9d,U+9edd"}},{uri:j5e,descriptors:{unicodeRange:"U+4f58,U+4f6c,U+4f70,U+4fd0,U+5014,U+51bd,U+524c,U+5315,U+5323,U+535e,U+540f,U+542d,U+545b,U+548e,U+549a,U+54ab,U+54fc,U+5567,U+556a,U+5600,U+5618,U+563f,U+5669,U+56f1,U+56ff,U+573b,U+574d,U+579b,U+57b8,U+57c2,U+586c,U+58f9,U+595a,U+598d,U+5993,U+5996,U+59d7,U+5b7a,U+5ba6,U+5c4e,U+5c96,U+5ce5,U+5eb6,U+5f08,U+5f99,U+602f,U+6059,U+606c,U+607a,U+60ed,U+61a9,U+620c,U+6249,U+62a8,U+62c4,U+62ed,U+62fd,U+6342,U+6345,U+6396,U+63a3,U+6402,U+6413,U+642a,U+6487,U+64a9,U+64ac,U+64ae,U+64b7,U+659f,U+65a1,U+667e,U+66f3,U+67e0,U+69db,U+69df,U+6aac,U+6b86,U+6c50,U+6c5e,U+6c76,U+6c85,U+6c8c,U+6cde,U+6d19,U+6d52,U+6da7,U+6db8,U+6e1a,U+6e25,U+6e4d,U+6e5f,U+6ec1,U+6f31,U+6f7a,U+6fa7,U+6fe1,U+701b,U+70ab,U+70f7,U+717d,U+71a8,U+7252,U+72c4,U+72e1,U+7315,U+736d,U+73ae,U+73c0,U+73c2,U+740f,U+75a4,U+7600-7601,U+768b,U+76bf,U+76d4,U+7728,U+772f,U+776c,U+77a0,U+77b0,U+77f8,U+783a,U+78d0,U+78fa,U+7977,U+7a37,U+7a92,U+7afa,U+7b71,U+7b94,U+7cef,U+7f28,U+7fe1,U+808b,U+80e5,U+80eb,U+8110,U+8113,U+812f,U+814c,U+81c3,U+8235,U+82d4,U+8309,U+83c1,U+8431,U+8469,U+84bf,U+84d3,U+84df,U+84e6,U+8511,U+8638,U+86c0,U+86db,U+86fe,U+8757,U+8822,U+8882,U+8885,U+8892,U+88f3,U+892a,U+8ba5,U+8bd9,U+8be0,U+8be7,U+8bfd,U+8c1a,U+8d4a,U+8d4e,U+8d66,U+8dda,U+8e0c,U+8e52,U+8e74,U+8e87,U+8f76,U+8fc2,U+8fe6,U+900d,U+9068,U+90ac,U+90b3,U+90b8,U+90e7,U+9119,U+9131,U+915a,U+916e,U+94b4,U+94d0,U+94e2,U+94ec,U+94ff,U+9522,U+9535,U+9556,U+965b,U+96f9,U+9774,U+9981,U+998d,U+998f,U+9a6e,U+9a7f,U+9a8a,U+9b13,U+9c9f,U+9e3e,U+9e43,U+9e6d,U+9e8b,U+9e92,U+9edb,U+9eef"}},{uri:Y5e,descriptors:{unicodeRange:"U+4e10,U+4e56,U+4e98,U+4ec3,U+4f3a,U+4f5f,U+4f88,U+4f97,U+4fa5,U+4fe8,U+504c,U+5197,U+52fa,U+5364,U+53e8,U+5406,U+543c,U+545c,U+5471,U+5480,U+5495,U+54b3,U+54df,U+54e6,U+54ee,U+557c,U+5583,U+55dc,U+55e3,U+566c,U+592f,U+5944,U+5983,U+59ca,U+59e5,U+5a13,U+5a7f,U+5b09,U+5bd0,U+5e4c,U+5eb5,U+5f1b,U+5f3c,U+608d,U+60cb,U+61a7,U+61ac,U+61cb,U+6233,U+62a0,U+62e7,U+62ee,U+62f4,U+62f7,U+634e,U+6382,U+63c9,U+63ea,U+6400,U+645e,U+6482,U+6556,U+6593,U+6615,U+664f,U+66e6,U+672d,U+675e,U+67da,U+6805,U+6808,U+6868,U+68a2,U+695e,U+69ad,U+6a80,U+6a90,U+6b83,U+6be1,U+6c30,U+6cad,U+6cb1,U+6cf1,U+6d31,U+6d93,U+6dae,U+6dbf,U+6dc6-6dc7,U+6e0d,U+6e32,U+6e3a,U+6e85,U+6eba,U+6f3e,U+6f5e,U+6f7c,U+6fee,U+71ee,U+722a,U+72b7,U+72e9,U+73ba,U+73d1,U+7409,U+7435-7436,U+7459-745a,U+747e,U+7487,U+74e2,U+7504,U+752c-752d,U+7599,U+759f,U+75a1,U+75ca,U+75f0,U+761f,U+7629,U+777f,U+7785,U+77a5,U+77bf,U+78d5,U+7934,U+7940,U+79a7,U+7b19,U+7c38,U+7c95,U+7cb1,U+7ce0,U+7eca,U+7ef7,U+7f2b,U+7f81,U+7fcc,U+8046,U+8148,U+8165,U+819b,U+81ba,U+828b,U+82ae,U+82b7,U+82d3,U+8301,U+830e,U+831c,U+8338,U+837c,U+8393,U+8398,U+83ba,U+83e0,U+83e9,U+853c,U+8654,U+86df,U+8712,U+873f,U+874e,U+8783,U+8859,U+88a4,U+8925,U+8bb7,U+8bff,U+8c19,U+8c1b,U+8c24,U+8c2c,U+8d61,U+8db4,U+8e6c,U+8f8a,U+8fe5,U+8ff8,U+901e,U+90f4,U+912f,U+9163,U+9170,U+91dc,U+949b,U+94a8,U+94b3,U+94c0,U+94e8,U+9525,U+9530,U+9539,U+954c-954d,U+9550,U+955b,U+962a,U+9685,U+96cc,U+9776,U+988d,U+9975,U+9985,U+9a6f,U+9aa5,U+9ab8,U+9c7f,U+9ca4,U+9cb8,U+9e25,U+9e35,U+9e4a"}},{uri:W5e,descriptors:{unicodeRange:"U+4ea2,U+4ea5,U+4f36,U+4f84,U+4f8d,U+501a,U+5029,U+516e,U+51a5,U+51c4,U+51f8,U+5201,U+527f,U+5321,U+5352,U+5366,U+53e9,U+54c7,U+5632,U+5676,U+56b7,U+56bc,U+56da,U+56e4,U+5703,U+5729,U+5742,U+57a2-57a3,U+5815,U+58d1,U+5919,U+592d,U+5955,U+5a05,U+5a25,U+5a34,U+5b70,U+5b75,U+5bdd,U+5bf0,U+5c41,U+5c79,U+5c91,U+5c94,U+5ce6,U+5ced,U+5d69,U+5dc5,U+5e16,U+5e27,U+5f27,U+5f95,U+5ffb,U+6020,U+604d,U+6055,U+60e6,U+60eb,U+6123,U+618b,U+61a8,U+620d,U+62c7,U+62ce,U+62d9,U+631f,U+634d,U+6452,U+6479,U+64ce,U+64d2,U+655b,U+660a,U+6726,U+67c4,U+6809,U+6853,U+68e3,U+68f1,U+68fa,U+693f,U+6942,U+6995,U+69a8,U+69b4,U+6a71,U+6b89,U+6bcb,U+6bd3,U+6bd9,U+6c40,U+6cf8,U+6cfe,U+6d85,U+6da3,U+6daa,U+6e0e,U+6e43-6e44,U+6f88,U+7078,U+7099,U+70bd,U+70d9,U+70fd,U+7109,U+7184,U+7239,U+733f,U+73f2,U+748b,U+749c,U+749e,U+759a,U+75d2,U+75eb,U+7620,U+766b,U+7693,U+76cf,U+7738,U+773a,U+776b,U+778e,U+77aa,U+7852,U+78be,U+7948,U+795b,U+7960,U+796f,U+79ba,U+7a20,U+7a96,U+7aa5,U+7b03,U+7b28,U+7b50,U+7b77,U+7bc6,U+7bf1,U+7c27,U+7d0a,U+7ead,U+7ec5,U+7ee2,U+7ef0,U+7efd,U+7f0e,U+7f2e,U+7f79,U+7f9a,U+8098,U+80da,U+80e7,U+80f0,U+80f3,U+80fa,U+818a,U+81e7,U+8237-8238,U+8299,U+82b8,U+82ce,U+837b,U+83bd,U+83cf,U+8426,U+8475,U+85c9,U+85d5,U+85dc,U+85e9,U+871a,U+8747,U+8749,U+888d,U+8910,U+891a,U+8bb4,U+8be3,U+8bec,U+8bf2,U+8c06,U+8c0d,U+8d31,U+8d48,U+8de4,U+8e1e,U+8e4a,U+8e66,U+8f84,U+8f97,U+9083,U+90e1,U+9165,U+91c9,U+94b0,U+94f5,U+9504,U+9532,U+956d,U+95f5,U+95fa,U+9668,U+9698,U+96bd,U+9704,U+9773,U+9890,U+996a,U+997a,U+9a74,U+9a8b,U+9cc4,U+9ccc"}},{uri:K5e,descriptors:{unicodeRange:"U+4ea8,U+4f1e,U+4f51,U+4f63,U+4f7c,U+4f83,U+4fa0,U+4fd1,U+4ffa,U+5018,U+5026,U+508d,U+50bb,U+50f5,U+50fb,U+5162,U+5319,U+5320,U+538c,U+5413,U+541f,U+5475,U+54bd,U+54d1,U+5589,U+5598,U+575f,U+57ae,U+57e0,U+5937,U+5974,U+5978,U+59ae,U+5a1f,U+5a49,U+5ab3,U+5b99,U+5b9b,U+5ba0,U+5be1,U+5be5,U+5c09,U+5c27,U+5de2,U+5e9a,U+5f26,U+5f8a,U+5f98,U+6021,U+606d,U+60bc,U+60d5,U+60e7,U+611a,U+614c,U+6254,U+626f,U+6292,U+6296,U+62b9,U+62e2,U+631a,U+631d,U+6320,U+6346,U+63ba,U+6467,U+64bc,U+658b,U+663c,U+6643,U+6652,U+6656,U+6687,U+66d9,U+66dd,U+66f0,U+673d,U+67ab,U+6816-6817,U+68a7,U+68ad,U+68cd,U+68e0,U+6986,U+69fd,U+6b47,U+6bd7,U+6c1f,U+6c2e-6c2f,U+6cbe,U+6de4,U+6e1d,U+6e83,U+6e9c,U+6ed4-6ed5,U+6f4d,U+70f9,U+7130,U+716e,U+718f,U+71ac,U+71e5,U+72fc,U+731c,U+7334,U+73ca,U+7422,U+7426,U+745f,U+7470,U+75af,U+75f4,U+762b,U+763e,U+7696,U+7737,U+7741,U+77a7,U+77bb,U+77ee,U+785d,U+788c,U+78ca,U+7901,U+796d,U+7985,U+79fd,U+7a3c,U+7a57,U+7a74,U+7b5b,U+7caa,U+7cb9,U+7cd5,U+7eac,U+7eb6,U+7ed1,U+7ee5,U+7f20,U+7f2a,U+7f38,U+7f69,U+7fa1,U+8018,U+8038,U+803f,U+804b,U+80a2,U+80be,U+80d6,U+817a,U+81fb,U+820c,U+82ad,U+82af,U+82bd,U+8327,U+8354,U+835f,U+8367,U+836b,U+840c,U+841d,U+8471,U+849c,U+84b2,U+84c9,U+8517,U+851a,U+8549,U+8681,U+8721,U+8776,U+88d9,U+88f9,U+89c5,U+8c1c,U+8c34,U+8d81,U+8d9f,U+8e0a,U+8e72,U+8eb2,U+8fed,U+901b,U+902e,U+906e,U+9091,U+90aa,U+90af,U+915d,U+9171,U+946b,U+9489,U+9499,U+94a5,U+9508,U+9524,U+952d,U+9551,U+9576,U+95f7,U+9600,U+96b6,U+96c0,U+9756,U+97f6,U+98a0,U+98a4,U+997f,U+9a73,U+9a86,U+9ad3,U+9e3d,U+9ed4"}},{uri:JUe,descriptors:{unicodeRange:"U+4e4d,U+4e5e,U+4ec7,U+4ed5,U+50da,U+50e7,U+515c,U+51a4,U+51ff,U+5203,U+5254,U+5300,U+533e,U+5375,U+53ee,U+5435,U+543b,U+5455,U+548b,U+548f,U+54d7,U+54fa,U+5578,U+5587,U+55a7,U+560e,U+5760,U+576f,U+5777,U+5830,U+58a9,U+5962,U+59e8,U+5a07,U+5a23,U+5a3c,U+5b5a,U+5bb5,U+5bc5,U+5bde,U+5c7f,U+5cb1,U+5ce8,U+5cea,U+5d29,U+5d4c,U+5e18,U+5f57,U+5f5d,U+5f87,U+5ff1,U+6016,U+601c,U+6064,U+6177,U+61d2,U+625b,U+62e3,U+62f1,U+634f,U+63a0,U+6401,U+6405,U+6495,U+64c2,U+6512,U+6577,U+6590,U+65a7,U+65a9,U+65f7,U+6627,U+6655,U+6714,U+6795,U+67d1,U+67ff,U+68b3,U+68d5,U+68d8,U+6930,U+6960,U+6977,U+69bb,U+69d0,U+6a31,U+6b7c,U+6bb4,U+6c22,U+6c72,U+6c79,U+6c7e,U+6c81,U+6c93,U+6ca5,U+6cbc,U+6ce3,U+6cfb,U+6d3c,U+6da9,U+6df3,U+6e2d,U+6eaf,U+6ec7,U+6f13,U+6f33,U+6f62,U+6fa1,U+7011,U+707c,U+708a,U+70c1,U+70d8,U+70eb,U+711a,U+7194,U+7281,U+7316,U+7357,U+7384,U+7405,U+742a,U+745b,U+7574,U+7578,U+75ea,U+7682,U+7792,U+77d7,U+77e9,U+77eb,U+77f6,U+780c,U+78c5,U+7941,U+79e4,U+7a1a,U+7a9c,U+7ad6,U+7b5d,U+7bf7,U+7c07,U+7c3f,U+7c9f,U+7ca5,U+7cdf,U+7e82,U+7eab,U+7ece,U+7eda,U+7f09,U+7f15,U+7f9e,U+7fdf,U+7fe9,U+803b,U+803d,U+80aa,U+80b4,U+813e,U+8155,U+817b,U+819d,U+821c,U+82b9,U+82df,U+82ef,U+8304,U+83b9,U+8446,U+853d,U+85af,U+85fb,U+8650,U+865e,U+86d9,U+86ee,U+8700,U+8862,U+889c,U+88d4,U+88f8,U+895f,U+8a79,U+8bb3,U+8bb6,U+8bc0,U+8beb,U+8bf5,U+8c23,U+8c79,U+8d1e,U+8dcb,U+8e29,U+8e44,U+8e81,U+8eac,U+8eaf,U+8f8d,U+9050,U+90f8,U+914b,U+948a,U+94be,U+94ee,U+950c,U+9540,U+962e,U+9647,U+9661,U+9699,U+96cf,U+9716,U+9761,U+97a0,U+97e7,U+9a7c,U+9a8f,U+9ae6,U+9cd6,U+9e26"}},{uri:Z5e,descriptors:{unicodeRange:"U+4fa3,U+4fae,U+4fd8,U+4fef,U+50a3,U+5189,U+5195,U+51db,U+51f3,U+51f9,U+5220,U+5228,U+5288,U+52ff,U+532e,U+533f,U+5351,U+53db,U+53ed,U+5450,U+5484,U+5490,U+54c9,U+54e9,U+5501,U+5507,U+5543,U+55d3,U+56a3,U+575e,U+589f,U+5984,U+59ec,U+5a04,U+5a36,U+5a77,U+5a9a-5a9b,U+5ab2,U+5ac2,U+5ad6,U+5bc7,U+5c2c,U+5c34,U+5c51,U+5cd9,U+5d0e,U+5deb,U+5e3c,U+5e87,U+5ed3,U+5f13,U+5f64,U+5fe1,U+606a,U+6096,U+60df,U+60f6,U+60f9,U+6151,U+620e,U+6241,U+6252,U+6273,U+627c,U+6289,U+62c2,U+62cc,U+62ef,U+6361,U+6363,U+63b7,U+63e3,U+6518,U+66ae,U+6756,U+6789,U+6813,U+6829,U+6862,U+6866,U+6893,U+6897,U+690e,U+6984,U+69cc,U+6a1f,U+6a44,U+6a59,U+6ba1,U+6c13,U+6c90,U+6ca6,U+6cbd,U+6ccc,U+6cd3,U+6cd7,U+6d4a,U+6d4f,U+6d5a,U+6d9f,U+6da1,U+6dcc,U+6ea5,U+6ee4,U+6ee6,U+6f2f,U+6f8e,U+701a,U+7095,U+709c,U+70af,U+70db,U+70e8,U+714e,U+715e,U+71a0,U+71ce,U+7235,U+7280,U+72d0,U+72f8,U+73ab,U+7410,U+745c,U+7480,U+74a7-74a8,U+74e3,U+75ae,U+75f9,U+76b1,U+76ce,U+7736,U+77e2-77e3,U+781a,U+789f,U+797a,U+79be,U+79c3,U+79c6,U+79f8,U+7a8d,U+7a98,U+7aa6,U+7aff,U+7b1b,U+7cd9,U+7d6e,U+7ede,U+7eee,U+7f00,U+7f24,U+7f2d,U+7fd8,U+800d,U+8116,U+8151,U+81b3,U+8205,U+82c7,U+82db,U+832c,U+8335,U+8339,U+8386,U+846b,U+8587,U+8611,U+8682,U+868a,U+868c,U+8774,U+88d8,U+88f4,U+8912,U+8b6c,U+8bbd,U+8c0e,U+8c41,U+8d26,U+8d3b-8d3c,U+8d50,U+8dea,U+8e35,U+8f99,U+8fe2,U+8fe9,U+9017,U+914c,U+916f,U+9175-9176,U+918b,U+94a0,U+94ae,U+94ce,U+94f2,U+951a,U+952f,U+9541,U+9640,U+9672,U+968b,U+96cd,U+96ef,U+9713,U+97ec,U+9885,U+9992,U+9a6d,U+9a79,U+9a85,U+9cbb,U+9cd7,U+9cde,U+9e93,U+9f9f"}},{uri:q5e,descriptors:{unicodeRange:"U+4e11,U+4ed7,U+4fcf,U+4fe9,U+4fed,U+50ac,U+50b2,U+5112,U+5180,U+5188,U+51f6,U+522e,U+5265,U+52cb,U+52df,U+5349,U+5367,U+5378,U+537f,U+5395,U+5398,U+53d4,U+543e,U+5440,U+5446,U+54b8,U+5565-5566,U+5580,U+55bb,U+56ca,U+572d,U+573e,U+574e,U+5782-5784,U+58f3,U+5938-5939,U+5948,U+594e,U+5a1c,U+5a74,U+5ae9,U+5b55,U+5b5c,U+5bb0,U+5bd3,U+5bf8,U+5c3f,U+5d14,U+5d2d,U+5df7,U+5dfe,U+5e05-5e06,U+5e1c,U+5e62,U+5e7b,U+5e7d,U+5ed6,U+5f2f,U+5f66,U+5f6c,U+5fa1,U+604b,U+609f,U+60a6,U+60e8,U+6101,U+6124,U+6127,U+6148,U+61be,U+6247,U+62d8,U+62da,U+633d,U+635e,U+6367,U+6380,U+638f,U+63a9,U+63fd,U+641c,U+64e6,U+655e,U+6572,U+6591,U+65a5,U+6691,U+6735,U+67a2-67a3,U+67ef,U+680b,U+6876,U+6905,U+6a0a,U+6a61,U+6b79,U+6bb7,U+6bbf,U+6c41,U+6c55,U+6c83,U+6c9b,U+6ca7,U+6cfc,U+6d46,U+6d51,U+6d74,U+6d9d,U+6daf,U+6dc0,U+6deb,U+6e17,U+6e24,U+6e89,U+6ea2,U+6ef4,U+6f6d,U+707f,U+70b3,U+70e4,U+70ef,U+710a,U+722c,U+725f,U+7261,U+72ee,U+72f1,U+730e,U+732b,U+7433,U+7538,U+75bc,U+7624,U+7709,U+7750,U+7779,U+7802,U+7898,U+78a7,U+78b1,U+78cb,U+78f7,U+7984,U+7a83,U+7aed,U+7b3c,U+7b4b,U+7c92,U+7c98,U+7ca4,U+7eb9,U+7ee3,U+7ef3,U+7ef5,U+7f05,U+7f55,U+7f62,U+7fc1,U+7fd4,U+7fe0,U+8042,U+806a,U+80a0,U+80a4,U+80c3,U+8102,U+8106,U+814a,U+8154,U+8247,U+8258,U+82cd,U+8328,U+832b,U+8389,U+83ca,U+845b,U+846c,U+84b8,U+8574,U+859b,U+8680,U+8695,U+86c7,U+8702,U+886c,U+8896,U+88b1,U+88e4,U+8bc8,U+8c10,U+8c26,U+8c28,U+8c2d,U+8d4c,U+8d63,U+8f67,U+8f74,U+8fc4,U+9006,U+9063,U+90a2,U+90b1,U+90c1,U+9177,U+9189,U+9493,U+949e,U+94fe,U+9610,U+961c,U+96a7,U+96fe,U+978d,U+97f5,U+9888,U+997c,U+9a84,U+9b3c,U+9b44-9b45,U+9b54,U+9e64,U+9f0e,U+9f9a"}},{uri:Q5e,descriptors:{unicodeRange:"U+4e19,U+4e38,U+4e53,U+4e7e,U+4e9f,U+4ec6,U+4f50,U+4fde,U+502a,U+5154,U+517d,U+51d1,U+51f0,U+5239,U+5256,U+52c9,U+52fe,U+5308,U+532a,U+535c,U+5384,U+53a2,U+53a8,U+53c9,U+53e0,U+5496,U+54ac,U+54c0,U+54c4,U+54e8,U+5561,U+5582,U+561b,U+5631,U+566a,U+5764,U+576a,U+5792,U+57ab,U+584c,U+5885,U+58f6,U+59a8,U+5acc,U+5bc2,U+5c38-5c39,U+5c60,U+5c6f,U+5c82,U+5c90,U+5d16,U+5dcd,U+5e37,U+5e90,U+5eb8,U+5f6a,U+5fcc,U+6012,U+6068,U+6073,U+607c,U+6094,U+6109,U+621a,U+626e,U+6284,U+62d0,U+62e6,U+62fe,U+6321,U+6328,U+632b,U+6349,U+6454,U+65ed,U+660f,U+6674,U+66a8,U+6749,U+674f,U+6760,U+67af,U+6850,U+6854,U+6869,U+68a8,U+68d2,U+68f5,U+6912,U+6b49,U+6b6a,U+6bef,U+6c28,U+6c5d,U+6c82,U+6cab,U+6cb8,U+6cc4,U+6cf5,U+6d47,U+6d78,U+6da4,U+6dc4,U+6dcb,U+6df9,U+6e0a,U+6e23,U+6e5b,U+6eb6,U+6f06,U+6f47,U+6f84,U+6f9c,U+6fd2,U+7076,U+70ac,U+7199,U+723d,U+72ac,U+72ed,U+7476,U+7529,U+752b,U+754f,U+7554,U+75d5,U+7626,U+76ef,U+7720,U+7766,U+7784,U+77ac,U+780d,U+7838,U+7845,U+786b,U+78b3,U+7978,U+79b9,U+79c9,U+79e7,U+7a3d,U+7a84,U+7a9f,U+7b0b,U+7b52,U+7c7d,U+7f1a,U+7fc5,U+7ff0,U+804a,U+8086-8087,U+808c,U+809a,U+80ba,U+810a,U+8180,U+818f,U+81c2,U+81ed,U+8231,U+8292,U+829c,U+82a6,U+82d1,U+8346,U+838e,U+839e,U+83c7,U+83f1,U+8403,U+840e,U+8513,U+857e,U+85e4,U+867e,U+871c,U+87ba,U+87f9,U+884d,U+8944,U+8a93,U+8c05,U+8d2c,U+8d2e,U+8d42-8d43,U+8dfb,U+8e22,U+8eba,U+8f69,U+8f9c,U+8fa3,U+8fa8,U+8fb1,U+900a,U+9038,U+903b,U+9042,U+904f,U+90b5,U+90dd,U+9102,U+9187,U+94a7,U+94c5,U+9523,U+95f8,U+95fd,U+960e,U+964b-964c,U+96c1,U+9709,U+971c,U+97ad,U+9882,U+9965,U+9976,U+9988,U+99a8,U+9a82,U+9a9a,U+9b41,U+9c8d,U+9e45,U+9e70,U+9e9f,U+9f3b,U+9f7f"}},{uri:J5e,descriptors:{unicodeRange:"U+4e08,U+4e18,U+4e1b,U+4e22,U+4e27,U+4e32,U+4e52,U+4e73,U+4ead,U+4ed4,U+4ed9,U+4ef0,U+4fa6,U+5076,U+5179,U+51bb,U+51c9,U+51ef,U+51fd,U+524a,U+526a,U+529d,U+52ab,U+5306,U+5339,U+53d9,U+540a,U+5410,U+541e,U+5439,U+54b1,U+54ed,U+5564,U+558a,U+55b7,U+5634,U+574a,U+5751,U+57a6,U+57cb,U+57d4,U+5824,U+582a,U+5835,U+5858,U+5893,U+58e4,U+5951,U+5986,U+59da,U+59fb,U+59ff,U+5a03,U+5a46,U+5ac1,U+5b5d,U+5bfa,U+5c18,U+5c3a,U+5c48,U+5c4f,U+5c61,U+5cb3,U+5d1b,U+5e15,U+5e3d,U+5e99,U+5e9e,U+5eca,U+5f0a,U+5f17-5f18,U+5f25,U+5f7c,U+5fcd,U+6028,U+60a0,U+60ac,U+60d1,U+614e,U+6155,U+6168,U+61c8,U+6208,U+6212,U+6251,U+629a-629b,U+62ab-62ac,U+62fc,U+6323,U+632a,U+63d2,U+643a,U+6491-6492,U+649e,U+64b0,U+64c5,U+659c,U+6614,U+662d,U+6664,U+6670,U+6676,U+6746,U+67cf,U+67d4,U+682a,U+6843,U+6846,U+68da,U+6b3a,U+6b67,U+6c27,U+6c5b,U+6c64,U+6c70,U+6caa,U+6cca,U+6ce1,U+6d12,U+6d45,U+6dd1,U+6dd8,U+6e34,U+6e7f,U+6ee5,U+6f02,U+7092,U+70c2,U+70e6,U+7115,U+7237,U+7272,U+727a,U+72c2,U+739b,U+73b2,U+743c,U+751c,U+758f,U+75b2,U+7686,U+76c6,U+76d2,U+76fc,U+775b,U+77a9,U+7816,U+788e,U+7897,U+78b0,U+79bd,U+7a0d,U+7a91,U+7a9d,U+7ae3,U+7bad,U+7cca,U+7d2b,U+7eb1,U+7f06,U+7f14,U+7f1d,U+7f50,U+7ffc,U+8036,U+80bf,U+80c1,U+80ce,U+80f8,U+8109,U+810f,U+8170,U+8179,U+819c,U+821f,U+8230,U+8236,U+8273,U+829d,U+82f9,U+8305,U+8350,U+83b2,U+83cc,U+8404,U+840d,U+8427,U+8482,U+8679,U+8854,U+886b,U+8bbc,U+8be6,U+8c31,U+8c6b,U+8d4b,U+8dcc,U+8e2a,U+8e48,U+8f90,U+8fb0,U+9022,U+903c,U+903e,U+9065,U+916c,U+917f,U+94a9,U+94c3,U+94dd,U+94ed,U+9510,U+953b,U+96c7,U+970d,U+9738,U+9877,U+987d,U+989c,U+98d8,U+9a70,U+9a91,U+9aa4,U+9b42,U+9b4f,U+9e2d,U+9e3f,U+9e7f,U+9f20"}},{uri:qUe,descriptors:{unicodeRange:"U+4e59,U+4ed3,U+4f0f,U+4f38,U+4f69,U+4fa7,U+4faf,U+4ff1,U+5077,U+5085,U+5144,U+5151,U+51af,U+51b6,U+51cc,U+523a,U+5251,U+5269,U+5272,U+52d8,U+5353,U+5389,U+53f9,U+5401,U+5415,U+541b,U+54f2,U+5524,U+554a,U+559d,U+5609,U+5740,U+575d,U+5806,U+5821,U+586b,U+5915,U+594f,U+5960,U+5999,U+59a5,U+59b9,U+59c6,U+59d1,U+59dc,U+5b5f,U+5b64,U+5b87,U+5bb4,U+5bbf,U+5c16,U+5c1d,U+5c3e,U+5c9a,U+5ca9,U+5cad,U+5cfb,U+5de1,U+5de7,U+5de9,U+5ef7,U+5f04,U+5f70,U+5f79,U+5fc6,U+602a,U+6050,U+6052,U+6070,U+6084,U+60b2,U+60dc,U+60e9,U+6167,U+6170,U+61c2,U+6270,U+6291,U+62b1,U+62bc,U+62dc,U+62df,U+62f3,U+6324,U+633a,U+6377,U+6398,U+63cf,U+640f,U+642c-642d,U+6458,U+6478,U+6500,U+654c,U+6566,U+658c,U+65c1,U+65cb,U+65e8,U+65ec,U+6696-6697,U+6734,U+679a,U+679d,U+67dc,U+67f3-67f4,U+680f,U+683d,U+684c,U+68af,U+699c,U+6bc1,U+6c0f,U+6c1b,U+6c57,U+6c6a,U+6d3d,U+6d6e,U+6d82,U+6db5,U+6dee,U+6e58,U+6eaa,U+6ecb,U+6ede,U+6ee9,U+6f0f,U+6f20,U+6f58,U+704c,U+7070,U+70b8,U+718a,U+7238,U+7262,U+7275,U+72b9,U+72d7,U+72e0,U+741b,U+7434,U+7483,U+74f6-74f7,U+75ab,U+764c,U+7761,U+7855,U+7891,U+78c1,U+79d2,U+7a00,U+7a3b,U+7c97,U+7ea4,U+7eb2,U+7ed2,U+7eea,U+7ef8,U+7f18,U+7fbd,U+8000,U+8010,U+8096,U+809d,U+80a9,U+817f,U+81e3,U+8206,U+8212,U+82ac,U+8302,U+8361,U+8377,U+83f2,U+8461,U+848b,U+84ec,U+8521,U+85aa,U+8870,U+8877,U+8881,U+888b,U+88ad,U+88c2,U+8986,U+8bd1,U+8bf1,U+8d24,U+8d2a,U+8d3e-8d3f,U+8d41,U+8d56,U+8d64,U+8d6b,U+8e0f,U+8f70,U+8f85,U+8f88,U+8fa9,U+9003,U+901d,U+90b9,U+90ce,U+94a6,U+94f8,U+9505,U+95ea,U+95ef,U+95f2,U+95f9,U+9601,U+9605,U+9634,U+966a,U+9677,U+9690,U+9694,U+96d5,U+971e,U+9896-9897,U+9972,U+9a71,U+9a76,U+9a7e,U+9e1f,U+9e23"}},{uri:eye,descriptors:{unicodeRange:"U+4e01,U+4e43,U+4ea6,U+4ef2,U+4eff,U+4f26,U+4f2a,U+4f2f,U+4f5b,U+4fa8,U+4fca,U+4fd7,U+5021,U+504f,U+5141,U+51c0,U+51dd,U+51e4,U+51ed,U+5200,U+5237,U+5427,U+5448,U+54a8,U+5706,U+5708,U+5723,U+575b,U+57c3,U+5899,U+58a8,U+58c1,U+5976,U+5988,U+59bb,U+59d0,U+59d3,U+5a18,U+5a31,U+5a92,U+5b54,U+5b85,U+5baa-5bab,U+5bc4,U+5bd2,U+5be8,U+5bff,U+5c65,U+5d07,U+5e1d,U+5e78,U+5e7c,U+5f03,U+5f1f,U+5f39,U+5f6d,U+5f92,U+5faa,U+5fbd,U+5fe7,U+5ffd,U+60a8,U+60ef,U+6108,U+6162,U+622a,U+6234,U+626b,U+626d,U+62c6,U+62d2,U+62d4,U+62d6,U+62e8,U+6316,U+6355,U+63ed,U+6447,U+64a4,U+65f1,U+6606,U+6628,U+664b,U+6668,U+6682,U+66f9,U+66fc,U+66ff,U+6717,U+6740,U+676d,U+67aa,U+67ec,U+67f1,U+6842,U+6851,U+695a,U+6982,U+6a2a,U+6b20,U+6b23,U+6b32,U+6b96,U+6bc5,U+6beb,U+6c60,U+6c9f,U+6cea,U+6cf3,U+6d1e,U+6d53,U+6d66,U+6d69,U+6d8c,U+6d9b,U+6db2,U+6de1,U+6dfb,U+6e14,U+6ed1,U+6eda,U+6ee8,U+6f2b,U+706d,U+7089,U+708e,U+70ad-70ae,U+70e7,U+7126,U+714c,U+71c3,U+71d5,U+7206,U+7259,U+731b,U+73a9,U+73bb,U+74dc,U+7532,U+7545,U+755c,U+75c7,U+7687,U+76d7,U+76f2,U+788d,U+78e8,U+79e6,U+79e9,U+7a3f,U+7a46,U+7a97,U+7af9,U+7bee,U+7c4d,U+7c89,U+7cd6,U+7eb5,U+7ebd,U+7ed8,U+8017,U+8033,U+80c0,U+80de,U+80f6,U+8138,U+817e,U+81a8,U+820d,U+827e,U+82b3,U+82d7,U+83b1,U+84c4,U+84dd,U+8584,U+864e,U+865a,U+866b,U+86cb,U+88d5,U+89e6,U+8bca,U+8bde,U+8bfa,U+8c0a,U+8c37,U+8c46,U+8c6a,U+8c8c,U+8d1d,U+8d29,U+8d4f,U+8d54,U+8d5a,U+8d60,U+8d62,U+8f7f,U+8f96,U+8f9e-8f9f,U+8fc1,U+8fdf,U+8fea,U+8ff7,U+9012,U+906d,U+9075,U+90a6,U+90bb,U+90ca,U+9178,U+9192,U+91ca,U+94bb,U+94dc,U+94fa,U+9501,U+950b,U+9521,U+955c,U+963b,U+9655,U+9675-9676,U+9887,U+9891,U+9971,U+9a97,U+9ece,U+9ed8"}},{uri:tye,descriptors:{unicodeRange:"U+4e1d,U+4e39,U+4e4c,U+4e4f,U+4e54,U+4e58,U+4e95,U+4ea1,U+4eab,U+4eae,U+4ec1,U+4f10,U+4f19,U+4f30,U+4f34,U+4fb5,U+503e,U+518c,U+5192,U+51a0,U+51ac,U+51b0,U+51e1,U+5211,U+5242,U+52a3,U+52b2,U+52c3,U+52c7,U+52d2,U+52e4,U+5377,U+539a,U+53a6,U+53e5,U+5417,U+5510,U+552f,U+5531,U+574f-5750,U+5761,U+5851,U+5854,U+58ee,U+593a,U+5949,U+5954,U+5a5a,U+5b8b,U+5bbd,U+5c04,U+5c0a,U+5c4b,U+5ce1,U+5cf0,U+5e10,U+5e8a,U+5e9f,U+5ec9,U+5f31,U+5f84,U+5fd8-5fd9,U+5fe0,U+6015,U+6062,U+6069,U+6076,U+6089,U+60a3,U+60ca,U+620f,U+624e,U+6263,U+6298,U+62a2,U+62bd,U+6311,U+6350,U+6389,U+638c,U+63f4,U+6446,U+644a,U+6469,U+64cd,U+654f,U+6562,U+656c,U+65d7,U+65e6,U+65fa,U+660c,U+6653,U+66b4,U+670b,U+672b,U+676f-6770,U+6881,U+6885,U+68a6,U+68cb,U+68ee,U+6b8a,U+6c88-6c89,U+6cc9,U+6ce5,U+6d01,U+6d17,U+6d1b,U+6d59,U+6d6a,U+6da8,U+6df7,U+6e10,U+6e20-6e21,U+6f5c,U+706f,U+70bc,U+719f,U+7267,U+732a,U+73cd,U+7518,U+756a,U+7586,U+7591,U+75db,U+76c8,U+76d0,U+76d6,U+76d8,U+76df,U+76fe,U+77db,U+7801,U+786c,U+795d,U+7965,U+79cb,U+7a77,U+7a7f,U+7aef,U+7b11,U+7bb1,U+7bc7,U+7ea0,U+7eaf,U+7ed5,U+7edc,U+7f13,U+7f29,U+7f34,U+7f8a,U+7ffb,U+8015,U+8058,U+805a,U+8083,U+80af,U+80c6,U+80cc,U+811a,U+8150,U+82e5,U+8336,U+8352,U+83ab,U+8428,U+8463,U+852c,U+8861,U+89c8,U+8bcd,U+8bd7,U+8bda,U+8be2,U+8bef,U+8bf8,U+8c0b,U+8c13,U+8d34,U+8d3a,U+8d74,U+8d76,U+8da3,U+8dd1,U+8ddd,U+8ddf,U+8df3,U+8f68,U+8f6f,U+8f7d,U+8f91,U+8f9b,U+8fbd,U+8fc8,U+8fd4,U+8feb,U+8ff9,U+900f,U+9057,U+907f-9080,U+90d1,U+90ed,U+91ce,U+9519,U+9526,U+95ed,U+9614,U+9635,U+9644,U+9686,U+96c5,U+96ea,U+9707,U+9732,U+9759,U+978b,U+9876,U+9881,U+9910,U+996e,U+9970,U+9c81,U+9e21,U+9ebb,U+9f84"}},{uri:nye,descriptors:{unicodeRange:"U+4e3d,U+4e4e,U+4e71,U+4e8f,U+4ed8,U+4eea,U+4f0a,U+4f0d,U+4f11,U+4f1f,U+4f24,U+4f3c,U+4f73,U+4fc4,U+500d,U+5012,U+501f,U+503a,U+505c,U+507f,U+50a8,U+514d,U+5178,U+517c,U+51b2,U+51b7,U+520a,U+5238,U+523b,U+52b1,U+535a,U+5371,U+5385,U+53eb-53ec,U+53f3,U+53f6,U+5409,U+542b,U+542f,U+5434,U+5462,U+5473,U+547c,U+54c8,U+54ea,U+56fa,U+5733,U+5757,U+5766,U+5802,U+585e,U+590f,U+591c,U+591f,U+5947,U+594b,U+5987,U+5a01,U+5b59,U+5b63,U+5b88,U+5b97,U+5b9c,U+5bbe,U+5bfb,U+5c01,U+5c1a,U+5c24,U+5c3c,U+5c97,U+5c9b,U+5cb8,U+5de6,U+5e01,U+5e2e,U+5e45,U+5e55,U+5e84,U+5ef6,U+5f02,U+5f52,U+5f69,U+5f7b,U+5f90,U+5fae,U+6000,U+600e,U+6025,U+60e0,U+6276,U+6297,U+62b5,U+62cd,U+62d3,U+62e5,U+62e9,U+62ff,U+6302,U+632f,U+63e1,U+6444,U+64ad,U+653b,U+6551,U+6563,U+65a4,U+65e7,U+6620,U+667a,U+66f2,U+671d,U+6731,U+6742,U+675f,U+6768,U+677e-677f,U+6790,U+67b6,U+67d3,U+6863,U+68b0,U+68c9,U+690d,U+6b8b,U+6bcd,U+6bd2,U+6bd5,U+6c38,U+6c61,U+6cbf,U+6cdb,U+6cf0,U+6d2a,U+6d89,U+6da6,U+6f6e,U+6fb3,U+7075,U+707e,U+70df,U+7164,U+7236,U+725b,U+7389,U+73e0,U+745e,U+74e6,U+751a,U+7537,U+75be,U+76ae,U+76db,U+793c,U+7956,U+7981,U+79d8,U+79df,U+79fb,U+7adf,U+7ae5,U+7b14,U+7b26,U+7b54,U+7b79,U+7d2f,U+7eb8,U+7eba,U+7ec6,U+7ee9,U+7eff,U+7f5a,U+7f6a,U+7f72,U+8089,U+80a5,U+80e1,U+8111,U+8131,U+821e,U+822c,U+8270,U+8499,U+8651,U+867d,U+8840,U+8857,U+8863,U+88c1,U+89c9,U+89d2,U+8a89,U+8bed,U+8bfe,U+8c01,U+8c22,U+8d21,U+8d25,U+8d2f,U+8d5e,U+8d75,U+8d8b,U+8dc3,U+8de8,U+8df5,U+8f6e,U+8f86,U+8f89,U+8fc5,U+8ff0,U+8ffd,U+9014,U+904d,U+90ae,U+9274,U+949f,U+952e,U+969c,U+96c4,U+96e8,U+96f6-96f7,U+97e9,U+987f,U+996d,U+9a7b,U+9aa8,U+9c7c,U+9c9c,U+9e4f,U+9f13,U+9f50"}},{uri:sye,descriptors:{unicodeRange:"U+4e13,U+4e16,U+4e1c,U+4e24,U+4e3e,U+4e49,U+4e61,U+4e66,U+4e89,U+4e8c,U+4e94,U+4e9b,U+4ea4,U+4eac,U+4ebf,U+4eca,U+4ef6-4ef7,U+4efb,U+4f18,U+4f20,U+4f46,U+4f7f,U+4fe1,U+503c,U+505a,U+5146,U+5148,U+515a,U+5171,U+5177,U+519b,U+51b3,U+51c6,U+51e0,U+5212,U+521b,U+522b,U+529e,U+52bf,U+534e-534f,U+5355,U+5357,U+5382,U+539f,U+53bb,U+53bf,U+53c2,U+53c8,U+53ca,U+53d6-53d8,U+53e3,U+53ea,U+53f0,U+540d,U+5411,U+56db,U+56de,U+56e0,U+56e2,U+578b,U+57ce,U+57fa,U+589e,U+5904,U+5934,U+5982,U+5b89,U+5b8c,U+5bfc,U+5c06,U+5c11,U+5c40,U+5c71,U+5e38,U+5e72,U+5e76,U+5e7f,U+5e94,U+5e9c,U+5f0f,U+5f15,U+5f20,U+5f3a,U+5f62,U+5f88,U+5fc5,U+5fd7,U+5feb,U+601d,U+6027,U+60c5,U+60f3,U+610f,U+6216,U+6218,U+624b,U+624d,U+6279,U+628a,U+6295,U+6301,U+6307,U+636e,U+63a5,U+63a8,U+652f,U+6536,U+653e,U+6548,U+6559,U+6570,U+65bd,U+65e0,U+6602,U+660e,U+6613,U+66f4,U+6700,U+670d,U+671f,U+672f,U+6743,U+674e,U+6751,U+6761,U+6784,U+6797,U+679c,U+67e5,U+6807,U+6837,U+683c,U+6b21,U+6b63-6b65,U+6bcf,U+6bd4,U+6c42,U+6c5f,U+6ca1,U+6cbb,U+6d3b,U+6d41,U+6d88,U+6df1,U+70b9,U+7136,U+7269,U+7279,U+7531,U+754c,U+767e,U+76ca,U+76f8,U+770b,U+7740,U+7814,U+79ef,U+7a0b,U+7a0e,U+7a76,U+7b80,U+7cbe,U+7cfb,U+7e41,U+7ea7,U+7ec4,U+7ec7,U+7ed3,U+7ed9,U+7edf,U+7f8e,U+8001,U+804c,U+8054,U+80b2,U+81f3,U+8425,U+8868,U+88ab,U+897f,U+89c1-89c2,U+89c4,U+89c6,U+89e3,U+8ba1,U+8ba4,U+8bae,U+8bb0,U+8bba,U+8bc1,U+8c03,U+8d28,U+8d39,U+8def,U+8f66,U+8f6c,U+8fd0-8fd1,U+9020,U+9053,U+90a3,U+90fd,U+91cc,U+9500,U+9547,U+95e8,U+95f4,U+961f,U+9645,U+9662,U+96be,U+96c6,U+9700,U+9769,U+97e6,U+9875,U+9879,U+9886,U+9898,U+98ce,U+9996,U+2b5af,U+2cc56,U+2e9f5,U+30edd-30ede"}},{uri:rye,descriptors:{unicodeRange:"U+4e03,U+4e30,U+4e34,U+4e45,U+4e60,U+4e70,U+4e88,U+4e91-4e92,U+4ea9,U+4eb2,U+4ec0,U+4ecb,U+4ecd,U+4ee4,U+4fee,U+5019,U+5047,U+50cf,U+5145,U+516d,U+5170,U+5175,U+5199,U+51cf,U+51fb,U+521a,U+5224,U+5267,U+52aa,U+5347-5348,U+534a,U+5356,U+5361,U+536b,U+5370,U+538b,U+53e4,U+53e6,U+5403,U+5426,U+5428,U+542c,U+5438,U+5668,U+56ed,U+56f4,U+56fe,U+57df,U+592a,U+5957,U+5b69,U+5b81,U+5b8f,U+5b98,U+5b9d,U+5ba1,U+5ba4,U+5bb3,U+5bc6,U+5bdf,U+5c3d,U+5c5e,U+5c81,U+5ddd,U+5de8,U+5dee,U+5e0c,U+5e86,U+5e8f,U+5e93,U+5e95,U+5e97,U+5ea7,U+5ead,U+5eb7,U+5f55,U+5f81,U+5f85,U+5ff5,U+6001,U+613f,U+6258,U+6267,U+6269,U+626c,U+627e,U+62db,U+62ec,U+6325,U+635f,U+6362,U+6388,U+6392,U+63a2,U+63a7,U+63aa,U+641e,U+6545,U+6597,U+65e2,U+65e9,U+661f,U+665a,U+666e-666f,U+66fe,U+6728,U+67d0,U+6811,U+6838,U+6865,U+697c,U+6b22,U+6b27,U+6b4c,U+6b62,U+6b66,U+6b7b,U+6bdb,U+6c47,U+6c49,U+6c7d,U+6c99,U+6cfd,U+6d0b,U+6d25,U+6d32,U+6d3e,U+6d4b,U+6e29,U+6e56,U+6e7e,U+6f14,U+6fc0,U+706b,U+70c8,U+7247,U+72af,U+72b6,U+72ec,U+732e,U+73ed,U+7403,U+7533,U+753b,U+7559,U+7565,U+7597,U+767b,U+773c,U+7763,U+77ed,U+77ff,U+7968,U+798f,U+79bb,U+79c0-79c1,U+7ad9,U+7ae0,U+7b51,U+7b7e,U+7cae,U+7d22,U+7ea2,U+7eb3,U+7eb7,U+7ec3,U+7ec8,U+7ecd,U+7edd,U+7efc,U+7f16,U+7f3a,U+7f51,U+7f57,U+7f6e,U+80dc,U+822a,U+8239,U+826f,U+82cf,U+82e6,U+8349,U+8363,U+83dc,U+8457,U+85cf,U+878d,U+8865,U+8a00,U+8b66,U+8ba2,U+8ba8,U+8bad,U+8bb2,U+8bc9,U+8bd5,U+8bfb,U+8d2b,U+8d35,U+8d37,U+8f7b,U+8f93,U+8fce,U+8fdd,U+9000-9002,U+9010,U+9047,U+9093,U+9152,U+9488,U+94a2,U+9633,U+9636,U+963f,U+9646,U+9648,U+964d,U+9664,U+9669,U+9760,U+97f3,U+987a,U+987e,U+9884,U+98de,U+9986,U+9ed1"}},{uri:oye,descriptors:{unicodeRange:"U+4e14,U+4e25,U+4e48,U+4e50,U+4e5d,U+4e9a,U+4ec5,U+4efd,U+4f17,U+4f4e-4f4f,U+4f55,U+4f59,U+4f60,U+4f8b,U+4f9b,U+4f9d,U+4fbf,U+4fc3,U+5065,U+513f,U+5149,U+514b,U+516b,U+5174,U+517b,U+518d,U+51b5,U+5207,U+5217-5219,U+521d,U+526f,U+529f,U+52a9,U+52b3,U+5305,U+533b,U+5343,U+5360,U+5373-5374,U+5386,U+53cb-53cd,U+53f2,U+53f7,U+544a,U+5468,U+547d,U+54cd,U+552e,U+5584,U+56f0,U+571f,U+5747,U+575a,U+57f9,U+5883,U+58eb,U+58f0,U+5907,U+590d,U+592e,U+5931,U+5956,U+5965,U+5973,U+5979,U+59cb,U+5b57-5b58,U+5b83,U+5ba2-5ba3,U+5bb9,U+5bcc,U+5c42,U+5c45,U+5c4a,U+5dde,U+5df1,U+5df4,U+5e03,U+5e08,U+5e26,U+5e2d,U+5f71,U+5f80,U+5f8b,U+5fb7,U+606f,U+611f,U+6237,U+623f,U+6253,U+627f,U+6293,U+62a4,U+62c5,U+62c9,U+6309,U+6574,U+6599,U+65ad,U+65af,U+65c5,U+65cf,U+6625,U+663e,U+671b,U+672a,U+6750,U+6781,U+6821,U+6839,U+6848,U+68c0,U+6a21,U+6b3e,U+6bb5,U+6c14,U+6cb3,U+6cb9,U+6ce8,U+6e05,U+6e2f,U+6e38,U+6e90,U+6ee1,U+70ed,U+7167,U+7231,U+7248,U+724c,U+7387,U+738b,U+73af,U+7530,U+75c5,U+767d,U+76d1,U+76f4,U+771f,U+77e5,U+77f3,U+7834,U+7840,U+786e,U+793a,U+795e,U+79f0,U+7a33,U+7a7a,U+7a81,U+7ade,U+7b56,U+7b97,U+7c73,U+7c7b,U+7d20,U+7d27,U+7ea6,U+7eaa,U+7ebf,U+7ee7,U+7eed,U+7ef4,U+7fa4,U+8003,U+80a1,U+81f4,U+8272,U+827a,U+8282,U+82b1,U+82f1,U+8303,U+836f,U+83b7,U+843d,U+88c5,U+8ba9,U+8baf,U+8bb8,U+8bbf,U+8bc4,U+8bc6,U+8bdd,U+8be5,U+8bf7,U+8c08,U+8c61,U+8d1f,U+8d22-8d23,U+8d27,U+8d2d,U+8d38,U+8d5b,U+8d70,U+8d85,U+8d8a,U+8db3,U+8eab,U+8f83,U+8fb9,U+8fdc,U+8fde,U+9009,U+901f,U+914d,U+91c7,U+94b1,U+94c1,U+94f6,U+95fb,U+9632,U+9650,U+968f,U+9752,U+975e,U+987b,U+989d,U+98df,U+9999,U+9a6c,U+9a8c,U+9ec4,U+9feb-9fec"}},{uri:aye,descriptors:{unicodeRange:"U+98fb-990c,U+990e-990f,U+9911-992d,U+992f-9953,U+9956-9962,U+9964,U+9966,U+9973,U+9978-9979,U+997b,U+997e,U+9982-9983,U+9989,U+998c,U+998e,U+999a-99a4,U+99a6-99a7,U+99a9-99c8"}},{uri:lye,descriptors:{unicodeRange:"U+8e4c-8e50,U+8e53-8e58,U+8e5a-8e65,U+8e67-8e68,U+8e6a-8e6b,U+8e6e,U+8e71,U+8e73,U+8e75,U+8e77-8e7b,U+8e7d-8e7e,U+8e80,U+8e82-8e84,U+8e86,U+8e88-8e8e,U+8e91-8e93,U+8e95-8e9b,U+8e9d,U+8e9f-8eaa,U+8ead-8eae,U+8eb0-8eb1,U+8eb3-8eb9,U+8ebb-8ecd,U+8ecf-8f02"}},{uri:cye,descriptors:{unicodeRange:"U+2e3a,U+3001-3002,U+3008-3011,U+3014-3017,U+301d-301f,U+4dae,U+4e00,U+4e07,U+4e09-4e0b,U+4e0d-4e0e,U+4e1a,U+4e2a,U+4e2d,U+4e3a-4e3b,U+4e4b,U+4e5f,U+4e86,U+4e8b,U+4e8e,U+4ea7,U+4eba,U+4ece,U+4ed1,U+4ed6,U+4ee3,U+4ee5,U+4eec,U+4f01,U+4f1a,U+4f4d,U+4f53,U+4f5c,U+4fdd,U+5143,U+5165,U+5168,U+516c,U+5173,U+5176,U+5185,U+519c,U+51fa,U+5206,U+5229,U+5230,U+5236,U+524d,U+529b,U+52a0-52a1,U+52a8,U+5316-5317,U+533a,U+5341,U+5362,U+53d1,U+53ef,U+53f8,U+5404,U+5408,U+540c,U+540e,U+5458,U+548c,U+54c1,U+54e5,U+5546,U+559c,U+56fd,U+5728,U+5730,U+573a,U+5916,U+591a,U+5927,U+5929,U+592b,U+597d,U+59d4,U+5b50,U+5b66,U+5b9a,U+5b9e,U+5bb6,U+5bf9,U+5c0f,U+5c14,U+5c31,U+5c55,U+5de5,U+5df2,U+5e02,U+5e73-5e74,U+5ea6,U+5efa,U+5f00,U+5f53,U+5f97,U+5fc3,U+603b,U+6210-6211,U+6240,U+6280,U+62a5,U+63d0,U+6539,U+653f,U+6587,U+65b0,U+65b9,U+65e5,U+65f6,U+662f,U+6708-6709,U+672c,U+673a,U+675c,U+6765,U+6c11,U+6c34,U+6cd5,U+6ce2,U+6d4e,U+6d77,U+73b0,U+7406,U+751f,U+7528,U+7535,U+7684,U+76ee,U+793e,U+79cd,U+79d1,U+7acb,U+7b2c,U+7b49,U+7ba1,U+7ecf,U+8005,U+800c,U+80fd,U+81ea,U+884c,U+8981,U+8bbe,U+8bf4,U+8d44,U+8d77,U+8fbe,U+8fc7,U+8fd8-8fd9,U+8fdb,U+901a,U+90e8,U+91cd,U+91cf,U+91d1,U+9485,U+957f,U+95ee,U+9762,U+9ad8,U+9ea6,U+9f99,U+9fcf,U+9fd4,U+9fed,U+fe10-fe19,U+fe30-fe31,U+fe33-fe44,U+ff01,U+ff0c,U+ff1f,U+2b4e7,U+2b7f7,U+2b7fc,U+2cb2d,U+2cb3b,U+2cb4a,U+2cb5b,U+2cb73"}},{uri:dye,descriptors:{unicodeRange:"U+6490,U+6493-6494,U+6497-6498,U+649a-649d,U+649f-64a3,U+64a5-64a8,U+64aa-64ab,U+64af,U+64b1-64b4,U+64b6,U+64b9,U+64bb,U+64bd-64bf,U+64c1,U+64c3-64c4,U+64c6-64cc,U+64cf,U+64d1,U+64d3-64d6,U+64d9-64dd,U+64df-64e1,U+64e3,U+64e5,U+64e7-64ff,U+6501-6508,U+650a-6511,U+6513-6517,U+6519-6524,U+6526-652a,U+652c-652d,U+6530-6533,U+6537,U+653a,U+653c-653d,U+6540-6544,U+6546-6547,U+654a-654b,U+654d-654e,U+6550,U+6552-6554,U+6557-6558,U+655a,U+655c,U+655f-6561,U+6564-6565,U+6567-6568"}},{uri:uye,descriptors:{unicodeRange:"U+9695-9696,U+969a-969b,U+969d-96a6,U+96a8-96af,U+96b1-96b2,U+96b4-96b5,U+96b7-96b8,U+96ba-96bb,U+96bf,U+96c2-96c3,U+96c8,U+96ca-96cb,U+96d0-96d1,U+96d3-96d4,U+96d6-96df,U+96e1-96e7,U+96eb-96ee,U+96f0-96f2,U+96f4-96f5,U+96f8,U+96fa-96fd,U+96ff,U+9702-9703,U+9705,U+970a-970c,U+9710-9712,U+9714-9715,U+9717-971b,U+971d,U+971f-9729,U+972b-972c,U+972e-972f,U+9731,U+9733-9737,U+973a-973d,U+973f-9751,U+9754-9755,U+9757-9758,U+975a,U+975c-975d,U+975f,U+9763-9764,U+9766-9768,U+976a-9770"}},{uri:fye,descriptors:{unicodeRange:"U+6af0-6b1f,U+6b25-6b26,U+6b28-6b31,U+6b33-6b36,U+6b38,U+6b3b-6b3d,U+6b3f-6b42,U+6b44-6b45,U+6b48,U+6b4a-6b4b,U+6b4d-6b58,U+6b5a-6b61,U+6b68-6b69,U+6b6b-6b78,U+6b7a,U+6b7d-6b80,U+6b85,U+6b88,U+6b8c,U+6b8e-6b91,U+6b94-6b95,U+6b97-6b99,U+6b9c-6ba0,U+6ba2-6ba9,U+6bab-6bb2,U+6bb6,U+6bb8-6bba"}},{uri:hye,descriptors:{unicodeRange:"U+430e-439a,U+29e8a,U+29ec4,U+29edb,U+29ee9,U+29f7e,U+29f83,U+29f8c,U+29fce,U+2a01a,U+2a02f,U+2a082,U+2a0f9,U+2a190,U+2a38c"}},{uri:gye,descriptors:{unicodeRange:"U+92ef-933d,U+933f-9369,U+936b-9388"}},{uri:mye,descriptors:{unicodeRange:"U+4512-458d,U+2b300,U+2b363,U+2b36f,U+2b372,U+2b37d,U+2b404,U+2b410,U+2b413,U+2b461,U+2b4ef,U+2b4f6,U+2b4f9,U+2b50d-2b50e,U+2b536,U+2b5ae,U+2b5b3,U+2b5e7,U+2b5f4,U+2b61c-2b61d,U+2b626-2b628,U+2b62a,U+2b62c,U+2b695-2b696,U+2b6ad,U+2b6ed"}},{uri:pye,descriptors:{unicodeRange:"U+88bd-88c0,U+88c3-88c4,U+88c7-88c8,U+88ca-88cd,U+88cf-88d1,U+88d3,U+88d6-88d7,U+88da-88de,U+88e0-88e1,U+88e6-88e7,U+88e9-88ef,U+88f2,U+88f5-88f7,U+88fa-88fb,U+88fd,U+88ff-8901,U+8903-8909,U+890b-890f,U+8911,U+8914-8918,U+891c-8920,U+8922-8924,U+8926-8929,U+892c-892f,U+8931-8933,U+8935,U+8937-8940,U+8942-8943,U+8945-895d,U+8960-8965,U+8967-897a,U+897c-897e,U+8980,U+8982,U+8984-8985"}},{uri:ebe,descriptors:{unicodeRange:"U+4b0b-4ba0"}},{uri:Uye,descriptors:{unicodeRange:"U+7179,U+717b-717c,U+717e-7183,U+7185-7189,U+718b-718e,U+7190-7193,U+7195-7197,U+719a-719e,U+71a1-71a7,U+71a9-71ab,U+71ad-71b2,U+71b4,U+71b6-71b8,U+71ba-71c2,U+71c4-71cd,U+71cf-71d3,U+71d6-71df,U+71e1-71e4,U+71e6,U+71e8-71ed,U+71ef-71f8,U+71fa-7205,U+7207-721c,U+721e-7227,U+7229,U+722b,U+722d"}},{uri:bye,descriptors:{unicodeRange:"U+982e-9874,U+988b,U+988e,U+9892,U+9895,U+9899,U+98a3,U+98a8-98cd,U+98cf-98d0,U+98d4,U+98d6-98d7,U+98db-98dd,U+98e0-98e6,U+98e9-98fa"}},{uri:yye,descriptors:{unicodeRange:"U+7c14-7c15,U+7c17-7c1e,U+7c20-7c25,U+7c28-7c29,U+7c2b-7c37,U+7c39-7c3e,U+7c42-7c4c,U+7c4e-7c72,U+7c75-7c7a,U+7c7e-7c88,U+7c8a-7c90,U+7c93-7c94,U+7c96,U+7c99-7c9b,U+7ca0-7ca1,U+7ca3,U+7ca6-7ca9,U+7cab-7cad,U+7caf-7cb0,U+7cb4-7cb8,U+7cba-7cbb,U+7cbf-7cc0,U+7cc2-7cc4,U+7cc6,U+7cc9,U+7ccb,U+7cce-7cd4"}},{uri:Eye,descriptors:{unicodeRange:"U+7d95-7da5,U+7da7-7dad,U+7daf-7e2a"}},{uri:vye,descriptors:{unicodeRange:"U+4a78-4b0a"}},{uri:_ye,descriptors:{unicodeRange:"U+9b30-9b31,U+9b33-9b3a,U+9b3d-9b40,U+9b46,U+9b4a-9b4c,U+9b4e,U+9b50,U+9b52-9b53,U+9b55-9bcf"}},{uri:wye,descriptors:{unicodeRange:"U+6a4b-6a4f,U+6a51-6a57,U+6a5a,U+6a5c-6a60,U+6a62-6a64,U+6a66-6a70,U+6a72-6a78,U+6a7a-6a7b,U+6a7d-6a7f,U+6a81-6a83,U+6a85-6a8d,U+6a8f,U+6a92-6a96,U+6a98-6a9f,U+6aa1-6aa8,U+6aaa,U+6aad-6aef"}},{uri:Tye,descriptors:{unicodeRange:"U+99c9-9a53"}},{uri:Iye,descriptors:{unicodeRange:"U+8550-8555,U+8557-8558,U+855a-855d,U+855f-8563,U+8565-8567,U+8569-8571,U+8573,U+8575-8578,U+857c-857d,U+857f-8583,U+8586,U+8588-858e,U+8590-859a,U+859d-85a3,U+85a5-85a7,U+85a9,U+85ab-85ad,U+85b1-85b6,U+85b8,U+85ba-85c0,U+85c2-85c8,U+85ca-85ce,U+85d1-85d2,U+85d4,U+85d6-85db,U+85dd-85e3,U+85e5-85e8,U+85ea-85fa,U+85fc-85fe,U+8600-8603"}},{uri:Sye,descriptors:{unicodeRange:"U+6fb2,U+6fb4-6fb5,U+6fb7-6fb8,U+6fba-6fbf,U+6fc1,U+6fc3-6fc8,U+6fca-6fd0,U+6fd3-6fdd,U+6fdf,U+6fe2-6fed,U+6ff0-7010,U+7012-7019,U+701c-7022,U+7024-7034,U+7036-7038,U+703a-704b,U+704d-704e,U+7050-7053"}},{uri:Cye,descriptors:{unicodeRange:"U+4ba1-4c2c"}},{uri:xye,descriptors:{unicodeRange:"U+9a54-9a6b,U+9a72,U+9a83,U+9a89,U+9a8d-9a8e,U+9a94-9a95,U+9a99,U+9aa6,U+9aa9-9aaf,U+9ab2-9ab5,U+9ab9,U+9abb,U+9abd-9abf,U+9ac3-9ac4,U+9ac6-9aca,U+9acd-9ad0,U+9ad2,U+9ad4-9ad7,U+9ad9-9ade,U+9ae0,U+9ae2-9ae5,U+9ae7-9aea,U+9aec,U+9aee,U+9af0-9af8,U+9afa,U+9afc-9b02,U+9b04-9b07,U+9b09-9b0e,U+9b10-9b12,U+9b14-9b1e,U+9b20-9b22,U+9b24-9b2e"}},{uri:Aye,descriptors:{unicodeRange:"U+9d1a-9da1"}},{uri:Mye,descriptors:{unicodeRange:"U+9e13-9e1e,U+9e24,U+9e27,U+9e2e,U+9e30,U+9e34,U+9e3b-9e3c,U+9e40,U+9e4d,U+9e50,U+9e52-9e54,U+9e56,U+9e59,U+9e5d,U+9e5f-9e62,U+9e65,U+9e6e-9e6f,U+9e72,U+9e74-9e7d,U+9e80-9e81,U+9e83-9e86,U+9e89-9e8a,U+9e8c-9e91,U+9e94-9e9c,U+9e9e,U+9ea0-9ea5,U+9ea7-9eb3,U+9eb5-9eb7,U+9eb9-9eba,U+9ebc,U+9ebf-9ec3,U+9ec5-9ec8,U+9eca-9ecc,U+9ed0,U+9ed2-9ed3,U+9ed5-9ed7,U+9ed9-9eda,U+9ede,U+9ee1,U+9ee3-9ee4,U+9ee6,U+9ee8,U+9eeb-9eee,U+9ef0-9ef8"}},{uri:kye,descriptors:{unicodeRange:"U+8b1c-8b25,U+8b27-8b65,U+8b67-8b6b,U+8b6d-8b9f,U+8bac,U+8bb1,U+8bbb,U+8bc7,U+8bd0"}},{uri:Rye,descriptors:{unicodeRange:"U+4cad-4d2f"}},{uri:Dye,descriptors:{unicodeRange:"U+9c4b-9c7b,U+9c7d-9c7e,U+9c80,U+9c83-9c84,U+9c89-9c8a,U+9c8c,U+9c8f,U+9c93,U+9c96-9c99,U+9c9d,U+9caa,U+9cac,U+9caf,U+9cb9,U+9cbe-9cc2,U+9cc8-9cc9,U+9cd1-9cd2,U+9cda-9cdb,U+9ce0-9ce1,U+9ce3-9d19"}},{uri:Lye,descriptors:{unicodeRange:"U+9389-938e,U+9390-93c9,U+93cb-93d5,U+93d7-9410"}},{uri:iye,descriptors:{unicodeRange:"U+20a0-20b5,U+20b9-20ba,U+20bc-20bd,U+4e2c,U+5107,U+5216,U+5293,U+54f3,U+5523,U+5819,U+5adc,U+5c88,U+5e3b,U+5fee,U+62f6,U+63be,U+6484,U+6499,U+67d9,U+67dd,U+6d5e,U+6f46,U+717a,U+71e0,U+72c1,U+73e7,U+75b0,U+7603,U+7722,U+7809,U+7811,U+7946,U+7967,U+799a,U+7b45,U+7ba2,U+8014,U+80d9,U+8159,U+817d,U+81a3,U+81aa,U+8201,U+833c,U+836e,U+83e5,U+8459,U+84f0,U+8729,U+8753,U+87d3,U+89dc,U+8bf6,U+8c2e,U+8e2c,U+8e9c,U+8e9e,U+8ece,U+8fee,U+9139,U+914f,U+9174,U+9191,U+960c,U+9622,U+9a98,U+9b48,U+9ca6,U+9cb0,U+9da2-9e12,U+9e88,U+9f44,U+9f86"}},{uri:Pye,descriptors:{unicodeRange:"U+9bd0-9c4a"}},{uri:Nye,descriptors:{unicodeRange:"U+4c2d-4cac"}},{uri:Oye,descriptors:{unicodeRange:"U+4d30-4dab"}},{uri:Fye,descriptors:{unicodeRange:"U+9411-943d,U+943f-946a,U+946c-9484"}},{uri:Bye,descriptors:{unicodeRange:"U+9efa,U+9efd,U+9eff-9f0a,U+9f0c,U+9f0f,U+9f11-9f12,U+9f14-9f16,U+9f18,U+9f1a-9f1f,U+9f21,U+9f23-9f2b,U+9f2d-9f2e,U+9f30-9f36,U+9f38,U+9f3a,U+9f3c,U+9f3f-9f43,U+9f45-9f4f,U+9f52-9f7e,U+9f81-9f82,U+9f8d-9f94"}},{uri:zye,descriptors:{unicodeRange:"U+7e2b-7e3a,U+7e3c-7e40,U+7e42-7e46,U+7e48-7e81,U+7e83-7e9a,U+7e9c-7e9e,U+7eae,U+7eb4,U+7ebb-7ebc,U+7ed6,U+7ee4,U+7eec,U+7ef9,U+7f0a,U+7f10,U+7f1e,U+7f37,U+7f39,U+7f3b"}}],ot=class ot{constructor(t){B(this,"scene");B(this,"getSceneFamilies",()=>ot.getUniqueFamilies(this.scene.getNonDeletedElements()));B(this,"onLoaded",t=>{let n=!0;for(const r of t){const o=`${r.family}-${r.style}-${r.weight}-${r.unicodeRange}`;ot.loadedFontsCache.has(o)||(ot.loadedFontsCache.add(o),n=!1)}if(n)return;let i=!1;const s=this.scene.getNonDeletedElementsMap();for(const r of this.scene.getNonDeletedElements())if(he(r)){i=!0,kn.delete(r),i2.clearCache(_t(r));const o=Gn(r,s);o&&kn.delete(o)}i&&this.scene.triggerUpdate()});B(this,"loadSceneFonts",async()=>{const t=this.getSceneFamilies(),n=ot.getCharsPerFamily(this.scene.getNonDeletedElements());return ot.loadFontFaces(t,n)});this.scene=t}static get registered(){return ot._registered?ot._initialized||(ot._registered=new Map([...ot.init().entries(),...ot._registered.entries()])):ot._registered=ot.init(),ot._registered}get registered(){return ot.registered}static async generateFontFaceDeclarations(t){const n=ot.getUniqueFamilies(t),i=ot.getCharsPerFamily(t),s=n.find(l=>hz(l).includes(ch));if(s){const l=ot.getCharacters(i,s);if(yde(l)){const c=dh[ch];i[c]=new Set(l),n.unshift(dh[ch])}}const r=ot.fontFacesStylesGenerator(n,i),o=3,a=await new sM(r,o).all();return Array.from(new Set(a))}static async loadFontFaces(t,n){for(const{fontFaces:o,metadata:a}of ot.registered.values())if(!a.local)for(const{fontFace:l}of o)window.document.fonts.has(l)||window.document.fonts.add(l);const i=ot.fontFacesLoader(t,n),s=10;return(await new sM(i,s).all()).flat().filter(Boolean)}static*fontFacesLoader(t,n){for(const[i,s]of t.entries()){const r=_t({fontFamily:s,fontSize:lh.sm}),o=ot.getCharacters(n,s);window.document.fonts.check(r,o)||(yield sd(async()=>{var a;try{const l=await window.document.fonts.load(r,o);return[i,l]}catch(l){console.error(`Failed to load font "${r}" from urls "${(a=ot.registered.get(s))==null?void 0:a.fontFaces.map(c=>c.urls)}"`,l)}}))}}static*fontFacesStylesGenerator(t,n){for(const[i,s]of t.entries()){const{fontFaces:r,metadata:o}=ot.registered.get(s)??{};if(!Array.isArray(r)){console.error(`Couldn't find registered fonts for font-family "${s}"`,ot.registered);continue}if(!(o!=null&&o.local))for(const[a,l]of r.entries())yield sd(async()=>{try{const c=ot.getCharacters(n,s),d=await l.toCSS(c);return d?[i*1e4+a,d]:void 0}catch(c){console.error(`Couldn't transform font-face to css for family "${l.fontFace.family}"`,c)}})}}static register(t,n,...i){const s=ct[t]??dh[t];return this.registered.get(s)||this.registered.set(s,{metadata:n,fontFaces:i.map(({uri:o,descriptors:a})=>new w_(t,o,a))}),this.registered}static init(){const t={registered:new Map},n=(i,...s)=>{const r=ct[i]??dh[i],o=ig[r]??ig[ct.Excalifont];ot.register.call(t,i,o,...s)};return n("Cascadia",...gUe),n("Comic Shanns",...yUe),n("Excalifont",...DUe),n("Helvetica",...LUe),n("Liberation Sans",...NUe),n("Lilita One",...BUe),n("Nunito",...XUe),n("Virgil",...YUe),n(ch,...Hye),n(F0,...EUe),ot._initialized=!0,t.registered}static getUniqueFamilies(t){return Array.from(t.reduce((n,i)=>(he(i)&&n.add(i.fontFamily),n),new Set))}static getCharsPerFamily(t){const n={};for(const i of t)if(he(i))for(const s of i.originalText)n[i.fontFamily]||(n[i.fontFamily]=new Set),n[i.fontFamily].add(s);return n}static getCharacters(t,n){return t[n]?Array.from(t[n]).join(""):""}static getAllFamilies(){return Array.from(ot.registered.keys())}};B(ot,"loadedFontsCache",new Set),B(ot,"_registered"),B(ot,"_initialized",!1),B(ot,"loadElementsFonts",async t=>{const n=ot.getUniqueFamilies(t),i=ot.getCharsPerFamily(t);return ot.loadFontFaces(n,i)});let wl=ot;const Sj=de.forwardRef(({className:e,placeholder:t,onChange:n},i)=>P("div",{className:ae("QuickSearch__wrapper",e),children:[Fu,g("input",{ref:i,className:"QuickSearch__input",type:"text",placeholder:t,onChange:s=>n(s.target.value.trim().toLowerCase())})]})),Cj=({className:e,placeholder:t,children:n})=>{const i=!C.Children.count(n);return g("div",{className:ae("ScrollableList__wrapper",e),role:"menu",children:i?g("div",{className:"empty",children:t}):n})},w5=({children:e,className:t="",style:n,title:i})=>P("div",{className:`dropdown-menu-group ${t}`,style:n,children:[i&&g("p",{className:"dropdown-menu-group-title",children:i}),e]});w5.displayName="DropdownMenuGroup";const xj=de.createContext({}),CE=(e="",t=!1,n=!1)=>`dropdown-menu-item dropdown-menu-item-base ${e} ${t?"dropdown-menu-item--selected":""} ${n?"dropdown-menu-item--hovered":""}`.trim(),Aj=e=>{const t=C.useContext(xj);return By(e,n=>{var i;(i=t.onSelect)==null||i.call(t,n)})},Mj=({children:e,...t})=>g("span",{...t,style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",...t.style},children:e}),xE=({textStyle:e,icon:t,shortcut:n,children:i,badge:s})=>{const r=Nn();return P(fe,{children:[t&&g("div",{className:"dropdown-menu-item__icon",children:t}),g("div",{style:e,className:"dropdown-menu-item__text",children:g(Mj,{children:i})}),s&&g("div",{className:"dropdown-menu-item__badge",children:s}),n&&r.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut",children:n})]})},Ys=({icon:e,badge:t,value:n,children:i,shortcut:s,className:r,selected:o,onSelect:a,...l})=>{const c=Aj(a);return g(KX,{className:"radix-menu-item",onSelect:c,asChild:!0,children:g("button",{...l,value:n,className:CE(r,o),title:l.title??l["aria-label"],children:g(xE,{icon:e,shortcut:s,badge:t,children:i})})})};Ys.displayName="DropdownMenuItem";const U1={GREEN:"green",RED:"red",BLUE:"blue"},NI=({type:e=U1.BLUE,children:t})=>{const{theme:n}=S2(),i={display:"inline-flex",marginLeft:"auto",padding:"2px 4px",borderRadius:6,fontSize:9,fontFamily:"Cascadia, monospace",border:n===be.LIGHT?"1.5px solid white":"none"};switch(e){case U1.GREEN:Object.assign(i,{backgroundColor:"var(--background-color-badge)",color:"var(--color-badge)"});break;case U1.RED:Object.assign(i,{backgroundColor:"pink",color:"darkred"});break;case U1.BLUE:default:Object.assign(i,{background:"var(--color-promo)",color:"var(--color-surface-lowest)"})}return g("div",{className:"DropDownMenuItemBadge",style:i,children:t})};NI.displayName="DropdownMenuItemBadge";Ys.Badge=NI;const Vye=({event:e,inputRef:t,hoveredFont:n,filteredFonts:i,onClose:s,onSelect:r,onHover:o})=>{var a,l,c;if(!e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===$.F)return(a=t.current)==null||a.focus(),!0;if(e.key===$.ESCAPE)return s(),!0;if(e.key===$.ENTER)return n!=null&&n.value&&r(n.value),!0;if(e.key===$.ARROW_DOWN)return n!=null&&n.next?o(n.next.value):(l=i[0])!=null&&l.value&&o(i[0].value),!0;if(e.key===$.ARROW_UP)return n!=null&&n.prev?o(n.prev.value):(c=i[i.length-1])!=null&&c.value&&o(i[i.length-1].value),!0},$ye=e=>{switch(e){case ct.Excalifont:case ct.Virgil:return u2;case ct.Nunito:case ct.Helvetica:return u_;case ct["Lilita One"]:return Gge;case ct["Comic Shanns"]:case ct.Cascadia:return hG;default:return u_}},Gye=de.memo(({selectedFontFamily:e,hoveredFontFamily:t,onSelect:n,onHover:i,onLeave:s,onOpen:r,onClose:o})=>{const{container:a}=Ws(),l=Ir(),{fonts:c}=l,{showDeprecatedFonts:d}=I2(),u=Na(),[f,h]=C.useState(""),m=C.useRef(null),p=C.useMemo(()=>Array.from(wl.registered.entries()).filter(([D,{metadata:N}])=>!N.private&&!N.fallback).map(([D,{metadata:N,fontFaces:L}])=>{var Y,G;const j={value:D,icon:$ye(D),text:((G=(Y=L[0])==null?void 0:Y.fontFace)==null?void 0:G.family)??"Unknown"};return N.deprecated&&Object.assign(j,{deprecated:N.deprecated,badge:{type:U1.RED,placeholder:x("fontList.badge.old")}}),j}).sort((D,N)=>D.text.toLowerCase()>N.text.toLowerCase()?1:-1),[]),U=C.useMemo(()=>new Set(c.getSceneFamilies()),[e]),b=C.useMemo(()=>p.filter(D=>U.has(D.value)),[p,U]),y=C.useMemo(()=>p.filter(D=>!U.has(D.value)&&(d||!D.deprecated)),[p,U,d]),E=C.useMemo(()=>Jie([...b,...y].filter(D=>{var N;return(N=D.text)==null?void 0:N.toLowerCase().includes(f)})),[b,y,f]),_=C.useMemo(()=>{var N;let D;return t?D=E.find(L=>L.value===t):e&&(D=E.find(L=>L.value===e)),!D&&f&&((N=E[0])!=null&&N.value?i(E[0].value):s()),D},[t,e,f,E,i,s]),I=C.useCallback(D=>{let N=null;if(l.state.editingTextElement){const L=document.querySelector(".excalidraw-wysiwyg");L&&(N={start:L.selectionStart,end:L.selectionEnd})}n(D),l.state.editingTextElement&&N&&setTimeout(()=>{const L=document.querySelector(".excalidraw-wysiwyg");L&&N&&(L.focus(),L.selectionStart=N.start,L.selectionEnd=N.end)},0)},[n,l.state.editingTextElement]),k=C.useCallback(D=>{Vye({event:D,inputRef:m,hoveredFont:_,filteredFonts:E,onSelect:I,onHover:i,onClose:o})&&(D.preventDefault(),D.stopPropagation())},[_,E,I,i,o]);C.useEffect(()=>(r(),()=>{o()}),[]);const w=C.useMemo(()=>E.filter(D=>U.has(D.value)),[E,U]),T=C.useMemo(()=>E.filter(D=>!U.has(D.value)),[E,U]),A=({font:D,order:N})=>{const L=C.useRef(null),j=D.value===(_==null?void 0:_.value),Y=D.value===e;return C.useEffect(()=>{var G,O,z,H;j&&(N===0?(O=(G=L.current)==null?void 0:G.scrollIntoView)==null||O.call(G,{block:"end"}):(H=(z=L.current)==null?void 0:z.scrollIntoView)==null||H.call(z,{block:"nearest"}))},[j,N]),g("button",{ref:L,type:"button",value:D.value,className:CE("",Y,j),title:D.text,tabIndex:Y?0:-1,onClick:G=>{I(Number(G.currentTarget.value))},onMouseMove:()=>{(_==null?void 0:_.value)!==D.value&&i(D.value)},children:g(xE,{icon:D.icon,badge:D.badge&&g(NI,{type:D.badge.type,children:D.badge.placeholder}),textStyle:{fontFamily:Xp({fontFamily:D.value})},children:D.text})})},S=[];return w.length&&S.push(g(w5,{title:x("fontList.sceneFonts"),children:w.map((D,N)=>g(A,{font:D,order:N},D.value))},"group_1")),T.length&&S.push(g(w5,{title:x("fontList.availableFonts"),children:T.map((D,N)=>g(A,{font:D,order:N+w.length},D.value))},"group_2")),P(Qg,{className:"properties-content",container:a,style:{width:"15rem"},onClose:()=>{o(),l.state.editingTextElement&&setTimeout(()=>{const D=document.querySelector(".excalidraw-wysiwyg");D&&D.focus()},0)},onPointerLeave:s,onKeyDown:k,preventAutoFocusOnTouch:!!l.state.editingTextElement,children:[u==="full"&&g(Sj,{ref:m,placeholder:x("quickSearch.placeholder"),onChange:Al(h,20)}),g(Cj,{className:"dropdown-menu fonts manual-hover",placeholder:x("fontList.empty"),children:S.length?S:null})]})},(e,t)=>e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),Xye=({selectedFontFamily:e,isOpened:t=!1,compactMode:n=!1})=>{const i=On(),s=n?{...Gp,width:"2rem",height:"2rem"}:{};return g(Xl,{asChild:!0,children:g("div",{"data-openpopup":"fontFamily",className:"properties-trigger",children:g(rI,{standalone:!0,icon:Fh,title:x("labels.showFonts"),className:"properties-trigger",testId:"font-family-show-fonts",active:t,onClick:()=>{i(r=>({openPopup:r.openPopup==="fontFamily"?null:r.openPopup}))},style:{border:"none",...s}})})})},kj=[{value:ct.Excalifont,icon:u2,text:x("labels.handDrawn"),testId:"font-family-hand-drawn"},{value:ct.Nunito,icon:u_,text:x("labels.normal"),testId:"font-family-normal"},{value:ct["Comic Shanns"],icon:hG,text:x("labels.code"),testId:"font-family-code"}];new Set(kj.map(e=>e.value));const jye=de.memo(({isOpened:e,selectedFontFamily:t,hoveredFontFamily:n,onSelect:i,onHover:s,onLeave:r,onPopupChange:o,compactMode:a=!1})=>{const l=C.useMemo(()=>kj,[]),c=C.useCallback(d=>{d&&i(d)},[i]);return P("div",{role:"dialog","aria-modal":"true",className:ae("FontPicker__container",{"FontPicker__container--compact":a}),children:[!a&&g("div",{className:"buttonList",children:g(La,{type:"button",options:l,value:t,onClick:c})}),!a&&g(_j,{}),P(Gl,{open:e,onOpenChange:o,children:[g(Xye,{selectedFontFamily:t,isOpened:e,compactMode:a}),e&&g(Gye,{selectedFontFamily:t,hoveredFontFamily:n,onSelect:c,onHover:s,onLeave:r,onOpen:()=>o(!0),onClose:()=>o(!1)})]})]})},(e,t)=>e.isOpened===t.isOpened&&e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),E2=({className:e,icon:t,size:n="1em"})=>g("span",{className:e,style:{width:n,height:"100%",margin:"0 0.5ex 0 0.5ex",display:"inline-flex",lineHeight:0,verticalAlign:"middle",flex:"0 0 auto"},children:t}),T_=({label:e,open:t,openTrigger:n,children:i,className:s,showCollapsedIcon:r=!0})=>P(fe,{children:[P("div",{style:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},className:s,onClick:n,children:[e,r&&g(E2,{icon:t?Ime:EG})]}),t&&g("div",{style:{display:"flex",flexDirection:"column"},children:i})]}),Yye=Nt(!1);function Wye({options:e,value:t,label:n,onChange:i,onClose:s,numberOfOptionsToAlwaysShow:r=e.length}){const o=Nn(),{container:a}=Ws(),l=p=>{const U=e.find(b=>b.keyBinding===p.key.toLowerCase());if(!(p.metaKey||p.altKey||p.ctrlKey)&&U)i(U.value),p.preventDefault();else if(p.key===$.TAB){const b=e.findIndex(E=>E.value===t),y=p.shiftKey?(e.length+b-1)%e.length:(b+1)%e.length;i(e[y].value)}else if(f1(p.key)){const b=W0().rtl,y=e.findIndex(E=>E.value===t);if(y!==-1){const E=e.length;let _=y;switch(p.key){case(b?$.ARROW_LEFT:$.ARROW_RIGHT):_=(y+1)%E;break;case(b?$.ARROW_RIGHT:$.ARROW_LEFT):_=(E+y-1)%E;break;case $.ARROW_DOWN:{_=(y+(r??1))%E;break}case $.ARROW_UP:{_=(E+y-(r??1))%E;break}}i(e[_].value)}p.preventDefault()}else(p.key===$.ESCAPE||p.key===$.ENTER)&&(p.preventDefault(),s());p.nativeEvent.stopImmediatePropagation(),p.stopPropagation()},[c,d]=dt(Yye),u=de.useMemo(()=>e.slice(0,r),[e,r]),f=de.useMemo(()=>e.slice(r),[e,r]);C.useEffect(()=>{u.some(p=>p.value===t)||d(!0)},[t,u,d]);const h=p=>g("div",{className:"picker-content",children:p.map((U,b)=>P("button",{type:"button",className:ae("picker-option",{active:t===U.value}),onClick:y=>{i(U.value)},title:`${U.text} ${U.keyBinding&&` ${U.keyBinding.toUpperCase()}`}`,"aria-label":U.text||"none","aria-keyshortcuts":U.keyBinding||void 0,ref:y=>{t===U.value&&setTimeout(()=>{y==null||y.focus()},0)},children:[U.icon,U.keyBinding&&g("span",{className:"picker-keybinding",children:U.keyBinding})]},U.text))}),m=o.formFactor==="phone";return g(EE,{side:m?"right":"bottom",align:"start",sideOffset:m?8:12,style:{zIndex:"var(--zIndex-ui-styles-popup)"},onKeyDown:l,collisionBoundary:a??void 0,children:P("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,children:[h(u),f.length>0&&g(T_,{label:x("labels.more_options"),open:c,openTrigger:()=>{d(p=>!p)},className:"picker-collapsible",children:h(f)})]})})}function oD({value:e,label:t,options:n,onChange:i,group:s="",numberOfOptionsToAlwaysShow:r}){var c;const[o,a]=de.useState(!1),l=de.useRef(null);return g("div",{children:P(Gl,{open:o,onOpenChange:d=>a(d),children:[g(Xl,{name:s,type:"button","aria-label":t,onClick:()=>a(!o),ref:l,className:o?"active":"",children:(c=n.find(d=>d.value===e))==null?void 0:c.icon}),o&&g(Wye,{options:n,value:e,label:t,onChange:i,onClose:()=>{a(!1)},numberOfOptionsToAlwaysShow:r})]})})}const Kye=({updateData:e,app:t,testId:n})=>{const i=de.useRef(null),s=de.useRef(null),r=t.scene.getSelectedElements(t.state);let o=!0;const a=r.at(0),c=r.reduce((d,u)=>(d!=null&&d!==u.opacity&&(o=!1),d==null||d>u.opacity?u.opacity:d),(a==null?void 0:a.opacity)??null)??t.state.currentItemOpacity;return C.useEffect(()=>{if(i.current&&s.current){const d=i.current,u=s.current,f=d.offsetWidth,h=15,m=c/100*(f-h)+h/2;u.style.left=`${m}px`,d.style.background=`linear-gradient(to right, var(--color-slider-track) 0%, var(--color-slider-track) ${c}%, var(--button-bg) ${c}%, var(--button-bg) 100%)`}},[c]),P("label",{className:"control-label",children:[x("labels.opacity"),P("div",{className:"range-wrapper",children:[g("input",{style:{"--color-slider-track":o?void 0:"var(--button-bg)"},ref:i,type:"range",min:"0",max:"100",step:"10",onChange:d=>{e(+d.target.value)},value:c,className:"range-input","data-testid":n}),g("div",{className:"value-bubble",ref:s,children:c!==0?c:null}),g("div",{className:"zero-label",children:"0"})]})]})},Rj=.1,em=e=>{const t=K1(e.editorInterface);return{stylesPanelMode:t,isCompact:t!=="full",isMobile:t==="mobile"}},xs=(e,t,n,i=!1)=>{const s=we(Ze(e,t,{includeBoundTextElement:i}));return e.map(r=>{var o;return s.get(r.id)||r.id===((o=t.editingTextElement)==null?void 0:o.id)?n(r):r})},As=function(e,t,n,i,s){const r=t.state.editingTextElement,o=qt(e);let a=null;if(r&&(a=n(r)),!a)if(oi(o,t.state)){const c=t.scene.getSelectedElements(t.state),d=i===!0?c:c.filter(u=>i(u));a=zz(d,n)??(typeof s=="function"?s(!0):s)}else a=typeof s=="function"?s(!1):s;return a},Zye=(e,t,n)=>Vt(t)||!t.autoResize?t:n.mutateElement(t,{x:e.textAlign==="left"?e.x:e.x+(e.width-t.width)/(e.textAlign==="center"?2:1),y:e.y+(e.height-t.height)/2}),OI=(e,t,n,i,s)=>{const r=new Set,o=xs(e,t,a=>{if(he(a)){const l=i(a);r.add(l);let c=xe(a,{fontSize:l});return fs(c,n.scene.getContainerElement(a),n.scene),c=Zye(a,c,n.scene),c}return a},!0);return Ze(e,t,{includeBoundTextElement:!0}).forEach(a=>{he(a)&&pi(a,n.scene)}),{elements:o,appState:{...t,currentItemFontSize:r.size===1?[...r][0]:s??t.currentItemFontSize},captureUpdate:q.IMMEDIATELY}};ue({name:"changeStrokeColor",label:"labels.stroke",trackEvent:!1,perform:(e,t,n)=>({...(n==null?void 0:n.currentItemStrokeColor)&&{elements:xs(e,t,i=>z4(i.type)?xe(i,{strokeColor:n.currentItemStrokeColor}):i,!0)},appState:{...t,...n},captureUpdate:n!=null&&n.currentItemStrokeColor?q.IMMEDIATELY:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{stylesPanelMode:r}=em(i);return P(fe,{children:[r==="full"&&g("h3",{"aria-hidden":"true",children:x("labels.stroke")}),g(LI,{topPicks:rz,palette:$ne,type:"elementStroke",label:x("labels.stroke"),color:As(e,i,o=>o.strokeColor,!0,o=>o?null:t.currentItemStrokeColor),onChange:o=>n({currentItemStrokeColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeBackgroundColor",label:"labels.changeBackground",trackEvent:!1,perform:(e,t,n,i)=>{if(!(n!=null&&n.currentItemBackgroundColor))return{appState:{...t,...n},captureUpdate:q.EVENTUALLY};let s;const r=i.scene.getSelectedElements(t);if(!ds(n.currentItemBackgroundColor)&&r.every(a=>cn(a)&&$H(a.points))){const a=we(r);s=e.map(l=>a.has(l.id)&&cn(l)?xe(l,{backgroundColor:n.currentItemBackgroundColor,...ST(l,!0)}):l)}else s=xs(e,t,a=>xe(a,{backgroundColor:n.currentItemBackgroundColor}));return{elements:s,appState:{...t,...n},captureUpdate:q.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{stylesPanelMode:r}=em(i);return P(fe,{children:[r==="full"&&g("h3",{"aria-hidden":"true",children:x("labels.background")}),g(LI,{topPicks:oz,palette:Gne,type:"elementBackground",label:x("labels.background"),color:As(e,i,o=>o.backgroundColor,!0,o=>o?null:t.currentItemBackgroundColor),onChange:o=>n({currentItemBackgroundColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeFillStyle",label:"labels.fill",trackEvent:!1,perform:(e,t,n,i)=>(at("element","changeFillStyle",`${n} (${i.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),{elements:xs(e,t,s=>xe(s,{fillStyle:n})),appState:{...t,currentItemFillStyle:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Ze(e,t),r=s.length>0&&s.every(o=>o.fillStyle==="zigzag");return P("fieldset",{children:[g("legend",{children:x("labels.fill")}),g("div",{className:"buttonList",children:g(La,{type:"button",options:[{value:"hachure",text:`${x(r?"labels.zigzag":"labels.hachure")} (${J("Alt-Click")})`,icon:r?pge:Uge,active:r?!0:void 0,testId:"fill-hachure"},{value:"cross-hatch",text:x("labels.crossHatch"),icon:bge,testId:"fill-cross-hatch"},{value:"solid",text:x("labels.solid"),icon:yge,testId:"fill-solid"}],value:As(e,i,o=>o.fillStyle,o=>o.hasOwnProperty("fillStyle"),o=>o?null:t.currentItemFillStyle),onClick:(o,a)=>{const l=a.altKey&&o==="hachure"&&s.every(c=>c.fillStyle==="hachure")?"zigzag":o;n(l)}})})]})}});ue({name:"changeStrokeWidth",label:"labels.strokeWidth",trackEvent:!1,perform:(e,t,n)=>({elements:xs(e,t,i=>xe(i,{strokeWidth:n})),appState:{...t,currentItemStrokeWidth:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>P("fieldset",{children:[g("legend",{children:x("labels.strokeWidth")}),g("div",{className:"buttonList",children:g(La,{group:"stroke-width",options:[{value:v3.thin,text:x("labels.thin"),icon:uG,testId:"strokeWidth-thin"},{value:v3.bold,text:x("labels.bold"),icon:Ege,testId:"strokeWidth-bold"},{value:v3.extraBold,text:x("labels.extraBold"),icon:vge,testId:"strokeWidth-extraBold"}],value:As(e,i,r=>r.strokeWidth,r=>r.hasOwnProperty("strokeWidth"),r=>r?null:t.currentItemStrokeWidth),onChange:r=>n(r)})})]})});ue({name:"changeSloppiness",label:"labels.sloppiness",trackEvent:!1,perform:(e,t,n)=>({elements:xs(e,t,i=>xe(i,{seed:to(),roughness:n})),appState:{...t,currentItemRoughness:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>P("fieldset",{children:[g("legend",{children:x("labels.sloppiness")}),g("div",{className:"buttonList",children:g(La,{group:"sloppiness",options:[{value:0,text:x("labels.architect"),icon:Tge},{value:1,text:x("labels.artist"),icon:Ige},{value:2,text:x("labels.cartoonist"),icon:Sge}],value:As(e,i,r=>r.roughness,r=>r.hasOwnProperty("roughness"),r=>r?null:t.currentItemRoughness),onChange:r=>n(r)})})]})});ue({name:"changeStrokeStyle",label:"labels.strokeStyle",trackEvent:!1,perform:(e,t,n)=>({elements:xs(e,t,i=>xe(i,{strokeStyle:n})),appState:{...t,currentItemStrokeStyle:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>P("fieldset",{children:[g("legend",{children:x("labels.strokeStyle")}),g("div",{className:"buttonList",children:g(La,{group:"strokeStyle",options:[{value:"solid",text:x("labels.strokeStyle_solid"),icon:uG},{value:"dashed",text:x("labels.strokeStyle_dashed"),icon:_ge},{value:"dotted",text:x("labels.strokeStyle_dotted"),icon:wge}],value:As(e,i,r=>r.strokeStyle,r=>r.hasOwnProperty("strokeStyle"),r=>r?null:t.currentItemStrokeStyle),onChange:r=>n(r)})})]})});ue({name:"changeOpacity",label:"labels.opacity",trackEvent:!1,perform:(e,t,n)=>({elements:xs(e,t,i=>xe(i,{opacity:n}),!0),appState:{...t,currentItemOpacity:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({app:e,updateData:t})=>g(Kye,{updateData:t,app:e,testId:"opacity"})});ue({name:"changeFontSize",label:"labels.fontSize",trackEvent:!1,perform:(e,t,n,i)=>OI(e,t,i,()=>(Ce(n,"actionChangeFontSize: Expected a font size value"),n),n),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{isCompact:r}=em(i);return P("fieldset",{children:[g("legend",{children:x("labels.fontSize")}),g("div",{className:"buttonList",children:g(La,{group:"font-size",options:[{value:lh.sm,text:x("labels.small"),icon:zge,testId:"fontSize-small"},{value:lh.md,text:x("labels.medium"),icon:Hge,testId:"fontSize-medium"},{value:lh.lg,text:x("labels.large"),icon:Vge,testId:"fontSize-large"},{value:lh.xl,text:x("labels.veryLarge"),icon:$ge,testId:"fontSize-veryLarge"}],value:As(e,i,o=>{if(he(o))return o.fontSize;const a=Ne(o,i.scene.getNonDeletedElementsMap());return a?a.fontSize:null},o=>he(o)||Ne(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:t.currentItemFontSize||$l),onChange:o=>{IE(()=>n(o),r,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})}});const aD=ue({name:"decreaseFontSize",label:"labels.decreaseFontSize",icon:lE,trackEvent:!1,perform:(e,t,n,i)=>OI(e,t,i,s=>Math.round(1/(1+Rj)*s.fontSize)),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&(e.key===$.CHEVRON_LEFT||e.key===$.COMMA)}),lD=ue({name:"increaseFontSize",label:"labels.increaseFontSize",icon:lE,trackEvent:!1,perform:(e,t,n,i)=>OI(e,t,i,s=>Math.round(s.fontSize*(1+Rj))),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&(e.key===$.CHEVRON_RIGHT||e.key===$.PERIOD)});ue({name:"changeFontFamily",label:"labels.fontFamily",trackEvent:!1,perform:(e,t,n,i)=>{var m;const{cachedElements:s,resetAll:r,resetContainers:o,...a}=n;if(r)return{elements:xs(e,t,U=>{const b=s==null?void 0:s.get(U.id);return b?xe(U,{...b}):U},!0),appState:{...t,...a},captureUpdate:q.NEVER};Ce(n,"actionChangeFontFamily: value must be defined");const{currentItemFontFamily:l,currentHoveredFontFamily:c}=n;let d=q.EVENTUALLY,u,f=!1;if(l)u=l,d=q.IMMEDIATELY;else if(c){u=c,d=q.EVENTUALLY;const p=Ze(e,t,{includeBoundTextElement:!0}).filter(U=>he(U));if(p.length>200)f=!0;else{let U=0,b=0;for(;U<p.length&&b<5e3;){const y=p[U];b+=(y==null?void 0:y.originalText.length)||0,U++}b>5e3&&(f=!0)}}const h={appState:{...t,...a},captureUpdate:d};if(u&&!f){const p=new Map;let U=new Set,b=!1;const y=Array.from(wl.loadedFontsCache.values()),E=(m=Object.entries(ct).find(([k,w])=>w===u))==null?void 0:m[0];c&&E&&y.some(k=>k.startsWith(E))&&(b=!0),Object.assign(h,{elements:xs(e,t,k=>{if(he(k)&&(k.fontFamily!==u||l)){const w=xe(k,{fontFamily:u,lineHeight:id(u)}),T=(s==null?void 0:s.get(k.containerId||""))||{},A=i.scene.getContainerElement(k);return o&&A&&T&&i.scene.mutateElement(A,{...T}),b||(U=new Set([...U,...Array.from(w.originalText)])),p.set(w,A),w}return k},!0)});const _=`10px ${Xp({fontFamily:u})}`,I=Array.from(U.values()).join();if(b||window.document.fonts.check(_,I))for(const[k,w]of p)fs(k,w,i.scene);else window.document.fonts.load(_,I).then(k=>{for(const[w,T]of p){const A=i.scene.getElement(w.id),S=T?i.scene.getElement(T.id):null;A&&fs(A,S,i.scene)}i.fonts.onLoaded(k)})}return h},PanelComponent:({elements:e,appState:t,app:n,updateData:i})=>{const s=C.useRef(new Map),r=C.useRef(null),[o,a]=C.useState({}),l=C.useRef(!0),{stylesPanelMode:c,isCompact:d}=em(n),u=C.useMemo(()=>{var h;const f=(m,p)=>As(m,n,U=>{if(he(U))return U.fontFamily;const b=Ne(U,p);return b?b.fontFamily:null},U=>he(U)||Ne(U,p)!==null,U=>U?null:t.currentItemFontFamily||Td);return o.openPopup==="fontFamily"&&t.openPopup==="fontFamily"?f(Array.from(((h=s.current)==null?void 0:h.values())??[]),s.current):!o.openPopup&&t.openPopup!=="fontFamily"?f(e,n.scene.getNonDeletedElementsMap()):r.current},[o.openPopup,t,e,n]);return C.useEffect(()=>{r.current=u},[u]),C.useEffect(()=>{Object.keys(o).length&&(i(o),a({}))},[o]),C.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),P(fe,{children:[c==="full"&&g("legend",{children:x("labels.fontFamily")}),g(jye,{isOpened:t.openPopup==="fontFamily",selectedFontFamily:u,hoveredFontFamily:t.currentHoveredFontFamily,compactMode:c!=="full",onSelect:f=>{IE(()=>{a({openPopup:null,currentHoveredFontFamily:null,currentItemFontFamily:f}),s.current.clear()},d,!!t.editingTextElement)},onHover:f=>{a({currentHoveredFontFamily:f,cachedElements:new Map(s.current),resetContainers:!0})},onLeave:()=>{a({currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0})},onPopupChange:f=>{if(f){s.current.clear();const{editingTextElement:h}=t;if((h==null?void 0:h.type)==="text"){const m=n.scene.getElement(h.id);s.current.set(h.id,xe(m||h,{},!0))}else{const m=Ze(e,t,{includeBoundTextElement:!0});for(const p of m)s.current.set(p.id,xe(p,{},!0))}a({...o,openPopup:"fontFamily"})}else{const h={currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0};a({...h}),s.current.clear(),d&&t.editingTextElement&&RI(null)}}})]})}});ue({name:"changeTextAlign",label:"Change text alignment",trackEvent:!1,perform:(e,t,n,i)=>({elements:xs(e,t,s=>{if(he(s)){const r=xe(s,{textAlign:n});return fs(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t,currentItemTextAlign:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const r=i.scene.getNonDeletedElementsMap(),{isCompact:o}=em(i);return P("fieldset",{children:[g("legend",{children:x("labels.textAlign")}),g("div",{className:"buttonList",children:g(La,{group:"text-align",options:[{value:"left",text:x("labels.left"),icon:Xge,testId:"align-left"},{value:"center",text:x("labels.center"),icon:jge,testId:"align-horizontal-center"},{value:"right",text:x("labels.right"),icon:Yge,testId:"align-right"}],value:As(e,i,a=>{if(he(a))return a.textAlign;const l=Ne(a,r);return l?l.textAlign:null},a=>he(a)||Ne(a,r)!==null,a=>a?null:t.currentItemTextAlign),onChange:a=>{IE(()=>n(a),o,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})}});ue({name:"changeVerticalAlign",label:"Change vertical alignment",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:xs(e,t,s=>{if(he(s)){const r=xe(s,{verticalAlign:n});return fs(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{isCompact:r}=em(i);return g("fieldset",{children:g("div",{className:"buttonList",children:g(La,{group:"text-align",options:[{value:lr.TOP,text:x("labels.alignTop"),icon:g(Wge,{theme:t.theme}),testId:"align-top"},{value:lr.MIDDLE,text:x("labels.centerVertically"),icon:g(Zge,{theme:t.theme}),testId:"align-middle"},{value:lr.BOTTOM,text:x("labels.alignBottom"),icon:g(Kge,{theme:t.theme}),testId:"align-bottom"}],value:As(e,i,o=>{if(he(o)&&o.containerId)return o.verticalAlign;const a=Ne(o,i.scene.getNonDeletedElementsMap());return a?a.verticalAlign:null},o=>he(o)||Ne(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:lr.MIDDLE),onChange:o=>{IE(()=>n(o),r,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})})}});ue({name:"changeRoundness",label:"Change edge roundness",trackEvent:!1,perform:(e,t,n)=>({elements:xs(e,t,i=>ve(i)?i:xe(i,{roundness:n==="round"?{type:of(i.type)?wn.ADAPTIVE_RADIUS:wn.PROPORTIONAL_RADIUS}:null})),appState:{...t,currentItemRoundness:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>{const o=Qy(qt(e),t).some(a=>{var l;return((l=a.roundness)==null?void 0:l.type)===wn.LEGACY});return P("fieldset",{children:[g("legend",{children:x("labels.edges")}),P("div",{className:"buttonList",children:[g(La,{group:"edges",options:[{value:"sharp",text:x("labels.sharp"),icon:Cge},{value:"round",text:x("labels.round"),icon:xge}],value:As(e,i,a=>o?null:a.roundness?"round":"sharp",a=>!Te(a)&&a.hasOwnProperty("roundness"),a=>a?null:t.currentItemRoundness),onChange:a=>n(a)}),s("togglePolygon")]})]})}});const cD=e=>[{value:null,text:x("labels.arrowhead_none"),keyBinding:"q",icon:Age},{value:"arrow",text:x("labels.arrowhead_arrow"),keyBinding:"w",icon:g(d_,{flip:e})},{value:"triangle",text:x("labels.arrowhead_triangle"),icon:g(Dge,{flip:e}),keyBinding:"e"},{value:"triangle_outline",text:x("labels.arrowhead_triangle_outline"),icon:g(Lge,{flip:e}),keyBinding:"r"},{value:"circle",text:x("labels.arrowhead_circle"),keyBinding:"a",icon:g(Mge,{flip:e})},{value:"circle_outline",text:x("labels.arrowhead_circle_outline"),keyBinding:"s",icon:g(kge,{flip:e})},{value:"diamond",text:x("labels.arrowhead_diamond"),icon:g(Pge,{flip:e}),keyBinding:"d"},{value:"diamond_outline",text:x("labels.arrowhead_diamond_outline"),icon:g(Nge,{flip:e}),keyBinding:"f"},{value:"bar",text:x("labels.arrowhead_bar"),keyBinding:"z",icon:g(Rge,{flip:e})},{value:"crowfoot_one",text:x("labels.arrowhead_crowfoot_one"),icon:g(Fge,{flip:e}),keyBinding:"x"},{value:"crowfoot_many",text:x("labels.arrowhead_crowfoot_many"),icon:g(Oge,{flip:e}),keyBinding:"c"},{value:"crowfoot_one_or_many",text:x("labels.arrowhead_crowfoot_one_or_many"),icon:g(Bge,{flip:e}),keyBinding:"v"}];ue({name:"changeArrowhead",label:"Change arrowheads",trackEvent:!1,perform:(e,t,n)=>(Ce(n,"actionChangeArrowhead: value must be defined"),{elements:xs(e,t,i=>{if(De(i)){const{position:s,type:r}=n;if(s==="start")return xe(i,{startArrowhead:r});if(s==="end")return xe(i,{endArrowhead:r})}return i}),appState:{...t,[n.position==="start"?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=W0().rtl;return P("fieldset",{children:[g("legend",{children:x("labels.arrowheads")}),P("div",{className:"iconSelectList buttonList",children:[g(oD,{label:"arrowhead_start",options:cD(!s),value:As(e,i,r=>De(r)&&l5(r.type)?r.startArrowhead:t.currentItemStartArrowhead,!0,t.currentItemStartArrowhead),onChange:r=>n({position:"start",type:r}),numberOfOptionsToAlwaysShow:4}),g(oD,{label:"arrowhead_end",group:"arrowheads",options:cD(!!s),value:As(e,i,r=>De(r)&&l5(r.type)?r.endArrowhead:t.currentItemEndArrowhead,!0,t.currentItemEndArrowhead),onChange:r=>n({position:"end",type:r}),numberOfOptionsToAlwaysShow:4})]})]})}});ue({name:"changeArrowProperties",label:"Change arrow properties",trackEvent:!1,perform:(e,t,n,i)=>!1,PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>P("div",{className:"selected-shape-actions",children:[s("changeArrowhead"),s("changeArrowType")]})});ue({name:"changeArrowType",label:"Change arrow types",trackEvent:!1,perform:(e,t,n,i)=>{var a;const s=xs(e,t,l=>{if(!Te(l))return l;const c=i.scene.getNonDeletedElementsMap(),d=ne.getPointAtIndexGlobalCoordinates(l,0,c),u=ne.getPointAtIndexGlobalCoordinates(l,-1,c);let f=xe(l,{x:n===zn.elbow?d[0]:l.x,y:n===zn.elbow?d[1]:l.y,roundness:n===zn.round?{type:wn.PROPORTIONAL_RADIUS}:null,elbowed:n===zn.elbow,angle:n===zn.elbow?0:l.angle,points:n===zn.elbow||l.elbowed?[ne.pointFromAbsoluteCoords({...l,x:d[0],y:d[1],angle:0},d,c),ne.pointFromAbsoluteCoords({...l,x:d[0],y:d[1],angle:0},u,c)]:l.points});if(ve(f)){f.fixedSegments=null;const h=i.scene.getNonDeletedElementsMap();i.dismissLinearEditor();const m=ne.getPointAtIndexGlobalCoordinates(f,0,h),p=ne.getPointAtIndexGlobalCoordinates(f,-1,h),U=f.startBinding&&h.get(f.startBinding.elementId),b=f.endBinding&&h.get(f.endBinding.elementId),y=U&&f.startBinding?{...f.startBinding,...F4(f,U,"start",h)}:null,E=b&&f.endBinding?{...f.endBinding,...F4(f,b,"end",h)}:null;f={...f,startBinding:y,endBinding:E,...Yg(f,h,{points:[m,p].map(_=>M(_[0]-f.x,_[1]-f.y)),startBinding:y,endBinding:E,fixedSegments:null})}}else{const h=i.scene.getNonDeletedElementsMap();if(f.startBinding){const m=h.get(f.startBinding.elementId);m&&Rl(f,m,t.bindMode==="inside"?"inside":"orbit","start",i.scene)}if(f.endBinding){const m=h.get(f.endBinding.elementId);m&&Rl(f,m,t.bindMode==="inside"?"inside":"orbit","end",i.scene)}}return f}),r={...t,currentItemArrowType:n},o=(a=t.selectedLinearElement)==null?void 0:a.elementId;if(o){const l=s.find(c=>c.id===o);l&&(r.selectedLinearElement=new ne(l,we(e)))}return{elements:s,appState:r,captureUpdate:q.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>P("fieldset",{children:[g("legend",{children:x("labels.arrowtypes")}),g("div",{className:"buttonList",children:g(La,{group:"arrowtypes",options:[{value:zn.sharp,text:x("labels.arrowtype_sharp"),icon:nI,testId:"sharp-arrow"},{value:zn.round,text:x("labels.arrowtype_round"),icon:sI,testId:"round-arrow"},{value:zn.elbow,text:x("labels.arrowtype_elbowed"),icon:iI,testId:"elbow-arrow"}],value:As(e,i,s=>Te(s)?s.elbowed?zn.elbow:s.roundness?zn.round:zn.sharp:null,s=>Te(s),s=>s?null:t.currentItemArrowType),onChange:s=>n(s)})})]})});const qye=A9.includes(devicePixelRatio)?devicePixelRatio:1,Aa=()=>({showWelcomeScreen:!1,theme:be.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:En.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:En.fillStyle,currentItemFontFamily:Td,currentItemFontSize:$l,currentItemOpacity:En.opacity,currentItemRoughness:En.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:En.strokeColor,currentItemRoundness:"round",currentItemArrowType:zn.round,currentItemStrokeStyle:En.strokeStyle,currentItemStrokeWidth:En.strokeWidth,currentItemTextAlign:$p,currentHoveredFontFamily:null,cursorButton:"up",activeEmbeddable:null,newElement:null,editingTextElement:null,editingGroupId:null,activeTool:{type:"selection",customType:null,locked:En.locked,fromSelection:!1,lastActiveTool:null},preferredSelectionTool:{type:"selection",initialized:!1},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:qye,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:N6,gridStep:pz,gridModeEnabled:!1,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:null,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},hoveredElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,stats:{open:!1,panels:uh.generalStats|uh.elementProperties},startBoundElement:null,suggestedBinding:null,frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:Je.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set,isCropping:!1,croppingElementId:null,searchMatches:null,lockedMultiSelections:{},activeLockedId:null,bindMode:"orbit"}),Qye=(e=>e)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemArrowType:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},currentHoveredFontFamily:{browser:!1,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},newElement:{browser:!1,export:!1,server:!1},editingTextElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},preferredSelectionTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},gridStep:{browser:!0,export:!0,server:!0},gridModeEnabled:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},hoveredElementIds:{browser:!1,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},stats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBinding:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1},isCropping:{browser:!1,export:!1,server:!1},croppingElementId:{browser:!1,export:!1,server:!1},searchMatches:{browser:!1,export:!1,server:!1},lockedMultiSelections:{browser:!0,export:!0,server:!0},activeLockedId:{browser:!1,export:!1,server:!1},bindMode:{browser:!0,export:!1,server:!1}}),FI=(e,t)=>{const n={};for(const i of Object.keys(e)){const s=Qye[i];if(s!=null&&s[t]){const r=e[i];n[i]=r}}return n},Dj=e=>FI(e,"browser"),Lj=e=>FI(e,"export"),Jye=e=>FI(e,"server"),Yo=({activeTool:e})=>e.type==="eraser",_g=({activeTool:e})=>e.type==="hand",s0=()=>{const e=document.querySelector(".excalidraw-tooltip");if(e)return e;const t=document.createElement("div");return document.body.appendChild(t),t.classList.add("excalidraw-tooltip"),t},Pj=(e,t,n="bottom")=>{const i=e.getBoundingClientRect(),s=window.innerWidth,r=window.innerHeight,o=5;let a=t.left+t.width/2-i.width/2;a<0?a=o:a+i.width>=s&&(a=s-i.width-o);let l;n==="bottom"?(l=t.top+t.height+o,l+i.height>=r&&(l=t.top-i.height-o)):(l=t.top-i.height-o,l<0&&(l=t.top+t.height+o)),Object.assign(e.style,{top:`${l}px`,left:`${a}px`})},eEe=(e,t,n,i)=>{t.classList.add("excalidraw-tooltip--visible"),t.style.minWidth=i?"50ch":"10ch",t.style.maxWidth=i?"50ch":"15ch",t.textContent=n;const s=e.getBoundingClientRect();Pj(t,s)},Nl=({children:e,label:t,long:n=!1,style:i,disabled:s})=>(C.useEffect(()=>()=>s0().classList.remove("excalidraw-tooltip--visible"),[]),s?null:g("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:r=>eEe(r.currentTarget,s0(),t,n),onPointerLeave:()=>s0().classList.remove("excalidraw-tooltip--visible"),style:i,children:e})),Nj='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',tEe='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',Oj='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',nEe=`data:${Ee.svg},${encodeURIComponent(`${Nj}${Oj}</svg>`)}`,iEe=`data:${Ee.svg},${encodeURIComponent(`${Nj}${tEe}${Oj}</svg>`)}`,oo=e=>{e&&(e.style.cursor="")},Bt=(e,t)=>{e&&(e.style.cursor=t)};let Bo,dD;const Fj=(e,t)=>{const i=()=>{const s=t===be.DARK;Bo=document.createElement("canvas"),Bo.theme=t,Bo.height=20,Bo.width=20;const r=Bo.getContext("2d");r.lineWidth=1,r.beginPath(),r.arc(Bo.width/2,Bo.height/2,5,0,2*Math.PI),r.fillStyle=s?"#000":"#fff",r.fill(),r.strokeStyle=s?"#fff":"#000",r.stroke(),dD=Bo.toDataURL(Ee.svg)};(!Bo||Bo.theme!==t)&&i(),Bt(e,`url(${dD}) ${20/2} ${20/2}, auto`)},Vo=(e,t)=>{if(e)if(t.activeTool.type==="selection")oo(e);else if(_g(t))e.style.cursor=Dt.GRAB;else if(Yo(t))Fj(e,t.theme);else if(t.activeTool.type==="laser"){const n=t.theme===be.LIGHT?nEe:iEe;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?t.activeTool.type!=="image"&&(e.style.cursor=Dt.AUTO):e.style.cursor=Dt.CROSSHAIR},su=({viewportX:e,viewportY:t,nextZoom:n},i)=>{const s=e-i.offsetLeft,r=t-i.offsetTop,o=i.zoom.value,a=i.scrollX+(s-s/o),l=i.scrollY+(r-r/o),c=-(s-s/n),d=-(r-r/n);return{scrollX:a+c,scrollY:l+d,zoom:{value:n}}};ue({name:"changeViewBackgroundColor",label:"labels.canvasBackground",trackEvent:!1,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.changeViewBackgroundColor&&!t.viewModeEnabled,perform:(e,t,n)=>({appState:{...t,...n},captureUpdate:n!=null&&n.viewBackgroundColor?q.IMMEDIATELY:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i,data:s})=>g(LI,{palette:null,topPicks:az,label:x("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:r=>n({viewBackgroundColor:r}),"data-testid":"canvas-background-picker",elements:e,appState:t,updateData:n})});const r0=ue({name:"clearCanvas",label:"labels.clearCanvas",icon:Ia,trackEvent:{category:"canvas"},predicate:(e,t,n,i)=>{var s;return!!i.props.UIOptions.canvasActions.clearCanvas&&!t.viewModeEnabled&&((s=t.openDialog)==null?void 0:s.name)!=="elementLinkSelector"},perform:(e,t,n,i)=>(i.imageCache.clear(),{elements:e.map(s=>xe(s,{isDeleted:!0})),appState:{...Aa(),files:{},theme:t.theme,penMode:t.penMode,penDetected:t.penDetected,exportBackground:t.exportBackground,exportEmbedScene:t.exportEmbedScene,gridSize:t.gridSize,gridStep:t.gridStep,gridModeEnabled:t.gridModeEnabled,stats:t.stats,pasteDialog:t.pasteDialog,activeTool:t.activeTool.type==="image"?{...t.activeTool,type:i.state.preferredSelectionTool.type}:t.activeTool},captureUpdate:q.IMMEDIATELY})}),uD=ue({name:"zoomIn",label:"buttons.zoomIn",viewMode:!0,icon:UR,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...su({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:ml(t.zoom.value+Ny)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(qe,{type:"button",className:"zoom-in-button zoom-button",icon:UR,title:`${x("buttons.zoomIn")}  ${J("CtrlOrCmd++")}`,"aria-label":x("buttons.zoomIn"),disabled:t.zoom.value>=x9,onClick:()=>{e(null)}}),keyTest:e=>(e.code===ut.EQUAL||e.code===ut.NUM_ADD)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),fD=ue({name:"zoomOut",label:"buttons.zoomOut",icon:bR,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...su({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:ml(t.zoom.value-Ny)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(qe,{type:"button",className:"zoom-out-button zoom-button",icon:bR,title:`${x("buttons.zoomOut")}  ${J("CtrlOrCmd+-")}`,"aria-label":x("buttons.zoomOut"),disabled:t.zoom.value<=C9,onClick:()=>{e(null)}}),keyTest:e=>(e.code===ut.MINUS||e.code===ut.NUM_SUBTRACT)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),hD=ue({name:"resetZoom",label:"buttons.resetZoom",icon:Jhe,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...su({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:ml(1)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(Nl,{label:x("buttons.resetZoom"),style:{height:"100%"},children:P(qe,{type:"button",className:"reset-zoom-button zoom-button",title:x("buttons.resetZoom"),"aria-label":x("buttons.resetZoom"),onClick:()=>{e(null)},children:[(t.zoom.value*100).toFixed(0),"%"]})}),keyTest:e=>(e.code===ut.ZERO||e.code===ut.NUM_ZERO)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),sEe=(e,t,n=1)=>{const[i,s,r,o]=e,a=r-i,l=t.width/a,c=o-s,d=t.height/c,f=Math.min(l,d)*Ke(n,.1,1);return Math.min(f,1)},Bj=({bounds:e,appState:t,canvasOffsets:n,fitToViewport:i=!1,viewportZoomFactor:s=1,minZoom:r=-1/0,maxZoom:o=1/0})=>{s=Ke(s,C9,x9);const[a,l,c,d]=e,u=(a+c)/2,f=(l+d)/2,h=(n==null?void 0:n.left)??0,m=(n==null?void 0:n.top)??0,p=(n==null?void 0:n.right)??0,U=(n==null?void 0:n.bottom)??0,b=t.width-h-p,y=t.height-m-U;let E;if(i){const k=c-a,w=d-l;E=Math.min(b/k,y/w)*s}else E=sEe(e,{width:b,height:y},s);const _=ml(Ke(vne(E,Ny,"floor"),r,o)),I=J$({scenePoint:{x:u,y:f},viewportDimensions:{width:t.width,height:t.height},offsets:n,zoom:{value:_}});return{appState:{...t,scrollX:I.scrollX,scrollY:I.scrollY,zoom:{value:_}},captureUpdate:q.EVENTUALLY}},AE=({canvasOffsets:e,targetElements:t,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})=>{const a=Et(qt(t));return Bj({canvasOffsets:e,bounds:a,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})};ue({name:"zoomToFitSelectionInViewport",label:"labels.zoomToFitViewport",icon:tI,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return AE({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===ut.TWO&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});ue({name:"zoomToFitSelection",label:"helpDialog.zoomToSelection",icon:tI,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return AE({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!0,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===ut.THREE&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});ue({name:"zoomToFit",label:"helpDialog.zoomToFit",icon:tI,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>AE({targetElements:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()}),keyTest:e=>e.code===ut.ONE&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});const T5=ue({name:"toggleTheme",label:(e,t)=>t.theme===be.DARK?"buttons.lightMode":"buttons.darkMode",keywords:["toggle","dark","light","mode","theme"],icon:(e,t)=>e.theme===be.LIGHT?l_:c_,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n)=>({appState:{...t,theme:n||(t.theme===be.LIGHT?be.DARK:be.LIGHT)},captureUpdate:q.EVENTUALLY}),keyTest:e=>e.altKey&&e.shiftKey&&e.code===ut.D,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.toggleTheme});ue({name:"toggleEraserTool",label:"toolBar.eraser",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let s;return Yo(t)?s=sn(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):s=sn(t,{type:"eraser",lastActiveToolBeforeEraser:t.activeTool}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e.key===$.E});ue({name:"toggleLassoTool",label:"toolBar.lasso",icon:i0,trackEvent:{category:"toolbar"},predicate:(e,t,n,i)=>i.state.preferredSelectionTool.type!=="lasso",perform:(e,t,n,i)=>{let s;return t.activeTool.type!=="lasso"?(s=sn(t,{type:"lasso",fromSelection:!1}),Bt(i.interactiveCanvas,Dt.CROSSHAIR)):s=sn(t,{type:"selection"}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.NEVER}}});const rEe=ue({name:"toggleHandTool",label:"toolBar.hand",trackEvent:{category:"toolbar"},icon:mG,viewMode:!1,perform:(e,t,n,i)=>{let s;return _g(t)?s=sn(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(s=sn(t,{type:"hand",lastActiveToolBeforeEraser:t.activeTool}),Bt(i.interactiveCanvas,Dt.GRAB)),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.IMMEDIATELY}},keyTest:e=>!e.altKey&&!e[$.CTRL_OR_CMD]&&e.key===$.H});ue({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},target:"Tool",label:"toolBar.embeddable",perform:(e,t,n,i)=>{const s=sn(t,{type:"embeddable"});return Vo(i.canvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:sn(t,{type:"embeddable"})},captureUpdate:q.EVENTUALLY}}});const qs=ue({name:"finalize",label:"",trackEvent:!1,perform:(e,t,n,i)=>{var f,h,m;let s=e;const{interactiveCanvas:r,focusContainer:o,scene:a}=i,l=a.getNonDeletedElementsMap();if(n&&t.selectedLinearElement){const{event:p,sceneCoords:U}=n,b=ne.getElement(t.selectedLinearElement.elementId,l);Ce(b,"Arrow element should exist if selectedLinearElement is set"),Ce(U,"sceneCoords should be defined if actionFinalize is called with event");const y=ne.handlePointerUp(p,t.selectedLinearElement,t,i.scene);if(ln(b)&&!t.selectedLinearElement.segmentMidPointHoveredCoords){const E=!!t.newElement,I=(E||!t.selectedLinearElement.selectedPointsIndices?[b.points.length-1]:t.selectedLinearElement.selectedPointsIndices).reduce((k,w)=>(k.set(w,{point:ne.pointFromAbsoluteCoords(b,M(U.x-y.pointerOffset.x,U.y-y.pointerOffset.y),l)}),k),new Map)??new Map;gT(b,I,U.x-y.pointerOffset.x,U.y-y.pointerOffset.y,a,t,{newArrow:E,altKey:p.altKey,angleLocked:bc(p)})}else cn(b)&&(f=t.selectedLinearElement)!=null&&f.isEditing&&!t.newElement&&!N4(b.points)&&a.mutateElement(b,{polygon:!1});if(y!==t.selectedLinearElement){b&&_l(b)&&(s=s.map(_=>_.id===b.id?xe(_,{isDeleted:!0}):_));const E=(h=t.activeTool)==null?void 0:h.locked;return{elements:b.points.length<2||_l(b)?e.map(_=>_.id===b.id?xe(_,{isDeleted:!0}):_):s,appState:{...t,cursorButton:"up",selectedLinearElement:E?null:{...y,selectedPointsIndices:null,isEditing:!1,initialState:{...y.initialState,lastClickedPoint:-1},pointerOffset:{x:0,y:0}},selectionElement:null,suggestedBinding:null,newElement:null,multiElement:null},captureUpdate:q.IMMEDIATELY}}}window.document.activeElement instanceof HTMLElement&&o();let c=null;if(t.multiElement)c=t.multiElement;else if(((m=t.newElement)==null?void 0:m.type)==="freedraw"||ln(t.newElement))c=t.newElement;else if(Object.keys(t.selectedElementIds).length===1){const p=l.get(Object.keys(t.selectedElementIds)[0]);p&&(c=p)}if(c){if(t.selectedLinearElement&&t.multiElement&&c.type!=="freedraw"&&t.lastPointerDownWith!=="touch"){const{points:p}=c,{lastCommittedPoint:U}=t.selectedLinearElement;(!U||p[p.length-1]!==U)&&a.mutateElement(c,{points:c.points.slice(0,-1)})}if(c&&_l(c)&&(s=s.map(p=>p.id===(c==null?void 0:c.id)?xe(p,{isDeleted:!0}):p)),De(c)||us(c)){if(Ea(c.points,t.zoom.value)&&(cn(c)||us(c))){const U=c.points,b=U[0],y=U.map((E,_)=>_===U.length-1?M(b[0],b[1]):E);cn(c)?a.mutateElement(c,{points:y,polygon:!0}):a.mutateElement(c,{points:y})}cn(c)&&!N4(c.points)&&a.mutateElement(c,{polygon:!1})}}(!t.activeTool.locked&&t.activeTool.type!=="freedraw"||!c)&&oo(r);let d;t.activeTool.type==="eraser"?d=sn(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):d=sn(t,{type:i.state.preferredSelectionTool.type});let u=c&&De(c)?new ne(c,we(s)):t.selectedLinearElement;return u=u&&{...u,isEditing:t.newElement?!1:u.isEditing,initialState:{...u.initialState,lastClickedPoint:-1,origin:null}},{elements:s,appState:{...t,cursorButton:"up",activeTool:(t.activeTool.locked||t.activeTool.type==="freedraw")&&c?t.activeTool:d,activeEmbeddable:null,newElement:null,selectionElement:null,multiElement:null,editingTextElement:null,startBoundElement:null,suggestedBinding:null,selectedElementIds:c&&!t.activeTool.locked&&t.activeTool.type!=="freedraw"?{...t.selectedElementIds,[c.id]:!0}:t.selectedElementIds,selectedLinearElement:u},captureUpdate:q.IMMEDIATELY}},keyTest:(e,t)=>{var n;return e.key===$.ESCAPE&&(((n=t.selectedLinearElement)==null?void 0:n.isEditing)||!t.newElement&&t.multiElement===null)||(e.key===$.ESCAPE||e.key===$.ENTER)&&t.multiElement!==null},PanelComponent:({appState:e,updateData:t,data:n})=>g(qe,{type:"button",icon:oge,title:x("buttons.done"),"aria-label":x("buttons.done"),onClick:t,visible:e.multiElement!=null,size:(n==null?void 0:n.size)||"medium",style:{pointerEvents:"all"}})}),BI=({children:e,checked:t,onChange:n,className:i})=>P("div",{className:ae("Checkbox",i,{"is-checked":t}),onClick:s=>{n(!t,s),s.currentTarget.querySelector(".Checkbox-box").focus()},children:[g("button",{type:"button",className:"Checkbox-box",role:"checkbox","aria-checked":t,children:aG}),g("div",{className:"Checkbox-label",children:e})]}),oEe=e=>{const t=e.title||(e.value===be.DARK?x("buttons.lightMode"):x("buttons.darkMode"));return g(qe,{type:"icon",icon:e.value===be.LIGHT?gD.MOON:gD.SUN,title:t,"aria-label":t,onClick:()=>e.onChange(e.value===be.DARK?be.LIGHT:be.DARK),"data-testid":"toggle-dark-mode"})},gD={SUN:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})},aEe=e=>{const{id:t}=Ws(),[n,i]=C.useState(e.value),s=o=>{e.ignoreFocus||qie(o.target);const a=o.target.value;a!==e.value&&e.onChange(a)},r=o=>{if(o.key===$.ENTER){if(o.preventDefault(),o.nativeEvent.isComposing||o.keyCode===229)return;o.currentTarget.blur()}};return P("div",{className:"ProjectName",children:[g("label",{className:"ProjectName-label",htmlFor:"filename",children:`${e.label}:`}),g("input",{type:"text",className:"TextInput",onBlur:s,onKeyDown:r,id:`${t}-filename`,value:n,onChange:o=>i(o.target.value)})]})};/*! pako 2.0.3 https://github.com/nodeca/pako @license (MIT AND Zlib) */const lEe=4,mD=0,pD=1,cEe=2;function tm(e){let t=e.length;for(;--t>=0;)e[t]=0}const dEe=0,zj=1,uEe=2,fEe=3,hEe=258,zI=29,v2=256,np=v2+1+zI,Hh=30,HI=19,Hj=2*np+1,ru=15,u7=16,gEe=7,VI=256,Vj=16,$j=17,Gj=18,I_=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Pb=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),mEe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Xj=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pEe=512,Qa=new Array((np+2)*2);tm(Qa);const o0=new Array(Hh*2);tm(o0);const ip=new Array(pEe);tm(ip);const sp=new Array(hEe-fEe+1);tm(sp);const $I=new Array(zI);tm($I);const I5=new Array(Hh);tm(I5);function f7(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let jj,Yj,Wj;function h7(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Kj=e=>e<256?ip[e]:ip[256+(e>>>7)],rp=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},zs=(e,t,n)=>{e.bi_valid>u7-n?(e.bi_buf|=t<<e.bi_valid&65535,rp(e,e.bi_buf),e.bi_buf=t>>u7-e.bi_valid,e.bi_valid+=n-u7):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},ea=(e,t,n)=>{zs(e,n[t*2],n[t*2+1])},Zj=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},UEe=e=>{e.bi_valid===16?(rp(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},bEe=(e,t)=>{const n=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,f,h,m,p=0;for(f=0;f<=ru;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<Hj;c++)d=e.heap[c],f=n[n[d*2+1]*2+1]+1,f>l&&(f=l,p++),n[d*2+1]=f,!(d>i)&&(e.bl_count[f]++,h=0,d>=a&&(h=o[d-a]),m=n[d*2],e.opt_len+=m*(f+h),r&&(e.static_len+=m*(s[d*2+1]+h)));if(p!==0){do{for(f=l-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(f=l;f!==0;f--)for(d=e.bl_count[f];d!==0;)u=e.heap[--c],!(u>i)&&(n[u*2+1]!==f&&(e.opt_len+=(f-n[u*2+1])*n[u*2],n[u*2+1]=f),d--)}},qj=(e,t,n)=>{const i=new Array(ru+1);let s=0,r,o;for(r=1;r<=ru;r++)i[r]=s=s+n[r-1]<<1;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=Zj(i[a]++,a))}},yEe=()=>{let e,t,n,i,s;const r=new Array(ru+1);for(n=0,i=0;i<zI-1;i++)for($I[i]=n,e=0;e<1<<I_[i];e++)sp[n++]=i;for(sp[n-1]=i,s=0,i=0;i<16;i++)for(I5[i]=s,e=0;e<1<<Pb[i];e++)ip[s++]=i;for(s>>=7;i<Hh;i++)for(I5[i]=s<<7,e=0;e<1<<Pb[i]-7;e++)ip[256+s++]=i;for(t=0;t<=ru;t++)r[t]=0;for(e=0;e<=143;)Qa[e*2+1]=8,e++,r[8]++;for(;e<=255;)Qa[e*2+1]=9,e++,r[9]++;for(;e<=279;)Qa[e*2+1]=7,e++,r[7]++;for(;e<=287;)Qa[e*2+1]=8,e++,r[8]++;for(qj(Qa,np+1,r),e=0;e<Hh;e++)o0[e*2+1]=5,o0[e*2]=Zj(e,5);jj=new f7(Qa,I_,v2+1,np,ru),Yj=new f7(o0,Pb,0,Hh,ru),Wj=new f7(new Array(0),mEe,0,HI,gEe)},Qj=e=>{let t;for(t=0;t<np;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Hh;t++)e.dyn_dtree[t*2]=0;for(t=0;t<HI;t++)e.bl_tree[t*2]=0;e.dyn_ltree[VI*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Jj=e=>{e.bi_valid>8?rp(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},EEe=(e,t,n,i)=>{Jj(e),rp(e,n),rp(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},UD=(e,t,n,i)=>{const s=t*2,r=n*2;return e[s]<e[r]||e[s]===e[r]&&i[t]<=i[n]},g7=(e,t,n)=>{const i=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&UD(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!UD(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i},bD=(e,t,n)=>{let i,s,r=0,o,a;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+r*2]<<8|e.pending_buf[e.d_buf+r*2+1],s=e.pending_buf[e.l_buf+r],r++,i===0?ea(e,s,t):(o=sp[s],ea(e,o+v2+1,t),a=I_[o],a!==0&&(s-=$I[o],zs(e,s,a)),i--,o=Kj(i),ea(e,o,n),a=Pb[o],a!==0&&(i-=I5[o],zs(e,i,a)));while(r<e.last_lit);ea(e,VI,t)},S_=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l=-1,c;for(e.heap_len=0,e.heap_max=Hj,o=0;o<r;o++)n[o*2]!==0?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=i[c*2+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)g7(e,n,o);c=r;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],g7(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[c*2]=n[o*2]+n[a*2],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[o*2+1]=n[a*2+1]=c,e.heap[1]=c++,g7(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],bEe(e,t),qj(n,l,e.bl_count)},yD=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)&&(a<c?e.bl_tree[r*2]+=a:r!==0?(r!==s&&e.bl_tree[r*2]++,e.bl_tree[Vj*2]++):a<=10?e.bl_tree[$j*2]++:e.bl_tree[Gj*2]++,a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},ED=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)){if(a<c)do ea(e,r,e.bl_tree);while(--a!==0);else r!==0?(r!==s&&(ea(e,r,e.bl_tree),a--),ea(e,Vj,e.bl_tree),zs(e,a-3,2)):a<=10?(ea(e,$j,e.bl_tree),zs(e,a-3,3)):(ea(e,Gj,e.bl_tree),zs(e,a-11,7));a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}},vEe=e=>{let t;for(yD(e,e.dyn_ltree,e.l_desc.max_code),yD(e,e.dyn_dtree,e.d_desc.max_code),S_(e,e.bl_desc),t=HI-1;t>=3&&e.bl_tree[Xj[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},_Ee=(e,t,n,i)=>{let s;for(zs(e,t-257,5),zs(e,n-1,5),zs(e,i-4,4),s=0;s<i;s++)zs(e,e.bl_tree[Xj[s]*2+1],3);ED(e,e.dyn_ltree,t-1),ED(e,e.dyn_dtree,n-1)},wEe=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return mD;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return pD;for(n=32;n<v2;n++)if(e.dyn_ltree[n*2]!==0)return pD;return mD};let vD=!1;const TEe=e=>{vD||(yEe(),vD=!0),e.l_desc=new h7(e.dyn_ltree,jj),e.d_desc=new h7(e.dyn_dtree,Yj),e.bl_desc=new h7(e.bl_tree,Wj),e.bi_buf=0,e.bi_valid=0,Qj(e)},eY=(e,t,n,i)=>{zs(e,(dEe<<1)+(i?1:0),3),EEe(e,t,n)},IEe=e=>{zs(e,zj<<1,3),ea(e,VI,Qa),UEe(e)},SEe=(e,t,n,i)=>{let s,r,o=0;e.level>0?(e.strm.data_type===cEe&&(e.strm.data_type=wEe(e)),S_(e,e.l_desc),S_(e,e.d_desc),o=vEe(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=n+5,n+4<=s&&t!==-1?eY(e,t,n,i):e.strategy===lEe||r===s?(zs(e,(zj<<1)+(i?1:0),3),bD(e,Qa,o0)):(zs(e,(uEe<<1)+(i?1:0),3),_Ee(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),bD(e,e.dyn_ltree,e.dyn_dtree)),Qj(e),i&&Jj(e)},CEe=(e,t,n)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(sp[n]+v2+1)*2]++,e.dyn_dtree[Kj(t)*2]++),e.last_lit===e.lit_bufsize-1);var xEe=TEe,AEe=eY,MEe=SEe,kEe=CEe,REe=IEe,DEe={_tr_init:xEe,_tr_stored_block:AEe,_tr_flush_block:MEe,_tr_tally:kEe,_tr_align:REe};const LEe=(e,t,n,i)=>{let s=e&65535|0,r=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do s=s+t[i++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0};var op=LEe;const PEe=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},NEe=new Uint32Array(PEe()),OEe=(e,t,n,i)=>{const s=NEe,r=i+n;e^=-1;for(let o=i;o<r;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var Ti=OEe,Hu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ME={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:FEe,_tr_stored_block:BEe,_tr_flush_block:zEe,_tr_tally:Vc,_tr_align:HEe}=DEe,{Z_NO_FLUSH:hf,Z_PARTIAL_FLUSH:VEe,Z_FULL_FLUSH:$Ee,Z_FINISH:$c,Z_BLOCK:_D,Z_OK:ta,Z_STREAM_END:wD,Z_STREAM_ERROR:qr,Z_DATA_ERROR:GEe,Z_BUF_ERROR:m7,Z_DEFAULT_COMPRESSION:XEe,Z_FILTERED:jEe,Z_HUFFMAN_ONLY:zU,Z_RLE:YEe,Z_FIXED:WEe,Z_DEFAULT_STRATEGY:KEe,Z_UNKNOWN:ZEe,Z_DEFLATED:kE}=ME,qEe=9,QEe=15,JEe=8,e8e=29,t8e=256,C_=t8e+1+e8e,n8e=30,i8e=19,s8e=2*C_+1,r8e=15,pt=3,Sc=258,Co=Sc+pt+1,o8e=32,RE=42,x_=69,Nb=73,Ob=91,Fb=103,ou=113,b1=666,gi=1,_2=2,Vu=3,nm=4,a8e=3,Cc=(e,t)=>(e.msg=Hu[t],t),TD=e=>(e<<1)-(e>4?9:0),Ec=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let l8e=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,Gc=l8e;const rc=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},ji=(e,t)=>{zEe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,rc(e.strm)},kt=(e,t)=>{e.pending_buf[e.pending++]=t},Gm=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},c8e=(e,t,n,i)=>{let s=e.avail_in;return s>i&&(s=i),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),e.state.wrap===1?e.adler=op(e.adler,t,s,n):e.state.wrap===2&&(e.adler=Ti(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},tY=(e,t)=>{let n=e.max_chain_length,i=e.strstart,s,r,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-Co?e.strstart-(e.w_size-Co):0,c=e.window,d=e.w_mask,u=e.prev,f=e.strstart+Sc;let h=c[i+o-1],m=c[i+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(s=t,!(c[s+o]!==m||c[s+o-1]!==h||c[s]!==c[i]||c[++s]!==c[i+1])){i+=2,s++;do;while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<f);if(r=Sc-(f-i),i=f-Sc,r>o){if(e.match_start=t,o=r,r>=a)break;h=c[i+o-1],m=c[i+o]}}while((t=u[t&d])>l&&--n!==0);return o<=e.lookahead?o:e.lookahead},$u=e=>{const t=e.w_size;let n,i,s,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Co)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do s=e.head[--n],e.head[n]=s>=t?s-t:0;while(--i);i=t,n=i;do s=e.prev[--n],e.prev[n]=s>=t?s-t:0;while(--i);r+=t}if(e.strm.avail_in===0)break;if(i=c8e(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=pt)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Gc(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Gc(e,e.ins_h,e.window[o+pt-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<pt)););}while(e.lookahead<Co&&e.strm.avail_in!==0)},d8e=(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if($u(e),e.lookahead===0&&t===hf)return gi;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,ji(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Co&&(ji(e,!1),e.strm.avail_out===0))return gi}return e.insert=0,t===$c?(ji(e,!0),e.strm.avail_out===0?Vu:nm):(e.strstart>e.block_start&&(ji(e,!1),e.strm.avail_out===0),gi)},p7=(e,t)=>{let n,i;for(;;){if(e.lookahead<Co){if($u(e),e.lookahead<Co&&t===hf)return gi;if(e.lookahead===0)break}if(n=0,e.lookahead>=pt&&(e.ins_h=Gc(e,e.ins_h,e.window[e.strstart+pt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Co&&(e.match_length=tY(e,n)),e.match_length>=pt)if(i=Vc(e,e.strstart-e.match_start,e.match_length-pt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=pt){e.match_length--;do e.strstart++,e.ins_h=Gc(e,e.ins_h,e.window[e.strstart+pt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Gc(e,e.ins_h,e.window[e.strstart+1]);else i=Vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ji(e,!1),e.strm.avail_out===0))return gi}return e.insert=e.strstart<pt-1?e.strstart:pt-1,t===$c?(ji(e,!0),e.strm.avail_out===0?Vu:nm):e.last_lit&&(ji(e,!1),e.strm.avail_out===0)?gi:_2},Rf=(e,t)=>{let n,i,s;for(;;){if(e.lookahead<Co){if($u(e),e.lookahead<Co&&t===hf)return gi;if(e.lookahead===0)break}if(n=0,e.lookahead>=pt&&(e.ins_h=Gc(e,e.ins_h,e.window[e.strstart+pt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=pt-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Co&&(e.match_length=tY(e,n),e.match_length<=5&&(e.strategy===jEe||e.match_length===pt&&e.strstart-e.match_start>4096)&&(e.match_length=pt-1)),e.prev_length>=pt&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-pt,i=Vc(e,e.strstart-1-e.prev_match,e.prev_length-pt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=Gc(e,e.ins_h,e.window[e.strstart+pt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=pt-1,e.strstart++,i&&(ji(e,!1),e.strm.avail_out===0))return gi}else if(e.match_available){if(i=Vc(e,0,e.window[e.strstart-1]),i&&ji(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return gi}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Vc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<pt-1?e.strstart:pt-1,t===$c?(ji(e,!0),e.strm.avail_out===0?Vu:nm):e.last_lit&&(ji(e,!1),e.strm.avail_out===0)?gi:_2},u8e=(e,t)=>{let n,i,s,r;const o=e.window;for(;;){if(e.lookahead<=Sc){if($u(e),e.lookahead<=Sc&&t===hf)return gi;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=pt&&e.strstart>0&&(s=e.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){r=e.strstart+Sc;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<r);e.match_length=Sc-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=pt?(n=Vc(e,1,e.match_length-pt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ji(e,!1),e.strm.avail_out===0))return gi}return e.insert=0,t===$c?(ji(e,!0),e.strm.avail_out===0?Vu:nm):e.last_lit&&(ji(e,!1),e.strm.avail_out===0)?gi:_2},f8e=(e,t)=>{let n;for(;;){if(e.lookahead===0&&($u(e),e.lookahead===0)){if(t===hf)return gi;break}if(e.match_length=0,n=Vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ji(e,!1),e.strm.avail_out===0))return gi}return e.insert=0,t===$c?(ji(e,!0),e.strm.avail_out===0?Vu:nm):e.last_lit&&(ji(e,!1),e.strm.avail_out===0)?gi:_2};function zo(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}const y1=[new zo(0,0,0,0,d8e),new zo(4,4,8,4,p7),new zo(4,5,16,8,p7),new zo(4,6,32,32,p7),new zo(4,4,16,16,Rf),new zo(8,16,32,32,Rf),new zo(8,16,128,128,Rf),new zo(8,32,128,256,Rf),new zo(32,128,258,1024,Rf),new zo(32,258,258,4096,Rf)],h8e=e=>{e.window_size=2*e.w_size,Ec(e.head),e.max_lazy_match=y1[e.level].max_lazy,e.good_match=y1[e.level].good_length,e.nice_match=y1[e.level].nice_length,e.max_chain_length=y1[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=pt-1,e.match_available=0,e.ins_h=0};function g8e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=kE,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(s8e*2),this.dyn_dtree=new Uint16Array((2*n8e+1)*2),this.bl_tree=new Uint16Array((2*i8e+1)*2),Ec(this.dyn_ltree),Ec(this.dyn_dtree),Ec(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(r8e+1),this.heap=new Uint16Array(2*C_+1),Ec(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*C_+1),Ec(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const nY=e=>{if(!e||!e.state)return Cc(e,qr);e.total_in=e.total_out=0,e.data_type=ZEe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?RE:ou,e.adler=t.wrap===2?0:1,t.last_flush=hf,FEe(t),ta},iY=e=>{const t=nY(e);return t===ta&&h8e(e.state),t},m8e=(e,t)=>!e||!e.state||e.state.wrap!==2?qr:(e.state.gzhead=t,ta),sY=(e,t,n,i,s,r)=>{if(!e)return qr;let o=1;if(t===XEe&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>qEe||n!==kE||i<8||i>15||t<0||t>9||r<0||r>WEe)return Cc(e,qr);i===8&&(i=9);const a=new g8e;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+pt-1)/pt),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=r,a.method=n,iY(e)},p8e=(e,t)=>sY(e,t,kE,QEe,JEe,KEe),U8e=(e,t)=>{let n,i;if(!e||!e.state||t>_D||t<0)return e?Cc(e,qr):qr;const s=e.state;if(!e.output||!e.input&&e.avail_in!==0||s.status===b1&&t!==$c)return Cc(e,e.avail_out===0?m7:qr);s.strm=e;const r=s.last_flush;if(s.last_flush=t,s.status===RE)if(s.wrap===2)e.adler=0,kt(s,31),kt(s,139),kt(s,8),s.gzhead?(kt(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),kt(s,s.gzhead.time&255),kt(s,s.gzhead.time>>8&255),kt(s,s.gzhead.time>>16&255),kt(s,s.gzhead.time>>24&255),kt(s,s.level===9?2:s.strategy>=zU||s.level<2?4:0),kt(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(kt(s,s.gzhead.extra.length&255),kt(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=Ti(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=x_):(kt(s,0),kt(s,0),kt(s,0),kt(s,0),kt(s,0),kt(s,s.level===9?2:s.strategy>=zU||s.level<2?4:0),kt(s,a8e),s.status=ou);else{let o=kE+(s.w_bits-8<<4)<<8,a=-1;s.strategy>=zU||s.level<2?a=0:s.level<6?a=1:s.level===6?a=2:a=3,o|=a<<6,s.strstart!==0&&(o|=o8e),o+=31-o%31,s.status=ou,Gm(s,o),s.strstart!==0&&(Gm(s,e.adler>>>16),Gm(s,e.adler&65535)),e.adler=1}if(s.status===x_)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),rc(e),n=s.pending,s.pending===s.pending_buf_size));)kt(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=Nb)}else s.status=Nb;if(s.status===Nb)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),rc(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.name.length?i=s.gzhead.name.charCodeAt(s.gzindex++)&255:i=0,kt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.gzindex=0,s.status=Ob)}else s.status=Ob;if(s.status===Ob)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),rc(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.comment.length?i=s.gzhead.comment.charCodeAt(s.gzindex++)&255:i=0,kt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=Ti(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.status=Fb)}else s.status=Fb;if(s.status===Fb&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&rc(e),s.pending+2<=s.pending_buf_size&&(kt(s,e.adler&255),kt(s,e.adler>>8&255),e.adler=0,s.status=ou)):s.status=ou),s.pending!==0){if(rc(e),e.avail_out===0)return s.last_flush=-1,ta}else if(e.avail_in===0&&TD(t)<=TD(r)&&t!==$c)return Cc(e,m7);if(s.status===b1&&e.avail_in!==0)return Cc(e,m7);if(e.avail_in!==0||s.lookahead!==0||t!==hf&&s.status!==b1){let o=s.strategy===zU?f8e(s,t):s.strategy===YEe?u8e(s,t):y1[s.level].func(s,t);if((o===Vu||o===nm)&&(s.status=b1),o===gi||o===Vu)return e.avail_out===0&&(s.last_flush=-1),ta;if(o===_2&&(t===VEe?HEe(s):t!==_D&&(BEe(s,0,0,!1),t===$Ee&&(Ec(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),rc(e),e.avail_out===0))return s.last_flush=-1,ta}return t!==$c?ta:s.wrap<=0?wD:(s.wrap===2?(kt(s,e.adler&255),kt(s,e.adler>>8&255),kt(s,e.adler>>16&255),kt(s,e.adler>>24&255),kt(s,e.total_in&255),kt(s,e.total_in>>8&255),kt(s,e.total_in>>16&255),kt(s,e.total_in>>24&255)):(Gm(s,e.adler>>>16),Gm(s,e.adler&65535)),rc(e),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?ta:wD)},b8e=e=>{if(!e||!e.state)return qr;const t=e.state.status;return t!==RE&&t!==x_&&t!==Nb&&t!==Ob&&t!==Fb&&t!==ou&&t!==b1?Cc(e,qr):(e.state=null,t===ou?Cc(e,GEe):ta)},y8e=(e,t)=>{let n=t.length;if(!e||!e.state)return qr;const i=e.state,s=i.wrap;if(s===2||s===1&&i.status!==RE||i.lookahead)return qr;if(s===1&&(e.adler=op(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){s===0&&(Ec(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(t.subarray(n-i.w_size,n),0),t=l,n=i.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,$u(i);i.lookahead>=pt;){let l=i.strstart,c=i.lookahead-(pt-1);do i.ins_h=Gc(i,i.ins_h,i.window[l+pt-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=pt-1,$u(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=pt-1,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,i.wrap=s,ta};var E8e=p8e,v8e=sY,_8e=iY,w8e=nY,T8e=m8e,I8e=U8e,S8e=b8e,C8e=y8e,x8e="pako deflate (from Nodeca project)",a0={deflateInit:E8e,deflateInit2:v8e,deflateReset:_8e,deflateResetKeep:w8e,deflateSetHeader:T8e,deflate:I8e,deflateEnd:S8e,deflateSetDictionary:C8e,deflateInfo:x8e};const A8e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var M8e=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)A8e(n,i)&&(e[i]=n[i])}}return e},k8e=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,s=0,r=e.length;i<r;i++){let o=e[i];n.set(o,s),s+=o.length}return n},DE={assign:M8e,flattenChunks:k8e};let rY=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rY=!1}const ap=new Uint8Array(256);for(let e=0;e<256;e++)ap[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ap[254]=ap[254]=1;var R8e=e=>{let t,n,i,s,r,o=e.length,a=0;for(s=0;s<o;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),n<128?t[r++]=n:n<2048?(t[r++]=192|n>>>6,t[r++]=128|n&63):n<65536?(t[r++]=224|n>>>12,t[r++]=128|n>>>6&63,t[r++]=128|n&63):(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63,t[r++]=128|n>>>6&63,t[r++]=128|n&63);return t};const D8e=(e,t)=>{if(t<65534&&e.subarray&&rY)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var L8e=(e,t)=>{let n,i;const s=t||e.length,r=new Array(s*2);for(i=0,n=0;n<s;){let o=e[n++];if(o<128){r[i++]=o;continue}let a=ap[o];if(a>4){r[i++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<s;)o=o<<6|e[n++]&63,a--;if(a>1){r[i++]=65533;continue}o<65536?r[i++]=o:(o-=65536,r[i++]=55296|o>>10&1023,r[i++]=56320|o&1023)}return D8e(r,i)},P8e=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+ap[e[n]]>t?n:t},lp={string2buf:R8e,buf2string:L8e,utf8border:P8e};function N8e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var oY=N8e;const aY=Object.prototype.toString,{Z_NO_FLUSH:O8e,Z_SYNC_FLUSH:F8e,Z_FULL_FLUSH:B8e,Z_FINISH:z8e,Z_OK:S5,Z_STREAM_END:H8e,Z_DEFAULT_COMPRESSION:V8e,Z_DEFAULT_STRATEGY:$8e,Z_DEFLATED:G8e}=ME;function LE(e){this.options=DE.assign({level:V8e,method:G8e,chunkSize:16384,windowBits:15,memLevel:8,strategy:$8e},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oY,this.strm.avail_out=0;let n=a0.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==S5)throw new Error(Hu[n]);if(t.header&&a0.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(typeof t.dictionary=="string"?i=lp.string2buf(t.dictionary):aY.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,n=a0.deflateSetDictionary(this.strm,i),n!==S5)throw new Error(Hu[n]);this._dict_set=!0}}LE.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let s,r;if(this.ended)return!1;for(t===~~t?r=t:r=t===!0?z8e:O8e,typeof e=="string"?n.input=lp.string2buf(e):aY.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(r===F8e||r===B8e)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(s=a0.deflate(n,r),s===H8e)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=a0.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===S5;if(n.avail_out===0){this.onData(n.output);continue}if(r>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};LE.prototype.onData=function(e){this.chunks.push(e)};LE.prototype.onEnd=function(e){e===S5&&(this.result=DE.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function X8e(e,t){const n=new LE(t);if(n.push(e,!0),n.err)throw n.msg||Hu[n.err];return n.result}var j8e=X8e,Y8e={deflate:j8e};const HU=30,W8e=12;var K8e=function(t,n){let i,s,r,o,a,l,c,d,u,f,h,m,p,U,b,y,E,_,I,k,w,T,A,S;const D=t.state;i=t.next_in,A=t.input,s=i+(t.avail_in-5),r=t.next_out,S=t.output,o=r-(n-t.avail_out),a=r+(t.avail_out-257),l=D.dmax,c=D.wsize,d=D.whave,u=D.wnext,f=D.window,h=D.hold,m=D.bits,p=D.lencode,U=D.distcode,b=(1<<D.lenbits)-1,y=(1<<D.distbits)-1;e:do{m<15&&(h+=A[i++]<<m,m+=8,h+=A[i++]<<m,m+=8),E=p[h&b];t:for(;;){if(_=E>>>24,h>>>=_,m-=_,_=E>>>16&255,_===0)S[r++]=E&65535;else if(_&16){I=E&65535,_&=15,_&&(m<_&&(h+=A[i++]<<m,m+=8),I+=h&(1<<_)-1,h>>>=_,m-=_),m<15&&(h+=A[i++]<<m,m+=8,h+=A[i++]<<m,m+=8),E=U[h&y];n:for(;;){if(_=E>>>24,h>>>=_,m-=_,_=E>>>16&255,_&16){if(k=E&65535,_&=15,m<_&&(h+=A[i++]<<m,m+=8,m<_&&(h+=A[i++]<<m,m+=8)),k+=h&(1<<_)-1,k>l){t.msg="invalid distance too far back",D.mode=HU;break e}if(h>>>=_,m-=_,_=r-o,k>_){if(_=k-_,_>d&&D.sane){t.msg="invalid distance too far back",D.mode=HU;break e}if(w=0,T=f,u===0){if(w+=c-_,_<I){I-=_;do S[r++]=f[w++];while(--_);w=r-k,T=S}}else if(u<_){if(w+=c+u-_,_-=u,_<I){I-=_;do S[r++]=f[w++];while(--_);if(w=0,u<I){_=u,I-=_;do S[r++]=f[w++];while(--_);w=r-k,T=S}}}else if(w+=u-_,_<I){I-=_;do S[r++]=f[w++];while(--_);w=r-k,T=S}for(;I>2;)S[r++]=T[w++],S[r++]=T[w++],S[r++]=T[w++],I-=3;I&&(S[r++]=T[w++],I>1&&(S[r++]=T[w++]))}else{w=r-k;do S[r++]=S[w++],S[r++]=S[w++],S[r++]=S[w++],I-=3;while(I>2);I&&(S[r++]=S[w++],I>1&&(S[r++]=S[w++]))}}else if(_&64){t.msg="invalid distance code",D.mode=HU;break e}else{E=U[(E&65535)+(h&(1<<_)-1)];continue n}break}}else if(_&64)if(_&32){D.mode=W8e;break e}else{t.msg="invalid literal/length code",D.mode=HU;break e}else{E=p[(E&65535)+(h&(1<<_)-1)];continue t}break}}while(i<s&&r<a);I=m>>3,i-=I,m-=I<<3,h&=(1<<m)-1,t.next_in=i,t.next_out=r,t.avail_in=i<s?5+(s-i):5-(i-s),t.avail_out=r<a?257+(a-r):257-(r-a),D.hold=h,D.bits=m};const Df=15,ID=852,SD=592,CD=0,U7=1,xD=2,Z8e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),q8e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Q8e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),J8e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),e3e=(e,t,n,i,s,r,o,a)=>{const l=a.bits;let c=0,d=0,u=0,f=0,h=0,m=0,p=0,U=0,b=0,y=0,E,_,I,k,w,T=null,A=0,S;const D=new Uint16Array(Df+1),N=new Uint16Array(Df+1);let L=null,j=0,Y,G,O;for(c=0;c<=Df;c++)D[c]=0;for(d=0;d<i;d++)D[t[n+d]]++;for(h=l,f=Df;f>=1&&D[f]===0;f--);if(h>f&&(h=f),f===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,a.bits=1,0;for(u=1;u<f&&D[u]===0;u++);for(h<u&&(h=u),U=1,c=1;c<=Df;c++)if(U<<=1,U-=D[c],U<0)return-1;if(U>0&&(e===CD||f!==1))return-1;for(N[1]=0,c=1;c<Df;c++)N[c+1]=N[c]+D[c];for(d=0;d<i;d++)t[n+d]!==0&&(o[N[t[n+d]]++]=d);if(e===CD?(T=L=o,S=19):e===U7?(T=Z8e,A-=257,L=q8e,j-=257,S=256):(T=Q8e,L=J8e,S=-1),y=0,d=0,c=u,w=r,m=h,p=0,I=-1,b=1<<h,k=b-1,e===U7&&b>ID||e===xD&&b>SD)return 1;for(;;){Y=c-p,o[d]<S?(G=0,O=o[d]):o[d]>S?(G=L[j+o[d]],O=T[A+o[d]]):(G=96,O=0),E=1<<c-p,_=1<<m,u=_;do _-=E,s[w+(y>>p)+_]=Y<<24|G<<16|O|0;while(_!==0);for(E=1<<c-1;y&E;)E>>=1;if(E!==0?(y&=E-1,y+=E):y=0,d++,--D[c]===0){if(c===f)break;c=t[n+o[d]]}if(c>h&&(y&k)!==I){for(p===0&&(p=h),w+=u,m=c-p,U=1<<m;m+p<f&&(U-=D[m+p],!(U<=0));)m++,U<<=1;if(b+=1<<m,e===U7&&b>ID||e===xD&&b>SD)return 1;I=y&k,s[I]=h<<24|m<<16|w-r|0}}return y!==0&&(s[w+y]=c-p<<24|64<<16|0),a.bits=h,0};var l0=e3e;const t3e=0,lY=1,cY=2,{Z_FINISH:AD,Z_BLOCK:n3e,Z_TREES:VU,Z_OK:Gu,Z_STREAM_END:i3e,Z_NEED_DICT:s3e,Z_STREAM_ERROR:no,Z_DATA_ERROR:dY,Z_MEM_ERROR:uY,Z_BUF_ERROR:r3e,Z_DEFLATED:MD}=ME,fY=1,kD=2,RD=3,DD=4,LD=5,PD=6,ND=7,OD=8,FD=9,BD=10,C5=11,Ya=12,b7=13,zD=14,y7=15,HD=16,VD=17,$D=18,GD=19,$U=20,GU=21,XD=22,jD=23,YD=24,WD=25,KD=26,E7=27,ZD=28,qD=29,fn=30,hY=31,o3e=32,a3e=852,l3e=592,c3e=15,d3e=c3e,QD=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function u3e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gY=e=>{if(!e||!e.state)return no;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=fY,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(a3e),t.distcode=t.distdyn=new Int32Array(l3e),t.sane=1,t.back=-1,Gu},mY=e=>{if(!e||!e.state)return no;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,gY(e)},pY=(e,t)=>{let n;if(!e||!e.state)return no;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?no:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,mY(e))},UY=(e,t)=>{if(!e)return no;const n=new u3e;e.state=n,n.window=null;const i=pY(e,t);return i!==Gu&&(e.state=null),i},f3e=e=>UY(e,d3e);let JD=!0,v7,_7;const h3e=e=>{if(JD){v7=new Int32Array(512),_7=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(l0(lY,e.lens,0,288,v7,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;l0(cY,e.lens,0,32,_7,0,e.work,{bits:5}),JD=!1}e.lencode=v7,e.lenbits=9,e.distcode=_7,e.distbits=5},bY=(e,t,n,i)=>{let s;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(t.subarray(n-r.wsize,n),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>i&&(s=i),r.window.set(t.subarray(n-i,n-i+s),r.wnext),i-=s,i?(r.window.set(t.subarray(n-i,n),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},g3e=(e,t)=>{let n,i,s,r,o,a,l,c,d,u,f,h,m,p,U=0,b,y,E,_,I,k,w,T;const A=new Uint8Array(4);let S,D;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return no;n=e.state,n.mode===Ya&&(n.mode=b7),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,u=a,f=l,T=Gu;e:for(;;)switch(n.mode){case fY:if(n.wrap===0){n.mode=b7;break}for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.wrap&2&&c===35615){n.check=0,A[0]=c&255,A[1]=c>>>8&255,n.check=Ti(n.check,A,2,0),c=0,d=0,n.mode=kD;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=fn;break}if((c&15)!==MD){e.msg="unknown compression method",n.mode=fn;break}if(c>>>=4,d-=4,w=(c&15)+8,n.wbits===0)n.wbits=w;else if(w>n.wbits){e.msg="invalid window size",n.mode=fn;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=c&512?BD:Ya,c=0,d=0;break;case kD:for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.flags=c,(n.flags&255)!==MD){e.msg="unknown compression method",n.mode=fn;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=fn;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(A[0]=c&255,A[1]=c>>>8&255,n.check=Ti(n.check,A,2,0)),c=0,d=0,n.mode=RD;case RD:for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.head&&(n.head.time=c),n.flags&512&&(A[0]=c&255,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,n.check=Ti(n.check,A,4,0)),c=0,d=0,n.mode=DD;case DD:for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(A[0]=c&255,A[1]=c>>>8&255,n.check=Ti(n.check,A,2,0)),c=0,d=0,n.mode=LD;case LD:if(n.flags&1024){for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(A[0]=c&255,A[1]=c>>>8&255,n.check=Ti(n.check,A,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=PD;case PD:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(r,r+h),w)),n.flags&512&&(n.check=Ti(n.check,i,h,r)),a-=h,r+=h,n.length-=h),n.length))break e;n.length=0,n.mode=ND;case ND:if(n.flags&2048){if(a===0)break e;h=0;do w=i[r+h++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w));while(w&&h<a);if(n.flags&512&&(n.check=Ti(n.check,i,h,r)),a-=h,r+=h,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=OD;case OD:if(n.flags&4096){if(a===0)break e;h=0;do w=i[r+h++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w));while(w&&h<a);if(n.flags&512&&(n.check=Ti(n.check,i,h,r)),a-=h,r+=h,w)break e}else n.head&&(n.head.comment=null);n.mode=FD;case FD:if(n.flags&512){for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=fn;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Ya;break;case BD:for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}e.adler=n.check=QD(c),c=0,d=0,n.mode=C5;case C5:if(n.havedict===0)return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,s3e;e.adler=n.check=1,n.mode=Ya;case Ya:if(t===n3e||t===VU)break e;case b7:if(n.last){c>>>=d&7,d-=d&7,n.mode=E7;break}for(;d<3;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}switch(n.last=c&1,c>>>=1,d-=1,c&3){case 0:n.mode=zD;break;case 1:if(h3e(n),n.mode=$U,t===VU){c>>>=2,d-=2;break e}break;case 2:n.mode=VD;break;case 3:e.msg="invalid block type",n.mode=fn}c>>>=2,d-=2;break;case zD:for(c>>>=d&7,d-=d&7;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=fn;break}if(n.length=c&65535,c=0,d=0,n.mode=y7,t===VU)break e;case y7:n.mode=HD;case HD:if(h=n.length,h){if(h>a&&(h=a),h>l&&(h=l),h===0)break e;s.set(i.subarray(r,r+h),o),a-=h,r+=h,l-=h,o+=h,n.length-=h;break}n.mode=Ya;break;case VD:for(;d<14;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.nlen=(c&31)+257,c>>>=5,d-=5,n.ndist=(c&31)+1,c>>>=5,d-=5,n.ncode=(c&15)+4,c>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=fn;break}n.have=0,n.mode=$D;case $D:for(;n.have<n.ncode;){for(;d<3;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.lens[N[n.have++]]=c&7,c>>>=3,d-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},T=l0(t3e,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,T){e.msg="invalid code lengths set",n.mode=fn;break}n.have=0,n.mode=GD;case GD:for(;n.have<n.nlen+n.ndist;){for(;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,E=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(E<16)c>>>=b,d-=b,n.lens[n.have++]=E;else{if(E===16){for(D=b+2;d<D;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c>>>=b,d-=b,n.have===0){e.msg="invalid bit length repeat",n.mode=fn;break}w=n.lens[n.have-1],h=3+(c&3),c>>>=2,d-=2}else if(E===17){for(D=b+3;d<D;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=b,d-=b,w=0,h=3+(c&7),c>>>=3,d-=3}else{for(D=b+7;d<D;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=b,d-=b,w=0,h=11+(c&127),c>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=fn;break}for(;h--;)n.lens[n.have++]=w}}if(n.mode===fn)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=fn;break}if(n.lenbits=9,S={bits:n.lenbits},T=l0(lY,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,T){e.msg="invalid literal/lengths set",n.mode=fn;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},T=l0(cY,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,T){e.msg="invalid distances set",n.mode=fn;break}if(n.mode=$U,t===VU)break e;case $U:n.mode=GU;case GU:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,K8e(e,f),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,n.mode===Ya&&(n.back=-1);break}for(n.back=0;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,E=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(y&&!(y&240)){for(_=b,I=y,k=E;U=n.lencode[k+((c&(1<<_+I)-1)>>_)],b=U>>>24,y=U>>>16&255,E=U&65535,!(_+b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=_,d-=_,n.back+=_}if(c>>>=b,d-=b,n.back+=b,n.length=E,y===0){n.mode=KD;break}if(y&32){n.back=-1,n.mode=Ya;break}if(y&64){e.msg="invalid literal/length code",n.mode=fn;break}n.extra=y&15,n.mode=XD;case XD:if(n.extra){for(D=n.extra;d<D;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=jD;case jD:for(;U=n.distcode[c&(1<<n.distbits)-1],b=U>>>24,y=U>>>16&255,E=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(!(y&240)){for(_=b,I=y,k=E;U=n.distcode[k+((c&(1<<_+I)-1)>>_)],b=U>>>24,y=U>>>16&255,E=U&65535,!(_+b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=_,d-=_,n.back+=_}if(c>>>=b,d-=b,n.back+=b,y&64){e.msg="invalid distance code",n.mode=fn;break}n.offset=E,n.extra=y&15,n.mode=YD;case YD:if(n.extra){for(D=n.extra;d<D;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=fn;break}n.mode=WD;case WD:if(l===0)break e;if(h=f-l,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=fn;break}h>n.wnext?(h-=n.wnext,m=n.wsize-h):m=n.wnext-h,h>n.length&&(h=n.length),p=n.window}else p=s,m=o-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do s[o++]=p[m++];while(--h);n.length===0&&(n.mode=GU);break;case KD:if(l===0)break e;s[o++]=n.length,l--,n.mode=GU;break;case E7:if(n.wrap){for(;d<32;){if(a===0)break e;a--,c|=i[r++]<<d,d+=8}if(f-=l,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?Ti(n.check,s,f,o-f):op(n.check,s,f,o-f)),f=l,(n.flags?c:QD(c))!==n.check){e.msg="incorrect data check",n.mode=fn;break}c=0,d=0}n.mode=ZD;case ZD:if(n.wrap&&n.flags){for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=fn;break}c=0,d=0}n.mode=qD;case qD:T=i3e;break e;case fn:T=dY;break e;case hY:return uY;case o3e:default:return no}return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<fn&&(n.mode<E7||t!==AD))&&bY(e,e.output,e.next_out,f-e.avail_out),u-=e.avail_in,f-=e.avail_out,e.total_in+=u,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?Ti(n.check,s,f,e.next_out-f):op(n.check,s,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Ya?128:0)+(n.mode===$U||n.mode===y7?256:0),(u===0&&f===0||t===AD)&&T===Gu&&(T=r3e),T},m3e=e=>{if(!e||!e.state)return no;let t=e.state;return t.window&&(t.window=null),e.state=null,Gu},p3e=(e,t)=>{if(!e||!e.state)return no;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,Gu):no},U3e=(e,t)=>{const n=t.length;let i,s,r;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==C5)?no:i.mode===C5&&(s=1,s=op(s,t,n,0),s!==i.check)?dY:(r=bY(e,t,n,n),r?(i.mode=hY,uY):(i.havedict=1,Gu))};var b3e=mY,y3e=pY,E3e=gY,v3e=f3e,_3e=UY,w3e=g3e,T3e=m3e,I3e=p3e,S3e=U3e,C3e="pako inflate (from Nodeca project)",Ja={inflateReset:b3e,inflateReset2:y3e,inflateResetKeep:E3e,inflateInit:v3e,inflateInit2:_3e,inflate:w3e,inflateEnd:T3e,inflateGetHeader:I3e,inflateSetDictionary:S3e,inflateInfo:C3e};function x3e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var A3e=x3e;const yY=Object.prototype.toString,{Z_NO_FLUSH:M3e,Z_FINISH:k3e,Z_OK:cp,Z_STREAM_END:w7,Z_NEED_DICT:T7,Z_STREAM_ERROR:R3e,Z_DATA_ERROR:eL,Z_MEM_ERROR:D3e}=ME;function PE(e){this.options=DE.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oY,this.strm.avail_out=0;let n=Ja.inflateInit2(this.strm,t.windowBits);if(n!==cp)throw new Error(Hu[n]);if(this.header=new A3e,Ja.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=lp.string2buf(t.dictionary):yY.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Ja.inflateSetDictionary(this.strm,t.dictionary),n!==cp)))throw new Error(Hu[n])}PE.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?k3e:M3e,yY.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),r=Ja.inflate(n,o),r===T7&&s&&(r=Ja.inflateSetDictionary(n,s),r===cp?r=Ja.inflate(n,o):r===eL&&(r=T7));n.avail_in>0&&r===w7&&n.state.wrap>0&&e[n.next_in]!==0;)Ja.inflateReset(n),r=Ja.inflate(n,o);switch(r){case R3e:case eL:case T7:case D3e:return this.onEnd(r),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||r===w7))if(this.options.to==="string"){let l=lp.utf8border(n.output,n.next_out),c=n.next_out-l,d=lp.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(r===cp&&a===0)){if(r===w7)return r=Ja.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};PE.prototype.onData=function(e){this.chunks.push(e)};PE.prototype.onEnd=function(e){e===cp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=DE.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function L3e(e,t){const n=new PE(t);if(n.push(e),n.err)throw n.msg||Hu[n.err];return n.result}var P3e=L3e,N3e={inflate:P3e};const{deflate:O3e}=Y8e,{inflate:F3e}=N3e;var EY=O3e,vY=F3e;const Bb=12,B3e=()=>{const e=new Uint8Array(Bb);return window.crypto.getRandomValues(e)},GI=async e=>{const t=await window.crypto.subtle.generateKey({name:"AES-GCM",length:Uz},!0,["encrypt","decrypt"]);return e==="cryptoKey"?t:(await window.crypto.subtle.exportKey("jwk",t)).k},_Y=(e,t)=>window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:e,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:Uz},!1,[t]),NE=async(e,t)=>{const n=typeof e=="string"?await _Y(e,"encrypt"):e,i=B3e(),s=typeof t=="string"?new TextEncoder().encode(t):t instanceof Uint8Array?t:t instanceof Blob?await w2(t):t;return{encryptedBuffer:await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,s),iv:i}},dp=async(e,t,n)=>{const i=await _Y(n,"decrypt");return window.crypto.subtle.decrypt({name:"AES-GCM",iv:e},i,t)},x5=e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e instanceof Uint8Array?e:new Uint8Array(e);let n="";for(const i of t)n+=String.fromCharCode(i);return n},wY=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let i=0,s=e.length;i<s;i++)n[i]=e.charCodeAt(i);return t},TY=e=>new TextDecoder("utf-8").decode(wY(e)),IY=(e,t=!1)=>t?window.btoa(e):window.btoa(x5(e)),SY=(e,t=!1)=>t?window.atob(e):TY(window.atob(e)),tL=e=>window.atob(e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=")),CY=({text:e,compress:t})=>{let n;if(t!==!1)try{n=x5(EY(e))}catch(i){console.error("encode: cannot deflate",i)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||x5(e)}},xY=e=>{let t;switch(e.encoding){case"bstring":t=e.compressed?e.encoded:TY(e.encoded);break;default:throw new Error(`decode: unknown encoding "${e.encoding}"`)}return e.compressed?vY(new Uint8Array(wY(t)),{to:"string"}):t},AY=1,zb=4,Vh=4,I7={1:8,2:16,4:32};function A5(e,t,n,i){if(i!=null){if(i>Math.pow(2,I7[t])-1)throw new Error(`attempting to set value higher than the allocated bytes (value: ${i}, bytes: ${t})`);const r=`setUint${I7[t]}`;return new DataView(e.buffer)[r](n,i),e}const s=`getUint${I7[t]}`;return new DataView(e.buffer)[s](n)}const nL=(...e)=>{const t=new Uint8Array(zb+Vh*e.length+e.reduce((i,s)=>i+s.byteLength,0));let n=0;A5(t,zb,n,AY),n+=zb;for(const i of e)A5(t,Vh,n,i.byteLength),n+=Vh,t.set(i,n),n+=i.byteLength;return t},iL=e=>{const t=[];let n=0;const i=A5(e,Vh,n);if(i>AY)throw new Error(`invalid version ${i}`);for(n+=zb;;){const s=A5(e,Vh,n);if(n+=Vh,t.push(e.slice(n,n+s)),n+=s,n>=e.byteLength)break}return t},z3e=async(e,t)=>{const{encryptedBuffer:n,iv:i}=await NE(t,EY(e));return{iv:i,buffer:new Uint8Array(n)}},MY=async(e,t)=>{const n={version:2,compression:"pako@1",encryption:"AES-GCM"},i=new TextEncoder().encode(JSON.stringify(n)),s=new TextEncoder().encode(JSON.stringify(t.metadata||null)),{iv:r,buffer:o}=await z3e(nL(s,e),t.encryptionKey);return nL(i,r,o)},H3e=async(e,t,n,i)=>(t=new Uint8Array(await dp(e,t,n)),i?vY(t):t),kY=async(e,t)=>{const[n,i,s]=iL(e),r=JSON.parse(new TextDecoder().decode(n));try{const[o,a]=iL(await H3e(i,s,t.decryptionKey,!!r.compression));return{metadata:JSON.parse(new TextDecoder().decode(o)),data:a}}catch(o){throw console.error("Error during decompressing and decrypting the file.",r),o}},gf=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),V3e=gf?Ue(()=>import("./file-open-002ab408-DIuFHtCF.js"),__vite__mapDeps([])):Ue(()=>import("./file-open-7c801643-684qeFg4.js"),__vite__mapDeps([]));async function $3e(...e){return(await V3e).default(...e)}gf?Ue(()=>import("./directory-open-4ed118d0-BzWybGaI.js"),__vite__mapDeps([])):Ue(()=>import("./directory-open-01563666-DWU9wJ6I.js"),__vite__mapDeps([]));const G3e=gf?Ue(()=>import("./file-save-745eba88-Bb9F9Kg7.js"),__vite__mapDeps([])):Ue(()=>import("./file-save-3189631c-x92wctJd.js"),__vite__mapDeps([]));async function X3e(...e){return(await G3e).default(...e)}const sL=5e3,XI=async e=>{var s,r;const t=(s=e.extensions)==null?void 0:s.reduce((o,a)=>(o.push(Ee[a]),o),[]),n=(r=e.extensions)==null?void 0:r.reduce((o,a)=>a==="jpg"?o.concat(".jpg",".jpeg"):o.concat(`.${a}`),[]),i=await $3e({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(o,a,l)=>{const c=Al(a,sL),d=()=>{u(),document.addEventListener(te.KEYUP,c),document.addEventListener(te.POINTER_UP,c),c()},u=()=>{var h;if((h=l.files)!=null&&h.length){const m=e.multiple?[...l.files]:l.files[0];o(m)}};requestAnimationFrame(()=>{window.addEventListener(te.FOCUS,d)});const f=window.setInterval(()=>{u()},sL);return h=>{clearInterval(f),c.cancel(),window.removeEventListener(te.FOCUS,d),document.removeEventListener(te.KEYUP,c),document.removeEventListener(te.POINTER_UP,c),h&&(console.warn("Opening the file was canceled (legacy-fs)."),h(new yg))}}});return Array.isArray(i)?await Promise.all(i.map(o=>fp(o))):await fp(i)},M5=(e,t)=>X3e(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`],mimeTypes:t.mimeTypes},t.fileHandle),j3e=(e,t)=>{const n={};for(const i of e)!i.isDeleted&&"fileId"in i&&i.fileId&&t[i.fileId]&&(n[i.fileId]=t[i.fileId]);return n},im=(e,t,n,i)=>{const s={type:jr.excalidraw,version:Oy.excalidraw,source:S9(),elements:e,appState:i==="local"?Lj(t):Jye(t),files:i==="local"?j3e(e,n):void 0};return JSON.stringify(s,null,2)},RY=async(e,t,n,i=t.name||Ez)=>{const s=im(e,t,n,"local"),r=new Blob([s],{type:Ee.excalidraw});return{fileHandle:await M5(r,{name:i,extension:"excalidraw",description:"Excalidraw file",fileHandle:KI(t.fileHandle)?null:t.fileHandle})}},Y3e=async(e,t)=>{const n=await XI({description:"Excalidraw files"});return ZI(n,e,t,n.handle)},W3e=e=>(e==null?void 0:e.type)===jr.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||typeof e.appState=="object")),DY=e=>typeof e=="object"&&e&&e.type===jr.excalidrawLibrary&&(e.version===1||e.version===2),K3e=e=>{const t={type:jr.excalidrawLibrary,version:Oy.excalidrawLibrary,source:S9(),libraryItems:e};return JSON.stringify(t,null,2)},Z3e=async e=>{const t=K3e(e);await M5(new Blob([t],{type:Ee.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})},q3e=12,LY=document.createElement("img");LY.src=`data:${Ee.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`;const PY=document.createElement("img");PY.src=`data:${Ee.svg}, ${encodeURIComponent('<svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="#1971c2"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-big-right-line"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v-3.586a1 1 0 0 1 1.707 -.707l6.586 6.586a1 1 0 0 1 0 1.414l-6.586 6.586a1 1 0 0 1 -1.707 -.707v-3.586h-6v-6h6z" /><path d="M3 9v6" /></svg>')}`;const jI=([e,t,n,i],s,r)=>{const o=q3e,a=r.zoom.value>1?r.zoom.value:1,l=o/a,c=o/a,d=o/a,u=(e+n)/2,f=(t+i)/2,h=(o-8)/(2*a),m=4/a,p=n+m-h,U=t-m-d+h,[b,y]=Z(M(p+l/2,U+c/2),M(u,f),s);return[b-l/2,y-c/2,l,c]},NY=(e,t,n,[i,s])=>{const r=4/n.zoom.value,[o,a,l,c]=je(e,t),[d,u,f,h]=jI([o,a,l,c],e.angle,n);return i>d-r&&i<d+r+f&&s>u-r&&s<u+h+r},S7=(e,t,n,[i,s],r)=>!e.link||n.selectedElementIds[e.id]?!1:!r&&n.viewModeEnabled&&Ky(M(i,s),e,t)?!0:NY(e,t,n,M(i,s)),OE=(e,t,n,i,s,r=!0)=>{e.beginPath(),e.arc(t,n,i,0,Math.PI*2),r&&e.fill(),s&&e.stroke()},FE=(e,t)=>[e.width/t,e.height/t],BE=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:i,theme:s,isExporting:r,viewBackgroundColor:o})=>{const a=e.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(t,t),typeof o=="string"?((o==="transparent"||o.length===5||o.length===9||/(hsla|rgba)\(/.test(o))&&a.clearRect(0,0,n,i),a.save(),a.fillStyle=s===be.DARK?Yi(o):o,a.fillRect(0,0,n,i),a.restore()):a.clearRect(0,0,n,i),a},zE=(e,t,n,i,s,r,o,a,l=!1,c=0)=>{e.save(),e.translate(r,o),e.rotate(a),l&&e.fillRect(t-r,n-o,i,s),c&&e.roundRect?(e.beginPath(),e.roundRect(t-r,n-o,i,s,c),e.stroke(),e.closePath()):e.strokeRect(t-r,n-o,i,s),e.restore()},XU={[be.LIGHT]:{bold:"#dddddd",regular:"#e5e5e5"},[be.DARK]:{bold:Yi("#dddddd"),regular:Yi("#e5e5e5")}},Q3e=(e,t,n,i,s,r,o,a,l)=>{const c=i%t-t,d=s%t-t,u=t*r.value,f=1/r.value;e.save(),r.value===1&&e.translate(c%1?0:.5,d%1?0:.5);for(let h=c;h<c+a+t*2;h+=t){const m=n>1&&Math.round(h-i)%(n*t)===0;if(!m&&u<10)continue;const p=Math.min(1/r.value,m?4:1);e.lineWidth=p;const U=[p*3,f+(p+f)];e.beginPath(),e.setLineDash(m?[]:U),e.strokeStyle=m?XU[o].bold:XU[o].regular,e.moveTo(h,d-t),e.lineTo(h,Math.ceil(d+l+t*2)),e.stroke()}for(let h=d;h<d+l+t*2;h+=t){const m=n>1&&Math.round(h-s)%(n*t)===0;if(!m&&u<10)continue;const p=Math.min(1/r.value,m?4:1);e.lineWidth=p;const U=[p*3,f+(p+f)];e.beginPath(),e.setLineDash(m?[]:U),e.strokeStyle=m?XU[o].bold:XU[o].regular,e.moveTo(c-t,h),e.lineTo(Math.ceil(c+a+t*2),h),e.stroke()}e.restore()},A_=(e,t,n,i)=>{t.translate(e.x+i.scrollX,e.y+i.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,rt.radius/i.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+i.scrollX),-(e.y+i.scrollY))},rL={regularLink:null,elementLink:null},oL=(e,t,n,i)=>{if(e.link&&!n.selectedElementIds[e.id]){const[s,r,o,a]=je(e,i),[l,c,d,u]=jI([s,r,o,a],e.angle,n),f=l+d/2,h=c+u/2;t.save(),t.translate(n.scrollX+f,n.scrollY+h),t.rotate(e.angle);const m=Lh(e.link)?"elementLink":"regularLink";let p=rL[m];if(!p||p.zoom!==n.zoom.value){p=Object.assign(document.createElement("canvas"),{zoom:n.zoom.value}),p.width=d*window.devicePixelRatio*n.zoom.value,p.height=u*window.devicePixelRatio*n.zoom.value,rL[m]=p;const U=p.getContext("2d");U.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),U.fillStyle=n.viewBackgroundColor||"#fff",U.fillRect(0,0,d,u),m==="elementLink"?U.drawImage(PY,0,0,d,u):U.drawImage(LY,0,0,d,u),U.restore()}t.globalAlpha=e.opacity/100,t.drawImage(p,l-f,c-h,d,u),t.restore()}},OY=({canvas:e,rc:t,elementsMap:n,allElementsMap:i,visibleElements:s,scale:r,appState:o,renderConfig:a})=>{var p;if(e===null)return;const{renderGrid:l=!0,isExporting:c}=a,[d,u]=FE(e,r),f=BE({canvas:e,scale:r,normalizedWidth:d,normalizedHeight:u,theme:o.theme,isExporting:c,viewBackgroundColor:o.viewBackgroundColor});f.scale(o.zoom.value,o.zoom.value),l&&Q3e(f,o.gridSize,o.gridStep,o.scrollX,o.scrollY,o.zoom,a.theme,d/o.zoom.value,u/o.zoom.value);const h=new Set;s.forEach(U=>{U.groupIds.length>0&&o.frameToHighlight&&o.selectedElementIds[U.id]&&(ad(U,o.frameToHighlight,n)||U.groupIds.find(b=>h.has(b)))&&U.groupIds.forEach(b=>h.add(b))});const m=new Map;s.filter(U=>!Br(U)).forEach(U=>{var b;try{const y=U.frameId||((b=o.frameToHighlight)==null?void 0:b.id);if(he(U)&&U.containerId&&n.has(U.containerId))return;if(f.save(),y&&o.frameRendering.enabled&&o.frameRendering.clip){const _=n5(U,n,o);_&&B4(U,_,o,n,m)&&A_(_,f,a,o),jd(U,n,i,t,f,a,o)}else jd(U,n,i,t,f,a,o);const E=Ne(U,n);E&&jd(E,n,i,t,f,a,o),f.restore(),c||oL(U,f,o,n)}catch(y){console.error(y,U.id,U.x,U.y,U.width,U.height)}}),s.filter(U=>Br(U)).forEach(U=>{var b;try{const y=()=>{if(jd(U,n,i,t,f,a,o),Br(U)&&(c||Es(U)&&a.embedsValidationStatus.get(U.id)!==!0)&&U.width&&U.height){const _=BV(U);jd(_,n,i,t,f,a,o)}c||oL(U,f,o,n)};if((U.frameId||((b=o.frameToHighlight)==null?void 0:b.id))&&o.frameRendering.enabled&&o.frameRendering.clip){f.save();const _=n5(U,n,o);_&&B4(U,_,o,n,m)&&A_(_,f,a,o),y(),f.restore()}else y()}catch(y){console.error(y)}}),(p=a.pendingFlowchartNodes)==null||p.forEach(U=>{try{jd(U,n,i,t,f,a,o)}catch(b){console.error(b)}})},FY=jp(e=>{OY(e)},{trailing:!0}),BY=(e,t)=>{if(t){FY(e);return}OY(e)},Xm=(e,t,n)=>{const i={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(i)},jm=(e,t,n,i,s)=>{if(!i.enabled||!i.clip)return null;const r=Vs(e,s);if(r){const o=t.ownerDocument.createElementNS(ht,"g");return o.setAttributeNS(ht,"clip-path",`url(#${r.id})`),n.forEach(a=>o.appendChild(a)),o}return null},Hb=(e,t,n,i,s,r,o,a)=>{var E;const l={x:r,y:o},[c,d,u,f]=je(e,t);let h=(u-c)/2-(e.x-c),m=(f-d)/2-(e.y-d);if(he(e)){const _=Gn(e,t);if(Te(_)){const[I,k,w,T]=je(_,t),A=ne.getBoundTextElementPosition(_,e,t);h=(w-I)/2-(A.x-I),m=(T-k)/2-(A.y-k),r=r+A.x-e.x,o=o+A.y-e.y}}const p=180*e.angle/Math.PI;let U=i;if(e.link){const _=i.ownerDocument.createElementNS(ht,"a");_.setAttribute("href",Ur(e.link)),U.appendChild(_),U=_}const b=(_,I)=>{U.appendChild(_)},y=(((E=Vs(e,t))==null?void 0:E.opacity)??100)*e.opacity/1e4;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{const _=kn.generateElementShape(e,a),I=Xm(n,_,Lm);y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const k=jm(e,U,[I],a.frameRendering,t);b(k||I);break}case"iframe":case"embeddable":{const _=kn.generateElementShape(e,a),I=Xm(n,_,Lm),k=e.opacity/100;k!==1&&(I.setAttribute("stroke-opacity",`${k}`),I.setAttribute("fill-opacity",`${k}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),b(I);const w=BV(e);Hb(w,t,n,U,s,w.x+l.x-e.x,w.y+l.y-e.y,a);const T=Xm(n,_,Lm);for(T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);T.firstChild;)T.removeChild(T.firstChild);const A=fa(Math.min(e.width,e.height),e),S=ph(P9(e.link||""));if(a.renderEmbeddables===!1||(S==null?void 0:S.type)==="document"){const D=i.ownerDocument.createElementNS(ht,"a");D.setAttribute("href",Ur(e.link||"")),D.setAttribute("target","_blank"),D.setAttribute("rel","noopener noreferrer"),D.style.borderRadius=`${A}px`,T.appendChild(D)}else{const D=i.ownerDocument.createElementNS(ht,"foreignObject");D.style.width=`${e.width}px`,D.style.height=`${e.height}px`,D.style.border="none";const N=D.ownerDocument.createElementNS(ht,"div");N.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),N.style.width="100%",N.style.height="100%";const L=N.ownerDocument.createElement("iframe");L.src=(S==null?void 0:S.link)??"",L.style.width="100%",L.style.height="100%",L.style.border="none",L.style.borderRadius=`${A}px`,L.style.top="0",L.style.left="0",L.allowFullscreen=!0,N.appendChild(L),D.appendChild(N),T.appendChild(D)}b(T);break}case"line":case"arrow":{const _=Ne(e,t),I=i.ownerDocument.createElementNS(ht,"mask");if(_){I.setAttribute("id",`mask-${e.id}`);const A=i.ownerDocument.createElementNS(ht,"rect");r=r||0,o=o||0,A.setAttribute("x","0"),A.setAttribute("y","0"),A.setAttribute("fill","#fff"),A.setAttribute("width",`${e.width+100+r}`),A.setAttribute("height",`${e.height+100+o}`),I.appendChild(A);const S=i.ownerDocument.createElementNS(ht,"rect"),D=ne.getBoundTextElementPosition(e,_,t),N=r+D.x-e.x,L=o+D.y-e.y;S.setAttribute("x",N.toString()),S.setAttribute("y",L.toString()),S.setAttribute("fill","#000"),S.setAttribute("width",`${_.width}`),S.setAttribute("height",`${_.height}`),S.setAttribute("opacity","1"),I.appendChild(S)}const k=i.ownerDocument.createElementNS(ht,"g");_&&k.setAttribute("mask",`url(#mask-${e.id})`),k.setAttribute("stroke-linecap","round"),kn.generateElementShape(e,a).forEach(A=>{const S=Xm(n,A,Lm);y!==1&&(S.setAttribute("stroke-opacity",`${y}`),S.setAttribute("fill-opacity",`${y}`)),S.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),e.type==="line"&&Ea(e.points)&&e.backgroundColor!=="transparent"&&S.setAttribute("fill-rule","evenodd"),k.appendChild(S)});const T=jm(e,U,[k,I],a.frameRendering,t);T?(b(T),U.appendChild(T)):(b(k),U.append(I));break}case"freedraw":{const _=i.ownerDocument.createElementNS(ht,"g"),I=kn.generateElementShape(e,a);for(const w of I)if(typeof w=="string"){const T=i.ownerDocument.createElementNS(ht,"path");T.setAttribute("fill",a.theme===be.DARK?Yi(e.strokeColor):e.strokeColor),T.setAttribute("d",w),_.appendChild(T)}else{const T=Xm(n,w,Lm);if(T.nodeName==="g")for(;T.firstChild;)_.appendChild(T.firstChild);else _.appendChild(T)}y!==1&&(_.setAttribute("stroke-opacity",`${y}`),_.setAttribute("fill-opacity",`${y}`)),_.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),_.setAttribute("stroke","none");const k=jm(e,U,[_],a.frameRendering,t);b(k||_);break}case"image":{const _=Math.round(e.width),I=Math.round(e.height),k=Jn(e)&&s[e.fileId];if(k){const{reuseImages:w=!0}=a;let T=`image-${k.id}`,A=e.width,S=e.height;e.crop&&({width:A,height:S}=ya(e),T=`image-crop-${k.id}-${BT(`${A}x${S}`)}`),w||(T=`image-${e.id}`);let D=i.querySelector(`#${T}`);if(!D){D=i.ownerDocument.createElementNS(ht,"symbol"),D.id=T;const H=i.ownerDocument.createElementNS(ht,"image");H.setAttribute("href",k.dataURL),H.setAttribute("preserveAspectRatio","none"),e.crop||!w?(H.setAttribute("width",`${A}`),H.setAttribute("height",`${S}`)):(H.setAttribute("width","100%"),H.setAttribute("height","100%")),D.appendChild(H),(U.querySelector("defs")||U).prepend(D)}const N=i.ownerDocument.createElementNS(ht,"use");N.setAttribute("href",`#${T}`);let L=0,j=0;if(e.crop){const{width:H,height:X}=ya(e);L=e.crop.x/(e.crop.naturalWidth/H),j=e.crop.y/(e.crop.naturalHeight/X)}const Y=h+L,G=m+j;N.setAttribute("width",`${_+L}`),N.setAttribute("height",`${I+j}`),N.setAttribute("opacity",`${y}`),(e.scale[0]!==1||e.scale[1]!==1)&&N.setAttribute("transform",`translate(${Y} ${G}) scale(${e.scale[0]} ${e.scale[1]}) translate(${-Y} ${-G})`);const O=i.ownerDocument.createElementNS(ht,"g");if(a.theme===be.DARK&&k.mimeType===Ee.svg&&O.setAttribute("filter",gz),e.crop){const H=i.ownerDocument.createElementNS(ht,"mask");H.setAttribute("id",`mask-image-crop-${e.id}`),H.setAttribute("fill","#fff");const X=i.ownerDocument.createElementNS(ht,"rect");X.setAttribute("x",`${L}`),X.setAttribute("y",`${j}`),X.setAttribute("width",`${_}`),X.setAttribute("height",`${I}`),H.appendChild(X),U.appendChild(H),O.setAttribute("mask",`url(#${H.id})`)}if(O.appendChild(N),O.setAttribute("transform",`translate(${r-L} ${o-j}) rotate(${p} ${Y} ${G})`),e.roundness){const H=i.ownerDocument.createElementNS(ht,"clipPath");H.id=`image-clipPath-${e.id}`,H.setAttribute("clipPathUnits","userSpaceOnUse");const X=i.ownerDocument.createElementNS(ht,"rect"),Q=fa(Math.min(e.width,e.height),e),re=e.crop?L:0,ie=e.crop?j:0;X.setAttribute("x",`${re}`),X.setAttribute("y",`${ie}`),X.setAttribute("width",`${e.width}`),X.setAttribute("height",`${e.height}`),X.setAttribute("rx",`${Q}`),X.setAttribute("ry",`${Q}`),H.appendChild(X),b(H),O.setAttributeNS(ht,"clip-path",`url(#${H.id})`)}const z=jm(e,U,[O],a.frameRendering,t);b(z||O)}break}case"frame":case"magicframe":{if(a.frameRendering.enabled&&a.frameRendering.outline){const _=document.createElementNS(ht,"rect");_.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),_.setAttribute("width",`${e.width}px`),_.setAttribute("height",`${e.height}px`),_.setAttribute("rx",rt.radius.toString()),_.setAttribute("ry",rt.radius.toString()),_.setAttribute("fill","none"),_.setAttribute("stroke",a.theme===be.DARK?Yi(rt.strokeColor):rt.strokeColor),_.setAttribute("stroke-width",rt.strokeWidth.toString()),b(_)}break}default:if(he(e)){const _=i.ownerDocument.createElementNS(ht,"g");y!==1&&(_.setAttribute("stroke-opacity",`${y}`),_.setAttribute("fill-opacity",`${y}`)),_.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const I=e.text.replace(/\r\n?/g,`
`).split(`
`),k=n2(e.fontSize,e.lineHeight),w=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,T=_z(e.fontFamily,e.fontSize,k),A=Rz(e.text)?"rtl":"ltr",S=e.textAlign==="center"?"middle":e.textAlign==="right"||A==="rtl"?"end":"start";for(let N=0;N<I.length;N++){const L=i.ownerDocument.createElementNS(ht,"text");L.textContent=I[N],L.setAttribute("x",`${w}`),L.setAttribute("y",`${N*k+T}`),L.setAttribute("font-family",Xp(e)),L.setAttribute("font-size",`${e.fontSize}px`),L.setAttribute("fill",a.theme===be.DARK?Yi(e.strokeColor):e.strokeColor),L.setAttribute("text-anchor",S),L.setAttribute("style","white-space: pre;"),L.setAttribute("direction",A),L.setAttribute("dominant-baseline","alphabetic"),_.appendChild(L)}const D=jm(e,U,[_],a.frameRendering,t);b(D||_)}else throw new Error(`Unimplemented type ${e.type}`)}},J3e=(e,t,n,i,s,r)=>{i&&(e.filter(o=>!Br(o)).forEach(o=>{if(!o.isDeleted){if(he(o)&&o.containerId&&t.has(o.containerId))return;try{Hb(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r);const a=Ne(o,t);a&&Hb(a,t,n,i,s,a.x+r.offsetX,a.y+r.offsetY,r)}catch(a){console.error(a)}}}),e.filter(o=>Br(o)).forEach(o=>{if(!o.isDeleted)try{Hb(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r)}catch(a){console.error(a)}}))},e7e=(e,t)=>{if(e.width<=t)return e;const i=document.createElement("canvas").getContext("2d");i.font=_t({fontFamily:e.fontFamily,fontSize:e.fontSize});let s=e.text;if(i.measureText(s).width>t)for(let o=s.length;o>0;o--){const a=`${s.slice(0,o)}...`;if(i.measureText(a).width<=t){s=a;break}}return xe(e,{text:s,width:t})},t7e=(e,t)=>{const n=[];for(const i of e){if(_e(i)){let s=_r({x:i.x,y:i.y-rt.nameOffsetY,fontFamily:ct.Helvetica,fontSize:rt.nameFontSize,lineHeight:rt.nameLineHeight,strokeColor:t.exportWithDarkMode?rt.nameColorDarkTheme:rt.nameColorLightTheme,text:UV(i)});s.y-=s.height,s=e7e(s,i.width),n.push(s)}n.push(i)}return n},zY=(e,t)=>(t=t||Aa().frameRendering,{enabled:e?!0:t.enabled,outline:e?!1:t.outline,name:e?!1:t.name,clip:e?!0:t.clip}),HY=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:i})=>{let s;return t?s=IT(e,t):n.enabled&&n.name?s=t7e(e,{exportWithDarkMode:i}):s=e,s},VY=async(e,t,n,{exportBackground:i,exportPadding:s=$g,viewBackgroundColor:r,exportingFrame:o},a=(c,d)=>{const u=document.createElement("canvas");return u.width=c*t.exportScale,u.height=d*t.exportScale,{canvas:u,scale:t.exportScale}},l=async()=>{await wl.loadElementsFonts(e)})=>{await l();const c=zY(o??null,t.frameRendering??null);o&&(c.clip=!1);const d=HY({elements:e,exportingFrame:o,exportWithDarkMode:t.exportWithDarkMode,frameRendering:c});o&&(s=0);const[u,f,h,m]=WI(o?[o]:wT(d),s),{canvas:p,scale:U=1}=a(h,m),b=Aa(),{imageCache:y}=await WV({imageCache:new Map,fileIds:KV(d).map(E=>E.fileId),files:n});return BY({canvas:p,rc:Id.canvas(p),elementsMap:we(d),allElementsMap:we(Ad(e)),visibleElements:d,scale:U,appState:{...t,frameRendering:c,viewBackgroundColor:i?r:null,scrollX:-u+s,scrollY:-f+s,zoom:b.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?be.DARK:be.LIGHT},renderConfig:{canvasBackgroundColor:r,imageCache:y,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set,pendingFlowchartNodes:null,theme:t.exportWithDarkMode?be.DARK:be.LIGHT}}),p},E1=e=>document.createComment(` ${e} `),YI=async(e,t,n,i)=>{const s=zY((i==null?void 0:i.exportingFrame)??null,t.frameRendering??null);let{exportPadding:r=$g,exportWithDarkMode:o=!1,viewBackgroundColor:a,exportScale:l=1,exportEmbedScene:c}=t;const{exportingFrame:d=null}=i||{},u=HY({elements:e,exportingFrame:d,exportWithDarkMode:o,frameRendering:s});d&&(r=0);const[f,h,m,p]=WI(d?[d]:wT(u),r),U=-f+r,b=-h+r,y=document.createElementNS(ht,"svg");y.setAttribute("version","1.1"),y.setAttribute("xmlns",ht),y.setAttribute("viewBox",`0 0 ${m} ${p}`),y.setAttribute("width",`${m*l}`),y.setAttribute("height",`${p*l}`);const E=y.ownerDocument.createElementNS(ht,"defs"),_=y.ownerDocument.createElementNS(ht,"metadata");if(y.appendChild(E1("svg-source:excalidraw")),y.appendChild(_),y.appendChild(E),c)try{n7e({metadataElement:_,payload:im(e,t,n||{},"local")})}catch(D){console.error(D)}const I=_T(e);if(I.length){const D=we(e);for(const N of I){const L=y.ownerDocument.createElementNS(ht,"clipPath");L.setAttribute("id",N.id);const[j,Y,G,O]=je(N,D),z=(G-j)/2-(N.x-j),H=(O-Y)/2-(N.y-Y),X=y.ownerDocument.createElementNS(ht,"rect");X.setAttribute("transform",`translate(${N.x+U} ${N.y+b}) rotate(${N.angle} ${z} ${H})`),X.setAttribute("width",`${N.width}`),X.setAttribute("height",`${N.height}`),d||(X.setAttribute("rx",`${rt.radius}`),X.setAttribute("ry",`${rt.radius}`)),L.appendChild(X),E.appendChild(L)}}const k=i!=null&&i.skipInliningFonts?[]:await wl.generateFontFaceDeclarations(e),w=`
      `,T=y.ownerDocument.createElementNS(ht,"style");if(T.classList.add("style-fonts"),T.appendChild(document.createTextNode(`${w}${k.join(w)}`)),E.appendChild(T),t.exportBackground&&a){const D=y.ownerDocument.createElementNS(ht,"rect");D.setAttribute("x","0"),D.setAttribute("y","0"),D.setAttribute("width",`${m}`),D.setAttribute("height",`${p}`),D.setAttribute("fill",o?Yi(a):a),y.appendChild(D)}const A=Id.svg(y),S=(i==null?void 0:i.renderEmbeddables)??!1;return J3e(u,we(u),A,y,n||{},{offsetX:U,offsetY:b,isExporting:!0,exportWithDarkMode:o,renderEmbeddables:S,frameRendering:s,canvasBackgroundColor:a,embedsValidationStatus:S?new Map(u.filter(D=>_e(D)).map(D=>[D.id,!0])):new Map,reuseImages:(i==null?void 0:i.reuseImages)??!0,theme:o?be.DARK:be.LIGHT}),y},n7e=({payload:e,metadataElement:t})=>{const n=IY(JSON.stringify(CY({text:e})),!0);t.appendChild(E1(`payload-type:${Ee.excalidraw}`)),t.appendChild(E1("payload-version:2")),t.appendChild(E1("payload-start")),t.appendChild(document.createTextNode(n)),t.appendChild(E1("payload-end"))},i7e=({svg:e})=>{if(e.includes(`payload-type:${Ee.excalidraw}`)){const t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw new Error("INVALID");const n=e.match(/<!-- payload-version:(\d+) -->/),s=((n==null?void 0:n[1])||"1")!=="1";try{const r=SY(t[1],s),o=JSON.parse(r);if(!("encoded"in o)){if("type"in o&&o.type===jr.excalidraw)return r;throw new Error("FAILED")}return xY(o)}catch(r){throw console.error(r),new Error("FAILED")}}throw new Error("INVALID")},WI=(e,t)=>{const[n,i,s,r]=Et(e),o=rs(n,s)+t*2,a=rs(i,r)+t*2;return[n,i,o,a]},s7e=(e,t,n)=>{const[,,i,s]=WI(e,t).map(r=>Math.trunc(r*n));return[i,s]},r7e={selection:!0,lasso:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},o7e=e=>Object.keys(ct).includes(e)?ct[e]:Td,aL=(e,t,n,i,s)=>{try{if(!t)return null;if(ve(e))return{...t,fixedPoint:gg(t.fixedPoint??[0,0]),mode:t.mode||"orbit"};if(t.mode)return t.elementId?{elementId:t.elementId,mode:t.mode,fixedPoint:gg(t.fixedPoint||[.5,.5])}:null;const r=n.get(t.elementId)||void 0,o=r||(i==null?void 0:i.get(t.elementId))||void 0,a=r?n:i;if(o&&a){const l=ne.getPointAtIndexGlobalCoordinates(e,s==="start"?0:e.points.length-1,a),c=wa(l,o,a)?"inside":"orbit",d=c==="inside"?l:H0(e,l,o,s,a)||l,{fixedPoint:u}=Nu(e,o,s,a,d);return{mode:c,elementId:t.elementId,fixedPoint:u}}console.error("could not repair binding for element")}catch(r){console.error("Error repairing binding:",r)}return null},ec=(e,t)=>{const n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,index:e.index??null,isDeleted:e.isDeleted??!1,id:e.id||Li(),fillStyle:e.fillStyle||En.fillStyle,strokeWidth:e.strokeWidth||En.strokeWidth,strokeStyle:e.strokeStyle??En.strokeStyle,roughness:e.roughness??En.roughness,opacity:e.opacity==null?En.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||En.strokeColor,backgroundColor:e.backgroundColor||En.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:e.strokeSharpness==="round"?{type:of(e.type)?wn.LEGACY:wn.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(s=>({type:"arrow",id:s})):e.boundElements??[],updated:e.updated??Gg(),link:e.link?Ur(e.link):null,locked:e.locked??!1};("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData);const i={...e,...n,...CV(n),...t};return delete i.strokeSharpness,delete i.boundElementIds,i},a7e=(e,t,n,i)=>{var s;switch(e={...e},e.type){case"text":delete e.rawText;let r=e.fontSize,o=e.fontFamily;if("font"in e){const[m,p]=e.font.split(" ");r=parseFloat(m),o=o7e(p)}const a=typeof e.text=="string"&&e.text||"",l=e.lineHeight||(e.height?mde(e):id(e.fontFamily));return e=ec(e,{fontSize:r,fontFamily:o,text:a,textAlign:e.textAlign||$p,verticalAlign:e.verticalAlign||L6,containerId:e.containerId??null,originalText:e.originalText||a,autoResize:e.autoResize??!0,lineHeight:l}),i!=null&&i.deleteInvisibleElements&&!a&&!e.isDeleted&&(e={...e,originalText:a,isDeleted:!0},e=Qo(e)),e;case"freedraw":return ec(e,{points:e.points,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return ec(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1],crop:e.crop??null});case"line":case"draw":const{startArrowhead:c=null,endArrowhead:d=null}=e;let u=e.x,f=e.y,h=!Array.isArray(e.points)||e.points.length<2?[M(0,0),M(e.width,e.height)]:e.points;return(h[0][0]!==0||h[0][1]!==0)&&({points:h,x:u,y:f}=ne.getNormalizeElementPointsAndCoords(e)),ec(e,{type:"line",startBinding:null,endBinding:null,startArrowhead:c,endArrowhead:d,points:h,x:u,y:f,...cn(e)?{polygon:N4(e.points)?e.polygon??!1:!1}:{},...sg(h)});case"arrow":{const{startArrowhead:m=null,endArrowhead:p="arrow"}=e,U=e.x,b=e.y,y=!Array.isArray(e.points)||e.points.length<2?[M(0,0),M(e.width,e.height)]:e.points,E={type:e.type,startBinding:aL(e,e.startBinding,t,n,"start"),endBinding:aL(e,e.endBinding,t,n,"end"),startArrowhead:m,endArrowhead:p,points:y,x:U,y:b,elbowed:e.elbowed,...sg(y)},_=ve(e)?ec(e,{...E,elbowed:!0,fixedSegments:(s=e.fixedSegments)!=null&&s.length&&E.points.length>=4?e.fixedSegments:null,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}):ec(e,E);return{..._,...ne.getNormalizeElementPointsAndCoords(_)}}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return ec(e,{});case"magicframe":case"frame":return ec(e,{name:e.name??null})}return null},l7e=(e,t)=>{if(e.boundElements){const n=e.boundElements.slice(),i=new Set;e.boundElements=n.reduce((s,r)=>{const o=t.get(r.id);if(o&&!i.has(r.id)){if(i.add(r.id),o.isDeleted)return s;s.push(r),he(o)&&!o.containerId&&(o.containerId=e.id)}return s},[])}},c7e=(e,t)=>{const n=e.containerId?t.get(e.containerId):null;if(e.angle=Te(n)?0:(n==null?void 0:n.angle)??0,!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(i=>i.id===e.id)){const i=(n.boundElements||(n.boundElements=[])).slice();i.push({type:"text",id:e.id}),n.boundElements=i}},d7e=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},wr=(e,t,n)=>{const i=new Set,s=we(e||[]),r=t?we(t):null,o=Ad((e||[]).reduce((l,c)=>{if(c.type==="selection")return l;let d;try{d=a7e(c,s,r,{deleteInvisibleElements:n==null?void 0:n.deleteInvisibleElements})}catch(u){console.error("Error restoring element:",u),d=null}if(d){const u=r==null?void 0:r.get(c.id),f=(n==null?void 0:n.deleteInvisibleElements)&&_l(c);f&&(d=Qo(d,u==null?void 0:u.version)),f&&(d={...d,isDeleted:!0}),i.has(d.id)&&(d={...d,id:Li()}),i.add(d.id),l.push(d)}return l},[]));if(!(n!=null&&n.repairBindings))return o;const a=we(o);for(const l of o)l.frameId&&d7e(l,a),he(l)&&l.containerId?c7e(l,a):l.boundElements&&l7e(l,a),n.refreshDimensions&&he(l)&&Object.assign(l,OV(l,Gn(l,a),a)),De(l)&&(l.startBinding&&(!a.has(l.startBinding.elementId)||!Te(l))&&(l.startBinding=null),l.endBinding&&(!a.has(l.endBinding.elementId)||!Te(l))&&(l.endBinding=null));return o.map(l=>{if(ve(l)&&!HH(l)&&!iV(l.points))return{...l,...Yg(l,a,{points:[M(0,0),l.points[l.points.length-1]]}),index:l.index};if(ve(l)&&l.startBinding&&l.endBinding&&l.startBinding.elementId===l.endBinding.elementId&&l.points.length>1&&l.points.some(([c,d])=>Math.abs(c)>1e6||Math.abs(d)>1e6)){console.error("Fixing self-bound elbow arrow",l.id);const c=a.get(l.startBinding.elementId);return c?{...l,x:c.x+c.width/2,y:c.y-5,width:c.width,height:c.height,points:[M(0,0),M(0,-10),M(c.width/2+5,-10),M(c.width/2+5,c.height/2+5)]}:(console.error("Bound element not found",l.startBinding.elementId),l)}return l})},$Y=(e,t)=>{const n=t?we(t):null;return e.map(i=>{const s=n==null?void 0:n.get(i.id);return s&&(s.version>i.version||s.version===i.version&&s.versionNonce!==i.versionNonce)?Qo(i,s.version):i})},u7e=(e,t,n)=>{const i=t[e];return i!==void 0?i:n[e]},lL={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??u7e("defaultSidebarDockedPreference",e,t)]},Xc=(e,t)=>{var s;e=e||{};const n=Aa(),i={};for(const r of Object.keys(lL))if(r in e){const[o,a]=lL[r](e,n);i[o]=a}for(const[r,o]of Object.entries(n)){const a=e[r],l=t?t[r]:void 0;i[r]=a!==void 0?a:l!==void 0?l:o}return{...i,cursorButton:(t==null?void 0:t.cursorButton)||"up",penDetected:(t==null?void 0:t.penDetected)??(e.penMode?e.penDetected??!1:!1),activeTool:{...sn(n,i.activeTool.type&&r7e[i.activeTool.type]?i.activeTool:{type:"selection"}),lastActiveTool:null,locked:i.activeTool.locked??!1},zoom:{value:ml(j1(e.zoom)?e.zoom:((s=e.zoom)==null?void 0:s.value)??n.zoom.value)},openSidebar:typeof e.openSidebar=="string"?{name:Yr.name}:i.openSidebar,gridSize:Vhe(j1(e.gridSize)?e.gridSize:N6),gridStep:eG(j1(e.gridStep)?e.gridStep:pz),editingFrame:null}},cL=e=>{const t=wr(qt(e.elements),null);return t.length?{...e,elements:t}:null},HE=(e=[],t)=>{const n=[];for(const i of e)if(Array.isArray(i)){const s=cL({status:t,elements:i,id:Li(),created:Date.now()});s&&n.push(s)}else{const s=i,r=cL({...s,id:s.id||Li(),status:s.status||t,created:s.created||Date.now()});r&&n.push(r)}return n},GY=async e=>{let t;if(e.type===Ee.png)try{return await(await Ue(()=>Promise.resolve().then(()=>TW),void 0)).decodePngMetadata(e)}catch(n){throw n.message==="INVALID"?new iu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new iu("Error: cannot restore image")}else if("text"in Blob?t=await e.text():t=await new Promise(n=>{const i=new FileReader;i.readAsText(e,"utf8"),i.onloadend=()=>{i.readyState===FileReader.DONE&&n(i.result)}}),e.type===Ee.svg)try{return i7e({svg:t})}catch(n){throw n.message==="INVALID"?new iu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new iu("Error: cannot restore image")}return t},XY=e=>{var t;return e&&((t=e.name.match(/\.(json|excalidraw|png|svg)$/))==null?void 0:t[1])||null},f7e=e=>e==="png"||e==="svg",KI=e=>{const t=XY(e);return t==="png"||t==="svg"},jY=e=>!!e&&Object.values(ng).includes(e),up=e=>{const{type:t}=e||{};return jY(t)},YY=async(e,t,n,i)=>{const s=await GY(e);let r;try{try{r=JSON.parse(s)}catch(o){throw up(e)?new iu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):o}if(W3e(r))return{type:Ee.excalidraw,data:{elements:wr(r.elements,n,{repairBindings:!0,deleteInvisibleElements:!0}),appState:Xc({theme:t==null?void 0:t.theme,fileHandle:i||e.handle||null,...Lj(r.appState||{}),...t?K0(r.elements||[],t):{}},t),files:r.files||{}}};if(DY(r))return{type:Ee.excalidrawlib,data:r};throw new Error("Error: invalid file")}catch(o){throw o instanceof iu?o:new Error("Error: invalid file")}},ZI=async(e,t,n,i)=>{const s=await YY(e,t,n,i);if(s.type!==Ee.excalidraw)throw new Error("Error: invalid file");return s.data},WY=(e,t="unpublished")=>{const n=JSON.parse(e);if(!DY(n))throw new Error("Invalid library");const i=n.libraryItems||n.library;return HE(i,t)},h7e=async(e,t="unpublished")=>WY(await GY(e),t),k5=async e=>new Promise(async(t,n)=>{try{Wp(e)&&(e=await e),e.toBlob(i=>{if(!i)return n(new Nme("Error: Canvas too big","CANVAS_POSSIBLY_TOO_BIG"));t(i)})}catch(i){n(i)}}),g7e=async e=>{try{const t=await window.crypto.subtle.digest("SHA-1",await w2(e));return Pz(new Uint8Array(t))}catch(t){return console.error(t),PH(40)}},KY=async e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const s=i.result;t(s)},i.onerror=s=>n(s),i.readAsDataURL(e)}),m7e=(e,t)=>`data:${t};base64,${IY(x5(e),!0)}`,p7e=e=>SY(e.slice(e.indexOf(",")+1)),ZY=async(e,t)=>{if(e.type===Ee.svg)return e;const[n,i]=await Promise.all([Ue(()=>import("./pica-DDHCQIrT.js").then(r=>r.p),__vite__mapDeps([2,3])).then(r=>r.default),Ue(()=>import("./image-blob-reduce.esm-B6b2_-a4.js"),__vite__mapDeps([])).then(r=>r.default)]),s=i({pica:n({features:["js","wasm"]})});if(t.outputType){const{outputType:r}=t;s._create_blob=function(o){return this.pica.toBlob(o.out_canvas,r,.8).then(a=>(o.out_blob=a,o))}}if(!up(e))throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"});return new File([await s.toBlob(e,{max:t.maxWidthOrHeight,alpha:!0})],e.name,{type:t.outputType||e.type})},dL=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:Ee.svg}),U7e=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"})}if(!n.ok)throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"});const i=await n.blob();if(i.type&&up(i)){const s=t||i.name||"";return new File([i],s,{type:i.type})}throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"})},b7e=async e=>{var t,n;if(gf)try{return await(e instanceof DataTransferItem?e:(n=(t=e.dataTransfer)==null?void 0:t.items)==null?void 0:n[0]).getAsFileSystemHandle()||null}catch(i){return console.warn(i.name,i.message),null}return null},y7e=async e=>{let t=null;const n=[...new Uint8Array(await w2(e.slice(0,15)))].join(" "),i={png:/^137 80 78 71 13 10 26 10\b/,jpg:/^255 216 255\b/,gif:/^71 73 70 56 57 97\b/,webp:/^82 73 70 70 \d+ \d+ \d+ \d+ 87 69 66 80 86 80 56\b/};for(const s of Object.keys(i))if(n.match(i[s])){t=Ee[s];break}return t||e.type||null},Vb=(e,t,n)=>new File([e],n||"",{type:t}),uL=Symbol("fileNormalized"),fp=async e=>{var t,n,i;if(e[uL])return e;if((t=e==null?void 0:e.name)!=null&&t.endsWith(".excalidrawlib"))e=Vb(e,Ee.excalidrawlib,e.name);else if((n=e==null?void 0:e.name)!=null&&n.endsWith(".excalidraw"))e=Vb(e,Ee.excalidraw,e.name);else if(!e.type||(i=e.type)!=null&&i.startsWith("image/")){const s=await y7e(e);s&&s!==e.type&&(e=Vb(e,s,e.name))}return e[uL]=!0,e},w2=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.onload=s=>{var r;if(!((r=s.target)!=null&&r.result))return n(new Error("Couldn't convert blob to ArrayBuffer"));t(s.target.result)},i.readAsArrayBuffer(e)}),Uo=32,Gt=12,jc=256,qY=50,qd="NOT_SPREADSHEET",hp="VALID_SPREADSHEET",v1=e=>{const t=/^([-+]?)[$]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},C7=(e,t)=>e.slice(1).every(n=>v1(n[t])!==null),fL=e=>{const t=e[0].length;if(t>2)return{type:qd,reason:"More than 2 columns"};if(t===1){if(!C7(e,0))return{type:qd,reason:"Value is not numeric"};const l=v1(e[0][0])===null,c=(l?e.slice(1):e).map(d=>v1(d[0]));return c.length<2?{type:qd,reason:"Less than two rows"}:{type:hp,spreadsheet:{title:l?e[0][0]:null,labels:null,values:c}}}const n=C7(e,0),i=C7(e,1);if(!n&&!i)return{type:qd,reason:"Value is not numeric"};const[s,r]=i?[0,1]:[1,0],o=v1(e[0][r])===null,a=o?e.slice(1):e;return a.length<2?{type:qd,reason:"Less than 2 rows"}:{type:hp,spreadsheet:{title:o?e[0][r]:null,labels:a.map(l=>l[s]),values:a.map(l=>v1(l[r]))}}},E7e=e=>{const t=[];for(let n=0;n<e[0].length;n++){const i=[];for(let s=0;s<e.length;s++)i.push(e[s][n]);t.push(i)}return t},v7e=e=>{let t=e.trim().split(`
`).map(r=>r.trim().split("	"));if(t.length&&t[0].length!==2&&(t=e.trim().split(`
`).map(r=>r.trim().split(","))),t.length===0)return{type:qd,reason:"No values"};const n=t[0].length;if(!t.every(r=>r.length===n))return{type:qd,reason:"All rows don't have same number of columns"};const s=fL(t);if(s.type!==hp){const r=fL(E7e(t));if(r.type===hp)return r}return s},R5=Xne(Vne),xo={fillStyle:"hachure",fontFamily:Td,fontSize:$l,opacity:100,roughness:1,strokeColor:Je.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:lr.MIDDLE,locked:!1},QY=e=>{const t=(Uo+Gt)*e.values.length+Gt,n=jc+Gt*2;return{chartWidth:t,chartHeight:n}},_7e=(e,t,n,i,s)=>{var r;return((r=e.labels)==null?void 0:r.map((o,a)=>_r({groupIds:[i],backgroundColor:s,...xo,text:o.length>8?`${o.slice(0,5)}...`:o,x:t+a*(Uo+Gt)+Gt*2,y:n+Gt/2,width:Uo,angle:5.87,fontSize:lh.sm,textAlign:"center",verticalAlign:"top"})))||[]},w7e=(e,t,n,i,s)=>{const r=_r({groupIds:[i],backgroundColor:s,...xo,x:t-Gt,y:n-Gt,text:"0",textAlign:"right"}),o=_r({groupIds:[i],backgroundColor:s,...xo,x:t-Gt,y:n-jc-r.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[r,o]},T7e=(e,t,n,i,s)=>{const{chartWidth:r,chartHeight:o}=QY(e),a=Hc({backgroundColor:s,groupIds:[i],...xo,type:"line",x:t,y:n,width:r,points:[M(0,0),M(r,0)]}),l=Hc({backgroundColor:s,groupIds:[i],...xo,type:"line",x:t,y:n,height:o,points:[M(0,0),M(0,-280)]}),c=Hc({backgroundColor:s,groupIds:[i],...xo,type:"line",x:t,y:n-jc-Gt,strokeStyle:"dotted",width:r,opacity:qY,points:[M(0,0),M(r,0)]});return[a,l,c]},JY=(e,t,n,i,s,r)=>{const{chartWidth:o}=QY(e),a=e.title?_r({backgroundColor:s,groupIds:[i],...xo,text:e.title,x:t+o/2,y:n-jc-Gt*2-$l,roundness:null,textAlign:"center"}):null;return[...a?[a]:[],..._7e(e,t,n,i,s),...w7e(e,t,n,i,s),...T7e(e,t,n,i,s)]},I7e=(e,t,n)=>{const i=Math.max(...e.values),s=Li(),r=R5[Math.floor(Math.random()*R5.length)];return[...e.values.map((a,l)=>{const c=a/i*jc;return Ta({backgroundColor:r,groupIds:[s],...xo,type:"rectangle",x:t+l*(Uo+Gt)+Gt,y:n-c-Gt,width:Uo,height:c})}),...JY(e,t,n,s,r)]},S7e=(e,t,n)=>{const i=Math.max(...e.values),s=Li(),r=R5[Math.floor(Math.random()*R5.length)];let o=0;const a=[];for(const p of e.values){const U=o*(Uo+Gt),b=-(p/i)*jc;a.push([U,b]),o++}const l=Math.max(...a.map(p=>p[0])),c=Math.max(...a.map(p=>p[1])),d=Math.min(...a.map(p=>p[0])),u=Math.min(...a.map(p=>p[1])),f=Hc({backgroundColor:r,groupIds:[s],...xo,type:"line",x:t+Gt+Uo/2,y:n-Gt,height:c-u,width:l-d,strokeWidth:2,points:a}),h=e.values.map((p,U)=>{const b=U*(Uo+Gt)+Gt/2,y=-(p/i)*jc+Gt/2;return Ta({backgroundColor:r,groupIds:[s],...xo,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+b+Uo/2,y:n+y-Gt*2,width:Gt,height:Gt})}),m=e.values.map((p,U)=>{const b=U*(Uo+Gt)+Gt/2,y=p/i*jc+Gt/2+Gt;return Hc({backgroundColor:r,groupIds:[s],...xo,type:"line",x:t+b+Uo/2+Gt/2,y:n-y,height:y,strokeStyle:"dotted",opacity:qY,points:[M(0,0),M(0,y)]})});return[...JY(e,t,n,s,r),f,...m,...h]},C7e=(e,t,n,i)=>e==="line"?S7e(t,n,i):I7e(t,n,i),qI="clipboard"in navigator&&"writeText"in navigator.clipboard,QI="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,x7e=e=>!!([jr.excalidraw,jr.excalidrawClipboard,jr.excalidrawClipboardWithAPI].includes(e==null?void 0:e.type)&&Array.isArray(e.elements)),A7e=({types:e,files:t})=>{var i,s,r,o;!e&&!t&&console.warn("createPasteEvent: no types or files provided");const n=new ClipboardEvent(te.PASTE,{clipboardData:new DataTransfer});if(e)for(const[a,l]of Object.entries(e)){if(typeof l!="string"){t=t||[],t.push(l);continue}try{if((i=n.clipboardData)==null||i.items.add(l,a),((s=n.clipboardData)==null?void 0:s.getData(a))!==l)throw new Error(`Failed to set "${a}" as clipboardData item`)}catch(c){throw new Error(c.message)}}if(t){let a=-1;for(const l of t){a++;try{if((r=n.clipboardData)==null||r.items.add(l),((o=n.clipboardData)==null?void 0:o.files[a])!==l)throw new Error(`Failed to set file "${l.name}" as clipboardData item`)}catch(c){throw new Error(c.message)}}}return n},M7e=({elements:e,files:t})=>{const n=we(e),i=new Set(e.filter(a=>_e(a)));let s=!1;const r=e.reduce((a,l)=>(Jn(l)&&(s=!0,t&&t[l.fileId]&&(a[l.fileId]=t[l.fileId])),a),{});s&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");const o={type:jr.excalidrawClipboard,elements:e.map(a=>{if(Vs(a,n)&&!i.has(Vs(a,n))){const l=cd(a);return Dn(l,n,{frameId:null}),l}return a}),files:t?r:void 0};return JSON.stringify(o)},k7e=async(e,t,n)=>{const i=M7e({elements:e,files:t});await kd({[Ee.excalidrawClipboard]:i,[Ee.text]:i},n)},R7e=e=>{const t=v7e(e);return t.type===hp?{spreadsheet:t.spreadsheet}:null};function eW(e){var n;let t=[];for(const i of e.childNodes)if(i.nodeType===3){const s=(n=i.textContent)==null?void 0:n.trim();s&&t.push({type:"text",value:s})}else if(i instanceof HTMLImageElement){const s=i.getAttribute("src");s&&s.startsWith("http")&&t.push({type:"imageUrl",value:s})}else t=t.concat(eW(i));return t}const D7e=e=>{const t=e.value;try{const n=new DOMParser().parseFromString(t,Ee.html),i=eW(n.body);if(i.length)return{type:"mixedContent",value:i}}catch(n){console.error(`error in parseHTMLFromPaste: ${n.message}`)}return null},L7e=async()=>{var n,i,s,r;const e={};let t;try{t=await((n=navigator.clipboard)==null?void 0:n.read())}catch(o){try{if((i=navigator.clipboard)!=null&&i.readText){console.warn(`navigator.clipboard.readText() failed (${o.message}). Failling back to navigator.clipboard.read()`);const a=await((s=navigator.clipboard)==null?void 0:s.readText());if(a)return{[Ee.text]:a}}}catch(a){if((r=navigator.clipboard)!=null&&r.read)console.warn(`navigator.clipboard.readText() failed (${a.message}). Failling back to navigator.clipboard.read()`);else{if(a.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${a.message}`),e;throw a}}throw o}for(const o of t)for(const a of o.types)if(Oz(rie,a))try{if(a===Ee.text||a===Ee.html)e[a]=await(await o.getType(a)).text();else if(jY(a)){const l=await o.getType(a),c=Vb(l,a,void 0);e[a]=c}else throw new vo(`Unsupported clipboard type: ${a}`)}catch(l){console.warn(l instanceof vo?l.message:`Cannot retrieve ${a} from clipboardItem: ${l.message}`)}return Object.keys(e).length===0&&console.warn("No clipboard data found from clipboard.read()."),e},P7e=async(e,t=!1)=>{try{const n=e.findByType(Ee.html),i=!t&&n&&D7e(n);return i?i.value.every(s=>s.type==="text")?{type:"text",value:e.getData(Ee.text)??i.value.map(s=>s.value).join(`
`).trim()}:i:{type:"text",value:(e.getData(Ee.text)||"").trim()}}catch{return{type:"text",value:""}}},N7e=function(e){return this.find(t=>t.type===e)||null},O7e=function(e){const t=this.find(n=>n.type===e);return(t==null?void 0:t.value)??null},F7e=function(){return this.filter(e=>e.kind==="file")},B7e=e=>{var i,s;let t;nW(e)?t=(i=e.clipboardData)==null?void 0:i.items:t=(s=e.dataTransfer)==null?void 0:s.items;const n=new Set;for(const r of Array.from(t||[]))n.has(r.type)||n.add(r.type);return n},D5=async e=>{var i,s;let t;nW(e)?t=(i=e.clipboardData)==null?void 0:i.items:t=(s=e.dataTransfer)==null?void 0:s.items;const n=(await Promise.all(Array.from(t||[]).map(async r=>{var o;if(r.kind==="file"){let a=r.getAsFile();if(a){const l=await b7e(r);return a=await fp(a),{type:a.type,kind:"file",file:a,fileHandle:l}}}else if(r.kind==="string"){const{type:a}=r;let l;return"clipboardData"in e&&e.clipboardData?l=(o=e.clipboardData)==null?void 0:o.getData(a):l=await new Promise(c=>{r.getAsString(d=>c(d))}),{type:a,kind:"string",value:l}}return null}))).filter(r=>r!=null);return Object.assign(n,{findByType:N7e,getData:O7e,getFiles:F7e})},tW=async(e,t=!1)=>{const n=await P7e(e,t);if(n.type==="mixedContent")return{mixedContent:n.value};try{const i=!t&&R7e(n.value);if(i)return i}catch(i){console.error(i)}try{const i=JSON.parse(n.value),s=i.type===jr.excalidrawClipboardWithAPI;if(x7e(i))return{elements:i.elements,files:i.files,text:t?JSON.stringify(i.elements,null,2):void 0,programmaticAPI:s}}catch{}return{text:n.value}},z7e=async e=>{try{await navigator.clipboard.write([new ClipboardItem({[Ee.png]:e})])}catch(t){if(Wp(e))await navigator.clipboard.write([new ClipboardItem({[Ee.png]:await e})]);else throw t}},kd=async(e,t)=>{var s,r;e=e||"";const n=Object.entries(typeof e=="string"?{[Ee.text]:e}:e);try{if(t){for(const[o,a]of n)if((s=t.clipboardData)==null||s.setData(o,a),((r=t.clipboardData)==null?void 0:r.getData(o))!==a)throw new Error("Failed to setData on clipboardEvent");return}}catch(o){console.error(o)}const i=n.find(([o])=>o===Ee.text);if(qI&&i)try{await navigator.clipboard.writeText(i[1]);return}catch(o){console.error(o)}if(i&&!H7e(i[1]))throw new Error("Error copying to clipboard.")},H7e=e=>{e||(e=" ");const t=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";const i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${i}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let s=!1;try{n.select(),n.setSelectionRange(0,n.value.length),s=document.execCommand("copy")}catch(r){console.error(r)}return n.remove(),s},nW=e=>e.type===te.PASTE||e.type===te.COPY||e.type===te.CUT,VE=(e,{selectedElementIds:t},n)=>{e=qt(e);const i=n&&oi(e,{selectedElementIds:t});let s=null,r=i?Ze(e,{selectedElementIds:t},{includeBoundTextElement:!0}):e;return i&&(r.length===1&&_e(r[0])?(s=r[0],r=IT(e,s)):r.length>1&&(r=Ze(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:s,exportedElements:ua(r)}},$E=async(e,t,n,i,{exportBackground:s,exportPadding:r=$g,viewBackgroundColor:o,name:a=n.name||Ez,fileHandle:l=null,exportingFrame:c=null})=>{if(t.length===0)throw new Error(x("alerts.cannotExportEmptyCanvas"));if(e==="svg"||e==="clipboard-svg"){const u=YI(t,{exportBackground:s,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:o,exportPadding:r,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&e==="svg"},i,{exportingFrame:c});if(e==="svg")return M5(u.then(f=>new Blob([hie+f.outerHTML],{type:Ee.svg})),{description:"Export to SVG",name:a,extension:n.exportEmbedScene?"excalidraw.svg":"svg",mimeTypes:[ng.svg],fileHandle:l});if(e==="clipboard-svg"){const f=await u.then(h=>h.outerHTML);try{await kd(f)}catch{throw new Error(x("errors.copyToSystemClipboardFailed"))}return}}const d=VY(t,n,i,{exportBackground:s,viewBackgroundColor:o,exportPadding:r,exportingFrame:c});if(e==="png"){let u=k5(d);return n.exportEmbedScene&&(u=u.then(f=>Ue(()=>Promise.resolve().then(()=>TW),void 0).then(({encodePngMetadata:h})=>h({blob:f,metadata:im(t,n,i,"local")})))),M5(u,{description:"Export to PNG",name:a,extension:n.exportEmbedScene?"excalidraw.png":"png",mimeTypes:[ng.png],fileHandle:l})}else if(e==="clipboard")try{const u=k5(d);await z7e(u)}catch(u){throw console.warn(u),u.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(x("canvasError.canvasTooBig")):z0&&u.name==="TypeError"?new Error(`${x("alerts.couldNotCopyToClipboard")}

${x("hints.firefox_clipboard_write")}`):new Error(x("alerts.couldNotCopyToClipboard"))}else throw new Error("Unsupported export type")},V7e=async(e,t,n,i)=>{const{exportBackground:s,viewBackgroundColor:r,fileHandle:o}=t,a=XY(o);if(!o||!f7e(a))throw new Error("fileHandle should exist and should be of type svg or png when resaving");t={...t,exportEmbedScene:!0};const{exportedElements:l,exportingFrame:c}=VE(e,t,!1);return await $E(a,l,t,n,{exportBackground:s,viewBackgroundColor:r,name:i,fileHandle:o,exportingFrame:c}),{fileHandle:o}},$7e=ue({name:"changeProjectName",label:"labels.fileTitle",trackEvent:!1,perform:(e,t,n)=>({appState:{...t,name:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t,appProps:n,data:i,app:s})=>g(aEe,{label:x("labels.fileTitle"),value:s.getName(),onChange:r=>t(r),ignoreFocus:(i==null?void 0:i.ignoreFocus)??!1})}),G7e=ue({name:"changeExportScale",label:"imageExportDialog.scale",trackEvent:{category:"export",action:"scale"},perform:(e,t,n)=>({appState:{...t,exportScale:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=qt(e),r=oi(i,t)?Ze(i,t):i;return g(fe,{children:A9.map(o=>{const[a,l]=s7e(r,$g,o),c=`${x("imageExportDialog.label.scale")} ${o}x (${a}x${l})`;return g(qe,{size:"small",type:"radio",icon:`${o}x`,name:"export-canvas-scale",title:c,"aria-label":c,id:"export-canvas-scale",checked:o===t.exportScale,onChange:()=>n(o)},o)})})}}),X7e=ue({name:"changeExportBackground",label:"imageExportDialog.label.withBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(e,t,n)=>({appState:{...t,exportBackground:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g(BI,{checked:e.exportBackground,onChange:n=>t(n),children:x("imageExportDialog.label.withBackground")})}),iW=ue({name:"changeExportEmbedScene",label:"imageExportDialog.tooltip.embedScene",trackEvent:{category:"export",action:"embedScene"},perform:(e,t,n)=>({appState:{...t,exportEmbedScene:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>P(BI,{checked:e.exportEmbedScene,onChange:n=>t(n),children:[x("imageExportDialog.label.embedScene"),g(Nl,{label:x("imageExportDialog.tooltip.embedScene"),long:!0,children:g("div",{className:"excalidraw-tooltip-icon",children:age})})]})}),L5=ue({name:"saveToActiveFile",label:"buttons.save",icon:aE,trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.saveToActiveFile&&!!t.fileHandle&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{const s=!!t.fileHandle;try{const{fileHandle:r}=KI(t.fileHandle)?await V7e(e,t,i.files,i.getName()):await RY(e,t,i.files,i.getName());return{captureUpdate:q.EVENTUALLY,appState:{...t,fileHandle:r,toast:s?{message:r!=null&&r.name?x("toast.fileSavedToFilename").replace("{filename}",`"${r.name}"`):x("toast.fileSaved")}:null}}}catch(r){return(r==null?void 0:r.name)!=="AbortError"?console.error(r):console.warn(r),{captureUpdate:q.EVENTUALLY}}},keyTest:e=>e.key===$.S&&e[$.CTRL_OR_CMD]&&!e.shiftKey}),sW=ue({name:"saveFileToDisk",label:"exportDialog.disk_title",icon:aE,viewMode:!0,trackEvent:{category:"export"},perform:async(e,t,n,i)=>{try{const{fileHandle:s}=await RY(e,{...t,fileHandle:null},i.files,i.getName());return{captureUpdate:q.EVENTUALLY,appState:{...t,openDialog:null,fileHandle:s,toast:{message:x("toast.fileSaved")}}}}catch(s){return(s==null?void 0:s.name)!=="AbortError"?console.error(s):console.warn(s),{captureUpdate:q.EVENTUALLY}}},keyTest:e=>e.key===$.S&&e.shiftKey&&e[$.CTRL_OR_CMD],PanelComponent:({updateData:e})=>g(qe,{type:"button",icon:ige,title:x("buttons.saveAs"),"aria-label":x("buttons.saveAs"),showAriaLabel:Nn().formFactor==="phone",hidden:!gf,onClick:()=>e(null),"data-testid":"save-as-button"})}),M_=ue({name:"loadScene",label:"buttons.load",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.loadScene&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{try{const{elements:s,appState:r,files:o}=await Y3e(t,e);return{elements:s,appState:r,files:o,captureUpdate:q.IMMEDIATELY}}catch(s){return(s==null?void 0:s.name)==="AbortError"?(console.warn(s),!1):{elements:e,appState:{...t,errorMessage:s.message},files:i.files,captureUpdate:q.EVENTUALLY}}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.O}),j7e=ue({name:"exportWithDarkMode",label:"imageExportDialog.label.darkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(e,t,n)=>({appState:{...t,exportWithDarkMode:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:g(oEe,{value:e.exportWithDarkMode?be.DARK:be.LIGHT,onChange:n=>{t(n===be.DARK)},title:x("imageExportDialog.label.darkMode")})})});let rW="{}";const Y7e=ue({name:"copyStyles",label:"labels.copyStyles",icon:UG,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=[],r=e.find(o=>t.selectedElementIds[o.id]);if(s.push(r),r&&Ki(r)){const o=Ne(r,i.scene.getNonDeletedElementsMap());s.push(o)}return r&&(rW=JSON.stringify(s)),{appState:{...t,toast:{message:x("toast.copyStyles")}},captureUpdate:q.EVENTUALLY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.C}),W7e=ue({name:"pasteStyles",label:"labels.pasteStyles",icon:UG,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=JSON.parse(rW),r=s[0],o=s[1];if(!zH(r))return{elements:e,captureUpdate:q.EVENTUALLY};const a=Ze(e,t,{includeBoundTextElement:!0}),l=a.map(c=>c.id);return{elements:e.map(c=>{if(l.includes(c.id)){let d=r;if(he(c)&&c.containerId&&(d=o),!d)return c;let u=xe(c,{backgroundColor:d==null?void 0:d.backgroundColor,strokeWidth:d==null?void 0:d.strokeWidth,strokeColor:d==null?void 0:d.strokeColor,strokeStyle:d==null?void 0:d.strokeStyle,fillStyle:d==null?void 0:d.fillStyle,opacity:d==null?void 0:d.opacity,roughness:d==null?void 0:d.roughness,roundness:d.roundness?dde(d.roundness.type,c)?d.roundness:ude(c):null});if(he(u)){const f=d.fontSize||$l,h=d.fontFamily||Td;u=xe(u,{fontSize:f,fontFamily:h,textAlign:d.textAlign||$p,lineHeight:d.lineHeight||id(h)});let m=null;u.containerId&&(m=a.find(p=>he(u)&&p.id===u.containerId)||null),fs(u,m,i.scene)}return u.type==="arrow"&&Te(d)&&(u=xe(u,{startArrowhead:d.startArrowhead,endArrowhead:d.endArrowhead})),_e(c)&&(u=xe(u,{roundness:null,backgroundColor:"transparent"})),u}return c}),captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.V}),JI=ue({name:"toggleShortcuts",label:"welcomeScreen.defaults.helpHint",icon:tge,viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(e,t,n,{focusContainer:i})=>{var s,r;return((s=t.openDialog)==null?void 0:s.name)==="help"&&i(),{appState:{...t,openDialog:((r=t.openDialog)==null?void 0:r.name)==="help"?null:{name:"help"},openMenu:null,openPopup:null},captureUpdate:q.EVENTUALLY}},keyTest:e=>e.key===$.QUESTION_MARK}),K7e=e=>{if(e.length>=2){const t=e[0].groupIds;for(const n of t)if(e.reduce((i,s)=>i&&$0(s,n),!0))return!0}return!1},hL=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});return i.length>=2&&!K7e(i)&&!bV(i)},Z7e=ue({name:"group",label:"labels.group",icon:e=>g(RR,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=wT(i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}));if(s.length<2)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY};const r=zc(t);if(r.length===1){const U=r[0],b=new Set(Ot(e,U).map(_=>_.id)),y=new Set(s.map(_=>_.id));if(new Set([...Array.from(b),...Array.from(y)]).size===b.size)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY}}let o=[...e];new Set(s.map(U=>U.frameId)).size>1&&kue(s).forEach((b,y)=>{Jy(b,i.scene.getNonDeletedElementsMap())});const l=Li(),c=we(s);o=o.map(U=>c.get(U.id)?xe(U,{groupIds:Iue(U.groupIds,l,t.editingGroupId)}):U);const d=Ot(o,l),u=d[d.length-1],f=o.lastIndexOf(u),h=o.slice(f+1),m=o.slice(0,f).filter(U=>!$0(U,l)),p=Mo([...m,...d,...h],we(d));return{appState:{...t,...cV(l,{...t,selectedGroupIds:{}},qt(o))},elements:p,captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>hL(e,t,i),keyTest:e=>!e.shiftKey&&e[$.CTRL_OR_CMD]&&e.key===$.G,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!hL(e,t,i),type:"button",icon:g(RR,{theme:t.theme}),onClick:()=>n(null),title:`${x("labels.group")}  ${J("CtrlOrCmd+G")}`,"aria-label":x("labels.group"),visible:oi(qt(e),t)})}),q7e=ue({name:"ungroup",label:"labels.ungroup",icon:e=>g(DR,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=zc(t),r=we(e);if(s.length===0)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY};let o=[...e];const a=[];o=o.map(f=>{Vt(f)&&a.push(f.id);const h=Sue(f.groupIds,t.selectedGroupIds);return h.length===f.groupIds.length?f:xe(f,{groupIds:h})});const l=Fi(t,qt(o),t,null),c=i.scene.getSelectedElements(t),d=new Set(c.filter(f=>f.frameId).map(f=>f.frameId));return _T(e).filter(f=>d.has(f.id)).forEach(f=>{f&&(o=Wg(o,ha(o,f,t,r),f,i))}),l.selectedElementIds=Object.entries(l.selectedElementIds).reduce((f,[h,m])=>(m&&!a.includes(h)&&(f[h]=!0),f),{}),{appState:{...t,...l},elements:o,captureUpdate:q.IMMEDIATELY}},keyTest:e=>e.shiftKey&&e[$.CTRL_OR_CMD]&&e.key===$.G.toUpperCase(),predicate:(e,t)=>zc(t).length>0,PanelComponent:({elements:e,appState:t,updateData:n})=>g(qe,{type:"button",hidden:zc(t).length===0,icon:g(DR,{theme:t.theme}),onClick:()=>n(null),title:`${x("labels.ungroup")}  ${J("CtrlOrCmd+Shift+G")}`,"aria-label":x("labels.ungroup"),visible:oi(qt(e),t)})}),oW=(e,t,n,i,s,r,o)=>{e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+i-r,n),e.quadraticCurveTo(t+i,n,t+i,n+r),e.lineTo(t+i,n+s-r),e.quadraticCurveTo(t+i,n+s,t+i-r,n+s),e.lineTo(t+r,n+s),e.quadraticCurveTo(t,n+s,t,n+s-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath(),e.fill(),o&&(e.strokeStyle=o),e.stroke()};function Q7e(e){let t=0;if(e.length===0)return t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)-t+i}return t}const GE=(e,t)=>`hsl(${Math.abs(Q7e((t==null?void 0:t.id)||e))%37*10}, 100%, 83%)`,J7e=e=>{var n;const t=(n=e==null?void 0:e.trim())==null?void 0:n.codePointAt(0);return(t?String.fromCodePoint(t):"?").toUpperCase()},eve=({context:e,renderConfig:t,appState:n,normalizedWidth:i,normalizedHeight:s})=>{for(const[r,o]of t.remotePointerViewportCoords){let{x:a,y:l}=o;const c=n.collaborators.get(r);a-=n.offsetLeft,l-=n.offsetTop;const d=11,u=14,f=a<0||a>i-d||l<0||l>s-u;a=Math.max(a,0),a=Math.min(a,i-d),l=Math.max(l,0),l=Math.min(l,s-u);const h=GE(r,c);e.save(),e.strokeStyle=h,e.fillStyle=h;const m=t.remotePointerUserStates.get(r),p=f||m===tu.IDLE||m===tu.AWAY;p&&(e.globalAlpha=.3),t.remotePointerButton.get(r)==="down"&&(e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=3,e.strokeStyle="#ffffff88",e.stroke(),e.closePath(),e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=h,e.stroke(),e.closePath());const U=n.theme===be.DARK?"#2f6330":iie,b=c==null?void 0:c.isSpeaking;b&&(e.fillStyle=U,e.strokeStyle=U,e.lineWidth=10,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill()),e.fillStyle=pU,e.strokeStyle=pU,e.lineWidth=6,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill(),e.fillStyle=h,e.strokeStyle=h,e.lineWidth=2,e.lineJoin="round",e.beginPath(),p?(e.moveTo(a-1,l-1),e.lineTo(a-1,l+15),e.lineTo(a+5,l+10),e.lineTo(a+12,l+9),e.closePath(),e.fill()):(e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.fill(),e.stroke());const y=t.remotePointerUsernames.get(r)||"";if(!f&&y){e.font="600 12px sans-serif";const E=(b?a+0:a)+d/2,_=(b?l+0:l)+u+2,I=5,k=3,w=e.measureText(y),T=w.actualBoundingBoxDescent+w.actualBoundingBoxAscent,A=Math.max(T,12),S=E-1,D=_-1,N=w.width+2+I*2+2,L=A+2+k*2+2;if(e.roundRect?(e.beginPath(),e.roundRect(S,D,N,L,8),e.fillStyle=h,e.fill(),e.strokeStyle=pU,e.stroke(),b&&(e.beginPath(),e.roundRect(S-2,D-2,N+4,L+4,8),e.strokeStyle=U,e.stroke())):oW(e,S,D,N,L,8,pU),e.fillStyle=nie,e.fillText(y,E+I+1,_+k+w.actualBoundingBoxAscent+Math.floor((A-T)/2)+2),b){e.fillStyle=U;const j=8,Y=8,G=5;e.fillRect(S+N+Y,D+(L/2-j/2),2,j),e.fillRect(S+N+Y+G,D+(L/2-j*2/2),2,j*2),e.fillRect(S+N+Y+G*2,D+(L/2-j/2),2,j)}}e.restore(),e.closePath()}},gL=({color:e,onClick:t,name:n,src:i,className:s})=>{const r=J7e(n),[o,a]=C.useState(!1),l=!o&&i,c=l?void 0:{background:e};return g("div",{className:ae("Avatar",s),style:c,onClick:t,children:l?g("img",{className:"Avatar-img",src:i,alt:r,referrerPolicy:"no-referrer",onError:()=>a(!0)}):r})};ue({name:"goToCollaborator",label:"Go to a collaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(e,t,n)=>{var i;return Ce(n,"actionGoToCollaborator: collaborator should be defined when actionGoToCollaborator is called"),!n.socketId||((i=t.userToFollow)==null?void 0:i.socketId)===n.socketId||n.isCurrentUser?{appState:{...t,userToFollow:null},captureUpdate:q.EVENTUALLY}:{appState:{...t,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:t.openMenu==="canvas"?null:t.openMenu},captureUpdate:q.EVENTUALLY}},PanelComponent:({updateData:e,data:t,appState:n})=>{const{socketId:i,collaborator:s,withName:r,isBeingFollowed:o}=t,a=GE(i,s),l=ae({"is-followed":o,"is-current-user":s.isCurrentUser===!0,"is-speaking":s.isSpeaking,"is-in-call":s.isInCall,"is-muted":s.isMuted}),c=s.isInCall?s.isSpeaking?P("div",{className:"UserList__collaborator-status-icon-speaking-indicator",title:x("userList.hint.isSpeaking"),children:[g("div",{}),g("div",{}),g("div",{})]}):s.isMuted?g("div",{className:"UserList__collaborator-status-icon-microphone-muted",title:x("userList.hint.micMuted"),children:hme}):g("div",{title:x("userList.hint.inCall"),children:fme}):null;return r?P("div",{className:`dropdown-menu-item dropdown-menu-item-base UserList__collaborator ${l}`,style:{"--avatar-size":"1.5rem"},onClick:()=>e(s),children:[g(gL,{color:a,onClick:()=>{},name:s.username||"",src:s.avatarUrl,className:l}),g("div",{className:"UserList__collaborator-name",children:s.username}),P("div",{className:"UserList__collaborator-status-icons","aria-hidden":!0,children:[o&&g("div",{className:"UserList__collaborator-status-icon-is-followed",title:x("userList.hint.followStatus"),children:eI}),c]})]}):P("div",{className:`UserList__collaborator UserList__collaborator--avatar-only ${l}`,children:[g(gL,{color:a,onClick:()=>{e(s)},name:s.username||"",src:s.avatarUrl,className:l}),c&&g("div",{className:"UserList__collaborator-status-icon",children:c})]})}});const tve=ue({name:"addToLibrary",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(const r of yz)if(s.some(o=>o.type===r))return{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:x(`errors.libraryElementTypeError.${r}`)}};return i.library.getLatestLibrary().then(r=>i.library.setLibrary([{id:Li(),status:"unpublished",elements:s.map(cd),created:Date.now()},...r])).then(()=>({captureUpdate:q.EVENTUALLY,appState:{...t,toast:{message:x("toast.addedToLibrary")}}})).catch(r=>({captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:r.message}}))},label:"labels.addToLibrary"}),Xs=(e,t)=>{const n=t.scene.getSelectedElements(e);return qy(n,t.scene.getNonDeletedElementsMap(),e).length>1&&!n.some(i=>_e(i))},sm=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=ofe(s,i,n.scene,t),o=we(r);return pg(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"alignTop",label:"labels.alignTop",icon:SR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"start",axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_UP,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:SR,onClick:()=>n(null),title:`${x("labels.alignTop")}  ${J("CtrlOrCmd+Shift+Up")}`,"aria-label":x("labels.alignTop"),visible:oi(qt(e),t)})});ue({name:"alignBottom",label:"labels.alignBottom",icon:CR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"end",axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_DOWN,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:CR,onClick:()=>n(null),title:`${x("labels.alignBottom")}  ${J("CtrlOrCmd+Shift+Down")}`,"aria-label":x("labels.alignBottom"),visible:oi(qt(e),t)})});ue({name:"alignLeft",label:"labels.alignLeft",icon:xR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"start",axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_LEFT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:xR,onClick:()=>n(null),title:`${x("labels.alignLeft")}  ${J("CtrlOrCmd+Shift+Left")}`,"aria-label":x("labels.alignLeft"),visible:oi(qt(e),t)})});ue({name:"alignRight",label:"labels.alignRight",icon:AR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"end",axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_RIGHT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:AR,onClick:()=>n(null),title:`${x("labels.alignRight")}  ${J("CtrlOrCmd+Shift+Right")}`,"aria-label":x("labels.alignRight"),visible:oi(qt(e),t)})});ue({name:"alignVerticallyCentered",label:"labels.centerVertically",icon:MR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"center",axis:"y"}),captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:MR,onClick:()=>n(null),title:x("labels.centerVertically"),"aria-label":x("labels.centerVertically"),visible:oi(qt(e),t)})});ue({name:"alignHorizontallyCentered",label:"labels.centerHorizontally",icon:kR,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Xs(t,i),perform:(e,t,n,i)=>({appState:t,elements:sm(e,t,i,{position:"center",axis:"x"}),captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!Xs(t,i),type:"button",icon:kR,onClick:()=>n(null),title:x("labels.centerHorizontally"),"aria-label":x("labels.centerHorizontally"),visible:oi(qt(e),t)})});const aW=(e,t)=>{const n=t.scene.getSelectedElements(e);return qy(n,t.scene.getNonDeletedElementsMap(),e).length>2&&!n.some(i=>_e(i))},lW=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=_fe(s,n.scene.getNonDeletedElementsMap(),i,t,n.scene),o=we(r);return pg(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"distributeHorizontally",label:"labels.distributeHorizontally",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:lW(e,t,i,{axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.H,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!aW(t,i),type:"button",icon:fge,onClick:()=>n(null),title:`${x("labels.distributeHorizontally")}  ${J("Alt+H")}`,"aria-label":x("labels.distributeHorizontally"),visible:oi(qt(e),t)})});ue({name:"distributeVertically",label:"labels.distributeVertically",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:lW(e,t,i,{axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.V,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(qe,{hidden:!aW(t,i),type:"button",icon:hge,onClick:()=>n(null),title:`${x("labels.distributeVertically")}  ${J("Alt+V")}`,"aria-label":x("labels.distributeVertically"),visible:oi(qt(e),t)})});const nve=ue({name:"flipHorizontal",label:"labels.flipHorizontal",icon:Ume,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:pg(cW(e,i.scene.getNonDeletedElementsMap(),t,"horizontal",i),t,i),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===ut.H}),ive=ue({name:"flipVertical",label:"labels.flipVertical",icon:pme,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:pg(cW(e,i.scene.getNonDeletedElementsMap(),t,"vertical",i),t,i),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===ut.V&&!e[$.CTRL_OR_CMD]}),cW=(e,t,n,i,s)=>{const r=Ze(qt(e),n,{includeBoundTextElement:!0,includeElementsInFrames:!0}),o=sve(r,t,i,s),a=we(o);return e.map(l=>a.get(l.id)||l)},sve=(e,t,n,i)=>{if(e.every(f=>Te(f)&&(f.startBinding||f.endBinding)))return e.map(f=>{const h=f;return xe(h,{startArrowhead:h.endArrowhead,endArrowhead:h.startArrowhead})});const{midX:s,midY:r}=Kr(e);ZV(e,t,"nw",i.scene,new Map(Array.from(t.values()).map(f=>[f.id,cd(f)])),{flipByX:n==="horizontal",flipByY:n==="vertical",shouldResizeFromCenter:!0,shouldMaintainAspectRatio:!0}),O4(e.filter(Te),i.scene,i.state);const{elbowArrows:o,otherElements:a}=e.reduce((f,h)=>ve(h)?{...f,elbowArrows:f.elbowArrows.concat(h)}:{...f,otherElements:f.otherElements.concat(h)},{elbowArrows:[],otherElements:[]}),{midX:l,midY:c}=Kr(e),[d,u]=[s-l,r-c];return a.forEach(f=>i.scene.mutateElement(f,{x:f.x+d,y:f.y+u})),o.forEach(f=>i.scene.mutateElement(f,{x:f.x+d,y:f.y+u})),e},$b=ue({name:"copy",label:"labels.copy",icon:a_,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await k7e(s,i.files,n)}catch(r){return{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:r.message}}}return{captureUpdate:q.EVENTUALLY}},keyTest:void 0}),mL=ue({name:"paste",label:"labels.paste",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let s;try{s=await L7e()}catch(r){return r.name==="AbortError"||r.name==="NotAllowedError"?!1:(console.error(`actionPaste ${r.name}: ${r.message}`),z0?{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:x("hints.firefox_clipboard_write")}}:{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:x("errors.asyncPasteFailedOnRead")}})}try{i.pasteFromClipboard(A7e({types:s}))}catch(r){return console.error(r),{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:x("errors.asyncPasteFailedOnParse")}}}return{captureUpdate:q.EVENTUALLY}},keyTest:void 0}),pL=ue({name:"cut",label:"labels.cut",icon:Qge,trackEvent:{category:"element"},perform:(e,t,n,i)=>($b.perform(e,t,n,i),TG.perform(e,t,null,i)),keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.X}),UL=ue({name:"copyAsSvg",label:"labels.copyAsSvg",icon:bme,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:q.EVENTUALLY};const{exportedElements:s,exportingFrame:r}=VE(e,t,!0);try{await $E("clipboard-svg",s,t,i.files,{...t,exportingFrame:r,name:i.getName()});const o=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});return{appState:{toast:{message:x("toast.copyToClipboardAsSvg",{exportSelection:o.length?x("toast.selection"):x("toast.canvas"),exportColorScheme:t.exportWithDarkMode?x("buttons.darkMode"):x("buttons.lightMode")})}},captureUpdate:q.EVENTUALLY}}catch(o){return console.error(o),{appState:{errorMessage:o.message},captureUpdate:q.EVENTUALLY}}},predicate:e=>qI&&e.length>0,keywords:["svg","clipboard","copy"]}),bL=ue({name:"copyAsPng",label:"labels.copyAsPng",icon:yme,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:q.EVENTUALLY};const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:r,exportingFrame:o}=VE(e,t,!0);try{return await $E("clipboard",r,t,i.files,{...t,exportingFrame:o,name:i.getName()}),{appState:{...t,toast:{message:x("toast.copyToClipboardAsPng",{exportSelection:s.length?x("toast.selection"):x("toast.canvas"),exportColorScheme:t.exportWithDarkMode?x("buttons.darkMode"):x("buttons.lightMode")})}},captureUpdate:q.EVENTUALLY}}catch(a){return console.error(a),{appState:{...t,errorMessage:a.message},captureUpdate:q.EVENTUALLY}}},predicate:e=>QI&&e.length>0,keyTest:e=>e.code===ut.C&&e.altKey&&e.shiftKey,keywords:["png","clipboard","copy"]}),yL=ue({name:"copyText",label:"labels.copyText",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});try{kd(oT(s))}catch{throw new Error(x("errors.copyToSystemClipboardFailed"))}return{captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>qI&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).some(he),keywords:["text","clipboard","copy"]}),k_=ue({name:"gridMode",icon:wme,keywords:["snap"],label:"labels.toggleGrid",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>e.gridModeEnabled},perform(e,t){return{appState:{...t,gridModeEnabled:!this.checked(t),objectsSnapModeEnabled:!1},captureUpdate:q.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[$.CTRL_OR_CMD]&&e.code===ut.QUOTE}),P5=ue({name:"zenMode",label:"buttons.zenMode",icon:vme,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.zenModeEnabled},perform(e,t){return{appState:{...t,zenModeEnabled:!this.checked(t)},captureUpdate:q.EVENTUALLY}},checked:e=>e.zenModeEnabled,predicate:(e,t,n,i)=>i.editorInterface.formFactor!=="phone"&&typeof n.zenModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.Z}),dW=ue({name:"objectsSnapMode",label:"buttons.objectsSnapMode",icon:Eme,viewMode:!1,trackEvent:{category:"canvas",predicate:e=>!e.objectsSnapModeEnabled},perform(e,t){return{appState:{...t,objectsSnapModeEnabled:!this.checked(t),gridModeEnabled:!1},captureUpdate:q.EVENTUALLY}},checked:e=>e.objectsSnapModeEnabled,predicate:(e,t,n)=>typeof n.objectsSnapModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.S}),N5=ue({name:"stats",label:"stats.fullTitle",icon:mme,viewMode:!0,trackEvent:{category:"menu"},keywords:["edit","attributes","customize"],perform(e,t){return{appState:{...t,stats:{...t.stats,open:!this.checked(t)}},captureUpdate:q.EVENTUALLY}},checked:e=>e.stats.open,keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.SLASH}),rve=ue({name:"unbindText",label:"labels.unbindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>i.scene.getSelectedElements(t).some(r=>Ki(r)),perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=i.scene.getNonDeletedElementsMap();return s.forEach(o=>{var l;const a=Ne(o,r);if(a){const{width:c,height:d}=ri(a.originalText,_t(a),a.lineHeight),u=hde(o.id);GH(o.id);const{x:f,y:h}=Cd(o,a,r);i.scene.mutateElement(a,{containerId:null,width:c,height:d,text:a.originalText,x:f,y:h}),i.scene.mutateElement(o,{boundElements:(l=o.boundElements)==null?void 0:l.filter(m=>m.id!==a.id),height:u||o.height})}}),{elements:e,appState:t,captureUpdate:q.IMMEDIATELY}}}),ove=ue({name:"bindText",label:"labels.bindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);if(s.length===2){const r=he(s[0])||he(s[1]);let o;if(bu(s[0])?o=s[0]:bu(s[1])&&(o=s[1]),r&&o&&Ne(o,i.scene.getNonDeletedElementsMap())===null)return!0}return!1},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);let r,o;he(s[0])&&bu(s[1])?(r=s[0],o=s[1]):(r=s[1],o=s[0]),i.scene.mutateElement(r,{containerId:o.id,verticalAlign:lr.MIDDLE,textAlign:B0.CENTER,autoResize:!0,angle:Te(o)?0:(o==null?void 0:o.angle)??0}),i.scene.mutateElement(o,{boundElements:(o.boundElements||[]).concat({type:"text",id:r.id})});const a=o.height;return fs(r,o,i.scene),q6(o.id,a),{elements:ave(e,o,r),appState:{...t,selectedElementIds:{[o.id]:!0}},captureUpdate:q.IMMEDIATELY}}}),ave=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===n.id);i.splice(s,1);const r=i.findIndex(o=>o.id===t.id);return i.splice(r+1,0,n),Mo(i,we([t,n])),i},lve=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===t.id);i.splice(s,1);const r=i.findIndex(o=>o.id===n.id);return i.splice(r,0,t),Mo(i,we([t,n])),i},cve=ue({name:"wrapTextInContainer",label:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=s.some(o=>he(o)&&!Vt(o));return s.length>0&&r},perform:(e,t,n,i)=>{var a;const s=i.scene.getSelectedElements(t);let r=e.slice();const o={};for(const l of s)if(he(l)&&!Vt(l)){const c=Ta({type:"rectangle",backgroundColor:t.currentItemBackgroundColor,boundElements:[...l.boundElements||[],{id:l.id,type:"text"}],angle:l.angle,fillStyle:t.currentItemFillStyle,strokeColor:t.currentItemStrokeColor,roughness:t.currentItemRoughness,strokeWidth:t.currentItemStrokeWidth,strokeStyle:t.currentItemStrokeStyle,roundness:t.currentItemRoundness==="round"?{type:of("rectangle")?wn.ADAPTIVE_RADIUS:wn.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:l.x-ti,y:l.y-ti,width:Pu(l.width,"rectangle"),height:Pu(l.height,"rectangle"),groupIds:l.groupIds,frameId:l.frameId});if((a=l.boundElements)!=null&&a.length){const d=l.boundElements.filter(f=>f.type==="arrow").map(f=>f.id);r.filter(f=>d.includes(f.id)).forEach(f=>{let h=f.startBinding,m=f.endBinding;(h==null?void 0:h.elementId)===l.id&&(h={...h,elementId:c.id}),(m==null?void 0:m.elementId)===l.id&&(m={...m,elementId:c.id}),(h||m)&&i.scene.mutateElement(f,{startBinding:h,endBinding:m})})}i.scene.mutateElement(l,{containerId:c.id,verticalAlign:lr.MIDDLE,boundElements:null,textAlign:B0.CENTER,autoResize:!0}),fs(l,c,i.scene),r=lve([...r,c],c,l),o[c.id]=!0}return{elements:r,appState:{...t,selectedElementIds:o},captureUpdate:q.IMMEDIATELY}}}),eS=380,dve=42,R_=5,uW=85,uve=500;let D_=!1;const jU=new Map,fve=({element:e,scene:t,setAppState:n,onLinkOpen:i,setToast:s,updateEmbedValidationStatus:r})=>{const o=t.getNonDeletedElementsMap(),a=S2(),l=I2(),c=Nn(),d=e.link||"",[u,f]=C.useState(d),h=C.useRef(null),m=a.showHyperlinkPopup==="editor",p=C.useCallback(()=>{var I;if(!h.current)return;const _=Ur(h.current.value)||null;if(!e.link&&_&&at("hyperlink","create"),Es(e)){if(((I=a.activeEmbeddable)==null?void 0:I.element)===e&&n({activeEmbeddable:null}),!_){t.mutateElement(e,{link:null}),r(e,!1);return}if(!xb(_,l.validateEmbeddable))_&&s({message:x("toast.unableToEmbed"),closable:!0}),e.link&&jU.set(e.id,e.link),t.mutateElement(e,{link:_}),r(e,!1);else{const{width:k,height:w}=e,T=ph(_);(T==null?void 0:T.error)instanceof URIError&&s({message:x("toast.unrecognizedLinkFormat"),closable:!0});const A=T?T.intrinsicSize.w/T.intrinsicSize.h:1,S=jU.get(e.id)!==e.link;t.mutateElement(e,{...S?{width:(T==null?void 0:T.type)==="video"?k>w?k:w*A:k,height:(T==null?void 0:T.type)==="video"&&k>w?k/A:w}:{},link:_}),r(e,!0),jU.has(e.id)&&jU.delete(e.id)}}else t.mutateElement(e,{link:_})},[e,t,s,l.validateEmbeddable,a.activeEmbeddable,n,r]);C.useLayoutEffect(()=>()=>{p()},[p]),C.useEffect(()=>{m&&(h!=null&&h.current)&&!(c.formFactor==="phone"||c.isTouchScreen)&&h.current.select()},[m,c.formFactor,c.isTouchScreen]),C.useEffect(()=>{let _=null;const I=k=>{if(m)return;_&&clearTimeout(_),mve(e,o,a,M(k.clientX,k.clientY))&&(_=window.setTimeout(()=>{n({showHyperlinkPopup:!1})},uve))};return window.addEventListener(te.POINTER_MOVE,I,!1),()=>{window.removeEventListener(te.POINTER_MOVE,I,!1),_&&clearTimeout(_)}},[a,e,m,n,o]);const U=C.useCallback(()=>{at("hyperlink","delete"),t.mutateElement(e,{link:null}),n({showHyperlinkPopup:!1})},[n,e,t]),b=()=>{at("hyperlink","edit","popup-ui"),n({showHyperlinkPopup:"editor"})},{x:y,y:E}=fW(e,a,o);return a.contextMenu||a.selectedElementsAreBeingDragged||a.resizingElement||a.isRotating||a.openMenu||a.viewModeEnabled?null:P("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${E}px`,left:`${y}px`,width:eS,padding:R_},children:[m?g("input",{className:ae("excalidraw-hyperlinkContainer-input"),placeholder:x("labels.link.hint"),ref:h,value:u,onChange:_=>f(_.target.value),autoFocus:!0,onKeyDown:_=>{_.stopPropagation(),_[$.CTRL_OR_CMD]&&_.key===$.K&&_.preventDefault(),(_.key===$.ENTER||_.key===$.ESCAPE)&&(p(),n({showHyperlinkPopup:"info"}))}}):e.link?g("a",{href:Ur(e.link||""),className:"excalidraw-hyperlinkContainer-link",target:Vz(e.link)?"_self":"_blank",onClick:_=>{if(e.link&&i){const I=Nz(te.EXCALIDRAW_LINK,_.nativeEvent);i({...e,link:Ur(e.link)},I),I.defaultPrevented&&_.preventDefault()}},rel:"noopener noreferrer",children:e.link}):g("div",{className:"excalidraw-hyperlinkContainer-link",children:x("labels.link.empty")}),P("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!m&&g(qe,{type:"button",title:x("buttons.edit"),"aria-label":x("buttons.edit"),label:x("buttons.edit"),onClick:b,className:"excalidraw-hyperlinkContainer--edit",icon:u2}),g(qe,{type:"button",title:x("labels.linkToElement"),"aria-label":x("labels.linkToElement"),label:x("labels.linkToElement"),onClick:()=>{n({openDialog:{name:"elementLinkSelector",sourceElementId:e.id}})},icon:vG}),d&&!Es(e)&&g(qe,{type:"button",title:x("buttons.remove"),"aria-label":x("buttons.remove"),label:x("buttons.remove"),onClick:U,className:"excalidraw-hyperlinkContainer--remove",icon:Ia})]})]})},fW=(e,t,n)=>{const[i,s]=je(e,n),{x:r,y:o}=cr({sceneX:i+e.width/2,sceneY:s},t),a=r-t.offsetLeft-eS/2,l=o-t.offsetTop-uW;return{x:a,y:l}},EL=(e,t)=>{var s;const n=Ze(e,t);return Es(n[0])?"labels.link.editEmbed":(s=n[0])!=null&&s.link?"labels.link.edit":"labels.link.create"};let c0=null;const hve=(e,t,n)=>{c0&&clearTimeout(c0),c0=window.setTimeout(()=>gve(e,t,n),uie)},gve=(e,t,n)=>{if(!e.link)return;const i=s0();i.classList.add("excalidraw-tooltip--visible"),i.style.maxWidth="20rem",i.textContent=Lh(e.link)?x("labels.link.goToElement"):e.link;const[s,r,o,a]=je(e,n),[l,c,d,u]=jI([s,r,o,a],e.angle,t),f=cr({sceneX:l,sceneY:c},t);Pj(i,{left:f.x,top:f.y,width:d,height:u},"top"),at("hyperlink","tooltip","link-icon"),D_=!0},vL=()=>{c0&&clearTimeout(c0),D_&&(D_=!1,s0().classList.remove("excalidraw-tooltip--visible"))},mve=(e,t,n,[i,s])=>{const{x:r,y:o}=zt({clientX:i,clientY:s},n),a=15/n.zoom.value;if(Ky(M(r,o),e,t))return!1;const[l,c,d]=je(e,t);if(r>=l&&r<=d&&o>=c-uW&&o<=c)return!1;const{x:u,y:f}=fW(e,n,t);return!(i>=u-a&&i<=u+eS+R_*2+a&&s>=f-a&&s<=f+a+R_*2+dve)},hW=ue({name:"hyperlink",label:(e,t)=>EL(e,t),icon:m5,perform:(e,t)=>t.showHyperlinkPopup==="editor"?!1:{elements:e,appState:{...t,showHyperlinkPopup:"editor",openMenu:null},captureUpdate:q.IMMEDIATELY},trackEvent:{category:"hyperlink",action:"click"},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.K,predicate:(e,t)=>Ze(e,t).length===1,PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Ze(e,t);return g(qe,{type:"button",icon:m5,"aria-label":x(EL(e,t)),title:`${Es(e[0])?x("labels.link.labelEmbed"):x("labels.link.label")} - ${J("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:i.length===1&&!!i[0].link})}}),x7=e=>e.every(t=>!t.locked),gW=ue({name:"toggleElementLock",label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1});return x7(i)?"labels.elementLock.lock":"labels.elementLock.unlock"},icon:(e,t)=>{const n=Ze(t,e);return x7(n)?$T:rE},trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return s.length>0&&!s.some(r=>r.locked&&r.frameId)},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!s.length)return!1;const r=x7(s),o=we(s),a=s.length>1&&UT(s),c=s.length===1||a?null:Li();let d={...t.lockedMultiSelections};if(r)d={...t.lockedMultiSelections,...c?{[c]:!0}:{}};else if(a){const b=s[0].groupIds.at(-1);delete d[b]}const u=e.map(b=>{if(!o.has(b.id))return b;let y=b.groupIds;return r?c&&(y=[...y,c]):y=y.filter(E=>!t.lockedMultiSelections[E]),xe(b,{locked:r,groupIds:y.length!==b.groupIds.length?y:b.groupIds})}),f=we(u),h=r?{}:Object.fromEntries(s.map(b=>[b.id,!0])),m=s.map(b=>f.get(b.id)||b),p=r?{}:a2(m,t),U=r?c||(a?s[0].groupIds.at(-1):s[0].id):null;return{elements:u,appState:{...t,selectedElementIds:h,selectedGroupIds:p,selectedLinearElement:r?null:t.selectedLinearElement,lockedMultiSelections:d,activeLockedId:U},captureUpdate:q.IMMEDIATELY}},keyTest:(e,t,n,i)=>e.key.toLocaleLowerCase()===$.L&&e[$.CTRL_OR_CMD]&&e.shiftKey&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}).length>0}),pve=ue({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,icon:rE,predicate:(e,t)=>Ze(e,t).length===0&&e.some(i=>i.locked),perform:(e,t)=>{const n=e.filter(o=>o.locked),i=e.map(o=>{if(o.locked){const a=o.groupIds.filter(l=>!t.lockedMultiSelections[l]);return xe(o,{locked:!1,groupIds:o.groupIds.length!==a.length?a:o.groupIds})}return o}),s=we(i),r=n.map(o=>s.get(o.id)||o);return{elements:i,appState:{...t,selectedElementIds:Object.fromEntries(n.map(o=>[o.id,!0])),selectedGroupIds:a2(r,t),lockedMultiSelections:{},activeLockedId:null},captureUpdate:q.IMMEDIATELY}},label:"labels.elementLock.unlockAll"});var mW={exports:{}};(function(e,t){(function(){var n={};e.exports=n,n.simpleFilter=function(i,s){return s.filter(function(r){return n.test(i,r)})},n.test=function(i,s){return n.match(i,s)!==null},n.match=function(i,s,r){r=r||{};var o=0,a=[],l=s.length,c=0,d=0,u=r.pre||"",f=r.post||"",h=r.caseSensitive&&s||s.toLowerCase(),m;i=r.caseSensitive&&i||i.toLowerCase();for(var p=0;p<l;p++)m=s[p],h[p]===i[o]?(m=u+m+f,o+=1,d+=1+d):d=0,c+=d,a[a.length]=m;return o===i.length?(c=h===i?1/0:c,{rendered:a.join(""),score:c}):null},n.filter=function(i,s,r){return!s||s.length===0?[]:typeof i!="string"?s:(r=r||{},s.reduce(function(o,a,l,c){var d=a;r.extract&&(d=r.extract(a));var u=n.match(i,d,r);return u!=null&&(o[o.length]={string:u.rendered,score:u.score,index:l,original:a}),o},[]).sort(function(o,a){var l=a.score-o.score;return l||o.index-a.index}))}})()})(mW);var Uve=mW.exports;const bve=Hl(Uve),yve=8,Eve=10,_1=["rectangle","diamond","ellipse"],w1=["line","sharpArrow","curvedArrow","elbowArrow"],vve=new Set(_1),_ve=new Set(w1),wg=e=>vve.has(e),O5=e=>e==="arrow"||_ve.has(e),el=Nt(null),gp=new Map,mp=new Map,wve=({app:e})=>{const t=e.scene.getSelectedElements(e.state),n=C.useRef(null);return C.useEffect(()=>{if(t.length===0){e.updateEditorAtom(el,null);return}const i=XE(t);i&&!n.current?n.current=i:(n.current&&!i||n.current&&i!==n.current)&&(e.updateEditorAtom(el,null),n.current=null)},[t,e]),C.useEffect(()=>()=>{gp.clear(),mp.clear()},[]),g(Tve,{app:e,elements:t})},Tve=({app:e,elements:t})=>{const n=XE(t),i=C.useMemo(()=>n==="generic"?bW(t):[],[n,t]),s=C.useMemo(()=>n==="linear"?P_(t):[],[n,t]),r=n==="generic"?i.every(u=>u.type===i[0].type):n==="linear"?s.every(u=>kh(u)===kh(s[0])):!1,[o,a]=C.useState({x:0,y:0}),l=C.useRef(""),c=C.useRef(null);C.useEffect(()=>{const u=[...i,...s].sort((U,b)=>U.id.localeCompare(b.id)),f=`
      ${e.state.scrollX}${e.state.scrollY}${e.state.offsetTop}${e.state.offsetLeft}${e.state.zoom.value}${u.map(U=>U.id).join(",")}`;if(f===l.current)return;l.current=f;let h;if(u.length===1){const[U,,,b,y,E]=je(u[0],e.scene.getNonDeletedElementsMap());h=Z(M(U,b),M(y,E),u[0].angle)}else{const{minX:U,maxY:b}=Kr(u);h=M(U,b)}const{x:m,y:p}=cr({sceneX:h[0],sceneY:h[1]},e.state);a({x:m,y:p})},[i,s,e.scene,e.state]),C.useEffect(()=>{for(const u of s){const f=L_(u.id,Ave(u));mp.has(f)||mp.set(f,u)}},[s]),C.useEffect(()=>{for(const u of i)if(!gp.has(u.id)){const f=Ne(u,e.scene.getNonDeletedElementsMap());f&&gp.set(u.id,{fontSize:f.fontSize})}},[i,e.scene]);const d=n==="linear"?[["line",YT],["sharpArrow",nI],["curvedArrow",sI],["elbowArrow",iI]]:n==="generic"?[["rectangle",GT],["diamond",XT],["ellipse",jT]]:[];return g("div",{ref:c,tabIndex:-1,style:{position:"absolute",top:`${o.y+(Eve+8)*e.state.zoom.value-e.state.offsetTop}px`,left:`${o.x-e.state.offsetLeft-yve}px`,zIndex:2},className:Wi.CONVERT_ELEMENT_TYPE_POPUP,children:d.map(([u,f])=>{const h=r&&(n==="generic"&&i[0].type===u||n==="linear"&&kh(s[0])===u);return g(qe,{className:"Shape",type:"radio",icon:f,checked:h,name:"convertElementType-option",title:u,keyBindingLabel:"","aria-label":u,"data-testid":`toolbar-${u}`,onChange:()=>{var m;e.state.activeTool.type!==u&&at("convertElementType",u,"ui"),pW(e,{conversionType:n,nextType:u}),(m=c.current)==null||m.focus()}},`${t[0].id}${t[0].version}_${u}`)})})},Ive=(e,t,n)=>{const i=_a(e,t),s=r2(e,t),r=Sd(t.text,_t(t),i);let o=ri(r,_t(t),t.lineHeight),a=t.fontSize;for(;(o.width>i||o.height>s)&&a>0;){a-=1;const l={...t,fontSize:a};o=ri(t.text,_t(l),t.lineHeight)}Dn(t,n.getNonDeletedElementsMap(),{fontSize:a,width:o.width,height:o.height}),fs(t,e,n)},pW=(e,{conversionType:t,nextType:n,direction:i="right"})=>{var a;if(!t)return!1;const s=e.scene.getSelectedElements(e.state),r=s.reduce((l,c)=>({...l,[c.id]:!0}),{}),o=i==="right"?1:-1;if(t==="generic"){const l=bW(s),d=l.every(u=>u.type===l[0].type)?_1.indexOf(l[0].type):-1;if(n=n??_1[(d+_1.length+o)%_1.length],n&&wg(n)){const u={};for(const h of l){const m=wL(h,n,e);u[m.id]=m}const f=[];for(const h of e.scene.getElementsIncludingDeleted())u[h.id]?f.push(u[h.id]):f.push(h);e.scene.replaceAllElements(f);for(const h of Object.values(u)){const m=Ne(h,e.scene.getNonDeletedElementsMap());m&&(gp.get(h.id)&&Dn(m,e.scene.getNonDeletedElementsMap(),{fontSize:((a=gp.get(h.id))==null?void 0:a.fontSize)??m.fontSize}),Ive(h,m,e.scene))}e.setState(h=>({selectedElementIds:r,activeTool:sn(h,{type:"selection"})}))}}if(t==="linear"){const l=P_(s);if(!n){const d=zz(l,kh),u=d?w1.indexOf(d):-1;n=w1[(u+w1.length+o)%w1.length]}if(O5(n)){const d=[],u=e.scene.getElementsMapIncludingDeleted();for(const f of l){const h=mp.get(L_(f.id,n));if(h&&kh(h)===n)u.set(h.id,h),d.push(h);else{const m=wL(f,n,e);u.set(m.id,m),d.push(m)}}e.scene.replaceAllElements(u);for(const f of d)if(De(f))if(ve(f)){const h=Sve(f);if(h.length<2)continue;const m=[];for(let U=1;U<h.length-2;U++)m.push({start:h[U],end:h[U+1],index:U+1});const p=Yg(f,e.scene.getNonDeletedElementsMap(),{points:h,fixedSegments:m});Dn(f,e.scene.getNonDeletedElementsMap(),{...p,endArrowhead:"arrow"})}else{const h=Kie(["line","sharpArrow","curvedArrow"],m=>mp.get(L_(f.id,m)));if(h){const m=h.points;e.scene.mutateElement(f,{points:m})}}}const c=P_(e.scene.getSelectedElements(e.state));e.setState(d=>({selectedElementIds:r,selectedLinearElement:c.length===1?new ne(c[0],e.scene.getNonDeletedElementsMap()):null,activeTool:sn(d,{type:"selection"})}))}return!0},XE=e=>{if(e.length===0)return null;let t=!1;for(const n of e){if(wg(n.type))return"generic";UW(n)&&(t=!0)}return t?"linear":null},UW=e=>De(e)&&(!Te(e)||!HH(e)&&!Ki(e)),L_=(e,t)=>`${e}:${t}`,bW=e=>e.filter(t=>wg(t.type)),P_=e=>e.filter(t=>UW(t)),YU=20,$f=(e,t)=>e[0]===t[0],A7=(e,t)=>e[1]===t[1],_L=(e,t)=>$f(e,t)?Math.abs(e[1]-t[1]):Math.abs(e[0]-t[0]),Sve=e=>{const t=[e.points[0]],n=Cve(e.points);for(let r=1;r<n.length;++r){const o=t[t.length-1],a=[...n[r]];Math.abs(a[0]-o[0])<YU?a[0]=o[0]:Math.abs(a[1]-o[1])<YU&&(a[1]=o[1]),$f(o,a)||A7(o,a)||t.push(M(o[0],a[1])),t.push(a)}const i=[t[0]];for(let r=1;r<t.length-1;++r)$f(t[r-1],t[r])&&$f(t[r],t[r+1])||A7(t[r-1],t[r])&&A7(t[r],t[r+1])||i.push(t[r]);i.push(t[t.length-1]);const s=[i[0]];for(let r=1;r<i.length-1;++r){const o=s[s.length-1],a=i[r],l=i[r+1],c=$f(o,a),d=$f(a,l);if(c!==d){const u=_L(o,a),f=_L(a,l);if(u<YU||f<YU){if(f<u)c?l[0]=o[0]:l[1]=o[1];else if(d)for(let h=s.length-1;h>=0&&s[h][0]===o[0];--h)s[h][0]=a[0];else for(let h=s.length-1;h>=0&&s[h][1]===o[1];--h)s[h][1]=a[1];continue}}s.push(a)}return s.push(i[i.length-1]),s},Cve=e=>{if(e.length===0)return[];const t=[e[0]];for(let n=1;n<e.length;n++){const[i,s]=t[t.length-1],[r,o]=e[n];(i!==r||s!==o)&&t.push(e[n])}return t},wL=(e,t,n)=>{if(!xve(e.type,t)||e.type===t)return e;if(kn.delete(e),wg(t)){const i=Qo(Ta({...e,type:t,roundness:t==="diamond"&&e.roundness?{type:of(t)?wn.ADAPTIVE_RADIUS:wn.PROPORTIONAL_RADIUS}:e.roundness}));return V0(i,n.scene,n.state),i}if(O5(t))switch(t){case"line":return Qo(Hc({...e,type:"line"}));case"sharpArrow":return Qo(Ph({...e,type:"arrow",elbowed:!1,roundness:null,startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"curvedArrow":return Qo(Ph({...e,type:"arrow",elbowed:!1,roundness:{type:wn.PROPORTIONAL_RADIUS},startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"elbowArrow":return Qo(Ph({...e,type:"arrow",elbowed:!0,fixedSegments:null,roundness:null}))}return Ua(t,`unhandled conversion type: ${t}`),e},xve=(e,t)=>!!(wg(e)&&wg(t)||O5(e)&&O5(t)),Ave=e=>De(e)?kh(e):e.type,Mve=ue({name:"toggleShapeSwitch",label:"labels.shapeSwitch",icon:()=>null,viewMode:!0,trackEvent:{category:"shape_switch",action:"toggle"},keywords:["change","switch","swap"],perform(e,t,n,i){return ar.set(el,{type:"panel"}),{captureUpdate:q.NEVER}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>XE(e)!==null}),yW=ue({name:"copyElementLink",label:"labels.copyElementLink",icon:f2,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=Ze(e,t);try{if(window.location){const r=PV(s,t);return r?(await kd(i.props.generateLinkForSelection?i.props.generateLinkForSelection(r.id,r.type):LV(r.id,r.type)),{appState:{toast:{message:x("toast.elementLinkCopied"),closable:!0}},captureUpdate:q.EVENTUALLY}):{appState:t,elements:e,app:i,captureUpdate:q.EVENTUALLY}}}catch(r){console.error(r)}return{appState:t,elements:e,app:i,captureUpdate:q.EVENTUALLY}},predicate:(e,t)=>f5(Ze(e,t))}),kve=ue({name:"linkToElement",label:"labels.linkToElement",icon:vG,perform:(e,t,n,i)=>{const s=Ze(e,t);return s.length!==1||!f5(s)?{elements:e,appState:t,app:i,captureUpdate:q.EVENTUALLY}:{appState:{...t,openDialog:{name:"elementLinkSelector",sourceElementId:Ze(e,t)[0].id}},captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>{var r;const s=Ze(e,t);return((r=t.openDialog)==null?void 0:r.name)!=="elementLinkSelector"&&s.length===1&&f5(s)},trackEvent:!1}),Rve={toggleTheme:[J("Shift+Alt+D")],saveScene:[J("CtrlOrCmd+S")],loadScene:[J("CtrlOrCmd+O")],clearCanvas:[J("CtrlOrCmd+Delete")],imageExport:[J("CtrlOrCmd+Shift+E")],commandPalette:[J("CtrlOrCmd+/"),J("CtrlOrCmd+Shift+P")],cut:[J("CtrlOrCmd+X")],copy:[J("CtrlOrCmd+C")],paste:[J("CtrlOrCmd+V")],copyStyles:[J("CtrlOrCmd+Alt+C")],pasteStyles:[J("CtrlOrCmd+Alt+V")],selectAll:[J("CtrlOrCmd+A")],deleteSelectedElements:[J("Delete")],duplicateSelection:[J("CtrlOrCmd+D"),J(`Alt+${x("helpDialog.drag")}`)],sendBackward:[J("CtrlOrCmd+[")],bringForward:[J("CtrlOrCmd+]")],sendToBack:[J(Ao?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")],bringToFront:[J(Ao?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")],copyAsPng:[J("Shift+Alt+C")],group:[J("CtrlOrCmd+G")],ungroup:[J("CtrlOrCmd+Shift+G")],gridMode:[J("CtrlOrCmd+'")],zenMode:[J("Alt+Z")],objectsSnapMode:[J("Alt+S")],stats:[J("Alt+/")],addToLibrary:[],flipHorizontal:[J("Shift+H")],flipVertical:[J("Shift+V")],viewMode:[J("Alt+R")],hyperlink:[J("CtrlOrCmd+K")],toggleElementLock:[J("CtrlOrCmd+Shift+L")],resetZoom:[J("CtrlOrCmd+0")],zoomOut:[J("CtrlOrCmd+-")],zoomIn:[J("CtrlOrCmd++")],zoomToFitSelection:[J("Shift+3")],zoomToFit:[J("Shift+1")],zoomToFitSelectionInViewport:[J("Shift+2")],toggleEraserTool:[J("E")],toggleHandTool:[J("H")],setFrameAsActiveTool:[J("F")],saveFileToDisk:[J("CtrlOrCmd+S")],saveToActiveFile:[J("CtrlOrCmd+S")],toggleShortcuts:[J("?")],searchMenu:[J("CtrlOrCmd+F")],wrapSelectionInFrame:[],toolLock:[J("Q")]},Ln=(e,t=0)=>{const n=Rve[e];return n&&n.length>0?n[t]||n[0]:""},Dve="\\u0300-\\u036f",Lve="\\ufe20-\\ufe2f",Pve="\\u20d0-\\u20ff",Nve=Dve+Lve+Pve,Ove=`[${Nve}]`,Fve=RegExp(Ove,"g"),Bve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zve={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"E",:"e",:"T",:"t",:"s",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"I",:"i",:"E",:"e",:"n",:"s"},d0=e=>e.replace(Bve,t=>zve[t]||t).replace(Fve,""),EW=()=>{const[e,t]=C.useState(null),n=C.useCallback(i=>t(i),[]);return[e,n]};var jE={},Hve=Vve;function Vve(e,t){if(e=String(e),t=String(t),!/^[\x00-\xFF]+$/.test(e)||!/^[\x00-\xFF]+$/.test(t))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(e.length>=80)throw new Error('Keyword "'+e+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=e.length+t.length+1,i=new Uint8Array(n),s=0,r,o=0;o<e.length;o++){if(!(r=e.charCodeAt(o)))throw new Error("0x00 character is not permitted in tEXt keywords");i[s++]=r}i[s++]=0;for(var a=0;a<t.length;a++){if(!(r=t.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt content");i[s++]=r}return{name:"tEXt",data:i}}var $ve=Gve;function Gve(e){e.data&&e.name&&(e=e.data);for(var t=!0,n="",i="",s=0;s<e.length;s++){var r=e[s];if(t)r?i+=String.fromCharCode(r):t=!1;else if(r)n+=String.fromCharCode(r);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:i,text:n}}jE.encode=Hve;jE.decode=$ve;var Xve=function(e,t,n){var i=[],s=e.length;if(s===0)return i;var r=t<0?Math.max(0,t+s):t||0;for(n!==void 0&&(s=n<0?n+s:n);s-- >r;)i[s-r]=e[s];return i},tS={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="0.3.0";function n(){for(var c=0,d=new Array(256),u=0;u!=256;++u)c=u,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,d[u]=c;return typeof Int32Array<"u"?new Int32Array(d):d}var i=n(),s=typeof Buffer<"u";function r(c){if(c.length>32768&&s)return a(new Buffer(c));for(var d=-1,u=c.length-1,f=0;f<u;)d=i[(d^c.charCodeAt(f++))&255]^d>>>8,d=i[(d^c.charCodeAt(f++))&255]^d>>>8;return f===u&&(d=d>>>8^i[(d^c.charCodeAt(f))&255]),d^-1}function o(c){if(c.length>1e4)return a(c);for(var d=-1,u=0,f=c.length-3;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+3;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function a(c){for(var d=-1,u=0,f=c.length-7;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+7;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function l(c){for(var d=-1,u=0,f=c.length,h,m;u<f;)h=c.charCodeAt(u++),h<128?d=d>>>8^i[(d^h)&255]:h<2048?(d=d>>>8^i[(d^(192|h>>6&31))&255],d=d>>>8^i[(d^(128|h&63))&255]):h>=55296&&h<57344?(h=(h&1023)+64,m=c.charCodeAt(u++)&1023,d=d>>>8^i[(d^(240|h>>8&7))&255],d=d>>>8^i[(d^(128|h>>2&63))&255],d=d>>>8^i[(d^(128|m>>6&15|h&3))&255],d=d>>>8^i[(d^(128|m&63))&255]):(d=d>>>8^i[(d^(224|h>>12&15))&255],d=d>>>8^i[(d^(128|h>>6&63))&255],d=d>>>8^i[(d^(128|h&63))&255]);return d^-1}t.table=i,t.bstr=r,t.buf=o,t.str=l})})(tS);var jve=Xve,Yve=tS,Wve=qve,$o=new Uint8Array(4),Kve=new Int32Array($o.buffer),Zve=new Uint32Array($o.buffer);function qve(e){var t=8,n=t,i;for(i=0;i<e.length;i++)t+=e[i].data.length,t+=12;var s=new Uint8Array(t);for(s[0]=137,s[1]=80,s[2]=78,s[3]=71,s[4]=13,s[5]=10,s[6]=26,s[7]=10,i=0;i<e.length;i++){var r=e[i],o=r.name,a=r.data,l=a.length,c=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)];Zve[0]=l,s[n++]=$o[3],s[n++]=$o[2],s[n++]=$o[1],s[n++]=$o[0],s[n++]=c[0],s[n++]=c[1],s[n++]=c[2],s[n++]=c[3];for(var d=0;d<l;)s[n++]=a[d++];var u=c.concat(jve(a)),f=Yve.buf(u);Kve[0]=f,s[n++]=$o[3],s[n++]=$o[2],s[n++]=$o[1],s[n++]=$o[0]}return s}const Qve=Hl(Wve);var Jve=tS,e4e=i4e,Go=new Uint8Array(4),t4e=new Int32Array(Go.buffer),n4e=new Uint32Array(Go.buffer);function i4e(e){if(e[0]!==137)throw new Error("Invalid .png file header");if(e[1]!==80)throw new Error("Invalid .png file header");if(e[2]!==78)throw new Error("Invalid .png file header");if(e[3]!==71)throw new Error("Invalid .png file header");if(e[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[6]!==26)throw new Error("Invalid .png file header");if(e[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var t=!1,n=[],i=8;i<e.length;){Go[3]=e[i++],Go[2]=e[i++],Go[1]=e[i++],Go[0]=e[i++];var s=n4e[0]+4,r=new Uint8Array(s);r[0]=e[i++],r[1]=e[i++],r[2]=e[i++],r[3]=e[i++];var o=String.fromCharCode(r[0])+String.fromCharCode(r[1])+String.fromCharCode(r[2])+String.fromCharCode(r[3]);if(!n.length&&o!=="IHDR")throw new Error("IHDR header missing");if(o==="IEND"){t=!0,n.push({name:o,data:new Uint8Array(0)});break}for(var a=4;a<s;a++)r[a]=e[i++];Go[3]=e[i++],Go[2]=e[i++],Go[1]=e[i++],Go[0]=e[i++];var l=t4e[0],c=Jve.buf(r);if(c!==l)throw new Error("CRC values for "+o+" header do not match, PNG file is likely corrupted");var d=new Uint8Array(r.buffer.slice(4));n.push({name:o,data:d})}if(!t)throw new Error(".png file ended prematurely: no IEND header was found");return n}const vW=Hl(e4e),_W=async e=>{const n=vW(new Uint8Array(await w2(e))).find(i=>i.name==="tEXt");return n?jE.decode(n.data):null},wW=async({blob:e,metadata:t})=>{const n=vW(new Uint8Array(await w2(e))),i=jE.encode(Ee.excalidraw,JSON.stringify(CY({text:t,compress:!0})));return n.splice(-1,0,i),new Blob([Qve(n)],{type:Ee.png})},s4e=async e=>{const t=await _W(e);if((t==null?void 0:t.keyword)===Ee.excalidraw)try{const n=JSON.parse(t.text);if(!("encoded"in n)){if("type"in n&&n.type===jr.excalidraw)return t.text;throw new Error("FAILED")}return xY(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},TW=Object.freeze(Object.defineProperty({__proto__:null,decodePngMetadata:s4e,encodePngMetadata:wW,getTEXtChunk:_W},Symbol.toStringTag,{value:"Module"})),YE=({elements:e,appState:t,files:n,maxWidthOrHeight:i,getDimensions:s,exportPadding:r,exportingFrame:o})=>{const a=wr(e,null,{deleteInvisibleElements:!0}),l=Xc(t,null),{exportBackground:c,viewBackgroundColor:d}=l;return VY(a,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:r,viewBackgroundColor:d,exportingFrame:o},(u,f)=>{const h=document.createElement("canvas");if(i){typeof s=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");const p=Math.max(u,f),U=i<p?i/p:(t==null?void 0:t.exportScale)??1;return h.width=u*U,h.height=f*U,{canvas:h,scale:U}}const m=(s==null?void 0:s(u,f))||{width:u,height:f};return h.width=m.width,h.height=m.height,{canvas:h,scale:m.scale??1}})},r4e=async e=>{var s;let{mimeType:t=Ee.png,quality:n}=e;t===Ee.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${Ee.png}" mimeType`),t==="image/jpg"&&(t=Ee.jpg),t===Ee.jpg&&!((s=e.appState)!=null&&s.exportBackground)&&(console.warn(`Defaulting "exportBackground" to "true" for "${Ee.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});const i=await YE(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((r,o)=>{i.toBlob(async a=>{var l;if(!a)return o(new Error("couldn't export to blob"));a&&t===Ee.png&&((l=e.appState)!=null&&l.exportEmbedScene)&&(a=await wW({blob:a,metadata:im(e.elements,e.appState,e.files||{},"local")})),r(a)},t,n)})},IW=async({elements:e,appState:t=Aa(),files:n={},exportPadding:i,renderEmbeddables:s,exportingFrame:r,skipInliningFonts:o,reuseImages:a})=>{const l=wr(e,null,{deleteInvisibleElements:!0}),d={...Xc(t,null),exportPadding:i};return YI(l,d,n,{exportingFrame:r,renderEmbeddables:s,skipInliningFonts:o,reuseImages:a})},SW=Nt(new Map),TL=async e=>await IW({elements:e,appState:{exportBackground:!1,viewBackgroundColor:Je.white},files:null,renderEmbeddables:!1,skipInliningFonts:!0}),CW=(e,t,n,i)=>{const[s,r]=C.useState();return C.useEffect(()=>{if(t)if(e){const o=n.get(e);o?r(o):(async()=>{var l;const a=await TL(t);(l=a.querySelector(".style-fonts"))==null||l.remove(),a&&(n.set(e,a),r(a))})()}else(async()=>{const o=await TL(t);r(o)})()},[e,t,n,r]),C.useEffect(()=>{const o=i.current;if(o)return s&&(o.innerHTML=s.outerHTML),()=>{o.innerHTML=""}},[s,i]),s},nS=()=>{const[e]=dt(SW);return{clearLibraryCache:()=>e.clear(),deleteItemsFromLibraryCache:i=>{i.forEach(s=>e.delete(s))},svgCache:e}},o4e=["excalidraw.com","raw.githubusercontent.com/excalidraw/excalidraw-libraries"],xW=new fo,Tg=Nt({status:"loaded",isInitialized:!1,libraryItems:[]}),Ym=e=>ua(e),a4e=(e,t)=>!e.find(n=>n.elements.length!==t.elements.length?!1:n.elements.every((i,s)=>i.id===t.elements[s].id&&i.versionNonce===t.elements[s].versionNonce)),l4e=(e,t)=>{const n=[];for(const i of t)a4e(e,i)&&n.push(i);return[...n,...e]},AW=(e,t)=>{const n=we(t),i={deletedItems:new Map,addedItems:new Map,updatedItems:new Map};for(const r of e)n.has(r.id)||i.deletedItems.set(r.id,r);const s=we(e);for(const r of t){const o=s.get(r.id);o?O_(o)!==O_(r)&&i.updatedItems.set(r.id,r):i.addedItems.set(r.id,r)}return i};class c4e{constructor(t){B(this,"currLibraryItems",[]);B(this,"prevLibraryItems",Ym(this.currLibraryItems));B(this,"app");B(this,"updateQueue",[]);B(this,"getLastUpdateTask",()=>this.updateQueue[this.updateQueue.length-1]);B(this,"notifyListeners",()=>{var t,n;if(this.updateQueue.length>0)ar.set(Tg,i=>({status:"loading",libraryItems:this.currLibraryItems,isInitialized:i.isInitialized}));else{ar.set(Tg,{status:"loaded",libraryItems:this.currLibraryItems,isInitialized:!0});try{const i=this.prevLibraryItems;this.prevLibraryItems=Ym(this.currLibraryItems);const s=Ym(this.currLibraryItems);(n=(t=this.app.props).onLibraryChange)==null||n.call(t,s),xW.trigger(AW(i,s),s)}catch(i){console.error(i)}}});B(this,"destroy",()=>{this.updateQueue=[],this.currLibraryItems=[],ar.set(SW,new Map)});B(this,"resetLibrary",()=>this.setLibrary([]));B(this,"getLatestLibrary",()=>new Promise(async t=>{try{const n=await(this.getLastUpdateTask()||this.currLibraryItems);this.updateQueue.length>0?t(this.getLatestLibrary()):t(Ym(n))}catch{return t(this.currLibraryItems)}}));B(this,"updateLibrary",async({libraryItems:t,prompt:n=!1,merge:i=!1,openLibraryMenu:s=!1,defaultStatus:r="unpublished"})=>(s&&this.app.setState({openSidebar:{name:Yr.name,tab:O6}}),this.setLibrary(()=>new Promise(async(o,a)=>{try{const l=await(typeof t=="function"&&!(t instanceof Blob)?t(this.currLibraryItems):t);let c;l instanceof Blob?c=await h7e(l,r):c=HE(l,r),!n||window.confirm(x("alerts.confirmAddLibrary",{numShapes:c.length}))?(n&&this.app.focusContainer(),o(i?l4e(this.currLibraryItems,c):c)):a(new yg)}catch(l){a(l)}}))));B(this,"setLibrary",t=>{const n=new Promise(async(i,s)=>{try{await this.getLastUpdateTask(),typeof t=="function"&&(t=t(this.currLibraryItems)),this.currLibraryItems=Ym(await t),i(this.currLibraryItems)}catch(r){s(r)}}).catch(i=>{if(i.name==="AbortError")return console.warn("Library update aborted by user"),this.currLibraryItems;throw i}).finally(()=>{this.updateQueue=this.updateQueue.filter(i=>i!==n),this.notifyListeners()});return this.updateQueue.push(n),this.notifyListeners(),n});this.app=t}}const iS=e=>{const n=Math.ceil(Math.sqrt(e.length)),i=[],s=h=>e.slice(h*n,h*n+n).reduce((p,U)=>{const{height:b}=Kr(U.elements);return Math.max(p,b)},0),r=h=>{let m=0,p=0,U=0;for(const b of e){if(m%n===0&&(p=0),p===h){const{width:y}=Kr(b.elements);U=Math.max(U,y)}m++,p++}return U};let o=0,a=0,l=0,c=0,d=0,u=0,f=0;for(const h of e){d&&d%n===0&&(a+=l+50,o=0,u=0,f++),u===0&&(l=s(f)),c=r(u);const{minX:m,minY:p,width:U,height:b}=Kr(h.elements),y=(c-U)/2,E=(l-b)/2;i.push(...h.elements.map(_=>({..._,x:_.x+o+y-m,y:_.y+a+E-p}))),o+=c+50,d++,u++}return i},d4e=(e,t=o4e)=>{if(typeof t=="function"?t(e):t.some(n=>{const i=new URL(`https://${n.replace(/^https?:\/\//,"")}`),{hostname:s,pathname:r}=new URL(e);return new RegExp(`(^|\\.)${i.hostname}$`).test(s)&&new RegExp(`^${i.pathname.replace(/\/+$/,"")}(/+|$)`).test(r)}))return!0;throw new Error(`Invalid or disallowed library URL: "${e}"`)},N_=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get(u4.addLibrary)||new URLSearchParams(window.location.search).get(d4.addLibrary),t=e?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return e?{libraryUrl:e,idToken:t}:null},fc=class fc{constructor(t){B(this,"adapter");this.adapter=t}static async getLibraryItems(t,n,i=!0){const s=()=>new Promise(async(r,o)=>{try{const a=await t.load({source:n});r(HE((a==null?void 0:a.libraryItems)||[],"published"))}catch(a){o(a)}});return i?fc.queue.push(s):s()}getLibraryItems(t){return fc.getLibraryItems(this.adapter,t,!1)}};B(fc,"queue",new Eie),B(fc,"run",async(t,n)=>{const i=new fc(t);return fc.queue.push(()=>n(i))});let $h=fc,u0=0,F5=0;const O_=e=>`${e.id}:${e.name||""}:${t$(e.elements)}`,F_=e=>BT(e.map(t=>O_(t)).sort().join()),IL=async(e,t)=>{try{return F5++,await $h.run(e,async n=>{const i=we(await n.getLibraryItems("save"));for(const[a]of t.deletedItems)i.delete(a);const s=[];for(const[a,l]of t.addedItems)i.has(a)?i.set(a,l):s.push(l);if(t.updatedItems)for(const[a,l]of t.updatedItems)i.set(a,l);const r=s.concat(Array.from(i.values())),o=F_(r);return o!==u0&&await e.save({libraryItems:r}),u0=o,r})}finally{F5--}},u4e=e=>{const{excalidrawAPI:t}=e,n=C.useRef(e);n.current=e;const i=C.useRef(!1);C.useEffect(()=>{if(!t)return;i.current=!1;const s=async({libraryUrl:a,idToken:l})=>{const c=new Promise(async(u,f)=>{try{a=decodeURIComponent(a),a=P9(a),d4e(a,n.current.validateLibraryUrl);const m=await(await fetch(a)).blob();u(m)}catch(h){f(h)}}),d=l!==t.id;await(d&&document.hidden?new Promise(u=>{window.addEventListener("focus",()=>u(),{once:!0})}):null);try{await t.updateLibrary({libraryItems:c,prompt:d,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(u){throw t.updateScene({appState:{errorMessage:u.message}}),u}finally{if(window.location.hash.includes(u4.addLibrary)){const u=new URLSearchParams(window.location.hash.slice(1));u.delete(u4.addLibrary),window.history.replaceState({},Bc,`#${u.toString()}`)}else if(window.location.search.includes(d4.addLibrary)){const u=new URLSearchParams(window.location.search);u.delete(d4.addLibrary),window.history.replaceState({},Bc,`?${u.toString()}`)}}},r=a=>{a.preventDefault();const l=N_();l&&(a.stopImmediatePropagation(),window.history.replaceState({},"",a.oldURL),s(l))},o=N_();if(o&&s(o),"getInitialLibraryItems"in n.current&&n.current.getInitialLibraryItems&&(console.warn("useHandleLibrar `opts.getInitialLibraryItems` is deprecated. Use `opts.adapter` instead."),Promise.resolve(n.current.getInitialLibraryItems()).then(a=>{t.updateLibrary({libraryItems:a,merge:!0})}).catch(a=>{console.error(`UseHandeLibrary getInitialLibraryItems failed: ${a==null?void 0:a.message}`)})),"adapter"in n.current&&n.current.adapter){const a=n.current.adapter,l=n.current.migrationAdapter,c=Fy();l?c.resolve(sd(l.load).then(async d=>{let u=null;try{if(!d)return $h.getLibraryItems(a,"load");u=HE(d.libraryItems||[],"published");const f=await IL(a,AW([],u));try{await l.clear()}catch(h){console.error(`couldn't delete legacy library data: ${h.message}`)}return f}catch(f){return console.error(`couldn't migrate legacy library data: ${f.message}`),u}}).catch(d=>(console.error(`error during library migration: ${d.message}`),$h.getLibraryItems(a,"load")))):c.resolve(sd($h.getLibraryItems,a,"load")),t.updateLibrary({libraryItems:c.then(d=>{const u=d||[];return u0=F_(u),u}),merge:!0}).finally(()=>{i.current=!0})}return window.addEventListener(te.HASHCHANGE,r),()=>{window.removeEventListener(te.HASHCHANGE,r)}},[t]),C.useEffect(()=>{const s=xW.on(async(o,a)=>{const l=i.current,c="adapter"in n.current&&n.current.adapter||null;try{c&&u0!==F_(a)&&await IL(c,o)}catch(d){console.error(`couldn't persist library update: ${d.message}`,o),l&&n.current.excalidrawAPI&&n.current.excalidrawAPI.updateScene({appState:{errorMessage:x("errors.saveLibraryError")}})}}),r=o=>{F5&&R9(o)};return window.addEventListener(te.BEFORE_UNLOAD,r),()=>{window.removeEventListener(te.BEFORE_UNLOAD,r),s(),u0=0,F5=0}},[])},f4e=({theme:e,id:t,libraryReturnUrl:n})=>{const i=n||window.location.origin+window.location.pathname;return g("a",{className:"library-menu-browse-button",href:`https://libraries.excalidraw.com?target=${window.name||"_blank"}&referrer=${i}&useHash=true&token=${t}&theme=${e}&version=${Oy.excalidrawLibrary}`,target:"_excalidraw_libraries",children:x("labels.libraries")})},MW=({libraryReturnUrl:e,theme:t,id:n,style:i,children:s,className:r})=>P("div",{className:ae("library-menu-control-buttons",r),style:i,children:[g(f4e,{id:n,libraryReturnUrl:e,theme:t}),s]}),h4e=Nt(0),g4e=e=>{const[t,n]=dt(h4e);return C.useEffect(()=>{const{current:i}=e;if(!i)return;const s=na(()=>{const{scrollTop:r}=i;n(r)},200);return i.addEventListener("scroll",s),()=>{s.cancel(),i.removeEventListener("scroll",s)}},[e,n]),t},Ig=({label:e,onClick:t,className:n,children:i,actionType:s,type:r="button",isLoading:o,...a})=>{const l=s?`Dialog__action-button--${s}`:"";return P("button",{className:ae("Dialog__action-button",l,n),type:r,"aria-label":e,onClick:t,...a,children:[i&&g("div",{style:o?{visibility:"hidden"}:{},children:i}),g("div",{style:o?{visibility:"hidden"}:{},children:e}),o&&g("div",{style:{position:"absolute",inset:0},children:g(Sa,{})})]})},kW=e=>{const{onConfirm:t,onCancel:n,children:i,confirmText:s=x("buttons.confirm"),cancelText:r=x("buttons.cancel"),className:o="",...a}=e,l=On(),c=d2(sS),{container:d}=Ws();return P(Tr,{onCloseRequest:n,size:"small",...a,className:`confirm-dialog ${o}`,children:[i,P("div",{className:"confirm-dialog-buttons",children:[g(Ig,{label:r,onClick:()=>{l({openMenu:null}),c(!1),tn.flushSync(()=>{n()}),d==null||d.focus()}}),g(Ig,{label:s,onClick:()=>{l({openMenu:null}),c(!1),tn.flushSync(()=>{t()}),d==null||d.focus()},actionType:"danger"})]})]})};class Eu{static has(t){try{return!!window.localStorage.getItem(t)}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),!1}}static get(t){try{const n=window.localStorage.getItem(t);return n?JSON.parse(n):null}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),null}}}B(Eu,"set",(t,n)=>{try{return window.localStorage.setItem(t,JSON.stringify(n)),!0}catch(i){return console.warn(`localStorage.setItem error: ${i.message}`),!1}}),B(Eu,"delete",t=>{try{window.localStorage.removeItem(t)}catch(n){console.warn(`localStorage.removeItem error: ${n.message}`)}});const m4e=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,p4e=/{{([\w-]+)}}/,U4e=/<([\w-]+)>/,b4e=/<\/([\w-]+)>/,y4e=(e,t)=>{const n=[{name:"",children:[]}];return e.split(m4e).filter(Boolean).forEach(i=>{const s=i.match(U4e),r=i.match(b4e),o=i.match(p4e);if(s!==null){const a=s[1];t.hasOwnProperty(a)?n.push({name:a,children:[]}):console.warn(`Trans: missed to pass in prop ${a} for interpolating ${e}`)}else if(r!==null)if(r[1]===n[n.length-1].name){const l=n.pop(),c=de.createElement(de.Fragment,{},...l.children),d=t[l.name];typeof d=="function"&&n[n.length-1].children.push(d(c))}else console.warn(`Trans: unexpected end tag ${i} for interpolating ${e}`);else if(o!==null){const a=o[1];t.hasOwnProperty(a)?n[n.length-1].children.push(t[a]):console.warn(`Trans: key ${a} not in props for interpolating ${e}`)}else n[n.length-1].children.push(i)}),n.length!==1&&console.warn(`Trans: stack not empty for interpolating ${e}`),n[0].children},Hs=({i18nKey:e,children:t,...n})=>{const{t:i}=Ft();return de.createElement(de.Fragment,{},...y4e(i(e),n))},E4e=async e=>{const i=Math.round(8),s=Math.max(Math.round(128/64),2),r=Xie(e,6),o=document.createElement("canvas");o.width=r[0].length*128+(r[0].length+1)*(i*2)-i*2,o.height=r.length*128+(r.length+1)*(i*2)-i*2;const a=o.getContext("2d");a.fillStyle="#fff",a.fillRect(0,0,o.width,o.height);for(const[l,c]of e.entries()){const d=await YE({elements:c.elements,files:null,maxWidthOrHeight:128}),{width:u,height:f}=d,h=Math.floor(l/6)*(128+i*2),m=l%6*(128+i*2);a.drawImage(d,m+(128-u)/2+i,h+(128-f)/2+i),a.lineWidth=s,a.strokeStyle="#ced4da",a.strokeRect(m+i/2,h+i/2,128+i,128+i)}return await ZY(new File([await k5(o)],"preview",{type:Ee.png}),{outputType:Ee.jpg,maxWidthOrHeight:5e3})},v4e=({libItem:e,appState:t,index:n,onChange:i,onRemove:s})=>{const r=C.useRef(null),o=C.useRef(null);return C.useEffect(()=>{const a=r.current;a&&(async()=>{const l=await IW({elements:e.elements,appState:{...t,viewBackgroundColor:"#fff",exportBackground:!0},files:null,skipInliningFonts:!0});a.innerHTML=l.outerHTML})()},[e.elements,t]),P("div",{className:"single-library-item",children:[e.status==="published"&&g("span",{className:"single-library-item-status",children:x("labels.statusPublished")}),g("div",{ref:r,className:"single-library-item__svg"}),g(qe,{"aria-label":x("buttons.remove"),type:"button",icon:lf,className:"single-library-item--remove",onClick:s.bind(null,e.id),title:x("buttons.remove")}),P("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[P("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[P("div",{style:{padding:"0.5em 0"},children:[g("span",{style:{fontWeight:500,color:"#868e96"},children:x("publishDialog.itemName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",ref:o,style:{width:"80%",padding:"0.2rem"},defaultValue:e.name,placeholder:"Item name",onChange:a=>{i(a.target.value,n)}})]}),g("span",{className:"error",children:e.error})]})]})},_4e=({onClose:e,libraryItems:t,appState:n,onSuccess:i,onError:s,updateItemsInStorage:r,onRemove:o})=>{const[a,l]=C.useState({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[c,d]=C.useState(!1);C.useEffect(()=>{const E=Eu.get(W1.PUBLISH_LIBRARY);E&&l(E)},[]);const[u,f]=C.useState(t.slice());C.useEffect(()=>{f(t.slice())},[t]);const h=E=>{l({...a,[E.target.name]:E.target.value})},m=async E=>{E.preventDefault(),d(!0);const _=[];let I=!1;if(u.forEach(D=>{let N="";D.name||(N=x("publishDialog.errors.required"),I=!0),_.push({...D,error:N})}),I){f(_),d(!1);return}const k=await E4e(u),w={type:jr.excalidrawLibrary,version:Oy.excalidrawLibrary,source:S9(),libraryItems:u},T=JSON.stringify(w,null,2),A=new Blob([T],{type:"application/json"}),S=new FormData;S.append("excalidrawLib",A),S.append("previewImage",k),S.append("previewImageType",k.type),S.append("title",a.name),S.append("authorName",a.authorName),S.append("githubHandle",a.githubHandle),S.append("name",a.name),S.append("description",a.description),S.append("twitterHandle",a.twitterHandle),S.append("website",a.website),fetch("https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries/submit",{method:"post",body:S}).then(D=>D.ok?D.json().then(({url:N})=>{Eu.delete(W1.PUBLISH_LIBRARY),i({url:N,authorName:a.authorName,items:u})}):D.json().catch(()=>{throw new Error(D.statusText||"something went wrong")}).then(N=>{throw new Error(N.message||D.statusText||"something went wrong")}),D=>{console.error(D),s(D),d(!1)}).catch(D=>{console.error(D),s(D),d(!1)})},p=()=>{const E=[];return u.forEach((_,I)=>{E.push(g("div",{className:"single-library-item-wrapper",children:g(v4e,{libItem:_,appState:n,index:I,onChange:(k,w)=>{const T=u.slice();T[w].name=k,f(T)},onRemove:o})},I))}),g("div",{className:"selected-library-items",children:E})},U=C.useCallback(()=>{r(u),Eu.set(W1.PUBLISH_LIBRARY,a),e()},[u,e,r,a]),b=!!t.length,y=t.some(E=>E.status==="published");return g(Tr,{onCloseRequest:U,title:x("publishDialog.title"),className:"publish-library",children:b?P("form",{onSubmit:m,children:[g("div",{className:"publish-library-note",children:g(Hs,{i18nKey:"publishDialog.noteDescription",link:E=>g("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener",children:E})})}),g("span",{className:"publish-library-note",children:g(Hs,{i18nKey:"publishDialog.noteGuidelines",link:E=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:E})})}),g("div",{className:"publish-library-note",children:x("publishDialog.noteItems")}),y&&g("span",{className:"publish-library-note publish-library-warning",children:x("publishDialog.republishWarning")}),p(),P("div",{className:"publish-library__fields",children:[P("label",{children:[P("div",{children:[g("span",{children:x("publishDialog.libraryName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"name",required:!0,value:a.name,onChange:h,placeholder:x("publishDialog.placeholder.libraryName")})]}),P("label",{style:{alignItems:"flex-start"},children:[P("div",{children:[g("span",{children:x("publishDialog.libraryDesc")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("textarea",{name:"description",rows:4,required:!0,value:a.description,onChange:h,placeholder:x("publishDialog.placeholder.libraryDesc")})]}),P("label",{children:[P("div",{children:[g("span",{children:x("publishDialog.authorName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"authorName",required:!0,value:a.authorName,onChange:h,placeholder:x("publishDialog.placeholder.authorName")})]}),P("label",{children:[g("span",{children:x("publishDialog.githubUsername")}),g("input",{type:"text",name:"githubHandle",value:a.githubHandle,onChange:h,placeholder:x("publishDialog.placeholder.githubHandle")})]}),P("label",{children:[g("span",{children:x("publishDialog.twitterUsername")}),g("input",{type:"text",name:"twitterHandle",value:a.twitterHandle,onChange:h,placeholder:x("publishDialog.placeholder.twitterHandle")})]}),P("label",{children:[g("span",{children:x("publishDialog.website")}),g("input",{type:"text",name:"website",pattern:"https?://.+",title:x("publishDialog.errors.website"),value:a.website,onChange:h,placeholder:x("publishDialog.placeholder.website")})]}),g("span",{className:"publish-library-note",children:g(Hs,{i18nKey:"publishDialog.noteLicense",link:E=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:E})})})]}),P("div",{className:"publish-library__buttons",children:[g(Ig,{label:x("buttons.saveLibNames"),onClick:U,"data-testid":"cancel-clear-canvas-button"}),g(Ig,{type:"submit",label:x("buttons.submit"),actionType:"primary",isLoading:c})]})]}):g("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:x("publishDialog.atleastOneLibItem")})})},w4e=C.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:ae("Stack Stack_horizontal",s),style:{"--gap":t,alignItems:n,justifyContent:i,...r},ref:o,children:e})),T4e=C.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:ae("Stack Stack_vertical",s),style:{"--gap":t,justifyItems:n,justifyContent:i,...r},ref:o,children:e})),oa={Row:w4e,Col:T4e},RW=({children:e,onClickOutside:t,className:n="",onSelect:i,open:s=!0,align:r="end",style:o})=>{const a=Nn(),l=C.useRef(null),c=_E({onClickOutside:t});MI(l,C.useCallback(u=>{var f,h,m;(h=(f=l.current)==null?void 0:f.closest(`.${Wi.DROPDOWN_MENU_EVENT_WRAPPER}`))!=null&&h.contains(u.target)||(m=c.onClickOutside)==null||m.call(c)},[c])),C.useEffect(()=>{if(!s)return;const u=h=>{var m;h.key===$.ESCAPE&&(h.stopImmediatePropagation(),(m=c.onClickOutside)==null||m.call(c))},f={capture:!0};return document.addEventListener(te.KEYDOWN,u,f),()=>{document.removeEventListener(te.KEYDOWN,u,f)}},[c,s]);const d=ae(`dropdown-menu ${n}`,{"dropdown-menu--mobile":a.formFactor==="phone"}).trim();return g(xj.Provider,{value:{onSelect:i},children:g(O2e,{ref:l,className:d,style:o,"data-testid":"dropdown-menu",align:r,sideOffset:8,onCloseAutoFocus:u=>u.preventDefault(),children:a.formFactor==="phone"?g(oa.Col,{className:"dropdown-menu-container",children:e}):g(fr,{className:"dropdown-menu-container",padding:2,children:e})})})};RW.displayName="DropdownMenuContent";const I4e=({children:e,className:t="",selected:n,...i})=>g("div",{...i,className:`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${n?"dropdown-menu-item--selected":""}`.trim(),children:e}),f0=({icon:e,shortcut:t,href:n,children:i,onSelect:s,className:r="",selected:o,rel:a="noopener",...l})=>{const c=Aj(s);return g(KX,{className:"radix-menu-item",onSelect:c,asChild:!0,children:g("a",{...l,href:n,target:"_blank",rel:`noopener ${a}`,className:CE(r,o),title:l.title??l["aria-label"],children:g(xE,{icon:e,shortcut:t,children:i})})})};f0.displayName="DropdownMenuItemLink";const DW=()=>g("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:"6px 0",flex:"0 0 auto"}});DW.displayName="DropdownMenuSeparator";const M7=-4,S4e=4,LW=({children:e,className:t})=>{const n=Nn(),i=ae(`dropdown-menu dropdown-submenu ${t}`,{"dropdown-menu--mobile":n.formFactor==="phone"}).trim(),s=C.useCallback(c=>{if(c){const d=c.closest(".dropdown-menu-container"),u=d==null?void 0:d.getBoundingClientRect();if(u){const f=c.getBoundingClientRect().width,m=window.innerWidth-u.right;m<f+20&&(o(m-f+M7),l(M7+8))}}},[]),[r,o]=C.useState(S4e),[a,l]=C.useState(M7);return g(z2e,{className:i,sideOffset:r,alignOffset:a,collisionPadding:8,ref:s,children:n.formFactor==="phone"?g(oa.Col,{className:"dropdown-menu-container",children:e}):g(fr,{className:"dropdown-menu-container",padding:2,style:{zIndex:1},children:e})})};LW.displayName="DropdownMenuSubContent";const PW=({children:e,icon:t,shortcut:n,className:i})=>P(B2e,{className:`${CE(i)} dropdown-menu__submenu-trigger`,children:[g(xE,{icon:t,shortcut:n,children:e}),g("div",{className:"dropdown-menu__submenu-trigger-icon",children:Lme})]});PW.displayName="DropdownMenuSubTrigger";const WE=e=>t=>{const n=de.Children.toArray(t).find(i=>de.isValidElement(i)&&typeof i.type!="string"&&(i==null?void 0:i.type.displayName)&&i.type.displayName===e);return n||null},C4e=WE("DropdownMenuTrigger"),x4e=WE("DropdownMenuContent"),A4e=WE("DropdownMenuSubTrigger"),M4e=WE("DropdownMenuSubContent"),Yc=({children:e})=>{const t=A4e(e),n=M4e(e);return P(F2e,{children:[t,n]})};Yc.Trigger=PW;Yc.Content=LW;Yc.displayName="DropdownMenuSub";const NW=({className:e="",children:t,onToggle:n,title:i,...s})=>{const r=Nn(),o=ae(`dropdown-menu-button ${e}`,"zen-mode-transition",{"dropdown-menu-button--mobile":r.formFactor==="phone"}).trim();return g(N2e,{className:o,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:i,...s,children:t})};NW.displayName="DropdownMenuTrigger";const mf=e=>g(Ys,{...e,icon:e.checked?aG:Dme}),Oe=({children:e,open:t})=>{const n=C4e(e),i=x4e(e),s=i&&de.isValidElement(i)?de.cloneElement(i,{open:t}):i;return g(P2e,{open:t,modal:!1,children:P("div",{className:Wi.DROPDOWN_MENU_EVENT_WRAPPER,style:{display:"contents"},children:[n,s]})})};Oe.Trigger=NW;Oe.Content=RW;Oe.Item=Ys;Oe.ItemCheckbox=mf;Oe.ItemLink=f0;Oe.ItemCustom=I4e;Oe.Group=w5;Oe.Separator=DW;Oe.Sub=Yc;Oe.displayName="DropdownMenu";const k4e=(e,t)=>e.filter(n=>t.includes(n.id)),R4e=({setAppState:e,selectedItems:t,library:n,onRemoveFromLibrary:i,resetLibrary:s,onSelectItems:r,appState:o,className:a})=>{const[l]=dt(Tg),[c,d]=dt(sS),u=()=>{const S=t.length?x("alerts.removeItemsFromsLibrary",{count:t.length}):x("alerts.resetLibrary"),D=t.length?x("confirmDialog.removeItemsFromLib"):x("confirmDialog.resetLibrary");return g(kW,{onConfirm:()=>{t.length?i():s(),h(!1)},onCancel:()=>{h(!1)},title:D,children:g("p",{children:S})})},[f,h]=C.useState(!1),m=!!t.length,p=m?l.libraryItems.filter(S=>t.includes(S.id)):l.libraryItems,U=x(m?"buttons.remove":"buttons.resetLibrary"),[b,y]=C.useState(!1),[E,_]=C.useState(null),I=C.useCallback(()=>P(Tr,{onCloseRequest:()=>_(null),title:x("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[g("p",{children:g(Hs,{i18nKey:"publishSuccessDialog.content",authorName:E.authorName,link:S=>g("a",{href:E==null?void 0:E.url,target:"_blank",rel:"noopener noreferrer",children:S})})}),g(qe,{type:"button",title:x("buttons.close"),"aria-label":x("buttons.close"),label:x("buttons.close"),onClick:()=>_(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[_,E]),k=(S,D)=>{y(!1),_({url:S.url,authorName:S.authorName});const N=D.slice();N.forEach(L=>{t.includes(L.id)&&(L.status="published")}),n.setLibrary(N)},w=async()=>{try{await n.updateLibrary({libraryItems:XI({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(S){if((S==null?void 0:S.name)==="AbortError"){console.warn(S);return}e({errorMessage:x("errors.importLibraryError")})}},T=async()=>{const S=m?p:await n.getLatestLibrary();Z3e(S).catch(Dz).catch(D=>{e({errorMessage:D.message})})},A=()=>P(Oe,{open:c,children:[g(Oe.Trigger,{onToggle:()=>d(!c),children:Ghe}),P(Oe.Content,{onClickOutside:()=>d(!1),onSelect:()=>d(!1),className:"library-menu",children:[!m&&g(Oe.Item,{onSelect:w,icon:ZT,"data-testid":"lib-dropdown--load",children:x("buttons.load")}),!!p.length&&g(Oe.Item,{onSelect:T,icon:aE,"data-testid":"lib-dropdown--export",children:x("buttons.export")}),m&&g(Oe.Item,{icon:qge,onSelect:()=>y(!0),"data-testid":"lib-dropdown--remove",children:x("buttons.publishLibrary")}),!!p.length&&g(Oe.Item,{onSelect:()=>h(!0),icon:Ia,children:U})]})]});return P("div",{className:ae("library-menu-dropdown-container",a),children:[A(),t.length>0&&g("div",{className:"library-actions-counter",children:t.length}),f&&u(),b&&g(_4e,{onClose:()=>y(!1),libraryItems:k4e(l.libraryItems,t),appState:o,onSuccess:S=>k(S,l.libraryItems),onError:S=>window.alert(S),updateItemsInStorage:()=>n.setLibrary(l.libraryItems),onRemove:S=>r(t.filter(D=>D!==S))}),E&&I()]})},D4e=({selectedItems:e,onSelectItems:t,className:n})=>{const{library:i}=Ir(),{clearLibraryCache:s,deleteItemsFromLibraryCache:r}=nS(),o=Qt(),a=On(),[l]=dt(Tg),c=async u=>{const f=u.filter(h=>!e.includes(h.id));i.setLibrary(f).catch(()=>{a({errorMessage:x("alerts.errorRemovingFromLibrary")})}),r(e),t([])};return g(R4e,{appState:o,setAppState:a,selectedItems:e,onSelectItems:t,library:i,onRemoveFromLibrary:()=>c(l.libraryItems),resetLibrary:()=>{i.resetLibrary(),s()},className:n})};function L4e(){return[!1,C.useCallback(t=>t(),[])]}const P4e=de.useTransition||L4e,N4e=C.memo(({id:e,elements:t,isPending:n,onClick:i,selected:s,onToggle:r,onDrag:o,svgCache:a})=>{const l=C.useRef(null),c=CW(e,t,a,l),[d,u]=C.useState(!1),f=Nn().formFactor==="phone",h=n&&g("div",{className:"library-unit__adder",children:$he});return P("div",{className:ae("library-unit",{"library-unit__active":t,"library-unit--hover":t&&d,"library-unit--selected":s,"library-unit--skeleton":!c}),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[g("div",{className:ae("library-unit__dragger",{"library-unit__pulse":!!n}),ref:l,draggable:!!t,onClick:t||n?m=>{e&&m.shiftKey?r(e,m):i(e)}:void 0,onDragStart:m=>{if(!e){m.preventDefault();return}u(!1),o(e,m)}}),h,e&&t&&(d||f||s)&&g(BI,{checked:s,onChange:(m,p)=>r(e,p),className:"library-unit__checkbox"})]})}),O4e=()=>g("div",{className:"library-unit library-unit--skeleton"}),k7=({children:e})=>g("div",{className:"library-menu-items-container__grid",children:e}),WU=C.memo(({items:e,onItemSelectToggle:t,onItemDrag:n,isItemSelected:i,onClick:s,svgCache:r,itemsRenderedPerBatch:o})=>{const[,a]=P4e(),[l,c]=C.useState(0);return C.useEffect(()=>{l<e.length&&a(()=>{c(l+o)})},[l,e.length,a,o]),g(fe,{children:e.map((d,u)=>u<l?g(N4e,{elements:d==null?void 0:d.elements,isPending:!(d!=null&&d.id)&&!!(d!=null&&d.elements),onClick:s,svgCache:r,id:d==null?void 0:d.id,selected:i(d.id),onToggle:t,onDrag:n},(d==null?void 0:d.id)??u):g(O4e,{},u))})}),gd=({type:e="button",onSelect:t,selected:n,children:i,className:s="",...r})=>g("button",{onClick:By(r.onClick,o=>{t()}),type:e,className:ae("excalidraw-button",s,{selected:n}),...r,children:i}),Xu=C.forwardRef(({onChange:e,label:t,fullWidth:n,placeholder:i,readonly:s,selectOnRender:r,onKeyDown:o,isRedacted:a=!1,icon:l,className:c,type:d,...u},f)=>{const h=C.useRef(null);C.useImperativeHandle(f,()=>h.current),C.useLayoutEffect(()=>{var U,b;r&&((U=h.current)==null||U.focus(),(b=h.current)==null||b.select())},[r]);const[m,p]=C.useState(!1);return P("div",{className:ae("ExcTextField",c,{"ExcTextField--fullWidth":n,"ExcTextField--hasIcon":!!l}),onClick:()=>{var U;(U=h.current)==null||U.focus()},children:[l,t&&g("div",{className:"ExcTextField__label",children:t}),P("div",{className:ae("ExcTextField__input",{"ExcTextField__input--readonly":s}),children:[g("input",{className:ae({"is-redacted":"value"in u&&u.value&&a&&!m}),readOnly:s,value:"value"in u?u.value:void 0,defaultValue:"defaultValue"in u?u.defaultValue:void 0,placeholder:i,ref:h,onChange:U=>e==null?void 0:e(U.target.value),onKeyDown:o,type:d}),a&&g(gd,{onSelect:()=>p(!m),style:{border:0,userSelect:"none"},children:m?ame:eI})]})]})}),F4e=17,B4e=64;function z4e({isLoading:e,libraryItems:t,onAddToLibrary:n,onInsertLibraryItems:i,pendingElements:s,theme:r,id:o,libraryReturnUrl:a,onSelectItems:l,selectedItems:c}){const d=Nn(),u=C.useRef(null),f=g4e(u);C.useEffect(()=>{var O;f>0&&((O=u.current)==null||O.scrollTo(0,f))},[]);const{svgCache:h}=nS(),[m,p]=C.useState(null),[U,b]=C.useState(""),y=!t.length&&!s.length,E=!y&&!!U.trim(),_=C.useMemo(()=>{const O=d0(U.trim().toLowerCase());return O?t.filter(z=>{const H=z.name||"";return H.trim()&&d0(H.toLowerCase()).includes(O)}):[]},[t,U]),I=C.useMemo(()=>t.filter(O=>O.status!=="published"),[t]),k=C.useMemo(()=>t.filter(O=>O.status==="published"),[t]),w=C.useCallback((O,z)=>{const H=!c.includes(O),X=[...I,...k];if(H){if(z.shiftKey&&m){const Q=X.findIndex(Ae=>Ae.id===m),re=X.findIndex(Ae=>Ae.id===O);if(Q===-1||re===-1){l([...c,O]);return}const ie=we(c),me=Math.min(Q,re),ke=Math.max(Q,re),ye=X.reduce((Ae,$e,et)=>((et>=me&&et<=ke||ie.has($e.id))&&Ae.push($e.id),Ae),[]);l(ye)}else l([...c,O]);p(O)}else p(null),l(c.filter(Q=>Q!==O))},[m,l,k,c,I]);C.useEffect(()=>{c.length||p(null)},[c]);const T=C.useCallback(O=>{let z;return c.includes(O)?z=t.filter(H=>c.includes(H.id)):z=t.filter(H=>H.id===O),z.map(H=>({...H,elements:J1({type:"everything",elements:H.elements,randomizeSeed:!0}).duplicatedElements}))},[t,c]),A=C.useCallback((O,z)=>{const H={itemIds:c.includes(O)?c:[O]};z.dataTransfer.setData(Ee.excalidrawlibIds,JSON.stringify(H))},[c]),S=C.useCallback(O=>O?c.includes(O):!1,[c]),D=C.useCallback(()=>{n(s)},[s,n]),N=C.useCallback(O=>{O&&i(T(O))},[T,i]),L=h.size>=(_.length?_:t).length?B4e:F4e,j=C.useRef(null);C.useEffect(()=>{$ie(()=>{var O;(O=j.current)==null||O.focus()})},[]);const Y=!E&&P(fe,{children:[!y&&g("div",{className:"library-menu-items-container__header",children:x("labels.personalLib")}),!s.length&&!I.length?P("div",{className:"library-menu-items__no-items",children:[!k.length&&g("div",{className:"library-menu-items__no-items__label",children:x("library.noItems")}),g("div",{className:"library-menu-items__no-items__hint",children:k.length>0?x("library.hint_emptyPrivateLibrary"):x("library.hint_emptyLibrary")})]}):P(k7,{children:[s.length>0&&g(WU,{itemsRenderedPerBatch:L,items:[{id:null,elements:s}],onItemSelectToggle:w,onItemDrag:A,onClick:D,isItemSelected:S,svgCache:h}),g(WU,{itemsRenderedPerBatch:L,items:I,onItemSelectToggle:w,onItemDrag:A,onClick:N,isItemSelected:S,svgCache:h})]}),k.length>0&&g("div",{className:"library-menu-items-container__header",style:{marginTop:"0.75rem"},children:x("labels.excalidrawLib")}),k.length>0&&g(k7,{children:g(WU,{itemsRenderedPerBatch:L,items:k,onItemSelectToggle:w,onItemDrag:A,onClick:N,isItemSelected:S,svgCache:h})})]}),G=E&&P(fe,{children:[P("div",{className:"library-menu-items-container__header",children:[x("library.search.heading"),!e&&P("div",{className:"library-menu-items-container__header__hint",style:{cursor:"pointer"},onPointerDown:O=>O.preventDefault(),onClick:O=>{b("")},children:[g("kbd",{children:"esc"})," to clear"]})]}),_.length>0?g(k7,{children:g(WU,{itemsRenderedPerBatch:L,items:_,onItemSelectToggle:w,onItemDrag:A,onClick:N,isItemSelected:S,svgCache:h})}):P("div",{className:"library-menu-items__no-items",children:[g("div",{className:"library-menu-items__no-items__hint",children:x("library.search.noResults")}),g(gd,{onPointerDown:O=>O.preventDefault(),onSelect:()=>{b("")},style:{width:"auto",marginTop:"1rem"},children:x("library.search.clearSearch")})]})]});return P("div",{className:"library-menu-items-container",style:s.length||I.length||k.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[P("div",{className:"library-menu-items-header",children:[!y&&g(Xu,{ref:j,type:"search",className:ae("library-menu-items-container__search",{hideCancelButton:d.formFactor!=="phone"}),placeholder:x("library.search.inputPlaceholder"),value:U,onChange:O=>b(O)}),g(D4e,{selectedItems:c,onSelectItems:l,className:"library-menu-dropdown-container--in-heading"})]}),P(oa.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:k.length>0?1:"0 1 auto",margin:y?"auto":0},ref:u,children:[e&&g("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:g(Sa,{})}),Y,G,y&&g(MW,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:a,theme:r})]})]})}const sS=Nt(!1),SL=({children:e})=>g("div",{className:"layer-ui__library",children:e}),H4e=C.memo(({onInsertLibraryItems:e,pendingElements:t,onAddToLibrary:n,setAppState:i,libraryReturnUrl:s,library:r,id:o,theme:a,selectedItems:l,onSelectItems:c})=>{const[d]=dt(Tg),u=C.useCallback(m=>{(async(U,b)=>{at("element","addToLibrary","ui");for(const E of yz)if(U.some(_=>_.type===E))return i({errorMessage:x(`errors.libraryElementTypeError.${E}`)});const y=[{status:"unpublished",elements:U,id:Li(),created:Date.now()},...b];n(),r.setLibrary(y).catch(()=>{i({errorMessage:x("alerts.errorAddingToLibrary")})})})(m,d.libraryItems)},[n,r,i,d.libraryItems]),f=C.useMemo(()=>d.libraryItems,[d]);if(d.status==="loading"&&!d.isInitialized)return g(SL,{children:g("div",{className:"layer-ui__library-message",children:P("div",{children:[g(Sa,{size:"2em"}),g("span",{children:x("labels.libraryLoadingMessage")})]})})});const h=d.libraryItems.length>0||t.length>0;return P(SL,{children:[g(z4e,{isLoading:d.status==="loading",libraryItems:f,onAddToLibrary:u,onInsertLibraryItems:e,pendingElements:t,id:o,libraryReturnUrl:s,theme:a,onSelectItems:c,selectedItems:l}),h&&g(MW,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:o,libraryReturnUrl:s,theme:a})]})}),R7=(e,t)=>({elements:e,pending:Ze(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}),selectedElementIds:t}),V4e=(e,t)=>{const n=n8(),[i,s]=C.useState(()=>R7(n,e.selectedElementIds)),r=C.useRef(new Map);return C.useEffect(()=>{for(const o of i.pending)r.current.set(o.id,o.version)},[i.pending]),C.useEffect(()=>{t.state.cursorButton==="up"&&t.state.activeTool.type==="selection"&&s(o=>{var l;if(!ki(o.selectedElementIds,e.selectedElementIds))return r.current.clear(),R7(n,e.selectedElementIds);const a=t.scene.getNonDeletedElementsMap();for(const c of Object.keys(e.selectedElementIds)){const d=(l=a.get(c))==null?void 0:l.version;if(d&&d!==r.current.get(c))return R7(n,e.selectedElementIds)}return o})},[t,t.state.cursorButton,t.state.activeTool.type,e.selectedElementIds,n]),i.pending},$4e=C.memo(()=>{const e=Ir(),{onInsertElements:t}=e,n=I2(),i=Qt(),s=On(),[r,o]=C.useState([]),a=C.useMemo(()=>e.library,[e.library]),l=V4e(i,e);C.useEffect(()=>an(document,te.KEYDOWN,u=>{if(u.key===$.ESCAPE&&u.target instanceof HTMLElement){const f=u.target;if(f.closest(`.${Wi.SIDEBAR}`))r.length>0?(u.stopPropagation(),o([])):rl(f)&&f instanceof HTMLInputElement&&!f.value&&(u.stopPropagation(),s({openSidebar:null}),e.focusContainer());else if(r.length>0){const{x:h,y:m}=e.lastViewportPosition,p=document.elementFromPoint(h,m);p!=null&&p.closest(`.${Wi.SIDEBAR}`)&&(u.stopPropagation(),o([]))}}},{capture:!0}),[r,s,e]);const c=C.useCallback(u=>{t(iS(u)),e.focusContainer()},[t,e]),d=C.useCallback(()=>{s({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[s]);return g(H4e,{pendingElements:l,onInsertLibraryItems:c,onAddToLibrary:d,setAppState:s,libraryReturnUrl:n.libraryReturnUrl,library:a,id:e.id,theme:i.theme,selectedItems:r,onSelectItems:o})}),G4e=e=>{const{closeOnClickOutside:t=!0}=e,n=Tj({className:"excalidraw-modal-container"}),i=C.useRef(document.body.classList.contains("excalidraw-animations-disabled"));if(!n)return null;const s=r=>{r.key===$.ESCAPE&&(r.nativeEvent.stopImmediatePropagation(),r.stopPropagation(),e.onCloseRequest())};return tn.createPortal(P("div",{className:ae("Modal",e.className,{"animations-disabled":i.current}),role:"dialog","aria-modal":"true",onKeyDown:s,"aria-labelledby":e.labelledBy,children:[g("div",{className:"Modal__background",onClick:t?e.onCloseRequest:void 0}),g("div",{className:"Modal__content",style:{"--max-width":`${e.maxWidth}px`},tabIndex:0,children:e.children})]}),n)};function X4e(e){if(e&&typeof e=="number")return e;switch(e){case"small":return 550;case"wide":return 1024;case"regular":default:return 800}}const Tr=e=>{const[t,n]=EW(),[i]=C.useState(document.activeElement),{id:s}=Ws(),r=Nn().formFactor==="phone";C.useEffect(()=>{if(!t)return;const c=m4(t);setTimeout(()=>{c.length>0&&e.autofocus!==!1&&(c[1]||c[0]).focus()});const d=u=>{if(u.key===$.TAB){const f=m4(t),{activeElement:h}=document,m=f.findIndex(p=>p===h);m===0&&u.shiftKey?(f[f.length-1].focus(),u.preventDefault()):m===f.length-1&&!u.shiftKey&&(f[0].focus(),u.preventDefault())}};return t.addEventListener("keydown",d),()=>t.removeEventListener("keydown",d)},[t,e.autofocus]);const o=On(),a=d2(sS),l=()=>{o({openMenu:null}),a(!1),i.focus(),e.onCloseRequest()};return g(G4e,{className:ae("Dialog",e.className,{"Dialog--fullscreen":r}),labelledBy:"dialog-title",maxWidth:X4e(e.size),onCloseRequest:l,closeOnClickOutside:e.closeOnClickOutside,children:P(fr,{ref:n,children:[e.title&&g("h2",{id:`${s}-dialog-title`,className:"Dialog__title",children:g("span",{className:"Dialog__titleContent",children:e.title})}),r&&g("button",{className:"Dialog__close",onClick:l,title:x("buttons.close"),"aria-label":x("buttons.close"),type:"button",children:lf}),g("div",{className:"Dialog__content",children:e.children})]})})},B_=[{icon:oE,value:"selection",key:$.V,numericKey:$[1],fillable:!0},{icon:GT,value:"rectangle",key:$.R,numericKey:$[2],fillable:!0},{icon:XT,value:"diamond",key:$.D,numericKey:$[3],fillable:!0},{icon:jT,value:"ellipse",key:$.O,numericKey:$[4],fillable:!0},{icon:iG,value:"arrow",key:$.A,numericKey:$[5],fillable:!0},{icon:YT,value:"line",key:$.L,numericKey:$[6],fillable:!0},{icon:u2,value:"freedraw",key:[$.P,$.X],numericKey:$[7],fillable:!1},{icon:Fh,value:"text",key:$.T,numericKey:$[8],fillable:!1},{icon:Mb,value:"image",key:null,numericKey:$[9],fillable:!1},{icon:sG,value:"eraser",key:$.E,numericKey:$[0],fillable:!1}],OW=e=>e.state.preferredSelectionTool.type==="lasso"?[{value:"lasso",icon:oE,key:$.V,numericKey:$[1],fillable:!0},...B_.slice(1)]:B_,j4e=(e,t)=>{const n=OW(t).find((i,s)=>i.numericKey!=null&&e===i.numericKey.toString()||i.key&&(typeof i.key=="string"?i.key===e:i.key.includes(e)));return(n==null?void 0:n.value)||null};var Y4e={};const CL=e=>{let t;const n=new Set,i=(d,u)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,h))}},s=()=>t,l={setState:i,getState:s,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Y4e?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(i,s,l);return l},W4e=e=>e?CL(e):CL;var FW={exports:{}},BW={},zW={exports:{}},HW={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sg=C;function K4e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Z4e=typeof Object.is=="function"?Object.is:K4e,q4e=Sg.useState,Q4e=Sg.useEffect,J4e=Sg.useLayoutEffect,e_e=Sg.useDebugValue;function t_e(e,t){var n=t(),i=q4e({inst:{value:n,getSnapshot:t}}),s=i[0].inst,r=i[1];return J4e(function(){s.value=n,s.getSnapshot=t,D7(s)&&r({inst:s})},[e,n,t]),Q4e(function(){return D7(s)&&r({inst:s}),e(function(){D7(s)&&r({inst:s})})},[e]),e_e(n),n}function D7(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Z4e(e,n)}catch{return!0}}function n_e(e,t){return t()}var i_e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?n_e:t_e;HW.useSyncExternalStore=Sg.useSyncExternalStore!==void 0?Sg.useSyncExternalStore:i_e;zW.exports=HW;var s_e=zW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KE=C,r_e=s_e;function o_e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var a_e=typeof Object.is=="function"?Object.is:o_e,l_e=r_e.useSyncExternalStore,c_e=KE.useRef,d_e=KE.useEffect,u_e=KE.useMemo,f_e=KE.useDebugValue;BW.useSyncExternalStoreWithSelector=function(e,t,n,i,s){var r=c_e(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=u_e(function(){function l(h){if(!c){if(c=!0,d=h,h=i(h),s!==void 0&&o.hasValue){var m=o.value;if(s(m,h))return u=m}return u=h}if(m=u,a_e(d,h))return m;var p=i(h);return s!==void 0&&s(m,p)?(d=h,m):(d=h,u=p)}var c=!1,d,u,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,i,s]);var a=l_e(e,r[0],r[1]);return d_e(function(){o.hasValue=!0,o.value=a},[a]),f_e(a),a};FW.exports=BW;var h_e=FW.exports;const g_e=Hl(h_e);var VW={};const{useDebugValue:m_e}=de,{useSyncExternalStoreWithSelector:p_e}=g_e;let xL=!1;const U_e=e=>e;function b_e(e,t=U_e,n){(VW?"production":void 0)!=="production"&&n&&!xL&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),xL=!0);const i=p_e(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return m_e(i),i}const AL=e=>{(VW?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?W4e(e):e,n=(i,s)=>b_e(t,i,s);return Object.assign(n,t),n},y_e=e=>e?AL(e):AL;var ML,kL;const RL=typeof window<"u"&&((ML=window.document)!=null&&ML.createElement||((kL=window.navigator)==null?void 0:kL.product)==="ReactNative")?de.useLayoutEffect:de.useEffect;function Ho(){const e=y_e(t=>({current:new Array,version:0,set:t}));return{In:({children:t})=>{const n=e(s=>s.set),i=e(s=>s.version);return RL(()=>{n(s=>({version:s.version+1}))},[]),RL(()=>(n(({current:s})=>({current:[...s,t]})),()=>n(({current:s})=>({current:s.filter(r=>r!==t)}))),[t,i]),null},Out:()=>{const t=e(n=>n.current);return de.createElement(de.Fragment,null,t)}}}const $W=de.createContext(null),gs=()=>de.useContext($W),E_e=a$(),v_e=()=>de.useMemo(()=>({MainMenuTunnel:Ho(),WelcomeScreenMenuHintTunnel:Ho(),WelcomeScreenToolbarHintTunnel:Ho(),WelcomeScreenHelpHintTunnel:Ho(),WelcomeScreenCenterTunnel:Ho(),FooterCenterTunnel:Ho(),DefaultSidebarTriggerTunnel:Ho(),DefaultSidebarTabTriggersTunnel:Ho(),OverwriteConfirmDialogTunnel:Ho(),TTDDialogTriggerTunnel:Ho(),tunnelsJotai:E_e}),[]),B5=ue({name:"viewMode",label:"labels.viewMode",icon:eI,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.viewModeEnabled},perform(e,t){return{appState:{...t,viewModeEnabled:!this.checked(t)},captureUpdate:q.EVENTUALLY}},checked:e=>e.viewModeEnabled,predicate:(e,t,n)=>typeof n.viewModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ut.R}),Gb=({app:e,options:t,activeTool:n,defaultOption:i,className:s="Shape",namePrefix:r,title:o,"data-testid":a,onToolChange:l,displayedOption:c,fillable:d=!1})=>{const[u,f]=C.useState(!1),h=n.type,m=c.type===h,p=32/2+10,{container:U}=Ws();return!t.some(b=>b.type===h)&&u&&f(!1),C.useEffect(()=>{const b=e.onPointerDownEmitter.on(()=>{f(!1)});return()=>b==null?void 0:b()},[e]),P(Gl,{open:u,children:[g(Xl,{asChild:!0,children:g(qe,{className:ae(s,{fillable:d,active:t.some(b=>b.type===n.type)}),type:"radio",icon:c.icon,checked:m,name:"editor-current-shape",title:o,"aria-label":o,"data-testid":a,onPointerDown:()=>{f(b=>!b),l(i)}})}),g(EE,{className:"tool-popover-content",sideOffset:p,collisionBoundary:U??void 0,children:t.map(({type:b,icon:y,title:E})=>g(qe,{className:ae(s,{active:h===b}),type:"radio",icon:y,checked:h===b,name:`${r}-option`,title:E||Ht(b),keyBindingLabel:"","aria-label":E||Ht(b),"data-testid":`toolbar-${b}`,onChange:()=>{e.state.activeTool.type!==b&&at("toolbar",b,"ui"),e.setActiveTool({type:b}),l==null||l(b)}},b))})]})},rS=ae([Wi.SHAPE_ACTIONS_THEME_SCOPE,"properties-content"]),ZE=(e,t)=>{var i;let n=((i=t[0])==null?void 0:i.type)||null;for(const s of t)if(s.type!==n){n=null;break}return z4(e.activeTool.type)&&n!=="image"&&n!=="frame"&&n!=="magicframe"||t.some(s=>z4(s.type))},qE=(e,t)=>ld(e.activeTool.type)||t.some(n=>ld(n.type)),__e=({appState:e,elementsMap:t,renderAction:n,app:i})=>{var m;const s=Qy(t,e);let r=!1;s.length===2&&(Ki(s[0])||Ki(s[1]))&&(r=!0);const o=!!(e.editingTextElement||e.newElement),a=Nn(),l=document.documentElement.getAttribute("dir")==="rtl",c=ld(e.activeTool.type)&&!ds(e.currentItemBackgroundColor)||s.some(p=>ld(p.type)&&!ds(p.backgroundColor)),d=s.length===1||r,u=!((m=e.selectedLinearElement)!=null&&m.isEditing)&&s.length===1&&De(s[0])&&!ve(s[0]),f=!e.croppingElementId&&s.length===1&&xt(s[0]),h=!r&&Xs(e,i);return P("div",{className:"selected-shape-actions",children:[g("div",{children:ZE(e,s)&&n("changeStrokeColor")}),qE(e,s)&&g("div",{children:n("changeBackgroundColor")}),c&&n("changeFillStyle"),(r5(e.activeTool.type)||s.some(p=>r5(p.type)))&&n("changeStrokeWidth"),(e.activeTool.type==="freedraw"||s.some(p=>p.type==="freedraw"))&&n("changeStrokeShape"),(o5(e.activeTool.type)||s.some(p=>o5(p.type)))&&P(fe,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),(G0(e.activeTool.type)||s.some(p=>G0(p.type)))&&g(fe,{children:n("changeRoundness")}),(a5(e.activeTool.type)||s.some(p=>a5(p.type)))&&g(fe,{children:n("changeArrowType")}),(e.activeTool.type==="text"||s.some(he))&&P(fe,{children:[n("changeFontFamily"),n("changeFontSize"),(e.activeTool.type==="text"||KH(s,t))&&n("changeTextAlign")]}),WH(s,t)&&n("changeVerticalAlign"),(l5(e.activeTool.type)||s.some(p=>l5(p.type)))&&g(fe,{children:n("changeArrowhead")}),n("changeOpacity"),P("fieldset",{children:[g("legend",{children:x("labels.layers")}),P("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringForward"),n("bringToFront")]})]}),h&&!r&&P("fieldset",{children:[g("legend",{children:x("labels.align")}),P("div",{className:"buttonList",children:[l?P(fe,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):P(fe,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),s.length>2&&n("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),P("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),s.length>2&&n("distributeVertically")]})]})]}),!o&&s.length>0&&P("fieldset",{children:[g("legend",{children:x("labels.actions")}),P("div",{className:"buttonList",children:[a.formFactor!=="phone"&&n("duplicateSelection"),a.formFactor!=="phone"&&n("deleteSelectedElements"),n("group"),n("ungroup"),d&&n("hyperlink"),f&&n("cropEditor"),u&&n("toggleLinearEditor")]})]})]})},GW=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s})=>{const r=ld(e.activeTool.type)&&!ds(e.currentItemBackgroundColor)||i.some(l=>ld(l.type)&&!ds(l.backgroundColor)),o=i.length>0||e.activeTool.type!=="selection"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser"&&e.activeTool.type!=="lasso",a=e.openPopup==="compactStrokeStyles";return o?g("div",{className:"compact-action-item",children:P(Gl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactStrokeStyles"}:{openPopup:null})},children:[g(Xl,{asChild:!0,children:g("button",{type:"button",className:ae("compact-action-button properties-trigger",{active:a}),title:x("labels.stroke"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactStrokeStyles"})},children:Cme})}),a&&g(Qg,{className:rS,container:s,style:{maxWidth:"13rem"},onClose:()=>{},children:P("div",{className:"selected-shape-actions",children:[r&&t("changeFillStyle"),(r5(e.activeTool.type)||i.some(l=>r5(l.type)))&&t("changeStrokeWidth"),(o5(e.activeTool.type)||i.some(l=>o5(l.type)))&&P(fe,{children:[t("changeStrokeStyle"),t("changeSloppiness")]}),(G0(e.activeTool.type)||i.some(l=>G0(l.type)))&&t("changeRoundness"),t("changeOpacity")]})})]})}):null},XW=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,app:r})=>{const o=a5(e.activeTool.type)||i.some(l=>a5(l.type)),a=e.openPopup==="compactArrowProperties";return o?g("div",{className:"compact-action-item",children:P(Gl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactArrowProperties"}:{openPopup:null})},children:[g(Xl,{asChild:!0,children:g("button",{type:"button",className:ae("compact-action-button properties-trigger",{active:a}),title:x("labels.arrowtypes"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactArrowProperties"})},children:(()=>{const l=As(i,r,c=>Te(c)?c.elbowed?"elbow":c.roundness?"round":"sharp":null,c=>Te(c),c=>c?null:e.currentItemArrowType);return l==="elbow"?iI:l==="round"?sI:nI})()})}),a&&g(Qg,{container:s,className:"properties-content",style:{maxWidth:"13rem"},onClose:()=>{},children:t("changeArrowProperties")})]})}):null},jW=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,elementsMap:r})=>{const{saveCaretPosition:o,restoreCaretPosition:a}=eUe(),l=e.openPopup==="compactTextProperties";return g("div",{className:"compact-action-item",children:P(Gl,{open:l,onOpenChange:c=>{c?(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"})):(n({openPopup:null}),e.editingTextElement&&a())},children:[g(Xl,{asChild:!0,children:g("button",{type:"button",className:ae("compact-action-button properties-trigger",{active:l}),title:x("labels.textAlign"),onClick:c=>{c.preventDefault(),c.stopPropagation(),l?n({openPopup:null}):(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"}))},children:Qhe})}),e.openPopup==="compactTextProperties"&&g(Qg,{className:rS,container:s,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!e.editingTextElement,onClose:()=>{e.editingTextElement&&a()},children:P("div",{className:"selected-shape-actions",children:[(e.activeTool.type==="text"||i.some(he))&&t("changeFontSize"),(e.activeTool.type==="text"||KH(i,r))&&t("changeTextAlign"),WH(i,r)&&t("changeVerticalAlign")]})})]})})},YW=({appState:e,renderAction:t,targetElements:n,setAppState:i,container:s,app:r,showDuplicate:o,showDelete:a})=>{const l=!!(e.editingTextElement||e.newElement),c=!e.croppingElementId&&n.length===1&&xt(n[0]),d=n.length===1,u=Xs(e,r);let f=!1;n.length===2&&(Ki(n[0])||Ki(n[1]))&&(f=!0);const h=document.documentElement.getAttribute("dir")==="rtl",m=e.openPopup==="compactOtherProperties";return l||n.length===0?null:g("div",{className:"compact-action-item",children:P(Gl,{open:m,onOpenChange:p=>{i(p?{openPopup:"compactOtherProperties"}:{openPopup:null})},children:[g(Xl,{asChild:!0,children:g("button",{type:"button",className:ae("compact-action-button properties-trigger",{active:m}),title:x("labels.actions"),onClick:p=>{p.preventDefault(),p.stopPropagation(),i({openPopup:m?null:"compactOtherProperties"})},children:Xhe})}),m&&g(Qg,{className:rS,container:s,style:{maxWidth:"12rem",justifyContent:"center",alignItems:"center"},onClose:()=>{},children:P("div",{className:"selected-shape-actions",children:[P("fieldset",{children:[g("legend",{children:x("labels.layers")}),P("div",{className:"buttonList",children:[t("sendToBack"),t("sendBackward"),t("bringForward"),t("bringToFront")]})]}),u&&!f&&P("fieldset",{children:[g("legend",{children:x("labels.align")}),P("div",{className:"buttonList",children:[h?P(fe,{children:[t("alignRight"),t("alignHorizontallyCentered"),t("alignLeft")]}):P(fe,{children:[t("alignLeft"),t("alignHorizontallyCentered"),t("alignRight")]}),n.length>2&&t("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),P("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[t("alignTop"),t("alignVerticallyCentered"),t("alignBottom"),n.length>2&&t("distributeVertically")]})]})]}),P("fieldset",{children:[g("legend",{children:x("labels.actions")}),P("div",{className:"buttonList",children:[t("group"),t("ungroup"),d&&t("hyperlink"),c&&t("cropEditor"),o&&t("duplicateSelection"),a&&t("deleteSelectedElements")]})]})]})})]})})},w_e=({appState:e,renderAction:t,targetElements:n})=>{var s;return!((s=e.selectedLinearElement)!=null&&s.isEditing)&&n.length===1&&De(n[0])&&!ve(n[0])?g("div",{className:"compact-action-item",children:t("toggleLinearEditor")}):null},T_e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var c;const r=Qy(t,e),{container:o}=Ws(),a=!!(e.editingTextElement||e.newElement),l=!((c=e.selectedLinearElement)!=null&&c.isEditing)&&r.length===1&&De(r[0])&&!ve(r[0]);return P("div",{className:"compact-shape-actions",children:[ZE(e,r)&&g("div",{className:ae("compact-action-item"),children:n("changeStrokeColor")}),qE(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(GW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(XW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),l&&g("div",{className:"compact-action-item",children:n("toggleLinearEditor")}),(e.activeTool.type==="text"||r.some(he))&&P(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(jW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")}),g(YW,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i})]})},I_e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var U,b;const r=Qy(t,e),{container:o}=Ws(),a=C.useRef(null),l=((b=(U=a.current)==null?void 0:U.getBoundingClientRect())==null?void 0:b.width)??0,c=9,d=6,u=32,f=c*u+(c-1)*d,h=u+d,m=l>=f+h,p=l>=f+2*h;return P(fr,{className:"compact-shape-actions mobile-shape-actions",style:{flexDirection:"row",boxShadow:"none",padding:0,zIndex:2,backgroundColor:"transparent",height:u*1.35,marginBottom:4,alignItems:"center",gap:d,pointerEvents:"none"},ref:a,children:[P("div",{style:{display:"flex",flexDirection:"row",gap:d,flex:1},children:[ZE(e,r)&&g("div",{className:ae("compact-action-item"),children:n("changeStrokeColor")}),qE(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(GW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(XW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),g(w_e,{appState:e,renderAction:n,targetElements:r}),(e.activeTool.type==="text"||r.some(he))&&P(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(jW,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),g(YW,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i,showDuplicate:!p,showDelete:!m})]}),P("div",{style:{display:"flex",flexDirection:"row",gap:d},children:[g("div",{className:"compact-action-item",children:n("undo")}),g("div",{className:"compact-action-item",children:n("redo")}),p&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),m&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")})]})]})},S_e=({activeTool:e,setAppState:t,app:n,UIOptions:i})=>{const[s,r]=C.useState(!1),o=Na(),a=o==="full",l=o==="compact",c=[{type:"selection",icon:oE,title:Ht(x("toolBar.selection"))},{type:"lasso",icon:i0,title:Ht(x("toolBar.lasso"))}],d=e.type==="frame",u=e.type==="laser",f=a&&e.type==="lasso"&&n.state.preferredSelectionTool.type!=="lasso",h=e.type==="embeddable",{TTDDialogTriggerTunnel:m}=gs();return P(fe,{children:[OW(n).map(({value:p,icon:U,key:b,numericKey:y,fillable:E},_)=>{var T;if(((T=i.tools)==null?void 0:T[p])===!1)return null;const I=x(`toolBar.${p}`),k=b&&Ht(typeof b=="string"?b:b[0]),w=k?`${k} ${x("helpDialog.or")} ${y}`:`${y}`;return(p==="selection"||p==="lasso")&&l?g(Gb,{app:n,options:c,activeTool:e,defaultOption:n.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Ht(x("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:A=>{(A==="selection"||A==="lasso")&&(n.setActiveTool({type:A}),t({preferredSelectionTool:{type:A,initialized:!0}}))},displayedOption:c.find(A=>A.type===n.state.preferredSelectionTool.type)||c[0],fillable:e.type==="selection"},"selection-popover"):g(qe,{className:ae("Shape",{fillable:E}),type:"radio",icon:U,checked:e.type===p,name:"editor-current-shape",title:`${Ht(I)}  ${w}`,keyBindingLabel:y||k,"aria-label":Ht(I),"aria-keyshortcuts":w,"data-testid":`toolbar-${p}`,onPointerDown:({pointerType:A})=>{!n.state.penDetected&&A==="pen"&&n.togglePenMode(!0),p==="selection"&&(n.state.activeTool.type==="selection"?n.setActiveTool({type:"lasso"}):n.setActiveTool({type:"selection"}))},onChange:({pointerType:A})=>{n.state.activeTool.type!==p&&at("toolbar",p,"ui"),p==="image"?n.setActiveTool({type:p}):n.setActiveTool({type:p})}},p)}),g("div",{className:"App-toolbar__divider"}),P(Oe,{open:s,children:[g(Oe.Trigger,{className:ae("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":d||h||f||u&&!n.props.isCollaborating}),onToggle:()=>{r(!s),t({openMenu:null,openPopup:null})},title:x("toolBar.extraTools"),children:d?yu:h?g5:u&&!n.props.isCollaborating?Z0:f?i0:f_}),P(Oe.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",children:[g(Oe.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:yu,shortcut:$.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:x("toolBar.frame")}),g(Oe.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:g5,"data-testid":"toolbar-embeddable",selected:h,children:x("toolBar.embeddable")}),g(Oe.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:Z0,"data-testid":"toolbar-laser",selected:u,shortcut:$.K.toLocaleUpperCase(),children:x("toolBar.laser")}),a&&g(Oe.Item,{onSelect:()=>n.setActiveTool({type:"lasso"}),icon:i0,"data-testid":"toolbar-lasso",selected:f,children:x("toolBar.lasso")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),n.props.aiEnabled!==!1&&g(m.Out,{}),g(Oe.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:JT,"data-testid":"toolbar-embeddable",children:x("toolBar.mermaidToExcalidraw")}),n.props.aiEnabled!==!1&&n.plugins.diagramToCode&&g(Oe.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:p5,"data-testid":"toolbar-magicframe",badge:g(Oe.Item.Badge,{children:"AI"}),children:x("toolBar.magicframe")})]})]})]})},C_e=({renderAction:e,zoom:t})=>g(oa.Col,{gap:1,className:Wi.ZOOM_ACTIONS,children:P(oa.Row,{align:"center",children:[e("zoomOut"),e("resetZoom"),e("zoomIn")]})}),x_e=({renderAction:e,className:t})=>P("div",{className:`undo-redo-buttons ${t}`,children:[g("div",{className:"undo-button-container",children:g(Nl,{label:x("buttons.undo"),children:e("undo")})}),g("div",{className:"redo-button-container",children:P(Nl,{label:x("buttons.redo"),children:[" ",e("redo")]})})]}),A_e=({actionManager:e,showExitZenModeBtn:t})=>g("button",{type:"button",className:ae("disable-zen-mode",{"disable-zen-mode--visible":t}),onClick:()=>e.executeAction(P5),children:x("buttons.exitZenMode")}),M_e=({actionManager:e})=>g("button",{type:"button",className:"disable-view-mode",onClick:()=>e.executeAction(B5),children:Ame}),DL=e=>{const t=C.useRef({userFn:e});return t.current.userFn=e,t.current.stableFn||(t.current.stableFn=(...n)=>t.current.userFn(...n)),t.current.stableFn},QE=Nt(null),k_e=()=>{const[e,t]=dt(QE),n=Ei();return e&&e==="clearCanvas"?g(kW,{onConfirm:()=>{n.executeAction(r0),t(null)},onCancel:()=>t(null),title:x("clearCanvasDialog.title"),children:P("p",{className:"clear-canvas__content",children:[" ",x("alerts.clearReset")]})}):null},R_e={...T5,category:"App",label:"Toggle theme",perform:({actionManager:e})=>{e.executeAction(T5,"commandPalette")}},D_e=Object.freeze(Object.defineProperty({__proto__:null,toggleTheme:R_e},Symbol.toStringTag,{value:"Module"})),L_e=Nt(null),gt={app:"App",export:"Export",tools:"Tools",editor:"Editor",elements:"Elements",links:"Links"},LL=e=>{switch(e){case gt.app:return 1;case gt.export:return 2;case gt.editor:return 3;case gt.tools:return 4;case gt.elements:return 5;case gt.links:return 6;default:return 10}},Xb=({shortcut:e,className:t,children:n})=>{const i=e.replace("++","+$").split("+");return P("div",{className:ae("shortcut",t),children:[i.map((s,r)=>g("div",{className:"shortcut-wrapper",children:g("div",{className:"shortcut-key",children:s==="$"?"+":s})},s)),g("div",{className:"shortcut-desc",children:n})]})},WW=e=>!e.altKey&&e[$.CTRL_OR_CMD]&&(e.shiftKey&&e.key.toLowerCase()===$.P||e.key===$.SLASH),PL=Object.assign(e=>{var i;const t=Qt(),n=On();return C.useEffect(()=>{const s=r=>{WW(r)&&(r.preventDefault(),r.stopPropagation(),n(o=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="commandPalette"?null:{name:"commandPalette"};return a&&at("command_palette","open","shortcut"),{openDialog:a}}))};return window.addEventListener(te.KEYDOWN,s,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,s,{capture:!0})},[n]),((i=t.openDialog)==null?void 0:i.name)!=="commandPalette"?null:g(P_e,{...e})},{defaultItems:D_e});function P_e({customCommandPaletteItems:e}){const t=Ir(),n=Qt(),i=On(),s=I2(),r=Ei(),[o,a]=dt(L_e),[l,c]=C.useState(null),d=C.useRef(null),u=_E({uiAppState:n,customCommandPaletteItems:e,appProps:s}),[f]=dt(Tg),h=C.useMemo(()=>{var T;return((T=f.libraryItems)==null?void 0:T.filter(A=>!!A.name).map(A=>({label:A.name,icon:g(N_e,{id:A.id,elements:A.elements}),category:"Library",order:LL("Library"),haystack:d0(A.name),perform:()=>{t.onInsertElements(iS([A]))}})))||[]},[t,f.libraryItems]);C.useEffect(()=>{const{uiAppState:T,customCommandPaletteItems:A,appProps:S}=u,D=Y=>{let G="";return Y.label&&(typeof Y.label=="function"?G=x(Y.label(t.scene.getNonDeletedElements(),T,t)):G=x(Y.label)),G},N=Y=>typeof Y.icon=="function"?Y.icon(T,t.scene.getNonDeletedElements()):Y.icon;let L=[];const j=(Y,G,O)=>{const z={label:D(Y),icon:N(Y),category:G,shortcut:Ln(Y.name),keywords:Y.keywords,predicate:Y.predicate,viewMode:Y.viewMode,perform:()=>{r.executeAction(Y,"commandPalette")}};return O?O(z,Y):z};if(T&&t.scene&&r){const Y=[r.actions.group,r.actions.ungroup,r.actions.cut,r.actions.copy,r.actions.deleteSelectedElements,r.actions.wrapSelectionInFrame,r.actions.copyStyles,r.actions.pasteStyles,r.actions.bringToFront,r.actions.bringForward,r.actions.sendBackward,r.actions.sendToBack,r.actions.alignTop,r.actions.alignBottom,r.actions.alignLeft,r.actions.alignRight,r.actions.alignVerticallyCentered,r.actions.alignHorizontallyCentered,r.actions.duplicateSelection,r.actions.flipHorizontal,r.actions.flipVertical,r.actions.zoomToFitSelection,r.actions.zoomToFitSelectionInViewport,r.actions.increaseFontSize,r.actions.decreaseFontSize,r.actions.toggleLinearEditor,r.actions.cropEditor,r.actions.togglePolygon,hW,yW,kve].map(Q=>j(Q,gt.elements,(re,ie)=>({...re,predicate:ie.predicate?ie.predicate:(me,ke,ye,Ae)=>Ze(me,ke).length>0}))),G=[r.actions.toggleHandTool,r.actions.setFrameAsActiveTool,r.actions.toggleLassoTool].map(Q=>j(Q,gt.tools)),O=[r.actions.undo,r.actions.redo,r.actions.zoomIn,r.actions.zoomOut,r.actions.resetZoom,r.actions.zoomToFit,r.actions.zenMode,r.actions.viewMode,r.actions.gridMode,r.actions.objectsSnapMode,r.actions.toggleShortcuts,r.actions.selectAll,r.actions.toggleElementLock,r.actions.unlockAllElements,r.actions.stats].map(Q=>j(Q,gt.editor)),z=[r.actions.saveToActiveFile,r.actions.saveFileToDisk,r.actions.copyAsPng,r.actions.copyAsSvg].map(Q=>j(Q,gt.export));L=[...Y,...O,{label:D(r0),icon:N(r0),shortcut:Ln(r0.name),category:gt.editor,keywords:["delete","destroy"],viewMode:!1,perform:()=>{ar.set(QE,"clearCanvas")}},{label:x("buttons.exportImage"),category:gt.export,icon:lG,shortcut:Ln("imageExport"),keywords:["export","image","png","jpeg","svg","clipboard","picture"],perform:()=>{i({openDialog:{name:"imageExport"}})}},...z];const H=[{label:x("toolBar.library"),category:gt.app,icon:nG,viewMode:!1,perform:()=>{T.openSidebar?i({openSidebar:null}):i({openSidebar:{name:Yr.name,tab:Yr.defaultTab}})}},{label:x("search.title"),category:gt.app,icon:Fu,viewMode:!0,perform:()=>{r.executeAction(KW)}},{label:x("labels.shapeSwitch"),category:gt.elements,icon:h_,perform:()=>{r.executeAction(Mve)}},{label:x("labels.changeStroke"),keywords:["color","outline"],category:gt.elements,icon:K3,viewMode:!1,predicate:(Q,re)=>{const ie=Ze(Q,re);return ie.length>0&&ZE(re,ie)},perform:()=>{i(Q=>({openPopup:"elementStroke"}))}},{label:x("labels.changeBackground"),keywords:["color","fill"],icon:K3,category:gt.elements,viewMode:!1,predicate:(Q,re)=>{const ie=Ze(Q,re);return ie.length>0&&qE(re,ie)},perform:()=>{i(Q=>({openPopup:"elementBackground"}))}},{label:x("labels.canvasBackground"),keywords:["color"],icon:K3,category:gt.editor,viewMode:!1,perform:()=>{i(Q=>({openMenu:Q.openMenu==="canvas"?null:"canvas",openPopup:"canvasBackground"}))}},...B_.reduce((Q,re)=>{var Be;const{value:ie,icon:me,key:ke,numericKey:ye}=re;if(((Be=S.UIOptions.tools)==null?void 0:Be[ie])===!1)return Q;const $e=ke&&Ht(typeof ke=="string"?ke:ke[0])||ye,et={label:x(`toolBar.${ie}`),category:gt.tools,shortcut:$e,icon:me,keywords:["toolbar"],viewMode:!1,perform:({event:We})=>{ie==="image"?t.setActiveTool({type:ie}):t.setActiveTool({type:ie})}};return Q.push(et),Q},[]),...G,{label:x("toolBar.lock"),category:gt.tools,icon:T.activeTool.locked?$T:rE,shortcut:$.Q.toLocaleUpperCase(),viewMode:!1,perform:()=>{t.toggleLock()}},{label:`${x("labels.textToDiagram")}...`,category:gt.tools,icon:cme,viewMode:!1,predicate:S.aiEnabled,perform:()=>{i(Q=>({...Q,openDialog:{name:"ttd",tab:"text-to-diagram"}}))}},{label:`${x("toolBar.mermaidToExcalidraw")}...`,category:gt.tools,icon:JT,viewMode:!1,predicate:S.aiEnabled,perform:()=>{i(Q=>({...Q,openDialog:{name:"ttd",tab:"mermaid"}}))}}],X=[...L,...H,...A||[]].map(Q=>{var re;return{...Q,icon:Q.icon||h_,order:Q.order??LL(Q.category),haystack:`${d0(Q.label.toLocaleLowerCase())} ${((re=Q.keywords)==null?void 0:re.join(" "))||""}`}});c(X),a([...X,...h].find(Q=>Q.label===(o==null?void 0:o.label))??null)}},[u,t,r,c,o==null?void 0:o.label,a,i,h]);const[m,p]=C.useState(""),[U,b]=C.useState(null),[y,E]=C.useState({}),_=T=>{i({openDialog:null},T),p("")},I=(T,A)=>{var S;((S=n.openDialog)==null?void 0:S.name)==="commandPalette"&&(A.stopPropagation(),A.preventDefault(),document.body.classList.add("excalidraw-animations-disabled"),_(()=>{T.perform({actionManager:r,event:A}),a(T),requestAnimationFrame(()=>{document.body.classList.remove("excalidraw-animations-disabled")})}))},k=DL(T=>T.viewMode===!1&&n.viewModeEnabled?!1:typeof T.predicate=="function"?T.predicate(t.scene.getNonDeletedElements(),n,s,t):T.predicate===void 0||T.predicate),w=DL(T=>{var N;const A=rl(T.target)||WW(T)||T.key===$.ESCAPE;if(A&&T.key!==$.ARROW_UP&&T.key!==$.ARROW_DOWN&&T.key!==$.ENTER)return;const S=Object.values(y).flat(),D=o&&!m&&k(o);if(T.key===$.ARROW_UP){T.preventDefault();const L=S.findIndex(G=>G.label===(U==null?void 0:U.label));if(D){if(L===0){b(o);return}if(U===o){const G=S[S.length-1];G&&b(G);return}}let j;L===-1?j=S.length-1:j=L===0?S.length-1:(L-1)%S.length;const Y=S[j];Y&&b(Y);return}if(T.key===$.ARROW_DOWN){T.preventDefault();const L=S.findIndex(G=>G.label===(U==null?void 0:U.label));if(D){if(!U||L===S.length-1){b(o);return}if(U===o){const G=S[0];G&&b(G);return}}const j=(L+1)%S.length,Y=S[j];Y&&b(Y);return}if(T.key===$.ENTER&&U&&setTimeout(()=>{I(U,T)}),!A){if(T.stopPropagation(),/^[a-zA-Z0-9]$/.test(T.key)){(N=d==null?void 0:d.current)==null||N.focus();return}T.preventDefault()}});return C.useEffect(()=>(window.addEventListener(te.KEYDOWN,w,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,w,{capture:!0})),[w]),C.useEffect(()=>{if(!l)return;const T=N=>{const L={};for(const j of N)L[j.category]?L[j.category].push(j):L[j.category]=[j];return L};let A=(m==null?void 0:m.length)>1?[...l.filter(k).sort((N,L)=>N.order-L.order),...h]:l.filter(k).sort((N,L)=>N.order-L.order);const S=!m&&o&&k(o);if(!m){E(T(S?A.filter(N=>N.label!==(o==null?void 0:o.label)):A)),b(S?o:A[0]||null);return}const D=d0(m.toLocaleLowerCase().replace(/[<>_| -]/g,""));A=bve.filter(D,A,{extract:N=>N.haystack??""}).sort((N,L)=>L.score-N.score).map(N=>N.original),E(T(A)),b(A[0]??null)},[m,l,k,o,h]),P(Tr,{onCloseRequest:()=>_(),closeOnClickOutside:!0,title:!1,size:720,autofocus:!0,className:"command-palette-dialog",children:[g(Xu,{value:m,placeholder:x("commandPalette.search.placeholder"),onChange:T=>{p(T)},selectOnRender:!0,ref:d}),t.editorInterface.formFactor!=="phone"&&P("div",{className:"shortcuts-wrapper",children:[g(Xb,{shortcut:"",children:x("commandPalette.shortcuts.select")}),g(Xb,{shortcut:"",children:x("commandPalette.shortcuts.confirm")}),g(Xb,{shortcut:J("Esc"),children:x("commandPalette.shortcuts.close")})]}),P("div",{className:"commands",children:[o&&!m&&P("div",{className:"command-category",children:[P("div",{className:"command-category-title",children:[x("commandPalette.recents"),g("div",{className:"icon",style:{marginLeft:"6px"},children:dme})]}),g(NL,{command:o,isSelected:o.label===(U==null?void 0:U.label),onClick:T=>I(o,T),disabled:!k(o),onMouseMove:()=>b(o),showShortcut:t.editorInterface.formFactor!=="phone",appState:n})]}),Object.keys(y).length>0?Object.keys(y).map((T,A)=>P("div",{className:"command-category",children:[g("div",{className:"command-category-title",children:T}),y[T].map(S=>g(NL,{command:S,isSelected:S.label===(U==null?void 0:U.label),onClick:D=>I(S,D),onMouseMove:()=>b(S),showShortcut:t.editorInterface.formFactor!=="phone",appState:n,size:T==="Library"?"large":"small"},S.label))]},T)):l?P("div",{className:"no-match",children:[g("div",{className:"icon",children:Fu})," ",x("commandPalette.search.noMatch")]}):null]})]})}const N_e=({id:e,elements:t})=>{const n=C.useRef(null),{svgCache:i}=nS();return CW(e,t,i,n),g("div",{className:"library-item-icon",ref:n})},NL=({command:e,isSelected:t,disabled:n,onMouseMove:i,onClick:s,showShortcut:r,appState:o,size:a="small"})=>{const l=()=>{};return P("div",{className:ae("command-item",{"item-selected":t,"item-disabled":n,"command-item-large":a==="large"}),ref:c=>{var d;t&&!n&&((d=c==null?void 0:c.scrollIntoView)==null||d.call(c,{block:"nearest"}))},onClick:n?l:s,onMouseMove:n?l:i,title:n?x("commandPalette.itemNotAvailable"):"",children:[P("div",{className:"name",children:[e.icon&&g(E2,{className:"icon",size:"var(--icon-size, 1rem)",icon:typeof e.icon=="function"?e.icon(o,[]):e.icon}),g(Mj,{children:e.label})]}),r&&e.shortcut&&g(Xb,{shortcut:e.shortcut})]})},KU=ue({name:"toggleLinearEditor",category:gt.elements,label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds})[0];return(i==null?void 0:i.type)==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit"},keywords:["line"],trackEvent:{category:"element"},predicate:(e,t,n,i)=>{var r;const s=i.scene.getSelectedElements(t);return!!(!((r=t.selectedLinearElement)!=null&&r.isEditing)&&s.length===1&&De(s[0])&&!ve(s[0]))},perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];Ce(s,"No selected element found"),Ce(t.selectedLinearElement,"No selected linear element found"),Ce(s.id===t.selectedLinearElement.elementId,"Selected element ID and linear editor elementId does not match");const r={...t.selectedLinearElement,isEditing:!t.selectedLinearElement.isEditing};return{appState:{...t,selectedLinearElement:r},captureUpdate:q.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds})[0];if(!i)return null;const s=x(i.type==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit");return g(qe,{type:"button",icon:Tme,title:s,"aria-label":s,onClick:()=>t(null)})}});ue({name:"togglePolygon",category:gt.elements,icon:pR,keywords:["loop"],label:(e,t,n)=>!n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds}).some(r=>!cn(r)||!r.polygon)?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds});return s.length>0&&s.every(r=>cn(r)&&r.points.length>=4)},perform(e,t,n,i){const s=i.scene.getSelectedElements(t);if(s.some(l=>!cn(l)))return!1;const r=s,o=r.some(l=>!l.polygon),a=we(r);return{elements:e.map(l=>!a.has(l.id)||!cn(l)?l:xe(l,{backgroundColor:o?l.backgroundColor:"transparent",...ST(l,o)})),appState:t,captureUpdate:q.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds});if(i.length===0||i.some(o=>!cn(o)||!o.polygon||o.points.length<3))return null;const s=i.every(o=>cn(o)&&o.polygon),r=x(s?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon");return g(rI,{icon:pR,title:r,"aria-label":r,active:s,onClick:()=>t(null),style:{marginLeft:"auto"}})}});const KW=ue({name:"searchMenu",icon:Fu,keywords:["search","find"],label:"search.title",viewMode:!0,trackEvent:{category:"search_menu",action:"toggle",predicate:e=>e.gridModeEnabled},perform(e,t,n,i){var s,r;if(t.openDialog)return!1;if(((s=t.openSidebar)==null?void 0:s.name)===Yr.name&&t.openSidebar.tab===pu){const o=(r=i.excalidrawContainerValue.container)==null?void 0:r.querySelector(`.${Wi.SEARCH_MENU_INPUT_WRAPPER} input`);return o==null||o.focus(),o==null||o.select(),!1}return{appState:{...t,openSidebar:{name:Yr.name,tab:pu},openDialog:null},captureUpdate:q.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.F}),O_e=ue({name:"cropEditor",label:"helpDialog.cropStart",icon:PR,viewMode:!0,trackEvent:{category:"menu"},keywords:["image","crop"],perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];return{appState:{...t,isCropping:!1,croppingElementId:s.id},captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return!!(!t.croppingElementId&&s.length===1&&xt(s[0]))},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=x("helpDialog.cropStart");return g(qe,{type:"button",icon:PR,title:i,"aria-label":i,onClick:()=>t(null)})}}),ZW=(e,t)=>{const n=t.scene.getSelectedElements(e);return n.length===1&&_e(n[0])},F_e=ue({name:"selectAllElementsInFrame",label:"labels.selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;if(_e(s)){const r=br(qt(e),s.id).filter(o=>!(o.type==="text"&&o.containerId));return{elements:e,appState:{...t,selectedElementIds:r.reduce((o,a)=>(o[a.id]=!0,o),{})},captureUpdate:q.IMMEDIATELY}}return{elements:e,appState:t,captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>ZW(t,i)}),B_e=ue({name:"removeAllElementsFromFrame",label:"labels.removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;return _e(s)?{elements:pV(e,s),appState:{...t,selectedElementIds:{[s.id]:!0}},captureUpdate:q.IMMEDIATELY}:{elements:e,appState:t,captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>ZW(t,i)});ue({name:"updateFrameRendering",label:"labels.updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>({elements:e,appState:{...t,frameRendering:{...t.frameRendering,enabled:!t.frameRendering.enabled}},captureUpdate:q.EVENTUALLY}),checked:e=>e.frameRendering.enabled});ue({name:"setFrameAsActiveTool",label:"toolBar.frame",trackEvent:{category:"toolbar"},icon:yu,viewMode:!1,perform:(e,t,n,i)=>{const s=sn(t,{type:"frame"});return Vo(i.interactiveCanvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:sn(t,{type:"frame"})},captureUpdate:q.EVENTUALLY}},keyTest:e=>!e[$.CTRL_OR_CMD]&&!e.shiftKey&&!e.altKey&&e.key.toLocaleLowerCase()===$.F});const z_e=ue({name:"wrapSelectionInFrame",label:"labels.wrapSelectionInFrame",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ze(e,t);return s.length>0&&!s.some(r=>_e(r))},perform:(e,t,n,i)=>{const s=Ze(e,t),r=i.scene.getNonDeletedElementsMap(),[o,a,l,c]=Et(s,r),d=16,u=LT({x:o-d,y:a-d,width:l-o+d*2,height:c-a+d*2});if(t.editingGroupId){const h=Ot(s,t.editingGroupId);for(const m of h){const p=m.groupIds.indexOf(t.editingGroupId);Dn(m,r,{groupIds:m.groupIds.slice(0,p)})}}return{elements:Q1([...i.scene.getElementsIncludingDeleted(),u],s,u,t),appState:{selectedElementIds:{[u.id]:!0}},captureUpdate:q.IMMEDIATELY}}});class ZU extends Ou{applyTo(t,n,i){const[s,r]=this.elements.applyTo(t,i.elements,{excludedProperties:new Set(["version","versionNonce"])}),[o,a]=this.appState.applyTo(n,s);return[s,o,r||a]}static calculate(t,n){return super.calculate(t,n)}static inverse(t){return super.inverse(t)}static applyLatestChanges(t,n,i,s){return super.applyLatestChanges(t,n,i,s)}}class z5{constructor(t=!0,n=!0){this.isUndoStackEmpty=t,this.isRedoStackEmpty=n}}class au{constructor(t){B(this,"onHistoryChangedEmitter",new fo);B(this,"undoStack",[]);B(this,"redoStack",[]);this.store=t}get isUndoStackEmpty(){return this.undoStack.length===0}get isRedoStackEmpty(){return this.redoStack.length===0}clear(){this.undoStack.length=0,this.redoStack.length=0}record(t){if(t.isEmpty()||t instanceof ZU)return;const n=ZU.inverse(t);this.undoStack.push(n),n.elements.isEmpty()||(this.redoStack.length=0),this.onHistoryChangedEmitter.trigger(new z5(this.isUndoStackEmpty,this.isRedoStackEmpty))}undo(t,n){return this.perform(t,n,()=>au.pop(this.undoStack),i=>au.push(this.redoStack,i))}redo(t,n){return this.perform(t,n,()=>au.pop(this.redoStack),i=>au.push(this.undoStack,i))}perform(t,n,i,s){try{let r=i();if(r===null)return;const o=q.IMMEDIATELY;let a=this.store.snapshot,l=t,c=n,d=!1;for(;r;){try{[l,c,d]=r.applyTo(l,c,a);const u=a.elements,f=a.maybeClone(o,l,c),h=Rh.create(a,f),m=ZU.applyLatestChanges(r,u,l);m.isEmpty()||(this.store.scheduleMicroAction({action:o,change:h,delta:m}),r=m),a=f}finally{s(r)}if(d)break;r=i()}return[l,c]}finally{this.onHistoryChangedEmitter.trigger(new z5(this.isUndoStackEmpty,this.isRedoStackEmpty))}}static pop(t){if(!t.length)return null;const n=t.pop();return n!==void 0?n:null}static push(t,n){const i=ZU.inverse(n);return t.push(i)}}const qW=(e,t)=>{const[n,i]=C.useState(t);return C.useEffect(()=>{const s=e.on(r=>{i(r)});return()=>{s()}},[e]),n},QW=(e,t,n)=>{if(!t.multiElement&&!t.resizingElement&&!t.editingTextElement&&!t.newElement&&!t.selectedElementsAreBeingDragged&&!t.selectionElement&&!e.flowChartCreator.isCreatingChart){const i=n();if(!i)return{captureUpdate:q.EVENTUALLY};const[s,r]=i,o=RT(Array.from(s.values()));return{appState:r,elements:o,captureUpdate:q.NEVER}}return{captureUpdate:q.EVENTUALLY}},H_e=e=>({name:"undo",label:"buttons.undo",icon:ER,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>QW(s,n,()=>e.undo(we(t),n)),keyTest:t=>t[$.CTRL_OR_CMD]&&f4(t,$.Z)&&!t.shiftKey,PanelComponent:({appState:t,updateData:n,data:i,app:s})=>{const{isUndoStackEmpty:r}=qW(e.onHistoryChangedEmitter,new z5(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=Na()==="mobile";return g(qe,{type:"button",icon:ER,"aria-label":x("buttons.undo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:r,"data-testid":"button-undo",style:{...o?Gp:{}}})}}),V_e=e=>({name:"redo",label:"buttons.redo",icon:vR,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>QW(s,n,()=>e.redo(we(t),n)),keyTest:t=>t[$.CTRL_OR_CMD]&&t.shiftKey&&f4(t,$.Z)||Iz&&t.ctrlKey&&!t.shiftKey&&f4(t,$.Y),PanelComponent:({appState:t,updateData:n,data:i,app:s})=>{const{isRedoStackEmpty:r}=qW(e.onHistoryChangedEmitter,new z5(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=Na()==="mobile";return g(qe,{type:"button",icon:vR,"aria-label":x("buttons.redo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:r,"data-testid":"button-redo",style:{...o?Gp:{}}})}}),$_e=ue({name:"autoResize",label:"labels.autoResize",icon:null,trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ze(e,t);return s.length===1&&he(s[0])&&!s[0].autoResize},perform:(e,t,n,i)=>{const s=Ze(e,t);return{appState:t,elements:e.map(r=>{if(r.id===s[0].id&&he(r)){const o=ri(r.originalText,_t(r),r.lineHeight);return xe(r,{autoResize:!0,width:o.width,height:o.height,text:r.originalText})}return r}),captureUpdate:q.IMMEDIATELY}}}),L7=(e,t,n,i,s,r)=>{if(e.trackEvent)try{typeof e.trackEvent=="object"&&(!e.trackEvent.predicate||e.trackEvent.predicate(n,i,r))&&at(e.trackEvent.category,e.trackEvent.action||e.name,`${t} (${s.editorInterface.formFactor==="phone"?"mobile":"desktop"})`)}catch(o){console.error("error while logging action:",o)}};class G_e{constructor(t,n,i,s){B(this,"actions",{});B(this,"updater");B(this,"getAppState");B(this,"getElementsIncludingDeleted");B(this,"app");B(this,"renderAction",(t,n)=>{const i=this.app.props.UIOptions.canvasActions;if(this.actions[t]&&"PanelComponent"in this.actions[t]&&(!(t in i)||i[t])){const s=this.actions[t],r=s.PanelComponent;r.displayName="PanelComponent";const o=this.getElementsIncludingDeleted(),a=this.getAppState(),l=c=>{L7(s,"ui",a,o,this.app,c),this.updater(s.perform(this.getElementsIncludingDeleted(),this.getAppState(),c,this.app))};return g(r,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:l,appProps:this.app.props,app:this.app,data:n,renderAction:this.renderAction})}return null});B(this,"isActionEnabled",t=>{const n=this.getElementsIncludingDeleted(),i=this.getAppState();return!t.predicate||t.predicate(n,i,this.app.props,this.app)});this.updater=r=>{if(Wp(r))r.then(o=>t(o));else return t(r)},this.getAppState=n,this.getElementsIncludingDeleted=i,this.app=s}registerAction(t){this.actions[t.name]=t}registerAll(t){t.forEach(n=>this.registerAction(n))}handleKeyDown(t){const n=this.app.props.UIOptions.canvasActions,i=Object.values(this.actions).sort((l,c)=>(c.keyPriority||0)-(l.keyPriority||0)).filter(l=>(l.name in n?n[l.name]:!0)&&l.keyTest&&l.keyTest(t,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(i.length!==1)return i.length>1&&console.warn("Canceling as multiple actions match this shortcut",i),!1;const s=i[0];if(this.getAppState().viewModeEnabled&&s.viewMode!==!0)return!1;const r=this.getElementsIncludingDeleted(),o=this.getAppState(),a=null;return L7(s,"keyboard",o,r,this.app,null),t.preventDefault(),t.stopPropagation(),this.updater(i[0].perform(r,o,a,this.app)),!0}executeAction(t,n="api",i=null){const s=this.getElementsIncludingDeleted(),r=this.getAppState();L7(t,n,r,s,this.app,i),this.updater(t.perform(s,r,i,this.app))}}class X_e{constructor(){B(this,"targets",new WeakMap);B(this,"rafIds",new WeakMap)}register(t,n){this.targets.set(t,{callback:n,stopped:!0})}start(t){const n=this.targets.get(t);n&&(this.rafIds.has(t)||(this.targets.set(t,{...n,stopped:!1}),this.scheduleFrame(t)))}stop(t){const n=this.targets.get(t);n&&!n.stopped&&this.targets.set(t,{...n,stopped:!0}),this.cancelFrame(t)}constructFrame(t){return n=>{const i=this.targets.get(t);if(!i)return;const s=this.onFrame(i,n);!i.stopped&&!s?this.scheduleFrame(t):this.cancelFrame(t)}}scheduleFrame(t){const n=requestAnimationFrame(this.constructFrame(t));this.rafIds.set(t,n)}cancelFrame(t){if(this.rafIds.has(t)){const n=this.rafIds.get(t);cancelAnimationFrame(n)}this.rafIds.delete(t)}onFrame(t,n){return t.callback(n)??!1}}const OL=e=>{const t=Array.from(e.values());return{x:BL(t,n=>n.x)/t.length,y:BL(t,n=>n.y)/t.length}},FL=([e,t])=>Math.hypot(e.x-t.x,e.y-t.y),BL=(e,t)=>e.reduce((n,i)=>n+t(i),0),j_e=8,zL=99999,JE=e=>j_e/e,bs=class bs{};B(bs,"referenceSnapPoints",null),B(bs,"visibleGaps",null),B(bs,"setReferenceSnapPoints",t=>{bs.referenceSnapPoints=t}),B(bs,"getReferenceSnapPoints",()=>bs.referenceSnapPoints),B(bs,"setVisibleGaps",t=>{bs.visibleGaps=t}),B(bs,"getVisibleGaps",()=>bs.visibleGaps),B(bs,"destroy",()=>{bs.referenceSnapPoints=null,bs.visibleGaps=null});let ho=bs;const pp=e=>e.props.gridModeEnabled??e.state.gridModeEnabled,md=({event:e,app:t,selectedElements:n})=>{if(e){const i=t.state.activeTool.type==="lasso"&&t.state.selectedElementsAreBeingDragged;return(t.state.activeTool.type!=="lasso"||i)&&(t.state.objectsSnapModeEnabled&&!e[$.CTRL_OR_CMD]||!t.state.objectsSnapModeEnabled&&e[$.CTRL_OR_CMD]&&!pp(t))}return n.length===1&&n[0].type==="arrow"?!1:t.state.objectsSnapModeEnabled},Y_e=(e,t,n=.01)=>Math.abs(e-t)<=n,Up=(e,t,{omitCenter:n,boundingBoxCorners:i,dragOffset:s}={omitCenter:!1,boundingBoxCorners:!1})=>{let r=[];if(e.length===1){const o=e[0];let[a,l,c,d,u,f]=je(o,t);s&&(a+=s.x,c+=s.x,u+=s.x,l+=s.y,d+=s.y,f+=s.y);const h=(c-a)/2,m=(d-l)/2;if((o.type==="diamond"||o.type==="ellipse")&&!i){const p=Z(M(a,l+m),M(u,f),o.angle),U=Z(M(a+h,l),M(u,f),o.angle),b=Z(M(c,l+m),M(u,f),o.angle),y=Z(M(a+h,d),M(u,f),o.angle),E=M(u,f);r=n?[p,U,b,y]:[p,U,b,y,E]}else{const p=Z(M(a,l),M(u,f),o.angle),U=Z(M(c,l),M(u,f),o.angle),b=Z(M(a,d),M(u,f),o.angle),y=Z(M(c,d),M(u,f),o.angle),E=M(u,f);r=n?[p,U,b,y]:[p,U,b,y,E]}}else if(e.length>1){const[o,a,l,c]=MT(e,s??{x:0,y:0}),d=l-o,u=c-a,f=M(o,a),h=M(l,a),m=M(o,c),p=M(l,c),U=M(o+d/2,a+u/2);r=n?[f,h,m,p]:[f,h,m,p,U]}return r.map(o=>M(mn(o[0]),mn(o[1])))},JW=(e,t,n,i)=>hV(e,t,n,i),W_e=(e,t,n,i)=>{const s=JW(e,t,n,i),r=fV(s,i).filter(u=>!(u.length===1&&Vt(u[0]))).map(u=>Et(u).map(f=>mn(f))),o=r.sort((u,f)=>u[0]-f[0]),a=[];let l=0;e:for(let u=0;u<o.length;u++){const f=o[u];for(let h=u+1;h<o.length;h++){if(++l>zL)break e;const m=o[h],[,p,U,b]=f,[y,E,,_]=m;U<y&&k6(is(p,b),is(E,_))&&a.push({startBounds:f,endBounds:m,startSide:[M(U,p),M(U,b)],endSide:[M(y,E),M(y,_)],length:y-U,overlap:R6(is(p,b),is(E,_))})}}const c=r.sort((u,f)=>u[1]-f[1]),d=[];l=0;e:for(let u=0;u<c.length;u++){const f=c[u];for(let h=u+1;h<c.length;h++){if(++l>zL)break e;const m=c[h],[p,,U,b]=f,[y,E,_]=m;b<E&&k6(is(p,U),is(y,_))&&d.push({startBounds:f,endBounds:m,startSide:[M(p,b),M(U,b)],endSide:[M(y,E),M(_,E)],length:E-b,overlap:R6(is(p,U),is(y,_))})}}return{horizontalGaps:a,verticalGaps:d}},HL=(e,t,n,i,s,r,o)=>{if(!md({app:n,event:i,selectedElements:e}))return[];if(e.length===0)return[];const a=ho.getVisibleGaps();if(a){const{horizontalGaps:l,verticalGaps:c}=a,[d,u,f,h]=MT(e,t).map(U=>mn(U)),m=(d+f)/2,p=(u+h)/2;for(const U of l){if(!k6(is(u,h),U.overlap))continue;const b=U.startSide[0][0]+U.length/2,y=mn(b-m);if(U.length>f-d&&Math.abs(y)<=o.x){Math.abs(y)<o.x&&(s.length=0),o.x=Math.abs(y);const S={type:"gap",direction:"center_horizontal",gap:U,offset:y};s.push(S);continue}const[,,_]=U.endBounds,I=d-_,k=mn(U.length-I);if(Math.abs(k)<=o.x){Math.abs(k)<o.x&&(s.length=0),o.x=Math.abs(k);const S={type:"gap",direction:"side_right",gap:U,offset:k};s.push(S);continue}const[w,,,]=U.startBounds,T=w-f,A=mn(T-U.length);if(Math.abs(A)<=o.x){Math.abs(A)<o.x&&(s.length=0),o.x=Math.abs(A);const S={type:"gap",direction:"side_left",gap:U,offset:A};s.push(S);continue}}for(const U of c){if(!k6(is(d,f),U.overlap))continue;const b=U.startSide[0][1]+U.length/2,y=mn(b-p);if(U.length>h-u&&Math.abs(y)<=o.y){Math.abs(y)<o.y&&(r.length=0),o.y=Math.abs(y);const S={type:"gap",direction:"center_vertical",gap:U,offset:y};r.push(S);continue}const[,_,,]=U.startBounds,I=_-h,k=mn(I-U.length);if(Math.abs(k)<=o.y){Math.abs(k)<o.y&&(r.length=0),o.y=Math.abs(k);const S={type:"gap",direction:"side_top",gap:U,offset:k};r.push(S);continue}const[,,,w]=U.endBounds,T=mn(u-w),A=U.length-T;if(Math.abs(A)<=o.y){Math.abs(A)<o.y&&(r.length=0),o.y=Math.abs(A);const S={type:"gap",direction:"side_bottom",gap:U,offset:A};r.push(S);continue}}}},K_e=(e,t,n,i)=>{const s=JW(e,t,n,i);return fV(s,i).filter(r=>!(r.length===1&&Vt(r[0]))).flatMap(r=>Up(r,i))},Cg=(e,t,n,i,s,r,o)=>{if(!md({app:n,event:i,selectedElements:e})||e.length===0&&t.length===0)return[];const a=ho.getReferenceSnapPoints();if(a)for(const l of t)for(const c of a){const d=c[0]-l[0],u=c[1]-l[1];Math.abs(d)<=o.x&&(Math.abs(d)<o.x&&(s.length=0),s.push({type:"point",points:[l,c],offset:d}),o.x=Math.abs(d)),Math.abs(u)<=o.y&&(Math.abs(u)<o.y&&(r.length=0),r.push({type:"point",points:[l,c],offset:u}),o.y=Math.abs(u))}},Z_e=(e,t,n,i,s)=>{var U,b;const r=n.state,o=Ze(e,r);if(!md({app:n,event:i,selectedElements:o})||o.length===0)return{snapOffset:{x:0,y:0},snapLines:[]};t.x=mn(t.x),t.y=mn(t.y);const a=[],l=[],c=JE(r.zoom.value),d={x:c,y:c},u=Up(o,s,{dragOffset:t});Cg(o,u,n,i,a,l,d),HL(o,t,n,i,a,l,d);const f={x:((U=a[0])==null?void 0:U.offset)??0,y:((b=l[0])==null?void 0:b.offset)??0};d.x=0,d.y=0,a.length=0,l.length=0;const h={x:mn(t.x+f.x),y:mn(t.y+f.y)};Cg(o,Up(o,s,{dragOffset:h}),n,i,a,l,d),HL(o,h,n,i,a,l,d);const m=oS(a,l),p=Q_e(o,h,[...a,...l].filter(y=>y.type==="gap"));return{snapOffset:f,snapLines:[...m,...p]}},mn=e=>Math.round(e*10**6)/10**6,VL=e=>{const t=new Map;for(const n of e){const i=n.join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},oS=(e,t)=>{const n={},i={};if(e.length>0){for(const s of e)if(s.type==="point"){const r=mn(s.points[0][0]);n[r]||(n[r]=[]),n[r].push(...s.points.map(o=>M(mn(o[0]),mn(o[1]))))}}if(t.length>0){for(const s of t)if(s.type==="point"){const r=mn(s.points[0][1]);i[r]||(i[r]=[]),i[r].push(...s.points.map(o=>M(mn(o[0]),mn(o[1]))))}}return Object.entries(n).map(([s,r])=>({type:"points",points:VL(r.map(o=>M(Number(s),o[1])).sort((o,a)=>o[1]-a[1]))})).concat(Object.entries(i).map(([s,r])=>({type:"points",points:VL(r.map(o=>M(o[0],Number(s))).sort((o,a)=>o[0]-a[0]))})))},q_e=e=>{const t=new Map;for(const n of e){const i=n.points.flat().map(s=>[mn(s)]).join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},Q_e=(e,t,n)=>{const[i,s,r,o]=MT(e,t),a=[];for(const l of n){const[c,d,u,f]=l.gap.startBounds,[h,m,p,U]=l.gap.endBounds,b=R6(is(s,o),l.gap.overlap),y=R6(is(i,r),l.gap.overlap);switch(l.direction){case"center_horizontal":{if(b){const E=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[M(l.gap.startSide[0][0],E),M(i,E)]},{type:"gap",direction:"horizontal",points:[M(r,E),M(l.gap.endSide[0][0],E)]})}break}case"center_vertical":{if(y){const E=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[M(E,l.gap.startSide[0][1]),M(E,s)]},{type:"gap",direction:"vertical",points:[M(E,o),M(E,l.gap.endSide[0][1])]})}break}case"side_right":{if(b){const E=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[M(u,E),M(h,E)]},{type:"gap",direction:"horizontal",points:[M(p,E),M(i,E)]})}break}case"side_left":{if(b){const E=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[M(r,E),M(c,E)]},{type:"gap",direction:"horizontal",points:[M(u,E),M(h,E)]})}break}case"side_top":{if(y){const E=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[M(E,o),M(E,d)]},{type:"gap",direction:"vertical",points:[M(E,f),M(E,m)]})}break}case"side_bottom":{if(y){const E=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[M(E,f),M(E,m)]},{type:"gap",direction:"vertical",points:[M(E,U),M(E,s)]})}break}}}return q_e(a.map(l=>({...l,points:l.points.map(c=>M(mn(c[0]),mn(c[1])))})))},$L=(e,t,n,i,s,r)=>{var k,w;if(!md({event:i,selectedElements:e,app:n})||e.length===0||e.length===1&&!Y_e(e[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[o,a,l,c]=Et(t);r&&(r.includes("e")?l+=s.x:r.includes("w")&&(o+=s.x),r.includes("n")?a+=s.y:r.includes("s")&&(c+=s.y));const d=[];if(r)switch(r){case"e":{d.push(M(l,a),M(l,c));break}case"w":{d.push(M(o,a),M(o,c));break}case"n":{d.push(M(o,a),M(l,a));break}case"s":{d.push(M(o,c),M(l,c));break}case"ne":{d.push(M(l,a));break}case"nw":{d.push(M(o,a));break}case"se":{d.push(M(l,c));break}case"sw":{d.push(M(o,c));break}}const u=JE(n.state.zoom.value),f={x:u,y:u},h=[],m=[];Cg(t,d,n,i,h,m,f);const p={x:((k=h[0])==null?void 0:k.offset)??0,y:((w=m[0])==null?void 0:w.offset)??0};f.x=0,f.y=0,h.length=0,m.length=0;const[U,b,y,E]=Et(e).map(T=>mn(T)),_=[M(U,b),M(U,E),M(y,b),M(y,E)];Cg(e,_,n,i,h,m,f);const I=oS(h,m);return{snapOffset:p,snapLines:I}},J_e=(e,t,n,i,s,r)=>{var m,p;if(!md({event:n,selectedElements:[e],app:t}))return{snapOffset:{x:0,y:0},snapLines:[]};const o=[M(i.x+s.x,i.y+s.y)],a=JE(t.state.zoom.value),l={x:a,y:a},c=[],d=[];Cg([e],o,t,n,c,d,l);const u={x:((m=c[0])==null?void 0:m.offset)??0,y:((p=d[0])==null?void 0:p.offset)??0};l.x=0,l.y=0,c.length=0,d.length=0;const f=Up([e],r,{boundingBoxCorners:!0,omitCenter:!0});Cg([e],f,t,n,c,d,l);const h=oS(c,d);return{snapOffset:u,snapLines:h}},ewe=(e,t,n,i,s)=>{if(!md({event:i,selectedElements:[],app:t}))return{originOffset:{x:0,y:0},snapLines:[]};const r=hV(e,[],t.state,s),o=JE(t.state.zoom.value),a={x:o,y:o},l=[],c=[];for(const d of r){const u=Up([d],s);for(const f of u){const h=f[0]-n.x;Math.abs(h)<=Math.abs(a.x)&&(Math.abs(h)<Math.abs(a.x)&&(c.length=0),c.push({type:"pointer",points:[f,M(f[0],n.y)],direction:"vertical"}),a.x=h);const m=f[1]-n.y;Math.abs(m)<=Math.abs(a.y)&&(Math.abs(m)<Math.abs(a.y)&&(l.length=0),l.push({type:"pointer",points:[f,M(n.x,f[1])],direction:"horizontal"}),a.y=m)}}return{originOffset:{x:c.length>0?c[0].points[0][0]-n.x:0,y:l.length>0?l[0].points[0][1]-n.y:0},snapLines:[...c,...l]}},twe=e=>e===ui.rectangle||e===ui.ellipse||e===ui.diamond||e===ui.frame||e===ui.magicframe||e===ui.image||e===ui.text;class GL{constructor(t){B(this,"scene");B(this,"getRenderableElements",(()=>{const t=({elementsMap:i,zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l,height:c,width:d})=>{const u=[];for(const f of i.values())d5(f,d,c,{zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l},i)&&u.push(f);return u},n=({elements:i,editingTextElement:s,newElementId:r})=>{const o=new Map;for(const a of i)r!==a.id&&(!s||s.type!=="text"||a.id!==s.id)&&o.set(a.id,a);return o};return sse(({zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c,editingTextElement:d,newElementId:u,sceneNonce:f})=>{const h=this.scene.getNonDeletedElements(),m=n({elements:h,editingTextElement:d,newElementId:u}),p=t({elementsMap:m,zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c});return{elementsMap:m,visibleElements:p}})})());this.scene=t}destroy(){FY.cancel(),this.getRenderableElements.clear()}}const nwe=5,iwe=(e,t,n)=>{const[i,s]=je(e,n),{x:r,y:o}=cr({sceneX:i+e.width,sceneY:s},t),a=r-t.offsetLeft+10,l=o-t.offsetTop;return{x:a,y:l}},XL=({children:e,element:t,elementsMap:n})=>{const i=S2();if(i.contextMenu||i.newElement||i.resizingElement||i.isRotating||i.openMenu||i.viewModeEnabled)return null;const{x:s,y:r}=iwe(t,i,n);return g("div",{className:"excalidraw-canvas-buttons",style:{top:`${r}px`,left:`${s}px`,padding:nwe},children:e})};function swe(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var rwe={};swe(rwe,"LaserPointer",()=>V5);function Sn([e,t,n],[i,s,r]){return[e+i,t+s,n+r]}function T1([e,t,n],[i,s,r]){return[e-i,t-s,n-r]}function Wn([e,t,n],i){return[e*i,t*i,n*i]}function Lf([e,t,n]){return[e/Math.sqrt(e**2+t**2),t/Math.sqrt(e**2+t**2),n]}function ts([e,t,n],i){return[Math.cos(i)*e-Math.sin(i)*t,Math.sin(i)*e+Math.cos(i)*t,n]}function owe(e,t,n){return Sn(e,Wn(T1(t,e),n))}function jL(e,t,n){return Math.atan2(n[1]-e[1],n[0]-e[0])-Math.atan2(t[1]-e[1],t[0]-e[0])}function YL(e){return Math.atan2(Math.sin(e),Math.cos(e))}function WL([e,t]){return Math.sqrt(e**2+t**2)}function Gh([e,t],[n,i]){return Math.sqrt((n-e)**2+(i-t)**2)}function awe(e){if(e.length<2)return 0;let t=0;for(let n=1;n<=e.length-1;n++)t+=Gh(e[n-1],e[n]);return t+=Gh(e[e.length-2],e[e.length-1]),t}const lwe=(e,t,n)=>Math.max(t,Math.min(n,e));function cwe(e,t,n){const i=Gh(t,n);if(i===0)return Gh(e,t);const s=lwe(((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i**2,0,1),r=[t[0]+s*(n[0]-t[0]),t[1]+s*(n[1]-t[1]),e[2]];return Gh(r,e)}function H5(e,t){if(t===0||e.length<=2)return e;const n=e[0],i=e[e.length-1],[s,r]=e.reduce(([o,a],l,c)=>{const d=cwe(l,n,i);return d>o?[d,c]:[o,a]},[0,-1]);if(s>=t){const o=e[r];return[...H5([n,...e.slice(1,r),o],t).slice(0,-1),o,...H5([o,...e.slice(r,-1),i],t).slice(1)]}else return[n,i]}const hc=class hc{constructor(t){this.originalPoints=[],this.stablePoints=[],this.tailPoints=[],this.isFresh=!0,this.options=Object.assign({},hc.defaults,t)}get lastPoint(){return this.tailPoints[this.tailPoints.length-1]??this.stablePoints[this.stablePoints.length-1]}addPoint(t){const n=this.originalPoints[this.originalPoints.length-1];if(!(n&&n[0]===t[0]&&n[1]===t[1])){if(this.originalPoints.push(t),this.isFresh){this.isFresh=!1,this.stablePoints.push(t);return}this.options.streamline>0&&(t=owe(this.lastPoint,t,1-this.options.streamline)),this.tailPoints.push(t),awe(this.tailPoints)>hc.constants.maxTailLength&&this.stabilizeTail()}}close(){this.stabilizeTail()}stabilizeTail(){if(this.options.simplify>0&&this.options.simplifyPhase=="tail")throw new Error("Not implemented yet");this.stablePoints.push(...this.tailPoints),this.tailPoints=[]}getSize(t,n,i,s,r){return(t??this.options.size)*this.options.sizeMapping({pressure:n,runningLength:r,currentIndex:i,totalLength:s})}getStrokeOutline(t){if(this.isFresh)return[];let n=[...this.stablePoints,...this.tailPoints];this.options.simplify>0&&this.options.simplifyPhase==="input"&&(n=H5(n,this.options.simplify));const i=n.length;if(i===0)return[];if(i===1){const w=n[0],T=this.getSize(t,w[2],0,i,0);if(T<.5)return[];const A=[];for(let S=0;S<=Math.PI*2;S+=Math.PI/16)A.push(Sn(w,Wn(ts([1,0,0],S),T)));return A.push(Sn(w,Wn([1,0,0],this.getSize(t,w[2],0,i,0)))),A}if(i===2){const w=n[0],T=n[1],A=this.getSize(t,w[2],0,i,0),S=this.getSize(t,T[2],0,i,0);if(A<.5||S<.5)return[];const D=[],N=jL(w,[w[0],w[1]-100,w[2]],T);for(let L=N;L<=Math.PI+N;L+=Math.PI/16)D.push(Sn(w,Wn(ts([1,0,0],L),A)));for(let L=Math.PI+N;L<=Math.PI*2+N;L+=Math.PI/16)D.push(Sn(T,Wn(ts([1,0,0],L),S)));return D.push(D[0]),D}const s=[],r=[];let o=0,a=0,l=0,c=0;for(let w=1;w<i-1;w++){const T=n[w-1],A=n[w],S=n[w+1];let D=A[2];const N=Gh(T,A);c+=N,o=a+(N-a)*.2;const L=this.getSize(t,D,w,i,c);if(L===0){l=w+1;continue}const j=Lf(T1(T,A)),Y=Lf(T1(S,A)),G=ts(j,Math.PI/2),O=ts(j,-Math.PI/2),z=ts(Y,Math.PI/2),H=ts(Y,-Math.PI/2),X=Sn(A,Wn(G,L)),Q=Sn(A,Wn(O,L)),re=Sn(A,Wn(z,L)),ie=Sn(A,Wn(H,L)),me=Sn(G,H),ke=Sn(O,z),ye=Sn(A,Wn(WL(me)===0?j:Lf(me),L)),Ae=Sn(A,Wn(WL(ke)===0?Y:Lf(ke),L)),$e=YL(jL(A,T,S)),et=hc.constants.cornerDetectionMaxAngle/180*Math.PI*hc.constants.cornerDetectionVariance(o);if(Math.abs($e)<et){const Be=Math.abs(YL(Math.PI-$e));if(Be===0)continue;if($e<0){r.push(Q,Ae);for(let We=0;We<=Be;We+=Be/4)s.push(Sn(A,ts(Wn(G,L),We)));for(let We=Be;We>=0;We-=Be/4)r.push(Sn(A,ts(Wn(G,L),We)));r.push(Ae,re)}else{s.push(X,ye);for(let We=0;We<=Be;We+=Be/4)r.push(Sn(A,ts(Wn(G,-L),-We)));for(let We=Be;We>=0;We-=Be/4)s.push(Sn(A,ts(Wn(G,-L),-We)));s.push(ye,ie)}}else s.push(ye),r.push(Ae);a=o}if(l>=i-2)if(this.options.keepHead){const w=n[i-1],T=[];for(let A=0;A<=Math.PI*2;A+=Math.PI/16)T.push(Sn(w,Wn(ts([1,0,0],A),this.options.size)));return T.push(Sn(w,Wn([1,0,0],this.options.size))),T}else return[];const d=n[l],u=n[l+1],f=n[i-2],h=n[i-1],m=Lf(T1(u,d)),p=Lf(T1(f,h)),U=ts(m,-Math.PI/2),b=ts(p,Math.PI/2),y=this.getSize(t,d[2],0,i,0),E=[],_=this.options.keepHead?this.options.size:this.getSize(t,f[2],i-2,i,c),I=[];if(y>1){for(let w=0;w<=Math.PI;w+=Math.PI/16)E.unshift(Sn(d,ts(Wn(U,y),-w)));E.unshift(Sn(d,Wn(U,-y)))}else E.push(d);for(let w=0;w<=Math.PI*3;w+=Math.PI/16)I.push(Sn(h,ts(Wn(b,-_),-w)));const k=[...E,...s,...I.reverse(),...r.reverse()];return E.length>0&&k.push(E[0]),this.options.simplify>0&&this.options.simplifyPhase==="output"?H5(k,this.options.simplify):k}};hc.defaults={size:2,streamline:.45,simplify:.1,simplifyPhase:"output",keepHead:!1,sizeMapping:()=>1},hc.constants={cornerDetectionMaxAngle:75,cornerDetectionVariance:t=>t>35?.5:1,maxTailLength:50};let V5=hc;class $5{constructor(t,n,i){B(this,"currentTrail");B(this,"pastTrails",[]);B(this,"container");B(this,"trailElement");B(this,"trailAnimation");this.animationFrameHandler=t,this.app=n,this.options=i,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.trailElement=document.createElementNS(ht,"path"),this.options.animateTrail&&(this.trailAnimation=document.createElementNS(ht,"animate"),this.trailAnimation.setAttribute("attributeName","stroke-dashoffset"),this.trailElement.setAttribute("stroke-dasharray","7 7"),this.trailElement.setAttribute("stroke-dashoffset","10"),this.trailAnimation.setAttribute("from","0"),this.trailAnimation.setAttribute("to","-14"),this.trailAnimation.setAttribute("dur","0.3s"),this.trailElement.appendChild(this.trailAnimation))}get hasCurrentTrail(){return!!this.currentTrail}hasLastPoint(t,n){if(this.currentTrail){const i=this.currentTrail.originalPoints.length;return this.currentTrail.originalPoints[i-1][0]===t&&this.currentTrail.originalPoints[i-1][1]===n}return!1}start(t){t&&(this.container=t),this.trailElement.parentNode!==this.container&&this.container&&this.container.appendChild(this.trailElement),this.animationFrameHandler.start(this)}stop(){var t;this.animationFrameHandler.stop(this),this.trailElement.parentNode===this.container&&((t=this.container)==null||t.removeChild(this.trailElement))}startPath(t,n){this.currentTrail=new V5(this.options),this.currentTrail.addPoint([t,n,performance.now()]),this.update()}addPointToPath(t,n){this.currentTrail&&(this.currentTrail.addPoint([t,n,performance.now()]),this.update())}endPath(){this.currentTrail&&(this.currentTrail.close(),this.currentTrail.options.keepHead=!1,this.pastTrails.push(this.currentTrail),this.currentTrail=void 0,this.update())}getCurrentTrail(){return this.currentTrail}clearTrails(){this.pastTrails=[],this.currentTrail=void 0,this.update()}update(){this.start(),this.trailAnimation&&(this.trailAnimation.setAttribute("begin","indefinite"),this.trailAnimation.setAttribute("repeatCount","indefinite"))}onFrame(){const t=[];for(const i of this.pastTrails)t.push(this.drawTrail(i,this.app.state));if(this.currentTrail){const i=this.drawTrail(this.currentTrail,this.app.state);t.push(i)}this.pastTrails=this.pastTrails.filter(i=>i.getStrokeOutline().length!==0),t.length===0&&this.stop();const n=t.join(" ").trim();this.trailElement.setAttribute("d",n),this.trailAnimation?(this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this)),this.trailElement.setAttribute("stroke",(this.options.stroke??(()=>"black"))(this))):this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this))}drawTrail(t,n){const i=t.getStrokeOutline(t.options.size/n.zoom.value).map(([r,o])=>{const a=cr({sceneX:r,sceneY:o},n);return[a.x,a.y]}),s=this.trailAnimation?i.slice(0,i.length/2):i;return rse(s,!0)}}class dwe{constructor(t,n){B(this,"localTrail");B(this,"collabTrails",new Map);B(this,"container");this.animationFrameHandler=t,this.app=n,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.localTrail=new $5(t,n,{...this.getTrailOptions(),fill:()=>Qne})}getTrailOptions(){return{simplify:0,streamline:.4,sizeMapping:t=>{const s=Math.max(0,1-(performance.now()-t.pressure)/1e3),r=(50-Math.min(50,t.totalLength-t.currentIndex))/50;return Math.min(Ml(r),Ml(s))}}}startPath(t,n){this.localTrail.startPath(t,n)}addPointToPath(t,n){this.localTrail.addPointToPath(t,n)}endPath(){this.localTrail.endPath()}start(t){this.container=t,this.animationFrameHandler.start(this),this.localTrail.start(t)}stop(){this.animationFrameHandler.stop(this),this.localTrail.stop()}onFrame(){this.updateCollabTrails()}updateCollabTrails(){if(!(!this.container||this.app.state.collaborators.size===0)){for(const[t,n]of this.app.state.collaborators.entries()){let i;this.collabTrails.has(t)?i=this.collabTrails.get(t):(i=new $5(this.animationFrameHandler,this.app,{...this.getTrailOptions(),fill:()=>{var s;return((s=n.pointer)==null?void 0:s.laserColor)||GE(t,n)}}),i.start(this.container),this.collabTrails.set(t,i)),n.pointer&&n.pointer.tool==="laser"&&(n.button==="down"&&!i.hasCurrentTrail&&i.startPath(n.pointer.x,n.pointer.y),n.button==="down"&&i.hasCurrentTrail&&!i.hasLastPoint(n.pointer.x,n.pointer.y)&&i.addPointToPath(n.pointer.x,n.pointer.y),n.button==="up"&&i.hasCurrentTrail&&(i.addPointToPath(n.pointer.x,n.pointer.y),i.endPath()))}for(const t of this.collabTrails.keys())this.app.state.collaborators.has(t)||(this.collabTrails.get(t).stop(),this.collabTrails.delete(t))}}}const hn=e=>t=>{tn.unstable_batchedUpdates(e,t)},P7=e=>jp(t=>{tn.unstable_batchedUpdates(e,t)}),G5=(()=>{let e;try{const n=C.version.split(".");e=Number(n[0])>17}catch{e=!1}let t=!1;return()=>window.EXCALIDRAW_THROTTLE_RENDER===!0?e?!0:(t||(t=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1):!1})(),uwe=(e,t,n,i,s,r)=>{const{zoom:o}=i,a=180*n/Math.PI;let l=e*(o.value-1)/2,c=t*(o.value-1)/2;return e>s&&o.value!==1&&(l=s*(o.value-1)/2),t>r&&o.value!==1&&(c=r*(o.value-1)/2),`translate(${l}px, ${c}px) scale(${o.value}) rotate(${a}deg)`},fwe=({id:e,onChange:t,onSubmit:n,getViewportCoords:i,element:s,canvas:r,excalidrawContainer:o,app:a,autoSelect:l=!0})=>{const c=(O,z)=>{if(!z.style.fontFamily||!z.style.fontSize)return!1;const H=z.style.fontFamily.replace(/"/g,"");return Xp({fontFamily:O.fontFamily})!==H||`${O.fontSize}px`!==z.style.fontSize};let d=a.state.theme;const u=()=>{d=a.state.theme;const O=a.state,z=a.scene.getElement(e);if(!z)return;const{textAlign:H,verticalAlign:X}=z,Q=a.scene.getNonDeletedElementsMap();if(z&&he(z)){let re=z.x,ie=z.y;const me=Gn(z,a.scene.getNonDeletedElementsMap());let ke=z.width,ye=z.height,Ae=z.width,$e=z.height;if(me&&z.containerId){if(Te(me)){const Yn=ne.getBoundTextElementPosition(me,z,Q);re=Yn.x,ie=Yn.y}const Jt=c(z,f);let Pi;if(Jt?Pi=q6(me.id,me.height):(Pi=ug[me.id],Pi||(Pi=q6(me.id,me.height))),Ae=_a(me,z),$e=r2(me,z),!Te(me)&&ye>$e){const Yn=Pu(ye,me.type);a.scene.mutateElement(me,{height:Yn}),pi(me,a.scene);return}else if(!Te(me)&&me.height>Pi.height&&ye<$e){const Yn=Pu(ye,me.type);a.scene.mutateElement(me,{height:Yn}),pi(me,a.scene)}else{const{x:Yn,y:Sr}=Cd(me,z,Q);re=Yn,ie=Sr}}const[et,Be]=i(re,ie);me?ke+=.5:(Ae=(O.width-8-et)/O.zoom.value,ke=Math.min(ke,Ae)),ye*=1.05;const We=_t(z),bn=(O.height-Be)/O.zoom.value;Object.assign(f.style,{font:We,lineHeight:z.lineHeight,width:`${ke}px`,height:`${ye}px`,left:`${et}px`,top:`${Be}px`,transform:uwe(ke,ye,Mde(z,me),O,Ae,bn),textAlign:H,verticalAlign:X,color:O.theme===be.DARK?Yi(z.strokeColor):z.strokeColor,opacity:z.opacity/100,maxHeight:`${bn}px`}),f.scrollTop=0,a.scene.mutateElement(z,{x:re,y:ie})}},f=document.createElement("textarea");f.dir="auto",f.tabIndex=0,f.dataset.type="wysiwyg",f.wrap="off",f.classList.add("excalidraw-wysiwyg");let h="pre",m="normal";(Vt(s)||!s.autoResize)&&(h="pre-wrap",m="break-word"),Object.assign(f.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:m,whiteSpace:h,overflowWrap:"break-word",boxSizing:"content-box"}),f.value=s.originalText,u(),t&&(f.onpaste=async O=>{const z=B7e(O);let H=null;if(z.has(Ee.excalidrawClipboard)||z.has(Ee.excalidraw)){O.preventDefault(),H=await D5(O);try{const me=await tW(H);if(me.elements){const ke=oT(me.elements);if(ke){const{selectionStart:ye,selectionEnd:Ae,value:$e}=f;f.value=$e.slice(0,ye)+ke+$e.slice(Ae);const et=ye+ke.length;f.selectionStart=f.selectionEnd=et,f.dispatchEvent(new Event("input"))}}return}catch{console.warn("failed to parse excalidraw clipboard data")}}H=H||await D5(O);const X=H.findByType(Ee.text);if(!X)return;const Q=fg(X.value);if(!Q)return;const re=Gn(s,a.scene.getNonDeletedElementsMap()),ie=_t({fontSize:a.state.currentItemFontSize,fontFamily:a.state.currentItemFontFamily});if(re){const me=Ne(re,a.scene.getNonDeletedElementsMap()),ke=Sd(`${f.value}${Q}`,ie,_a(re,me)),ye=sT(ke,ie);f.style.width=`${ye}px`}},f.oninput=()=>{const O=fg(f.value);if(f.value!==O){const z=f.selectionStart;f.value=O,f.selectionStart=z,f.selectionEnd=z}t(f.value)}),f.onkeydown=O=>{if(!O.shiftKey&&uD.keyTest(O))O.preventDefault(),a.actionManager.executeAction(uD),u();else if(!O.shiftKey&&fD.keyTest(O))O.preventDefault(),a.actionManager.executeAction(fD),u();else if(!O.shiftKey&&hD.keyTest(O))O.preventDefault(),a.actionManager.executeAction(hD),u();else if(aD.keyTest(O))a.actionManager.executeAction(aD);else if(lD.keyTest(O))a.actionManager.executeAction(lD);else if(O.key===$.ESCAPE)O.preventDefault(),k=!0,w();else if(L5.keyTest(O))O.preventDefault(),w(),a.actionManager.executeAction(L5);else if(O.key===$.ENTER&&O[$.CTRL_OR_CMD]){if(O.preventDefault(),O.isComposing||O.keyCode===229)return;k=!0,w()}else if(O.key===$.TAB||O[$.CTRL_OR_CMD]&&(O.code===ut.BRACKET_LEFT||O.code===ut.BRACKET_RIGHT)){if(O.preventDefault(),O.isComposing)return;O.shiftKey||O.code===ut.BRACKET_LEFT?E():y(),f.dispatchEvent(new Event("input"))}};const p=4,U=" ".repeat(p),b=new RegExp(`^ {1,${p}}`),y=()=>{const{selectionStart:O,selectionEnd:z}=f,H=_();let X=f.value;H.forEach(Q=>{const re=X.slice(0,Q),ie=X.slice(Q);X=`${re}${U}${ie}`}),f.value=X,f.selectionStart=O+p,f.selectionEnd=z+p*H.length},E=()=>{const{selectionStart:O,selectionEnd:z}=f,H=_(),X=[];let Q=f.value;H.forEach(re=>{const ie=Q.slice(re,re+p).match(b);if(ie){const me=Q.slice(0,re),ke=Q.slice(re+ie[0].length);Q=`${me}${ke}`,X.push(re)}}),f.value=Q,X.length&&(O>X[X.length-1]?f.selectionStart=Math.max(O-p,X[X.length-1]):f.selectionStart=O,f.selectionEnd=Math.max(f.selectionStart,z-p*X.length))},_=()=>{let{selectionStart:O,selectionEnd:z,value:H}=f;const X=H.slice(0,O).match(/[^\n]*$/)[0].length;return O=O-X,H.slice(O,z).split(`
`).reduce((re,ie,me,ke)=>re.concat(me?re[me-1]+ke[me-1].length+1:O),[]).reverse()},I=O=>{O.target instanceof HTMLCanvasElement&&(O.preventDefault(),O.stopPropagation())};let k=!1;const w=()=>{var H;if(Y)return;Y=!0,T();const O=a.scene.getElement(s.id);if(!O)return;const z=Gn(O,a.scene.getNonDeletedElementsMap());if(z){if(f.value.trim()){const X=va(z);!X||X!==s.id?a.scene.mutateElement(z,{boundElements:(z.boundElements||[]).concat({type:"text",id:s.id})}):Te(z)&&Qo(z)}else a.scene.mutateElement(z,{boundElements:(H=z.boundElements)==null?void 0:H.filter(X=>!he(X))});fs(O,z,a.scene)}n({viaKeyboard:k,nextOriginalText:f.value})},T=()=>{f.onblur=null,f.oninput=null,f.onkeydown=null,G&&G.disconnect(),window.removeEventListener("resize",u),window.removeEventListener("wheel",I,!0),window.removeEventListener("pointerdown",D),window.removeEventListener("pointerup",A),window.removeEventListener("blur",w),window.removeEventListener("beforeunload",w),L(),N(),j(),f.remove()},A=O=>{window.removeEventListener("pointerup",A);const z=O==null?void 0:O.target,H=z instanceof HTMLElement&&z.classList.contains("properties-trigger"),X=(z instanceof HTMLElement||z instanceof SVGElement)&&!!z.closest(".properties-content"),Q=(z instanceof HTMLElement||z instanceof SVGElement)&&(!!z.closest(`.${Wi.SHAPE_ACTIONS_MENU}`)||!!z.closest(".compact-shape-actions-island"));setTimeout(()=>{Q||H||X||(f.onblur=w,f.focus())})},S=()=>{f.onblur=null,window.addEventListener("pointerup",A),window.addEventListener("blur",w)},D=O=>{const z=O==null?void 0:O.target;if(O.button===ic.WHEEL){z instanceof HTMLTextAreaElement&&(O.preventDefault(),a.handleCanvasPanUsingWheelOrSpaceDrag(O)),S();return}const H=z instanceof HTMLElement&&z.classList.contains("properties-trigger"),X=(z instanceof HTMLElement||z instanceof SVGElement)&&!!z.closest(".properties-content");(O.target instanceof HTMLElement||O.target instanceof SVGElement)&&(O.target.closest(`.${Wi.SHAPE_ACTIONS_MENU}, .${Wi.ZOOM_ACTIONS}`)||O.target.closest(".compact-shape-actions-island"))&&!rl(O.target)||H||X?S():O.target instanceof HTMLCanvasElement&&requestAnimationFrame(()=>{w()})},N=a.onChangeEmitter.on(O=>{a.state.theme!==d&&u()}),L=a.scene.onUpdate(()=>{var z;u(),!!((z=document.activeElement)!=null&&z.closest(".properties-content"))||f.focus()}),j=a.onScrollChangeEmitter.on(()=>{u()});let Y=!1;l&&f.select(),A();let G=null;return r&&"ResizeObserver"in window?(G=new window.ResizeObserver(()=>{u()}),G.observe(r)):window.addEventListener("resize",u),f.onpointerdown=O=>O.stopPropagation(),requestAnimationFrame(()=>{window.addEventListener("pointerdown",D,{capture:!0})}),window.addEventListener("beforeunload",w),o==null||o.querySelector(".excalidraw-textEditorContainer").appendChild(f),w},oc=4,Xo=6,hwe="rgba(0,0,0,0.3)",gwe=(e,t,n,i)=>{if(!e.size)return{horizontal:null,vertical:null};const[s,r,o,a]=Et(e),l=t/i.zoom.value,c=n/i.zoom.value,d={top:parseInt(bU("sat"))||0,bottom:parseInt(bU("sab"))||0,left:parseInt(bU("sal"))||0,right:parseInt(bU("sar"))||0},u=W0().rtl,f=-i.scrollX+d.left,h=-i.scrollY+d.top,m=f+l-d.right,p=h+c-d.bottom,U=Math.min(s,f),b=Math.min(r,h),y=Math.max(o,m),E=Math.max(a,p),_=o-s,I=a-r,k=y-U,w=E-b,T=Math.max(oc*2,d.left+d.right)+Xo*2,A=t*(l/k)-T,S=Math.max(oc*2,d.top+d.bottom)+Xo*2,D=n*(c/w)-S,N=k>_?k*i.zoom.value/(A+T):t/(A+T),L=w>I?w*i.zoom.value/(D+S):n/(D+S);return{horizontal:f===U&&m===y?null:{x:Math.max(d.left,oc)+Xo+(f-U)/k*t,y:n-Xo-Math.max(oc,d.bottom),width:A,height:Xo,deltaMultiplier:N},vertical:h===b&&p===E?null:{x:u?Math.max(d.left,oc):t-Xo-Math.max(d.right,oc),y:Math.max(d.top,oc)+Xo+(h-b)/w*n,width:Xo,height:D,deltaMultiplier:L}}},KL=(e,t,n)=>{const[i,s]=[e.horizontal,e.vertical].map(o=>o!=null&&o.x<=t&&t<=o.x+o.width&&o.y<=n&&n<=o.y+o.height);return{isOverEither:i||s,isOverHorizontal:i,isOverVertical:s}},mwe=e=>{const t=["flowchart","graph","sequenceDiagram","classDiagram","stateDiagram","stateDiagram-v2","erDiagram","journey","gantt","pie","quadrantChart","requirementDiagram","gitGraph","C4Context","mindmap","timeline","zenuml","sankey","xychart","block"];return new RegExp(`^(?:%%{.*?}%%[\\s\\n]*)?\\b(?:${t.map(i=>`\\s*${i}(-beta)?`).join("|")})\\b`).test(e.trim())};function N7(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function pwe(e,t,n){const i=N7(t,n);if(i===0)return N7(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),N7(e,Uwe(t,n,s))}function Uwe(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function bwe(e,t){return z_(e,0,e.length,t)}function z_(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=pwe(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(z_(e,t,c+1,i,r),z_(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}const ywe=e=>{const{lassoPath:t,elements:n,elementsMap:i,elementsSegments:s,intersectedElements:r,enclosedElements:o,simplifyDistance:a}=e;let l=t;a&&(l=bwe(t,a));const c=n.filter(f=>!f.locked);o.clear(),r.clear();const d=t.reduce((f,h)=>[Math.min(f[0],h[0]),Math.min(f[1],h[1]),Math.max(f[2],h[0]),Math.max(f[3],h[1])],[1/0,1/0,-1/0,-1/0]);for(const f of c){const h=Pn(f,i);xd(d,h)&&!r.has(f.id)&&!o.has(f.id)&&(Ewe(l,f,s)?o.add(f.id):vwe(l,f,i)&&r.add(f.id))}return{selectedElementIds:[...r,...o]}},Ewe=(e,t,n)=>{const i=M6(e),s=n.get(t.id);return s?s.some(r=>r.some(o=>nz(o,i))):!1},vwe=(e,t,n)=>{const i=e.slice(1).map((r,o)=>Pe(e[o],r)).concat([Pe(e[e.length-1],e[0])]),s=Ne(t,n);return i.some(r=>So(t,n,r,0,!0).length>0||!!s&&So({...s,...Cd(t,s,n)},n,r,0,!0).length>0)};class _we extends $5{constructor(n,i){super(n,i,{animateTrail:!0,streamline:.4,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/(1/0)),l=(5e3-Math.min(5e3,s.totalLength-s.currentIndex))/5e3;return Math.min(Ml(l),Ml(a))},fill:()=>"rgba(105,101,219,0.05)",stroke:()=>"rgba(105,101,219)"});B(this,"intersectedElements",new Set);B(this,"enclosedElements",new Set);B(this,"elementsSegments",null);B(this,"canvasTranslate",null);B(this,"keepPreviousSelection",!1);B(this,"selectElementsFromIds",n=>{this.app.setState(i=>{const s=n.reduce((l,c)=>(l[c]=!0,l),{});if(this.keepPreviousSelection)for(const l of Object.keys(i.selectedElementIds))s[l]=!0;for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&he(c)){const d=Gn(c,this.app.scene.getNonDeletedElementsMap());d&&(s[d.id]=!0,delete s[c.id])}}for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&_e(c)){const d=br(this.app.scene.getNonDeletedElementsMap(),c.id);for(const u of d)delete s[u.id]}}const r=Fi({editingGroupId:i.editingGroupId,selectedElementIds:s},this.app.scene.getNonDeletedElements(),i,this.app),o=[...Object.keys(r.selectedElementIds)],a=[...Object.keys(r.selectedGroupIds)];return{selectedElementIds:r.selectedElementIds,selectedGroupIds:r.selectedGroupIds,selectedLinearElement:o.length===1&&!a.length&&De(this.app.scene.getNonDeletedElement(o[0]))?new ne(this.app.scene.getNonDeletedElement(o[0]),this.app.scene.getNonDeletedElementsMap()):null}})});B(this,"addPointToPath",(n,i,s=!1)=>{super.addPointToPath(n,i),this.keepPreviousSelection=s,this.updateSelection()});B(this,"updateSelection",()=>{var s,r;const n=(r=(s=super.getCurrentTrail())==null?void 0:s.originalPoints)==null?void 0:r.map(o=>M(o[0],o[1])),i={scrollX:this.app.state.scrollX,scrollY:this.app.state.scrollY,zoom:this.app.state.zoom.value};if(!this.elementsSegments||!ki(i,this.canvasTranslate??{})){this.canvasTranslate=i,this.elementsSegments=new Map;const o=we(this.app.visibleElements);for(const a of this.app.visibleElements){const l=c5(a,o);this.elementsSegments.set(a.id,l)}}if(n){const{selectedElementIds:o}=ywe({lassoPath:n,elements:this.app.visibleElements,elementsMap:this.app.scene.getNonDeletedElementsMap(),elementsSegments:this.elementsSegments,intersectedElements:this.intersectedElements,enclosedElements:this.enclosedElements,simplifyDistance:5/this.app.state.zoom.value});this.selectElementsFromIds(o)}})}startPath(n,i,s=!1){this.endPath(),super.startPath(n,i),this.intersectedElements.clear(),this.enclosedElements.clear(),this.keepPreviousSelection=s,this.keepPreviousSelection||this.app.setState({selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null})}endPath(){super.endPath(),super.clearTrails(),this.intersectedElements.clear(),this.enclosedElements.clear(),this.elementsSegments=null}}class wwe extends $5{constructor(n,i){super(n,i,{streamline:.2,size:5,keepHead:!0,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/200),l=(10-Math.min(10,s.totalLength-s.currentIndex))/10;return Math.min(Ml(l),Ml(a))},fill:()=>i.state.theme===be.LIGHT?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.2)"});B(this,"elementsToErase",new Set);B(this,"groupsToErase",new Set)}startPath(n,i){this.endPath(),super.startPath(n,i),this.elementsToErase.clear()}addPointToPath(n,i,s=!1){return super.addPointToPath(n,i),this.updateElementsToBeErased(s)}updateElementsToBeErased(n){var a,l;const i=((l=(a=super.getCurrentTrail())==null?void 0:a.originalPoints)==null?void 0:l.map(c=>M(c[0],c[1])))||[];if(i.length<2)return[];const s=Pe(i[i.length-1],i[i.length-2]),r=this.app.visibleElements.filter(c=>!c.locked),o=we(r);for(const c of r)if(n&&this.elementsToErase.has(c.id)){if(ZL(s,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(this.groupsToErase.has(u)){const f=Ot(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.delete(h.id);this.groupsToErase.delete(u)}if(Vt(c)&&this.elementsToErase.delete(c.containerId),Ki(c)){const f=va(c);f&&this.elementsToErase.delete(f)}this.elementsToErase.delete(c.id)}}else if(!n&&!this.elementsToErase.has(c.id)&&ZL(s,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(!this.groupsToErase.has(u)){const f=Ot(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.add(h.id);this.groupsToErase.add(u)}if(Ki(c)){const f=va(c);f&&this.elementsToErase.add(f)}Vt(c)&&this.elementsToErase.add(c.containerId),this.elementsToErase.add(c.id)}return Array.from(this.elementsToErase)}endPath(){super.endPath(),super.clearTrails(),this.elementsToErase.clear(),this.groupsToErase.clear()}}const ZL=(e,t,n,i)=>{const s=e[1],r=us(t)?15:t.strokeWidth/2,o=[Math.min(e[0][0],e[1][0])-r,Math.min(e[0][1],e[1][1])-r,Math.max(e[0][0],e[1][0])+r,Math.max(e[0][1],e[1][1])+r],a=Pn(t,n),l=[a[0]-r,a[1]-r,a[2]+r,a[3]+r];if(!xd(o,l))return!1;if(Q6(t)&&wa(s,t,n))return!0;if(us(t)){const d=IV(t),u=Hue(t,d,n),f=Math.max(2.25,5/i);for(const m of u)if(ZA(m,e)<=f)return!0;const h=l4(...d.map(([m,p])=>M(t.x+m,t.y+p)));return!!nz(e[0],h)}const c=Ne(t,n);if(Te(t)||cn(t)&&!t.polygon){const d=Math.max(t.strokeWidth,t.strokeWidth*2/i),u=c5(t,n);for(const f of u)if(ZA(f,e)<=d)return!0;return!1}return So(t,n,e,0,!0).length>0||!!c&&So({...c,...Cd(t,c,n)},n,e,0,!0).length>0},Twe=()=>P("div",{"data-testid":"brave-measure-text-error",children:[g("p",{children:g(Hs,{i18nKey:"errors.brave_measure_text_error.line1",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Hs,{i18nKey:"errors.brave_measure_text_error.line2",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Hs,{i18nKey:"errors.brave_measure_text_error.line3",link:e=>g("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:e})})}),g("p",{children:g(Hs,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:e=>g("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:e}),discordLink:e=>P("a",{href:"https://discord.gg/UexuTaE",children:[e,"."]})})})]}),Iwe=({children:e,left:t,top:n,onCloseRequest:i,fitInViewport:s=!1,offsetLeft:r=0,offsetTop:o=0,viewportWidth:a=window.innerWidth,viewportHeight:l=window.innerHeight,className:c})=>{const d=C.useRef(null);C.useEffect(()=>{const f=d.current;if(!f)return;f.contains(document.activeElement)||f.focus();const h=m=>{var p,U,b;if(m.key===$.TAB){const y=m4(f),{activeElement:E}=document,_=y.findIndex(I=>I===E);E===f?(m.shiftKey?(p=y[y.length-1])==null||p.focus():y[0].focus(),m.preventDefault(),m.stopImmediatePropagation()):_===0&&m.shiftKey?((U=y[y.length-1])==null||U.focus(),m.preventDefault(),m.stopImmediatePropagation()):_===y.length-1&&!m.shiftKey&&((b=y[0])==null||b.focus(),m.preventDefault(),m.stopImmediatePropagation())}};return f.addEventListener("keydown",h),()=>f.removeEventListener("keydown",h)},[]);const u=C.useRef(null);return C.useLayoutEffect(()=>{var f,h;if(s&&d.current&&n!=null&&t!=null){const m=d.current,{width:p,height:U}=m.getBoundingClientRect();if(((f=u.current)==null?void 0:f.top)===n&&((h=u.current)==null?void 0:h.left)===t)return;u.current={top:n,left:t},p>=a?(m.style.width=`${a}px`,m.style.left="0px",m.style.overflowX="scroll"):t+p-r>a?m.style.left=`${a-p-10}px`:m.style.left=`${t}px`,U>=l?(m.style.height=`${l-20}px`,m.style.top="10px",m.style.overflowY="scroll"):n+U-o>l?m.style.top=`${l-U}px`:m.style.top=`${n}px`}},[n,t,s,a,l,r,o]),C.useEffect(()=>{if(i){const f=h=>{var m;(m=d.current)!=null&&m.contains(h.target)||tn.unstable_batchedUpdates(()=>i(h))};return document.addEventListener("pointerdown",f,!1),()=>document.removeEventListener("pointerdown",f,!1)}},[i]),g("div",{className:ae("popover",c),ref:d,tabIndex:-1,children:e})},di="separator",Swe=de.memo(({actionManager:e,items:t,top:n,left:i,onClose:s})=>{const r=S2(),o=n8(),a=t.reduce((l,c)=>(c&&(c===di||!c.predicate||c.predicate(o,r,e.app.props,e.app))&&l.push(c),l),[]);return g(Iwe,{onCloseRequest:()=>{s()},top:n,left:i,fitInViewport:!0,offsetLeft:r.offsetLeft,offsetTop:r.offsetTop,viewportWidth:r.width,viewportHeight:r.height,className:"context-menu-popover",children:g("ul",{className:"context-menu",onContextMenu:l=>l.preventDefault(),children:a.map((l,c)=>{var f;if(l===di)return!a[c-1]||a[c-1]===di?null:g("hr",{className:"context-menu-item-separator"},c);const d=l.name;let u="";return l.label&&(typeof l.label=="function"?u=x(l.label(o,r,e.app)):u=x(l.label)),g("li",{"data-testid":d,onClick:()=>{s(()=>{e.executeAction(l,"contextMenu")})},children:P("button",{type:"button",className:ae("context-menu-item",{dangerous:d==="deleteSelectedElements",checkmark:(f=l.checked)==null?void 0:f.call(l,r)}),children:[g("div",{className:"context-menu-item__label",children:u}),g("kbd",{className:"context-menu-item__shortcut",children:d?Ln(d):""})]})},c)})})})}),Cwe=({height:e,width:t,userToFollow:n,onDisconnect:i})=>g("div",{className:"follow-mode",style:{width:t,height:e},children:P("div",{className:"follow-mode__badge",children:[P("div",{className:"follow-mode__badge__label",children:["Following"," ",g("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),g("button",{type:"button",onClick:i,className:"follow-mode__disconnect-btn",children:lf})]})}),eK=({delay:e,theme:t})=>{const[n,i]=C.useState(!!e);return C.useEffect(()=>{if(!e)return;const s=setTimeout(()=>{i(!1)},e);return()=>clearTimeout(s)},[e]),n?null:P("div",{className:ae("LoadingMessage",{"LoadingMessage--dark":t===be.DARK}),children:[g("div",{children:g(Sa,{})}),g("div",{className:"LoadingMessage-text",children:x("labels.loadingScene")})]})},xwe="medium",qL={CHECKED:$T,UNCHECKED:rE},Awe=e=>P("label",{className:ae("ToolIcon ToolIcon__lock",`ToolIcon_size_${xwe}`,{"is-mobile":e.isMobile}),title:`${e.title}  Q`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-lock"}),g("div",{className:"ToolIcon__icon",children:e.checked?qL.CHECKED:qL.UNCHECKED})]}),tK=e=>g(qe,{className:ae("Shape",{fillable:!1,active:e.checked}),type:"radio",icon:mG,name:"editor-current-shape",checked:e.checked,title:`${e.title}  H`,keyBindingLabel:e.isMobile?void 0:$.H.toLocaleUpperCase(),"aria-label":`${e.title}  H`,"aria-keyshortcuts":$.H,"data-testid":"toolbar-hand",onChange:()=>{var t;return(t=e.onChange)==null?void 0:t.call(e)}}),O7=[{type:"rectangle",icon:GT,title:Ht(x("toolBar.rectangle"))},{type:"diamond",icon:XT,title:Ht(x("toolBar.diamond"))},{type:"ellipse",icon:jT,title:Ht(x("toolBar.ellipse"))}],F7=[{type:"selection",icon:oE,title:Ht(x("toolBar.selection"))},{type:"lasso",icon:i0,title:Ht(x("toolBar.lasso"))}],B7=[{type:"arrow",icon:iG,title:Ht(x("toolBar.arrow"))},{type:"line",icon:YT,title:Ht(x("toolBar.line"))}],Mwe=({app:e,onHandToolToggle:t,setAppState:n})=>{const i=e.state.activeTool,[s,r]=C.useState(!1),[o,a]=C.useState("rectangle"),[l,c]=C.useState("arrow");C.useEffect(()=>{(i.type==="rectangle"||i.type==="diamond"||i.type==="ellipse")&&a(i.type)},[i.type]),C.useEffect(()=>{(i.type==="arrow"||i.type==="line")&&c(i.type)},[i.type]);const d=i.type==="frame",u=i.type==="laser",f=i.type==="embeddable",{TTDDialogTriggerTunnel:h}=gs(),m=(N,L)=>{e.state.activeTool.type!==N&&at("toolbar",N,"ui"),N==="selection"?e.state.activeTool.type==="selection"||e.setActiveTool({type:"selection"}):e.setActiveTool({type:N})},[p,U]=C.useState(0),b=36,y=4,E=7,_=E*b+(E-1)*y,I=b+y,k=p>=_+1*I,w=p>=_+2*I,T=p>=_+3*I,S=["text","frame","embeddable","laser","magicframe"].filter(N=>!(k&&N==="text"||w&&N==="image"||T&&N==="frame")).includes(i.type),D=S?i.type==="text"?Fh:i.type==="image"?Mb:i.type==="frame"?yu:i.type==="embeddable"?g5:i.type==="laser"?Z0:i.type==="magicframe"?p5:f_:f_;return P("div",{className:"mobile-toolbar",ref:N=>{N&&U(N.getBoundingClientRect().width)},children:[g(tK,{checked:_g(e.state),onChange:t,title:x("toolBar.hand"),isMobile:!0}),g(Gb,{app:e,options:F7,activeTool:i,defaultOption:e.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Ht(x("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:N=>{(N==="selection"||N==="lasso")&&(e.setActiveTool({type:N}),n({preferredSelectionTool:{type:N,initialized:!0}}))},displayedOption:F7.find(N=>N.type===e.state.preferredSelectionTool.type)||F7[0]}),g(qe,{className:ae({active:i.type==="freedraw"}),type:"radio",icon:u2,checked:i.type==="freedraw",name:"editor-current-shape",title:`${Ht(x("toolBar.freedraw"))}`,"aria-label":Ht(x("toolBar.freedraw")),"data-testid":"toolbar-freedraw",onChange:()=>m("freedraw")}),g(qe,{className:ae({active:i.type==="eraser"}),type:"radio",icon:sG,checked:i.type==="eraser",name:"editor-current-shape",title:`${Ht(x("toolBar.eraser"))}`,"aria-label":Ht(x("toolBar.eraser")),"data-testid":"toolbar-eraser",onChange:()=>m("eraser")}),g(Gb,{app:e,options:O7,activeTool:i,defaultOption:o,namePrefix:"shapeType",title:Ht(x(o==="rectangle"?"toolBar.rectangle":o==="diamond"?"toolBar.diamond":o==="ellipse"?"toolBar.ellipse":"toolBar.rectangle")),"data-testid":"toolbar-rectangle",onToolChange:N=>{(N==="rectangle"||N==="diamond"||N==="ellipse")&&(a(N),e.setActiveTool({type:N}))},displayedOption:O7.find(N=>N.type===o)||O7[0]}),g(Gb,{app:e,options:B7,activeTool:i,defaultOption:l,namePrefix:"linearElementType",title:Ht(x(l==="arrow"?"toolBar.arrow":"toolBar.line")),"data-testid":"toolbar-arrow",fillable:!0,onToolChange:N=>{(N==="arrow"||N==="line")&&(c(N),e.setActiveTool({type:N}))},displayedOption:B7.find(N=>N.type===l)||B7[0]}),k&&g(qe,{className:ae({active:i.type==="text"}),type:"radio",icon:Fh,checked:i.type==="text",name:"editor-current-shape",title:`${Ht(x("toolBar.text"))}`,"aria-label":Ht(x("toolBar.text")),"data-testid":"toolbar-text",onChange:()=>m("text")}),w&&g(qe,{className:ae({active:i.type==="image"}),type:"radio",icon:Mb,checked:i.type==="image",name:"editor-current-shape",title:`${Ht(x("toolBar.image"))}`,"aria-label":Ht(x("toolBar.image")),"data-testid":"toolbar-image",onChange:()=>m("image")}),T&&g(qe,{className:ae({active:d}),type:"radio",icon:yu,checked:d,name:"editor-current-shape",title:`${Ht(x("toolBar.frame"))}`,"aria-label":Ht(x("toolBar.frame")),"data-testid":"toolbar-frame",onChange:()=>m("frame")}),P(Oe,{open:s,children:[g(Oe.Trigger,{className:ae("App-toolbar__extra-tools-trigger App-toolbar__extra-tools-trigger--mobile",{"App-toolbar__extra-tools-trigger--selected":S||s}),onToggle:()=>{r(!s),n({openMenu:null,openPopup:null})},title:x("toolBar.extraTools"),style:{width:b,height:b,display:"flex",alignItems:"center",justifyContent:"center"},children:D}),P(Oe.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",align:"start",children:[!k&&g(Oe.Item,{onSelect:()=>e.setActiveTool({type:"text"}),icon:Fh,shortcut:$.T.toLocaleUpperCase(),"data-testid":"toolbar-text",selected:i.type==="text",children:x("toolBar.text")}),!w&&g(Oe.Item,{onSelect:()=>e.setActiveTool({type:"image"}),icon:Mb,"data-testid":"toolbar-image",selected:i.type==="image",children:x("toolBar.image")}),!T&&g(Oe.Item,{onSelect:()=>e.setActiveTool({type:"frame"}),icon:yu,shortcut:$.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:x("toolBar.frame")}),g(Oe.Item,{onSelect:()=>e.setActiveTool({type:"embeddable"}),icon:g5,"data-testid":"toolbar-embeddable",selected:f,children:x("toolBar.embeddable")}),g(Oe.Item,{onSelect:()=>e.setActiveTool({type:"laser"}),icon:Z0,"data-testid":"toolbar-laser",selected:u,shortcut:$.K.toLocaleUpperCase(),children:x("toolBar.laser")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),e.props.aiEnabled!==!1&&g(h.Out,{}),g(Oe.Item,{onSelect:()=>e.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:JT,"data-testid":"toolbar-embeddable",children:x("toolBar.mermaidToExcalidraw")}),e.props.aiEnabled!==!1&&e.plugins.diagramToCode&&g(fe,{children:P(Oe.Item,{onSelect:()=>e.onMagicframeToolSelect(),icon:p5,"data-testid":"toolbar-magicframe",children:[x("toolBar.magicframe"),g(Oe.Item.Badge,{children:"AI"})]})})]})]})]})},nK=({children:e,side:t,className:n})=>g("div",{className:ae("FixedSideContainer",`FixedSideContainer_side_${t}`,n),children:e}),kwe="medium",iK=e=>e.penDetected?P("label",{className:ae("ToolIcon ToolIcon__penMode",`ToolIcon_size_${kwe}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:qhe})]}):null,Rwe=({appState:e,elements:t,actionManager:n,setAppState:i,onHandToolToggle:s,renderTopLeftUI:r,renderTopRightUI:o,renderSidebars:a,renderWelcomeScreen:l,UIOptions:c,app:d,onPenModeToggle:u})=>{var b;const{WelcomeScreenCenterTunnel:f,MainMenuTunnel:h,DefaultSidebarTriggerTunnel:m}=gs(),p=()=>{var _;if(((_=e.openDialog)==null?void 0:_.name)==="elementLinkSelector")return null;const y=P("div",{className:"excalidraw-ui-top-right",children:[(o==null?void 0:o(!0,e))??(!e.viewModeEnabled&&P(fe,{children:[g(iK,{checked:e.penMode,onChange:()=>u(null),title:x("toolBar.penMode"),isMobile:!0,penDetected:e.penDetected}),g(m.Out,{})]})),e.viewModeEnabled&&g(M_e,{actionManager:n})]}),E=P("div",{className:"excalidraw-ui-top-left",children:[r==null?void 0:r(!0,e),g(h.Out,{})]});return P("div",{className:"App-toolbar-content",style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[E,y]})},U=()=>g(Mwe,{app:d,onHandToolToggle:s,setAppState:i});return P(fe,{children:[a(),g("div",{className:"App-welcome-screen",children:l&&g(f.Out,{})}),!e.viewModeEnabled&&P("div",{className:"App-bottom-bar",style:{marginBottom:Xo+oc},children:[g(I_e,{appState:e,elementsMap:d.scene.getNonDeletedElementsMap(),renderAction:n.renderAction,app:d,setAppState:i}),P(fr,{className:"App-toolbar",children:[!e.viewModeEnabled&&((b=e.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&U(),e.scrolledOutside&&!e.openMenu&&!e.openSidebar&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(y=>({...K0(t,y)}))},children:x("buttons.scrollBackToContent")})]})]}),g(nK,{side:"top",className:"App-top-bar",children:p()})]})},QL=e=>{const t=C.useRef(null),[n,i]=C.useState(null);return C.useLayoutEffect(()=>{if(!e.spreadsheet)return;const s=C7e(e.chartType,e.spreadsheet,0,0);i(s);let r;const o=t.current;return(async()=>{var a;r=await YI(s,{exportBackground:!1,viewBackgroundColor:"#fff"},null,{skipInliningFonts:!0}),(a=r.querySelector(".style-fonts"))==null||a.remove(),o.replaceChildren(),o.appendChild(r),e.selected&&o.parentNode.focus()})(),()=>{o.replaceChildren()}},[e.spreadsheet,e.chartType,e.selected]),g("button",{type:"button",className:"ChartPreview",onClick:()=>{n&&e.onClick(e.chartType,n)},children:g("div",{ref:t})})},Dwe=({setAppState:e,appState:t,onClose:n})=>{const{onInsertElements:i}=Ir(),s=de.useCallback(()=>{n&&n()},[n]),r=(o,a)=>{i(a),at("paste","chart",o),e({currentChartType:o,pasteDialog:{shown:!1,data:null}})};return g(Tr,{size:"small",onCloseRequest:s,title:x("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:P("div",{className:"container",children:[g(QL,{chartType:"bar",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="bar",onClick:r}),g(QL,{chartType:"line",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="line",onClick:r})]})})},H_=({heading:e,children:t,...n})=>{const{id:i}=Ws(),s=g("h2",{className:"visually-hidden",id:`${i}-${e}-title`,children:x(`headings.${e}`)});return g("section",{...n,"aria-labelledby":`${i}-${e}-title`,children:typeof t=="function"?t(s):P(fe,{children:[s,t]})})},Lwe=4,Pwe=8,Nwe=({shouldWrap:e,children:t,username:n})=>e?g(Nl,{label:n||"Unknown user",children:t}):g(fe,{children:t}),z7=({actionManager:e,collaborator:t,socketId:n,withName:i=!1,shouldWrapWithTooltip:s=!1,isBeingFollowed:r})=>{const o={socketId:n,collaborator:t,withName:i,isBeingFollowed:r},a=e.renderAction("goToCollaborator",o);return g(Nwe,{username:t.username,shouldWrap:s,children:a},n)},Owe=["avatarUrl","id","socketId","username","isInCall","isSpeaking","isMuted"],sK=de.memo(({className:e,mobile:t,collaborators:n,userToFollow:i})=>{const s=Ei(),r=new Map;n.forEach((p,U)=>{const b=p.id||U;r.set(b,{...p,socketId:U})});const o=Array.from(r.values()).filter(p=>{var U;return(U=p.username)==null?void 0:U.trim()}),[a,l]=de.useState(""),c=o.filter(p=>{var U;return(U=p.username)==null?void 0:U.toLowerCase().includes(a)}),d=de.useRef(null);C.useLayoutEffect(()=>{if(d.current){const p=b=>{const y=Math.max(1,Math.min(8,Math.floor(b/38)));f(y)};if(p(d.current.clientWidth),!cz)return;const U=new ResizeObserver(b=>{for(const y of b){const{width:E}=y.contentRect;p(E)}});return U.observe(d.current),()=>{U.disconnect()}}},[]);const[u,f]=de.useState(Lwe),m=o.slice(0,u-1).map(p=>z7({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}));return t?g("div",{className:ae("UserList UserList_mobile",e),children:o.map(p=>z7({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}))}):g("div",{className:"UserList__wrapper",ref:d,children:P("div",{className:ae("UserList",e),style:{"--max-avatars":u},children:[m,o.length>u-1&&P(Gl,{children:[P(Xl,{className:"UserList__more",children:["+",o.length-u+1]}),g(EE,{style:{zIndex:2,width:"15rem",textAlign:"left"},align:"end",sideOffset:10,children:P(fr,{padding:2,children:[o.length>=Pwe&&g(Sj,{placeholder:x("quickSearch.placeholder"),onChange:l}),g(Cj,{className:"dropdown-menu UserList__collaborators",placeholder:x("userList.empty"),children:c.length>0?[g("div",{className:"hint",children:x("userList.hint.text")}),c.map(p=>z7({actionManager:s,collaborator:p,socketId:p.socketId,withName:!0,isBeingFollowed:p.socketId===i}))]:[]}),g(aj,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})]})]})})},(e,t)=>{if(e.collaborators.size!==t.collaborators.size||e.mobile!==t.mobile||e.className!==t.className||e.userToFollow!==t.userToFollow)return!1;const n=t.collaborators.keys();for(const[i,s]of e.collaborators){const r=t.collaborators.get(i);if(!r||i!==n.next().value||!ki(s,r,Owe))return!1}return!0}),Fwe=e=>g("button",{className:"help-icon",onClick:e.onClick,type:"button",title:`${x("helpDialog.title")}  ?`,"aria-label":x("helpDialog.title"),children:WT}),rK=({appState:e,actionManager:t,showExitZenModeBtn:n,renderWelcomeScreen:i})=>{const{FooterCenterTunnel:s,WelcomeScreenHelpHintTunnel:r}=gs();return P("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[g("div",{className:ae("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled}),children:g(oa.Col,{gap:2,children:P(H_,{heading:"canvasActions",children:[g(C_e,{renderAction:t.renderAction,zoom:e.zoom}),!e.viewModeEnabled&&g(x_e,{renderAction:t.renderAction,className:ae("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":e.zenModeEnabled})})]})})}),g(s.Out,{}),g("div",{className:ae("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:P("div",{style:{position:"relative"},children:[i&&g(r.Out,{}),g(Fwe,{onClick:()=>t.executeAction(JI)})]})}),g(A_e,{actionManager:t,showExitZenModeBtn:n})]})};rK.displayName="Footer";const oK=de.createContext({}),aK=({children:e,className:t})=>{const n=Nn(),i=C.useContext(oK),s=!!(n.canFitSidebar&&i.shouldRenderDockButton);return P("div",{className:ae("sidebar__header",t),"data-testid":"sidebar-header",children:[e,P("div",{className:"sidebar__header__buttons",children:[s&&g(Nl,{label:x("labels.sidebarLock"),children:g(gd,{onSelect:()=>{var r;return(r=i.onDock)==null?void 0:r.call(i,!i.docked)},selected:!!i.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":x("labels.sidebarLock"),children:jhe})}),g(gd,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:i.onCloseRequest,"aria-label":x("buttons.close"),children:lf})]})]})};aK.displayName="SidebarHeader";const lK=({children:e,tab:t,onSelect:n,...i})=>g(Ej,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...i,children:e})});lK.displayName="SidebarTabTrigger";const cK=({children:e,...t})=>g(yj,{className:"sidebar-triggers",...t,children:e});cK.displayName="SidebarTabTriggers";const dK=({name:e,tab:t,icon:n,title:i,children:s,onToggle:r,className:o,style:a})=>{var d;const l=On(),c=Qt();return P("label",{title:i,className:"sidebar-trigger__label-element",children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:u=>{var h;(h=document.querySelector(".layer-ui__wrapper"))==null||h.classList.remove("animate");const f=u.target.checked;l({openSidebar:f?{name:e,tab:t}:null,openMenu:null,openPopup:null}),r==null||r(f)},checked:((d=c.openSidebar)==null?void 0:d.name)===e,"aria-label":i,"aria-keyshortcuts":"0"}),P("div",{className:ae("sidebar-trigger",o),style:a,children:[n&&g("div",{children:n}),s&&g("div",{className:"sidebar-trigger__label",children:s})]})]})};dK.displayName="SidebarTrigger";const uK=({children:e,...t})=>{const n=Qt(),i=On();if(!n.openSidebar)return null;const{name:s}=n.openSidebar;return g(bj,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:r=>i(o=>({...o,openSidebar:{...o.openSidebar,name:s,tab:r}})),...t,children:e})};uK.displayName="SidebarTabs";const fK=({tab:e,children:t,...n})=>g(vj,{...n,value:e,"data-testid":e,children:t});fK.displayName="SidebarTab";const aS=Nt(!1),hK=C.forwardRef(({name:e,children:t,onDock:n,docked:i,className:s,...r},o)=>{const a=On(),l=d2(aS);C.useLayoutEffect(()=>(l(!!i),()=>{l(!1)}),[l,i]);const c=C.useRef({});c.current.onCloseRequest=()=>{a({openSidebar:null})},c.current.onDock=h=>n==null?void 0:n(h),c.current=yb(c.current,{docked:i,shouldRenderDockButton:!!n&&i!=null});const d=C.useRef(null);C.useImperativeHandle(o,()=>d.current);const u=Nn(),f=C.useCallback(()=>{document.querySelector(".Dialog")||a({openSidebar:null})},[a]);return MI(d,C.useCallback(h=>{h.target.closest(".sidebar-trigger")||(!i||!u.canFitSidebar)&&f()},[f,i,u.canFitSidebar])),C.useEffect(()=>{const h=m=>{m.key===$.ESCAPE&&(!i||!u.canFitSidebar)&&f()};return document.addEventListener(te.KEYDOWN,h),()=>{document.removeEventListener(te.KEYDOWN,h)}},[f,i,u.canFitSidebar]),g(fr,{...r,className:ae(Wi.SIDEBAR,{"sidebar--docked":i},s),ref:d,children:g(oK.Provider,{value:c.current,children:t})})});hK.displayName="SidebarInner";const Ns=Object.assign(C.forwardRef((e,t)=>{var l;const n=Qt(),{onStateChange:i}=e,s=C.useRef(n.openSidebar);C.useEffect(()=>{var c,d,u,f,h;(!n.openSidebar&&((c=s==null?void 0:s.current)==null?void 0:c.name)===e.name||((d=n.openSidebar)==null?void 0:d.name)===e.name&&((u=s==null?void 0:s.current)==null?void 0:u.name)!==e.name||((f=s.current)==null?void 0:f.name)===e.name)&&n.openSidebar!==s.current&&(i==null||i(((h=n.openSidebar)==null?void 0:h.name)!==e.name?null:n.openSidebar)),s.current=n.openSidebar},[n.openSidebar,i,e.name]);const[r,o]=C.useState(!1);return C.useLayoutEffect(()=>(o(!0),()=>o(!1)),[]),r&&((l=n.openSidebar)==null?void 0:l.name)===e.name?C.createElement(hK,{...e,ref:t,key:e.name}):null}),{Header:aK,TabTriggers:cK,TabTrigger:lK,Tabs:uK,Tab:fK,Trigger:dK});Ns.displayName="Sidebar";const T2=(e,t)=>{const n=Nt(0),i=s=>{const{tunnelsJotai:{useAtom:r}}=gs(),[,o]=r(n),a=C.useRef({preferHost:!1,counter:0});return C.useLayoutEffect(()=>{const l=a.current;return o(c=>{const d=c+1;return l.counter=d,d}),()=>{o(c=>{const d=c-1;return l.counter=d,d||(l.preferHost=!1),d})}},[o]),s.__fallback||(a.current.preferHost=!0),!a.current.counter&&s.__fallback&&a.current.preferHost||a.current.counter>1&&s.__fallback?null:g(t,{...s})};return i.displayName=e,i},gK=Nt({active:!1});async function V_({title:e,description:t,actionLabel:n,color:i}){return new Promise(s=>{ar.set(gK,{active:!0,onConfirm:()=>s(!0),onClose:()=>s(!1),onReject:()=>s(!1),title:e,description:t,actionLabel:n,color:i})})}const mK=function({onChange:e,value:t,choices:n,name:i}){return g("div",{className:"RadioGroup",children:n.map(s=>P("div",{className:ae("RadioGroup__choice",{active:s.value===t}),title:s.ariaLabel,children:[g("input",{name:i,type:"radio",checked:s.value===t,onChange:()=>e(s.value),"aria-label":s.ariaLabel}),s.label]},String(s.value)))})},pK=({value:e,shortcut:t,onChange:n,choices:i,children:s,name:r})=>{const o=Nn();return P(fe,{children:[P("div",{className:"dropdown-menu-item-base dropdown-menu-item-bare",children:[g("label",{className:"dropdown-menu-item__text",children:s}),g(mK,{name:r,value:e,onChange:n,choices:i})]}),t&&o.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut dropdown-menu-item__shortcut--orphaned",children:t})]})};pK.displayName="DropdownMenuItemContentRadio";const UK=()=>{const{t:e}=Ft(),t=Ei(),n=n8();return t.isActionEnabled(M_)?g(Ys,{icon:ZT,onSelect:async()=>{(!n.length||await V_({title:e("overwriteConfirm.modal.loadFromFile.title"),actionLabel:e("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:g(Hs,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:s=>g("strong",{children:s}),br:()=>g("br",{})})}))&&t.executeAction(M_)},"data-testid":"load-button",shortcut:Ln("loadScene"),"aria-label":e("buttons.load"),children:e("buttons.load")}):null};UK.displayName="LoadScene";const bK=()=>{const{t:e}=Ft(),t=Ei();return t.isActionEnabled(L5)?g(Ys,{shortcut:Ln("saveScene"),"data-testid":"save-button",onSelect:()=>t.executeAction(L5),icon:nge,"aria-label":`${e("buttons.save")}`,children:`${e("buttons.save")}`}):null};bK.displayName="SaveToActiveFile";const yK=()=>{const e=On(),{t}=Ft();return g(Ys,{icon:lG,"data-testid":"image-export-button",onSelect:()=>e({openDialog:{name:"imageExport"}}),shortcut:Ln("imageExport"),"aria-label":t("buttons.exportImage"),children:t("buttons.exportImage")})};yK.displayName="SaveAsImage";const EK=e=>{const t=On(),{t:n}=Ft();return g(Ys,{icon:h_,"data-testid":"command-palette-button",onSelect:()=>{at("command_palette","open","menu"),t({openDialog:{name:"commandPalette"}})},shortcut:Ln("commandPalette"),"aria-label":n("commandPalette.title"),className:e==null?void 0:e.className,children:n("commandPalette.title")})};EK.displayName="CommandPalette";const vK=e=>{const{t}=Ft(),n=Ei();return g(Ys,{icon:Fu,"data-testid":"search-menu-button",onSelect:()=>{n.executeAction(KW)},shortcut:Ln("searchMenu"),"aria-label":t("search.title"),className:e==null?void 0:e.className,children:t("search.title")})};vK.displayName="SearchMenu";const _K=()=>{const{t:e}=Ft(),t=Ei();return g(Ys,{"data-testid":"help-menu-item",icon:WT,onSelect:()=>t.executeAction(JI),shortcut:"?","aria-label":e("helpDialog.title"),children:e("helpDialog.title")})};_K.displayName="Help";const wK=()=>{const{t:e}=Ft(),t=d2(QE);return Ei().isActionEnabled(r0)?g(Ys,{icon:Ia,onSelect:()=>t("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":e("buttons.clearReset"),children:e("buttons.clearReset")}):null};wK.displayName="ClearCanvas";const TK=e=>{const{t}=Ft(),n=Qt(),i=Ei(),s=Ln("toggleTheme");return i.isActionEnabled(T5)?e!=null&&e.allowSystemTheme?g(pK,{name:"theme",value:e.theme,onChange:r=>e.onSelect(r),choices:[{value:be.LIGHT,label:c_,ariaLabel:`${t("buttons.lightMode")} - ${s}`},{value:be.DARK,label:l_,ariaLabel:`${t("buttons.darkMode")} - ${s}`},{value:"system",label:_me,ariaLabel:t("buttons.systemMode")}],children:t("labels.theme")}):g(Ys,{onSelect:r=>{if(r.preventDefault(),e!=null&&e.onSelect)e.onSelect(n.theme===be.DARK?be.LIGHT:be.DARK);else return i.executeAction(T5)},icon:n.theme===be.DARK?c_:l_,"data-testid":"toggle-dark-mode",shortcut:s,"aria-label":n.theme===be.DARK?t("buttons.lightMode"):t("buttons.darkMode"),children:n.theme===be.DARK?t("buttons.lightMode"):t("buttons.darkMode")}):null};TK.displayName="ToggleTheme";const IK=()=>{const{t:e}=Ft(),t=Qt(),n=Ei(),i=I2();return t.viewModeEnabled||!i.UIOptions.canvasActions.changeViewBackgroundColor?null:P("div",{style:{marginTop:"0.75rem"},children:[g("div",{"data-testid":"canvas-background-label",style:{fontSize:"0.875rem",marginBottom:"0.25rem",marginLeft:"0.5rem"},children:e("labels.canvasBackground")}),g("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})};IK.displayName="ChangeCanvasBackground";const SK=()=>{const{t:e}=Ft(),t=On();return g(Ys,{icon:aE,onSelect:()=>{t({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":e("buttons.export"),children:e("buttons.export")})};SK.displayName="Export";const CK=()=>{const{t:e}=Ft();return P(fe,{children:[g(f0,{icon:KT,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),g(f0,{icon:oG,href:"https://x.com/excalidraw","aria-label":"X",children:e("labels.followUs")}),g(f0,{icon:rG,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:e("labels.discordChat")})]})};CK.displayName="Socials";const xK=({onSelect:e,isCollaborating:t})=>{const{t:n}=Ft();return g(Ys,{"data-testid":"collab-button",icon:QT,className:ae({"active-collab":t}),onSelect:e,children:n("labels.liveCollaboration")})};xK.displayName="LiveCollaborationTrigger";const AK=()=>{const{t:e}=Ft(),t=Ir(),n=Qt();return g(mf,{checked:n.activeTool.locked,shortcut:Ln("toolLock"),onSelect:i=>{t.toggleLock(),i.preventDefault()},children:e("labels.preferences_toolLock")})},MK=()=>{const{t:e}=Ft(),t=Ei(),n=Qt();return g(mf,{checked:n.objectsSnapModeEnabled,shortcut:Ln("objectsSnapMode"),onSelect:i=>{t.executeAction(dW),i.preventDefault()},children:e("buttons.objectsSnapMode")})},lS=()=>{const{t:e}=Ft(),t=Ei(),n=Qt();return g(mf,{checked:n.gridModeEnabled,shortcut:Ln("gridMode"),onSelect:i=>{t.executeAction(k_),i.preventDefault()},children:e("labels.toggleGrid")})},cS=()=>{const{t:e}=Ft(),t=Ei(),n=Qt();return g(mf,{checked:n.zenModeEnabled,shortcut:Ln("zenMode"),onSelect:i=>{t.executeAction(P5),i.preventDefault()},children:e("buttons.zenMode")})},kK=()=>{const{t:e}=Ft(),t=Ei(),n=Qt();return g(mf,{checked:n.viewModeEnabled,shortcut:Ln("viewMode"),onSelect:i=>{t.executeAction(B5),i.preventDefault()},children:e("labels.viewMode")})},RK=()=>{const{t:e}=Ft(),t=Ei(),n=Qt();return g(mf,{checked:n.stats.open,shortcut:Ln("stats"),onSelect:i=>{t.executeAction(N5),i.preventDefault()},children:e("stats.fullTitle")})},Rd=({children:e,additionalItems:t})=>{const{t:n}=Ft();return P(Yc,{children:[g(Yc.Trigger,{icon:Pme,children:n("labels.preferences")}),P(Yc.Content,{className:"excalidraw-main-menu-preferences-submenu",children:[e||P(fe,{children:[g(AK,{}),g(MK,{}),g(lS,{}),g(cS,{}),g(kK,{}),g(RK,{})]}),t]})]})};Rd.ToggleToolLock=AK;Rd.ToggleSnapMode=MK;Rd.ToggleGridMode=lS;Rd.ToggleZenMode=cS;Rd.ToggleViewMode=kK;Rd.ToggleElementProperties=RK;Rd.displayName="Preferences";const Bwe=Object.freeze(Object.defineProperty({__proto__:null,ChangeCanvasBackground:IK,ClearCanvas:wK,CommandPalette:EK,Export:SK,Help:_K,LiveCollaborationTrigger:xK,LoadScene:UK,Preferences:Rd,PreferencesToggleGridModeItem:lS,PreferencesToggleZenModeItem:cS,SaveAsImage:yK,SaveToActiveFile:bK,SearchMenu:vK,Socials:CK,ToggleTheme:TK},Symbol.toStringTag,{value:"Module"})),Ct=Object.assign(T2("MainMenu",({children:e,onSelect:t})=>{var o;const{MainMenuTunnel:n}=gs(),i=Nn(),s=Qt(),r=On();return g(n.In,{children:P(Oe,{open:s.openMenu==="canvas",children:[g(Oe.Trigger,{onToggle:()=>{r({openMenu:s.openMenu==="canvas"?null:"canvas",openPopup:null,openDialog:null})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:ege}),P(Oe.Content,{onClickOutside:()=>r({openMenu:null}),onSelect:By(t,()=>{r({openMenu:null})}),className:"main-menu",align:"start",children:[e,i.formFactor==="phone"&&s.collaborators.size>0&&P("fieldset",{className:"UserList-Wrapper",children:[g("legend",{children:x("labels.collaborators")}),g(sK,{mobile:!0,collaborators:s.collaborators,userToFollow:((o=s.userToFollow)==null?void 0:o.socketId)||null})]})]})]})})}),{Trigger:Oe.Trigger,Item:Oe.Item,ItemLink:Oe.ItemLink,ItemCustom:Oe.ItemCustom,Group:Oe.Group,Separator:Oe.Separator,Sub:Yc,DefaultItems:Bwe}),$s=C.forwardRef(({children:e,icon:t,onClick:n,label:i,variant:s="filled",color:r="primary",size:o="medium",fullWidth:a,className:l,status:c,disabled:d},u)=>{const[f,h]=C.useState(!1),m=async U=>{const b=n==null?void 0:n(U);if(Wp(b)){const y=window.setTimeout(()=>{h(!0)},50);try{await b}catch(E){if(E instanceof yg)console.warn(E);else throw E}finally{clearTimeout(y),h(!1)}}},p=f?"loading":c;return r=p==="success"?"success":r,g("button",{className:ae("ExcButton",`ExcButton--color-${r}`,`ExcButton--variant-${s}`,`ExcButton--size-${o}`,`ExcButton--status-${p}`,{"ExcButton--fullWidth":a},l),onClick:m,type:"button","aria-label":i,ref:u,disabled:d||p==="loading"||p==="success",children:P("div",{className:"ExcButton__contents",children:[p==="loading"?g(Sa,{className:"ExcButton__statusIcon"}):p==="success"&&g("div",{className:"ExcButton__statusIcon",children:nme}),t&&g("div",{className:"ExcButton__icon","aria-hidden":!0,children:t}),s!=="icon"&&(e??i)]})})}),dS=({title:e,children:t,actionLabel:n,onClick:i})=>P("div",{className:"OverwriteConfirm__Actions__Action",children:[g("h4",{children:e}),g("div",{className:"OverwriteConfirm__Actions__Action__content",children:t}),g($s,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:i})]}),zwe=()=>{const{t:e}=Ft(),t=Ei(),n=On();return g(dS,{title:e("overwriteConfirm.action.exportToImage.title"),actionLabel:e("overwriteConfirm.action.exportToImage.button"),onClick:()=>{t.executeAction(iW,"ui",!0),n({openDialog:{name:"imageExport"}})},children:e("overwriteConfirm.action.exportToImage.description")})},Hwe=()=>{const{t:e}=Ft(),t=Ei();return g(dS,{title:e("overwriteConfirm.action.saveToDisk.title"),actionLabel:e("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{t.executeAction(sW,"ui")},children:e("overwriteConfirm.action.saveToDisk.description")})},JL=Object.assign(({children:e})=>g("div",{className:"OverwriteConfirm__Actions",children:e}),{ExportToImage:zwe,SaveToDisk:Hwe}),lu=Object.assign(T2("OverwriteConfirmDialog",({children:e})=>{const{OverwriteConfirmDialogTunnel:t}=gs(),[n,i]=dt(gK);if(!n.active)return null;const s=()=>{n.onClose(),i(o=>({...o,active:!1}))},r=()=>{n.onConfirm(),i(o=>({...o,active:!1}))};return g(t.In,{children:g(Tr,{onCloseRequest:s,title:!1,size:916,children:P("div",{className:"OverwriteConfirm",children:[g("h3",{children:n.title}),P("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[g("div",{className:"OverwriteConfirm__Description__icon",children:pG}),g("div",{children:n.description}),g("div",{className:"OverwriteConfirm__Description__spacer"}),g($s,{color:n.color,size:"large",label:n.actionLabel,onClick:r})]}),g(JL,{children:e})]})})})}),{Actions:JL,Action:dS});var Vwe="Expected a function",eP=NaN,$we="[object Symbol]",Gwe=/^\s+|\s+$/g,Xwe=/^[-+]0x[0-9a-f]+$/i,jwe=/^0b[01]+$/i,Ywe=/^0o[0-7]+$/i,Wwe=parseInt,Kwe=typeof ll=="object"&&ll&&ll.Object===Object&&ll,Zwe=typeof self=="object"&&self&&self.Object===Object&&self,qwe=Kwe||Zwe||Function("return this")(),Qwe=Object.prototype,Jwe=Qwe.toString,e9e=Math.max,t9e=Math.min,H7=function(){return qwe.Date.now()};function n9e(e,t,n){var i,s,r,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(Vwe);t=tP(t)||0,$_(n)&&(d=!!n.leading,u="maxWait"in n,r=u?e9e(tP(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(k){var w=i,T=s;return i=s=void 0,c=k,o=e.apply(T,w),o}function m(k){return c=k,a=setTimeout(b,t),d?h(k):o}function p(k){var w=k-l,T=k-c,A=t-w;return u?t9e(A,r-T):A}function U(k){var w=k-l,T=k-c;return l===void 0||w>=t||w<0||u&&T>=r}function b(){var k=H7();if(U(k))return y(k);a=setTimeout(b,p(k))}function y(k){return a=void 0,f&&i?h(k):(i=s=void 0,o)}function E(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function _(){return a===void 0?o:y(H7())}function I(){var k=H7(),w=U(k);if(i=arguments,s=this,l=k,w){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=E,I.flush=_,I}function $_(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function i9e(e){return!!e&&typeof e=="object"}function s9e(e){return typeof e=="symbol"||i9e(e)&&Jwe.call(e)==$we}function tP(e){if(typeof e=="number")return e;if(s9e(e))return eP;if($_(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=$_(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Gwe,"");var n=jwe.test(e);return n||Ywe.test(e)?Wwe(e.slice(2),n?2:8):Xwe.test(e)?eP:+e}var r9e=n9e;const o9e=Hl(r9e),a9e=Nt(""),DK=Nt(null),l9e=350,c9e=()=>{const e=Ir(),t=On(),n=C.useRef(null),[i,s]=dt(a9e),r=i.trim(),[o,a]=C.useState(!1),[l,c]=C.useState({nonce:null,items:[]}),d=C.useRef(null),u=C.useRef(void 0),[f,h]=dt(DK),m=e.scene.getNonDeletedElementsMap();C.useEffect(()=>{o||(r!==d.current||e.scene.getSceneNonce()!==u.current)&&(d.current=null,sP(r,e,(E,_)=>{c({nonce:to(),items:E}),d.current=r,u.current=e.scene.getSceneNonce(),t({searchMatches:E.length?{focusedId:null,matches:E.map(I=>({id:I.element.id,focus:!1,matchedLines:I.matchedLines}))}:null})}))},[o,r,m,e,t,h,u]);const p=()=>{l.items.length>0&&h(E=>E===null?0:(E+1)%l.items.length)},U=()=>{l.items.length>0&&h(E=>E===null?0:E-1<0?l.items.length-1:E-1)};C.useEffect(()=>{t(E=>{var I,k;return E.searchMatches?{searchMatches:{focusedId:f!==null&&((k=(I=E.searchMatches)==null?void 0:I.matches[f])==null?void 0:k.id)||null,matches:E.searchMatches.matches.map((w,T)=>T===f?{...w,focus:!0}:{...w,focus:!1})}}:null})},[f,t]),C.useEffect(()=>{var E,_,I,k;if(l.items.length>0&&f!==null){const w=l.items[f];if(w){const T=e.state.zoom.value,A=_r({text:w.searchQuery,x:w.element.x+(((E=w.matchedLines[0])==null?void 0:E.offsetX)??0),y:w.element.y+(((_=w.matchedLines[0])==null?void 0:_.offsetY)??0),width:(I=w.matchedLines[0])==null?void 0:I.width,height:(k=w.matchedLines[0])==null?void 0:k.height,fontSize:_e(w.element)?rt.nameFontSize:w.element.fontSize,fontFamily:_e(w.element)?ct.Assistant:w.element.fontFamily}),S=14,D=A.fontSize,N=D*T<S;if(!Cb([A],e.canvas.width/window.devicePixelRatio,e.canvas.height/window.devicePixelRatio,{offsetLeft:e.state.offsetLeft,offsetTop:e.state.offsetTop,scrollX:e.state.scrollX,scrollY:e.state.scrollY,zoom:e.state.zoom},e.scene.getNonDeletedElementsMap(),e.getEditorUIOffsets())||N){let L;N?D>=S?L={fitToContent:!0}:L={fitToViewport:!0,maxZoom:Ul(S/D,1)}:L={fitToContent:!0},e.scrollToContent(A,{animate:!0,duration:300,...L,canvasOffsets:e.getEditorUIOffsets()})}}}},[f,l,e]),C.useEffect(()=>()=>{h(null),d.current=null,u.current=void 0,t({searchMatches:null}),a(!1)},[t,h]);const b=_E({goToNextItem:p,goToPreviousItem:U,searchMatches:l});C.useEffect(()=>{const E=_=>{var I,k,w;if(_.key===$.ESCAPE&&!e.state.openDialog&&!e.state.openPopup){_.preventDefault(),_.stopPropagation(),t({openSidebar:null});return}if(_[$.CTRL_OR_CMD]&&_.key===$.F){if(_.preventDefault(),_.stopPropagation(),e.state.openDialog)return;(I=n.current)!=null&&I.matches(":focus")||(e.state.openDialog&&t({openDialog:null}),(k=n.current)==null||k.focus(),(w=n.current)==null||w.select())}_.target instanceof HTMLElement&&_.target.closest(".layer-ui__search")&&b.searchMatches.items.length&&(_.key===$.ENTER&&(_.stopPropagation(),b.goToNextItem()),_.key===$.ARROW_UP?(_.stopPropagation(),b.goToPreviousItem()):_.key===$.ARROW_DOWN&&(_.stopPropagation(),b.goToNextItem()))};return an(window,te.KEYDOWN,E,{capture:!0,passive:!1})},[t,b,e]);const y=`${l.items.length} ${l.items.length===1?x("search.singleResult"):x("search.multipleResults")}`;return P("div",{className:"layer-ui__search",children:[g("div",{className:"layer-ui__search-header",children:g(Xu,{className:Wi.SEARCH_MENU_INPUT_WRAPPER,value:i,ref:n,placeholder:x("search.placeholder"),icon:Fu,onChange:E=>{s(E),a(!0);const _=E.trim();sP(_,e,(I,k)=>{c({nonce:to(),items:I}),h(k),d.current=_,u.current=e.scene.getSceneNonce(),t({searchMatches:I.length?{focusedId:null,matches:I.map(w=>({id:w.element.id,focus:!1,matchedLines:w.matchedLines}))}:null}),a(!1)})},selectOnRender:!0})}),P("div",{className:"layer-ui__search-count",children:[l.items.length>0&&P(fe,{children:[f!==null&&f>-1?P("div",{children:[f+1," / ",y]}):g("div",{children:y}),P("div",{className:"result-nav",children:[g(gd,{onSelect:()=>{p()},className:"result-nav-btn",children:EG}),g(gd,{onSelect:()=>{U()},className:"result-nav-btn",children:Sme})]})]}),l.items.length===0&&r&&d.current&&g("div",{style:{margin:"1rem auto"},children:x("search.noMatch")})]}),g(f9e,{matches:l,onItemClick:h,focusIndex:f,searchQuery:r})]})},nP=e=>{const t=[e.preview.moreBefore?"...":"",e.preview.previewText.slice(0,e.preview.indexInSearchQuery),e.preview.previewText.slice(e.preview.indexInSearchQuery,e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.previewText.slice(e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.moreAfter?"...":""];return g("div",{tabIndex:-1,className:ae("layer-ui__result-item",{active:e.highlighted}),onClick:e.onClick,ref:n=>{e.highlighted&&(n==null||n.scrollIntoView({behavior:"auto",block:"nearest"}))},children:g("div",{className:"preview-text",children:t.flatMap((n,i)=>g(C.Fragment,{children:i===2?g("b",{children:n}):n},i))})})},d9e=e=>{const t=C.useMemo(()=>e.matches.items.filter(i=>_e(i.element)),[e.matches]),n=C.useMemo(()=>e.matches.items.filter(i=>he(i.element)),[e.matches]);return P("div",{children:[t.length>0&&P("div",{className:"layer-ui__search-result-container",children:[P("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:yu}),g("div",{children:x("search.frames")})]}),t.map((i,s)=>g(nP,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s===e.focusIndex,onClick:()=>e.onItemClick(s)},i.element.id+i.index)),n.length>0&&g("div",{className:"layer-ui__divider"})]}),n.length>0&&P("div",{className:"layer-ui__search-result-container",children:[P("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:Fh}),g("div",{children:x("search.texts")})]}),n.map((i,s)=>g(nP,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s+t.length===e.focusIndex,onClick:()=>e.onItemClick(s+t.length)},i.element.id+i.index))]})]})},u9e=(e,t)=>e.matches.nonce===t.matches.nonce&&e.focusIndex===t.focusIndex,f9e=C.memo(d9e,u9e),iP=(e,t,n)=>{const r=e.slice(0,t),o=r.split(/\s+/),a=r.endsWith(" "),l=o.length-2-1-(a?0:1);let c=o.slice(l<=0?0:l).join(" ")+(a?" ":"");c=c.length>20?c.slice(-20):c;const u=e.slice(t+n.length),f=u.split(/\s+/),h=!u.startsWith(" "),m=h?6:5,p=(h?"":" ")+f.slice(0,m).join(" ");return{indexInSearchQuery:c.length,previewText:c+n+p,moreBefore:l>0,moreAfter:f.length>m}},h9e=(e,t)=>{const n=e.split(`
`),i=[];let s=0;for(let r=0;r<n.length;r++){let o=n[r];const a=n[r+1];if(a){const l=t.indexOf(a,s);if(l>o.length+s){let c=l-(o.length+s);for(;c>0;)o+=" ",c--}}i.push(o),s=s+o.length}return i.join(`
`)},g9e=(e,t,n)=>{const s=h9e(e.text,e.originalText).split(`
`),r=[];let o=0,a=0;for(const u of s){const f=o,h=f+u.length-1;r.push({line:u,startIndex:f,endIndex:h,lineNumber:a}),o=h+1,a++}let l=n,c=e.originalText.slice(n,n+t.length);const d=[];for(const u of r){if(c==="")break;if(l>=u.startIndex&&l<=u.endIndex){const f=u.endIndex+1-l,h=u.line.slice(0,l-u.startIndex),m=c.slice(0,f);c=c.slice(f);const p=ri(h,_t(e),e.lineHeight);if(h===""&&(p.width=0),e.textAlign!=="left"&&u.line.length>0){const _=ri(u.line,_t(e),e.lineHeight),I=e.textAlign==="center"?(e.width-_.width)/2:e.width-_.width;p.width+=I}const{width:U,height:b}=ri(m,_t(e),e.lineHeight),y=p.width,E=u.lineNumber*p.height;d.push({offsetX:y,offsetY:E,width:U,height:b,showOnCanvas:!0}),l+=f}}return d},m9e=(e,t,n,i)=>{const s=e.name??TT(e),r=s.slice(n,n+t.length),o=s.slice(0,n),a=_t({fontSize:rt.nameFontSize,fontFamily:ct.Assistant}),l=id(ct.Assistant),c=ri(o,a,l);o===""&&(c.width=0);const d=ri(r,a,l),u=c.width,f=-c.height-rt.strokeWidth,h=d.width;return[{offsetX:u,offsetY:f,width:h,height:d.height,showOnCanvas:u+h<=e.width*i}]},p9e=e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&"),sP=o9e((e,t,n)=>{if(!e||e===""){n([],null);return}const i=t.scene.getNonDeletedElements(),s=i.filter(f=>he(f)),r=i.filter(f=>_e(f));s.sort((f,h)=>f.y-h.y),r.sort((f,h)=>f.y-h.y);const o=[],a=new RegExp(p9e(e),"gi");for(const f of s){let h=null;const m=f.originalText;for(;(h=a.exec(m))!==null;){const p=iP(m,h.index,e),U=g9e(f,e,h.index);U.length>0&&o.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const l=[];for(const f of r){let h=null;const m=f.name??TT(f);for(;(h=a.exec(m))!==null;){const p=iP(m,h.index,e),U=m9e(f,e,h.index,t.state.zoom.value);U.length>0&&l.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const c=new Set(t.visibleElements.map(f=>f.id)),d=[...l,...o],u=d.findIndex(f=>c.has(f.element.id))??null;n(d,u)},l9e),LK=T2("DefaultSidebarTrigger",e=>{const{DefaultSidebarTriggerTunnel:t}=gs();return g(t.In,{children:g(Ns.Trigger,{...e,className:"default-sidebar-trigger",name:Yr.name})})});LK.displayName="DefaultSidebarTrigger";const PK=({children:e})=>{const{DefaultSidebarTabTriggersTunnel:t}=gs();return g(t.In,{children:e})};PK.displayName="DefaultTabTriggers";const X5=Object.assign(T2("DefaultSidebar",({children:e,className:t,onDock:n,docked:i,...s})=>{var c;const r=Qt(),o=On(),{DefaultSidebarTabTriggersTunnel:a}=gs(),l=((c=r.openSidebar)==null?void 0:c.tab)===pu;return C.createElement(Ns,{...s,name:"default",key:"default",className:ae("default-sidebar",t),docked:l||(i??r.defaultSidebarDockedPreference),onDock:l||n===!1||!n&&i!=null?void 0:By(n,d=>{o({defaultSidebarDockedPreference:d})})},P(Ns.Tabs,{children:[g(Ns.Header,{children:P(Ns.TabTriggers,{children:[g(Ns.TabTrigger,{tab:pu,children:Fu}),g(Ns.TabTrigger,{tab:O6,children:nG}),g(a.Out,{})]})}),g(Ns.Tab,{tab:O6,children:g($4e,{})}),g(Ns.Tab,{tab:pu,children:g(c9e,{})}),e]}))}),{Trigger:LK,TabTriggers:PK}),U9e=({input:e,placeholder:t,onChange:n,onKeyboardSubmit:i})=>{const s=C.useRef(null),r=C.useRef(i);return r.current=i,C.useEffect(()=>{if(!r.current)return;const o=s.current;if(o){const a=l=>{var c;l[$.CTRL_OR_CMD]&&l.key===$.ENTER&&(l.preventDefault(),(c=r.current)==null||c.call(r))};return o.focus(),o.addEventListener(te.KEYDOWN,a),()=>{o.removeEventListener(te.KEYDOWN,a)}}},[]),g("textarea",{className:"ttd-dialog-input",onChange:n,value:e,placeholder:t,ref:s})},NK=({error:e,canvasRef:t,loaded:n,hideErrorDetails:i})=>P("div",{className:`ttd-dialog-output-wrapper ${e?"ttd-dialog-output-wrapper--error":""}`,children:[e&&g("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:P("div",{className:"ttd-dialog-output-error-content",children:[g("div",{className:"ttd-dialog-output-error-icon",children:pG}),g("div",{className:"ttd-dialog-output-error-title",children:x("ttd.error")}),g("div",{className:"ttd-dialog-output-error-message",children:i?x("chat.errors.mermaidParseError"):e.message})]})},"error"),n?g("div",{className:ae("ttd-dialog-output-canvas-container",{invisible:!!e}),children:g("div",{ref:t,className:"ttd-dialog-output-canvas-content"})},"canvas"):g(Sa,{size:"2rem"})]}),j5=({label:e,children:t,panelActions:n=[],onTextSubmitInProgess:i,renderTopRight:s,renderSubmitShortcut:r,className:o,panelActionJustifyContent:a="flex-start"})=>{const l=c=>{if((c==null?void 0:c.variant)==="link")return P("button",{className:ae("ttd-dialog-panel-action-link",c.className),onClick:c.action,disabled:(c==null?void 0:c.disabled)||i,type:"button",children:[c.label,c.icon&&g("span",{className:"ttd-dialog-panel-action-link__icon",children:c.icon})]});if((c==null?void 0:c.variant)==="button")return P(gd,{className:ae("ttd-dialog-panel-button",c.className),onSelect:c.action?c.action:()=>{},disabled:(c==null?void 0:c.disabled)||i,children:[P("div",{className:ae({invisible:i}),children:[c==null?void 0:c.label,(c==null?void 0:c.icon)&&g("span",{children:c.icon})]}),i&&g(Sa,{})]});if((c==null?void 0:c.variant)==="rateLimit")return g("div",{className:ae("ttd-dialog-panel__rate-limit",c.className),children:c.label})};return P("div",{className:ae("ttd-dialog-panel",o),children:[(e||s)&&P("div",{className:"ttd-dialog-panel__header",children:[typeof e=="string"?g("label",{children:e}):e,s==null?void 0:s()]}),t,P("div",{className:ae("ttd-dialog-panel-button-container",{invisible:!n.length}),style:{justifyContent:a},children:[n.filter(Boolean).map(c=>g(C.Fragment,{children:l(c)},c.label)),!i&&(r==null?void 0:r())]})]})},b9e=({children:e})=>g("div",{className:"ttd-dialog-panels",children:e}),y9e=()=>P("div",{className:"ttd-dialog-submit-shortcut",children:[g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("CtrlOrCmd")}),g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("Enter")})]}),OK=({canvasRef:e,setError:t})=>{const n=e.current;if(!n)return;const i=n.parentElement;i&&(i.style.background="",t(null),n.replaceChildren())},uS=async({canvasRef:e,mermaidToExcalidrawLib:t,mermaidDefinition:n,setError:i,data:s,theme:r})=>{const o=e.current,a=o==null?void 0:o.parentElement;if(!o||!a)return{success:!1};if(!n)return OK({canvasRef:e,setError:i}),{success:!1};let l;try{const c=await t.api;try{try{l=await c.parseMermaidToExcalidraw(n)}catch{l=await c.parseMermaidToExcalidraw(n.replace(/"/g,"'"))}}catch(h){return{success:!1,error:h}}const{elements:d,files:u}=l;i(null),s.current={elements:e_(d,{regenerateIds:!0}),files:u};const f=await YE({elements:s.current.elements,files:s.current.files,exportPadding:$g,maxWidthOrHeight:Math.max(a.offsetWidth,a.offsetHeight)*window.devicePixelRatio,appState:{exportWithDarkMode:r===be.DARK}});return a.style.background="var(--default-bg-color)",o.replaceChildren(f),{success:!0}}catch(c){return a.style.background="var(--default-bg-color)",n&&i(c),{success:!1,error:c}}},Y5=e=>{Eu.set(W1.MERMAID_TO_EXCALIDRAW,e)},G_=({app:e,data:t,text:n,shouldSaveMermaidDataToStorage:i})=>{const{elements:s,files:r}=t.current;s.length&&(e.addElementsFromPasteOrLibrary({elements:s,files:r,position:"center",fitToContent:!0}),e.setOpenDialog(null),i&&n&&Y5(n))},E9e=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,rP=Al(Y5,300),v9e=({mermaidToExcalidrawLib:e,isActive:t})=>{const[n,i]=C.useState(()=>Eu.get(W1.MERMAID_TO_EXCALIDRAW)||E9e),s=C.useDeferredValue(n.trim()),[r,o]=C.useState(null),a=C.useRef(null),l=C.useRef({elements:[],files:null}),c=Ir(),{theme:d}=Qt();C.useEffect(()=>{t&&((async()=>{try{if(!s){OK({canvasRef:a,setError:o});return}const h=await uS({canvasRef:a,data:l,mermaidToExcalidrawLib:e,setError:o,mermaidDefinition:s,theme:d});if(!h.success){const m=h.error??new Error("Invalid mermaid definition");o(m)}}catch{}})(),rP(s))},[s,e,t,d]),C.useEffect(()=>()=>{rP.flush()},[]);const u=()=>{G_({app:c,data:l,text:n,shouldSaveMermaidDataToStorage:!0})};return P(fe,{children:[g("div",{className:"ttd-dialog-desc",children:g(Hs,{i18nKey:"mermaid.description",flowchartLink:f=>g("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:f}),sequenceLink:f=>g("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:f}),classLink:f=>g("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:f})})}),P(b9e,{children:[g(j5,{children:g(U9e,{input:n,placeholder:x("mermaid.inputPlaceholder"),onChange:f=>i(f.target.value),onKeyboardSubmit:()=>{u()}})}),g(j5,{panelActions:[{action:()=>{u()},label:x("mermaid.button"),icon:cE,variant:"button"}],renderSubmitShortcut:()=>g(y9e,{}),children:g(NK,{canvasRef:a,loaded:e.loaded,error:r})})]})]})},FK=()=>P("div",{className:"chat-interface__welcome-screen__welcome-message",children:[g("h3",{children:x("chat.placeholder.title")}),g("p",{children:x("chat.placeholder.description")}),g("p",{children:x("chat.placeholder.hint")})]}),_9e=({message:e,onMermaidTabClick:t,onAiRepairClick:n,onDeleteMessage:i,onInsertMessage:s,onRetry:r,rateLimitRemaining:o,isLastMessage:a,renderWarning:l,allowFixingParseError:c})=>{const[d,u]=C.useState(!1);C.useEffect(()=>{if(!e.error||!a)return;if(e.error&&!e.lastAttemptAt){u(!0);return}const h=Date.now()-e.lastAttemptAt,m=Math.max(0,5e3-h);if(m===0){u(!0);return}u(!1);const p=setTimeout(()=>{u(!0)},m);return()=>clearTimeout(p)},[e.error,e.lastAttemptAt,a]);const f=h=>h.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(e.type==="warning"){const h=l==null?void 0:l(e);return g("div",{className:"chat-message chat-message--system",children:P("div",{className:"chat-message__content",children:[P("div",{className:"chat-message__header",children:[g("span",{className:"chat-message__role",children:x("chat.role.system")}),g("span",{className:"chat-message__timestamp",children:f(e.timestamp)})]}),g("div",{className:"chat-message__body",children:g("div",{className:"chat-message__text",children:h||(e.warningType==="messageLimitExceeded"?P(fe,{children:[x("chat.rateLimit.messageLimit"),g("div",{style:{marginTop:"10px"},children:g($s,{onClick:()=>{window.open("https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=ttdChatBanner#excalidraw-redirect","_blank","noopener")},children:x("chat.upsellBtnLabel")})})]}):x("chat.rateLimit.generalRateLimit"))})})]})})}return P("div",{className:`chat-message chat-message--${e.type}`,children:[P("div",{className:"chat-message__content",children:[P("div",{className:"chat-message__header",children:[g("span",{className:"chat-message__role",children:e.type==="user"?x("chat.role.user"):x("chat.role.assistant")}),g("span",{className:"chat-message__timestamp",children:f(e.timestamp)})]}),g("div",{className:"chat-message__body",children:e.error?P(fe,{children:[g("div",{className:"chat-message__error",children:e.content}),e.errorType!=="parse"&&P("div",{className:"chat-message__error_message",children:["Error: ",e.error||x("chat.errors.generationFailed")]}),e.errorType==="parse"&&c&&P("div",{className:"chat-message__error_message",children:[g("p",{children:x("chat.errors.invalidDiagram")}),P("div",{className:"chat-message__error-actions",children:[t&&g("button",{className:"chat-message__error-link",onClick:()=>t(e),type:"button",children:x("chat.errors.fixInMermaid")}),n&&g("button",{className:"chat-message__error-link",onClick:()=>n(e),disabled:o===0,type:"button",children:x("chat.errors.aiRepair")})]})]})]}):P("div",{className:"chat-message__text",children:[e.content,e.isGenerating&&g("span",{className:"chat-message__cursor",children:""})]})})]}),e.type==="assistant"&&!e.isGenerating&&P("div",{className:"chat-message__actions",children:[!e.error&&s&&g("button",{className:"chat-message__action",onClick:()=>s(e),type:"button","aria-label":x("chat.insert"),title:x("chat.insert"),children:rme}),t&&e.content&&g("button",{className:"chat-message__action",onClick:()=>t(e),type:"button","aria-label":x("chat.viewAsMermaid"),title:x("chat.viewAsMermaid"),children:fG}),i&&e.errorType!=="network"&&g("button",{className:"chat-message__action chat-message__action--danger",onClick:()=>i(e.id),type:"button","aria-label":x("chat.deleteMessage"),title:x("chat.deleteMessage"),children:Ia}),e.errorType==="network"&&r&&a&&g("button",{className:ae("chat-message__action",{invisible:!d}),onClick:()=>r(e),type:"button","aria-label":x("chat.retry"),title:x("chat.retry"),children:sme})]})]})},w9e=({chatId:e,messages:t,currentPrompt:n,onPromptChange:i,onGenerate:s,isGenerating:r,rateLimits:o,onAbort:a,onMermaidTabClick:l,onAiRepairClick:c,onDeleteMessage:d,onInsertMessage:u,onRetry:f,renderWelcomeScreen:h,renderWarning:m})=>{const p=C.useRef(null),U=C.useRef(null);C.useLayoutEffect(()=>{var w;(w=p.current)==null||w.scrollIntoView()},[t]),C.useEffect(()=>{U.current&&U.current.focus()},[e]);const b=w=>{const T=w.target.value;i(T)},y=()=>{if(r&&a){a();return}const w=n.trim();w&&(s({prompt:w}),i(""))},E=w=>{w.key===$.ENTER&&!w.shiftKey&&(w.preventDefault(),r||y())},_=n.trim().length>3&&!r&&((o==null?void 0:o.rateLimitRemaining)??1)>0,I=r&&!!a,k=w=>{const T=w.target;T.style.height="auto",T.style.height=`${Math.min(T.scrollHeight,120)}px`};return P("div",{className:"chat-interface",children:[P("div",{className:"chat-interface__messages",children:[t.length===0?g("div",{className:"chat-interface__welcome-screen",children:h?h({rateLimits:o??null}):g(FK,{})}):t.map((w,T)=>g(_9e,{message:w,onMermaidTabClick:l,onAiRepairClick:c,onDeleteMessage:d,onInsertMessage:u,onRetry:f,rateLimitRemaining:o==null?void 0:o.rateLimitRemaining,isLastMessage:T===t.length-1,renderWarning:m,allowFixingParseError:w.errorType==="parse"&&T===t.length-1},w.id)),g("div",{ref:p,id:"messages-end"})]}),g("div",{className:"chat-interface__input-container",children:g("div",{className:"chat-interface__input-outer",children:P("div",{className:"chat-interface__input-wrapper",style:{borderColor:r?"var(--dialog-border-color)":void 0},children:[g("textarea",{ref:U,autoFocus:!0,className:"chat-interface__input",value:n,onChange:b,onKeyDown:E,placeholder:r?x("chat.generating"):(o==null?void 0:o.rateLimitRemaining)===0?x("chat.rateLimit.messageLimitInputPlaceholder"):t.length>0?x("chat.inputPlaceholderWithMessages"):x("chat.inputPlaceholder",{shortcut:"Shift + Enter"}),disabled:(o==null?void 0:o.rateLimitRemaining)===0,rows:1,cols:30,onInput:k}),g("button",{className:"chat-interface__send-button",onClick:y,disabled:!_&&!I,type:"button",children:g(E2,{size:"1.5em",icon:r?gge:cE})})]})})})]})},BK=Nt(null),zK=Nt(!1),e8=Nt(null),rm=Nt({id:Li(),messages:[],currentPrompt:""}),yh=(e,t)=>{const{messages:n}=e,i=qo(n,o=>o.type==="assistant");if(i===-1)return e;const s=n[i],r=n.slice();return r[i]={...s,...t},{...e,messages:r}},t8=e=>{const{messages:t}=e,n=qo(t,i=>i.type==="assistant");return t[n]},X_=(e,t)=>{const n=t.map(i=>({...i,id:Li(),timestamp:new Date}));return{...e,messages:[...e.messages,...n]}},T9e=e=>{const t=qo(e.messages??[],n=>n.type==="assistant");return t!==-1?{...e,messages:e.messages.filter((n,i)=>i!==t)}:e},I9e=e=>{const t=[];for(const n of e.messages)n.content&&(n.type==="user"||n.type==="assistant")&&t.push({role:n.type,content:n.content});return t},HK=()=>{const[e,t]=dt(rm);return{addUserMessage:o=>{t(a=>X_(a,[{type:"user",content:o}]))},addAssistantMessage:()=>{t(o=>X_(o,[{type:"assistant",content:"",isGenerating:!0}]))},setAssistantError:(o,a="other",l)=>{const c=l?JSON.stringify({name:l instanceof Error?l.name:"Error",message:l instanceof Error?l.message:String(l),stack:l instanceof Error?l.stack:void 0}):void 0;t(d=>yh(d,{isGenerating:!1,error:o,errorType:a,errorDetails:c}))},chatHistory:e,setChatHistory:t,setLastRetryAttempt:()=>{t(o=>yh(o,{lastAttemptAt:Date.now()}))}}},S9e=e=>{const t=e.trim();return t.length<=50?t:`${t.substring(0,47)}...`},C9e=Nt([]),x9e=Nt(!1),A9e=Nt(!1),VK=({persistenceAdapter:e})=>{var p;const[t]=dt(rm),[n,i]=dt(C9e),[s,r]=dt(x9e),[o,a]=dt(A9e),l=C.useRef(n);l.current=n;const c=t==null?void 0:t.messages[(t==null?void 0:t.messages.length)-1],d=C.useCallback(async()=>{if(!(o||s)){r(!0);try{const U=await e.loadChats();i(U),a(!0)}catch(U){console.warn("Failed to load chats:",U),i([]),a(!0)}finally{r(!1)}}},[o,s,i,r,a,e]);C.useEffect(()=>{d()},[]);const u=C.useCallback(async()=>{if(t.messages.length===0)return;const U=t.messages.find(w=>w.type==="user");if(!U||typeof U.content!="string")return;const b=S9e(U.content),y=l.current,E=y.find(w=>w.id===t.id),_=!E||E.messages.length!==t.messages.length||E.messages.some((w,T)=>{var A,S;return w.id!==((A=t.messages[T])==null?void 0:A.id)||w.content!==((S=t.messages[T])==null?void 0:S.content)}),I={id:t.id,title:b,messages:t.messages.filter(w=>w.type==="user"||w.type==="assistant").map(w=>({...w,timestamp:w.timestamp instanceof Date?w.timestamp:new Date(w.timestamp)})),currentPrompt:t.currentPrompt,timestamp:_?Date.now():(E==null?void 0:E.timestamp)??Date.now()},k=[...y.filter(w=>w.id!==t.id),I].sort((w,T)=>T.timestamp-w.timestamp).slice(0,10);i(k);try{await e.saveChats(k)}catch(w){console.warn("Failed to save chats:",w)}},[t,i,e]);C.useEffect(()=>{c!=null&&c.isGenerating||u()},[(p=t.messages)==null?void 0:p.length,c==null?void 0:c.id,c==null?void 0:c.isGenerating]);const f=C.useCallback(async U=>{const b=l.current.filter(y=>y.id!==U);i(b);try{await e.saveChats(b)}catch(y){console.warn("Failed to save after delete:",y)}return b},[i,e]),h=C.useCallback(U=>U,[]),m=C.useCallback(async()=>(await u(),Li()),[u]);return{savedChats:n,saveCurrentChat:u,deleteChat:f,restoreChat:h,createNewChatId:m}},M9e=e=>{var d;const t=e.trim();if(!t)return!1;const n=(t.match(/\[/g)||[]).length,i=(t.match(/\]/g)||[]).length,s=(t.match(/\{/g)||[]).length,r=(t.match(/\}/g)||[]).length,o=(t.match(/\(/g)||[]).length,a=(t.match(/\)/g)||[]).length;if(n!==i||s!==r||o!==a)return!1;const l=((d=t.split(`
`).pop())==null?void 0:d.trim())||"";return![/-->$/,/--$/,/-\.$/,/==>$/,/==$/,/~~$/,/::$/,/:$/,/\|$/,/&$/].some(u=>u.test(l))},V7=300,k9e=3e3,R9e=100,oP=100,D9e=({mermaidToExcalidrawLib:e,canvasRef:t})=>{const[n]=dt(rm),[,i]=dt(e8),[s,r]=dt(zK),o=C.useRef(!1),a=C.useMemo(()=>t8(n),[n]),l=C.useRef(a);C.useEffect(()=>{l.current=a},[a]);const c=C.useRef({elements:[],files:null}),d=C.useRef(0),u=C.useRef(null),f=C.useRef(!1),h=C.useRef(V7),{theme:m}=Qt(),p=C.useCallback(async y=>{if(!y.trim()||!e.loaded||o.current)return!1;o.current=!0;const E=performance.now(),_=await uS({canvasRef:t,data:c,mermaidToExcalidrawLib:e,setError:i,mermaidDefinition:y,theme:m});return performance.now()-E<R9e?h.current=V7:h.current=k9e,o.current=!1,_.success},[t,e,i,m]),U=C.useMemo(()=>{const y=async E=>{const _=Date.now(),I=_-d.current,k=h.current;if(!M9e(E)){f.current||(d.current=Math.max(d.current,_-k+oP),f.current=!0),u.current=E;return}if(f.current=!1,I<k){u.current=E;return}u.current=null;const w=await p(E);d.current=Date.now(),w||(d.current=d.current-k+oP,f.current=!0)};return y.flush=async()=>{if(u.current){const E=u.current;u.current=null,await p(E),d.current=Date.now()}},y.cancel=()=>{u.current=null},y},[p]),b=C.useCallback(()=>{d.current=0,u.current=null,f.current=!1,h.current=V7},[]);return C.useEffect(()=>{a!=null&&a.content&&(a!=null&&a.isGenerating)?U(a.content):a!=null&&a.isGenerating||(U.flush(),b(),a!=null&&a.content&&U(a.content))},[b,U,a==null?void 0:a.isGenerating,a==null?void 0:a.content]),C.useEffect(()=>{const y=l.current;!(y!=null&&y.content)||y.error||s&&p(y.content)},[n==null?void 0:n.id,p,s]),C.useEffect(()=>{var y;if((y=n.messages)!=null&&y.filter(E=>E.type==="assistant").length)s||r(!0);else{const E=t.current;if(E){const _=E.parentElement;_&&(_.style.background="",E.replaceChildren())}r(!1)}},[n.messages,r,t,s]),{data:c}},$7=3,G7=1e4,L9e=({onTextSubmit:e})=>{const[,t]=dt(e8),[n,i]=dt(BK),[s,r]=dt(rm),{addUserMessage:o,addAssistantMessage:a,setAssistantError:l}=HK(),c=C.useRef(null),d=h=>h.length>G7||h.length<$7||(n==null?void 0:n.rateLimitRemaining)===0?(h.length<$7&&t(new Error(x("chat.errors.promptTooShort",{min:$7}))),h.length>G7&&t(new Error(x("chat.errors.promptTooLong",{max:G7}))),!1):!0;return{onGenerate:async({prompt:h,isRepairFlow:m=!1})=>{if(!d(h))return;c.current&&c.current.abort(),t(null);const p=new AbortController;c.current=p,m?r(U=>yh(U,{isGenerating:!0,content:"",error:void 0,errorType:void 0,errorDetails:void 0})):(o(h),a());try{at("ai","generate","ttd");const b=[...I9e(s).slice(-3),{role:"user",content:h}],{generatedResponse:y,error:E,rateLimit:_,rateLimitRemaining:I}=await e({messages:b,onStreamCreated:()=>{m&&r(k=>yh(k,{content:"",error:"",isGenerating:!0}))},onChunk:k=>{r(w=>{const T=t8(w);return yh(w,{content:T.content+k})})},signal:p.signal});if(r(k=>yh(k,{isGenerating:!1})),j1(_)&&j1(I)&&i({rateLimit:_,rateLimitRemaining:I}),((E==null?void 0:E.status)===429||I===0)&&r(k=>((E==null?void 0:E.status)===429&&(k=T9e(k)),k={...k,messages:k.messages.filter(T=>T.type!=="warning"||T.warningType==="rateLimitExceeded"||T.warningType==="messageLimitExceeded")},X_(k,[{type:"warning",warningType:I===0?"messageLimitExceeded":"rateLimitExceeded"}]))),E){if(E.name==="AbortError"||E.message==="Aborted"||p.signal.aborted)return;const w=new Error(E.message||x("chat.errors.requestFailed"));E.status!==429&&l(w.message,"network"),t(w);return}try{await ZQ(y??""),at("ai","mermaid parse success","ttd")}catch(k){at("ai","mermaid parse failed","ttd");const w=new Error(k.message||x("chat.errors.mermaidParseError"));l(w.message,"parse"),t(w)}}catch(U){const b=new Error(U.message||x("chat.errors.generationFailed"));l(b.message,"other"),t(b)}finally{c.current=null}},handleAbort:()=>{c.current&&c.current.abort()}}},P9e=({persistenceAdapter:e})=>{const t=d2(e8),[n,i]=dt(rm),[s,r]=C.useState(!1),{restoreChat:o,deleteChat:a,createNewChatId:l}=VK({persistenceAdapter:e}),c=C.useCallback(U=>{const b=U.messages.map(_=>({..._,timestamp:_.timestamp instanceof Date?_.timestamp:new Date(_.timestamp)})),y={id:U.id,messages:b,currentPrompt:""},E=t8(y);t(E!=null&&E.error?new Error(E==null?void 0:E.error):null),i(y)},[t,i]),d=C.useCallback(async()=>{const U=await l();i({id:U,messages:[],currentPrompt:""}),t(null)},[l,i,t]),u=C.useCallback(U=>{const b=o(U);c(b),r(!1)},[o,c]),f=C.useCallback(async(U,b)=>{b.stopPropagation();const y=U===n.id,E=await a(U);if(y)if(E.length>0){const _=E[0];c(_)}else await d()},[n.id,a,c,d]),h=C.useCallback(async()=>{await d(),r(!1)},[d]),m=C.useCallback(()=>{r(U=>!U)},[]),p=C.useCallback(()=>{r(!1)},[]);return{isMenuOpen:s,onRestoreChat:u,handleDeleteChat:f,handleNewChat:h,handleMenuToggle:m,handleMenuClose:p}},N9e=({isOpen:e,onToggle:t,onClose:n,onNewChat:i,onRestoreChat:s,onDeleteChat:r,isNewChatBtnVisible:o,savedChats:a,activeSessionId:l,disabled:c})=>P("div",{className:"ttd-chat-history-menu",children:[o&&g($s,{onClick:i,disabled:c,children:x("chat.newChat")}),a.length>0&&g("div",{className:"ttd-dialog-panel__menu-wrapper",children:P(Oe,{open:e,children:[g(Oe.Trigger,{onToggle:t,className:"ttd-dialog-menu-trigger",disabled:c,title:x("chat.menu"),"aria-label":x("chat.menu"),children:ume}),g(Oe.Content,{onClickOutside:n,onSelect:n,children:g(fe,{children:a.map(d=>P(Oe.ItemCustom,{className:ae("ttd-chat-menu-item",{"ttd-chat-menu-item--active":d.id===l}),onClick:()=>{s(d)},children:[g("span",{className:"ttd-chat-menu-item__title",children:d.title}),g("button",{className:"ttd-chat-menu-item__delete",onClick:u=>r(d.id,u),title:x("chat.deleteChat"),"aria-label":x("chat.deleteChat"),type:"button",children:Ia})]},d.id))})})]})})]}),O9e=({chatId:e,messages:t,currentPrompt:n,onPromptChange:i,onGenerate:s,isGenerating:r,generatedResponse:o,isMenuOpen:a,onMenuToggle:l,onMenuClose:c,onNewChat:d,onRestoreChat:u,onDeleteChat:f,savedChats:h,activeSessionId:m,onAbort:p,onMermaidTabClick:U,onAiRepairClick:b,onDeleteMessage:y,onInsertMessage:E,onRetry:_,onViewAsMermaid:I,renderWelcomeScreen:k,renderWarning:w})=>{const[T]=dt(BK),S=(()=>{const N=[];return T&&N.push({label:x("chat.rateLimitRemaining",{count:T.rateLimitRemaining}),variant:"rateLimit",className:T.rateLimitRemaining<5?"ttd-dialog-panel__rate-limit--danger":""}),o&&N.push({action:I,label:x("chat.viewAsMermaid"),icon:g(E2,{icon:cE}),variant:"link"}),N})(),D=()=>S.length===2?"space-between":S.length===1&&S[0].variant==="rateLimit"?"flex-start":"flex-end";return g(j5,{label:P("div",{className:"ttd-dialog-panel__label-wrapper",children:[g("div",{className:"ttd-dialog-panel__label-group"}),g("div",{className:"ttd-dialog-panel__header-right",children:g(N9e,{isNewChatBtnVisible:!!t.length,isOpen:a,onToggle:l,onClose:c,onNewChat:d,onRestoreChat:u,onDeleteChat:f,savedChats:h,activeSessionId:m,disabled:r})})]}),className:"ttd-dialog-chat-panel",panelActionJustifyContent:D(),panelActions:S,children:g(w9e,{chatId:e,messages:t,currentPrompt:n,onPromptChange:i,onGenerate:s,isGenerating:r,generatedResponse:o,onAbort:p,onMermaidTabClick:U,onAiRepairClick:b,onDeleteMessage:y,onInsertMessage:E,onRetry:_,rateLimits:T,renderWelcomeScreen:k,renderWarning:w})})},F9e=({canvasRef:e,error:t,loaded:n,onInsert:i,hideErrorDetails:s})=>{const r=[{action:i,label:x("chat.insert"),icon:cE,variant:"button"}];return g(j5,{panelActionJustifyContent:"flex-end",panelActions:r,className:"ttd-dialog-preview-panel",children:g(NK,{canvasRef:e,error:t,loaded:n,hideErrorDetails:s})})},B9e=({mermaidToExcalidrawLib:e,onTextSubmit:t,renderWelcomeScreen:n,renderWarning:i,persistenceAdapter:s})=>{const r=Ir(),o=On(),a=C.useRef(null),[l,c]=dt(e8),[d,u]=dt(rm),f=HT(zK),{savedChats:h}=VK({persistenceAdapter:s}),m=t8(d),{setLastRetryAttempt:p}=HK(),{data:U}=D9e({canvasRef:a,mermaidToExcalidrawLib:e}),{onGenerate:b,handleAbort:y}=L9e({onTextSubmit:t}),{isMenuOpen:E,onRestoreChat:_,handleDeleteChat:I,handleNewChat:k,handleMenuToggle:w,handleMenuClose:T}=P9e({persistenceAdapter:s}),A=()=>{typeof(m==null?void 0:m.content)=="string"&&(Y5(m.content),o({openDialog:{name:"ttd",tab:"mermaid"}}))},S=O=>{const z=O.content||"";z&&(Y5(z),o({openDialog:{name:"ttd",tab:"mermaid"}}))},D=async O=>{const z=O.content||"";if(!z.trim()||!e.loaded)return;const H={current:{elements:[],files:null}};(await uS({canvasRef:a,data:H,mermaidToExcalidrawLib:e,setError:c,mermaidDefinition:z,theme:r.state.theme})).success&&G_({app:r,data:H,text:z,shouldSaveMermaidDataToStorage:!0})},N=async O=>{const z=O.content||"",H=O.error||"";if(!z)return;const X=`Fix the error in this Mermaid diagram. The diagram is:

\`\`\`mermaid
${z}
\`\`\`

The exception/error is: ${H}

Please fix the Mermaid syntax and regenerate a valid diagram.`;await b({prompt:X,isRepairFlow:!0})},L=async O=>{const z=d.messages.findIndex(H=>H.id===O.id);if(z>0){const H=d.messages[z-1];H.type==="user"&&typeof H.content=="string"&&(p(),await b({prompt:H.content,isRepairFlow:!0}))}},j=()=>{G_({app:r,data:U})},Y=O=>{const z=d.messages.findIndex(X=>X.id===O&&X.type==="assistant"),H=d.messages.slice(0,z-1);u({...d,messages:H})},G=O=>{u(z=>({...z,currentPrompt:O}))};return P("div",{className:`ttd-dialog-layout ${f?"ttd-dialog-layout--split":"ttd-dialog-layout--chat-only"}`,children:[g(O9e,{chatId:d.id,messages:d.messages,currentPrompt:d.currentPrompt,onPromptChange:G,onGenerate:b,isGenerating:(m==null?void 0:m.isGenerating)??!1,generatedResponse:m==null?void 0:m.content,isMenuOpen:E,onMenuToggle:w,onMenuClose:T,onNewChat:k,onRestoreChat:_,onDeleteChat:I,savedChats:h,activeSessionId:d.id,onAbort:y,onMermaidTabClick:S,onAiRepairClick:N,onDeleteMessage:Y,onInsertMessage:D,onRetry:L,onViewAsMermaid:A,renderWarning:i,renderWelcomeScreen:n}),f&&g(F9e,{canvasRef:a,hideErrorDetails:(m==null?void 0:m.errorType)==="parse",error:l,loaded:e.loaded,onInsert:j})]})},z9e=({mermaidToExcalidrawLib:e,onTextSubmit:t,renderWelcomeScreen:n,renderWarning:i,persistenceAdapter:s})=>g(B9e,{mermaidToExcalidrawLib:e,onTextSubmit:t,renderWelcomeScreen:n,renderWarning:i,persistenceAdapter:s}),$K=e=>{const t=On(),n=C.useRef(null),i=C.useRef(0);return g(bj,{ref:n,className:"ttd-dialog-tabs-root",value:e.tab,onValueChange:s=>{var o;if(!s)return;const r=(o=n.current)==null?void 0:o.closest(".Modal__content");if(r){const a=r.offsetHeight||0;a>i.current&&(i.current=a,r.style.minHeight=`min(${i.current}px, 100%)`)}e.dialog==="ttd"&&Oz(["text-to-diagram","mermaid"],s)&&t({openDialog:{name:e.dialog,tab:s}})},children:e.children})};$K.displayName="TTDDialogTabs";const GK=({children:e,...t})=>g(yj,{className:"ttd-dialog-triggers",...t,children:e});GK.displayName="TTDDialogTabTriggers";const j_=({children:e,tab:t,onSelect:n,...i})=>g(Ej,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"ttd-dialog-tab-trigger",...i,children:e})});j_.displayName="TTDDialogTabTrigger";const Y_=({tab:e,children:t,...n})=>g(vj,{...n,value:e,children:t});Y_.displayName="TTDDialogTab";const fS=e=>{var n;const t=Qt();return((n=t.openDialog)==null?void 0:n.name)!=="ttd"?null:g(H9e,{...e,tab:t.openDialog.tab})};fS.WelcomeMessage=FK;const H9e=T2("TTDDialogBase",({tab:e,...t})=>{const n=Ir(),[i,s]=C.useState({loaded:!1,api:Ue(()=>import("./mermaid-to-excalidraw-C2eqzxpF.js").then(r=>r.bG),__vite__mapDeps([]))});return C.useEffect(()=>{(async()=>{await i.api,s(o=>({...o,loaded:!0}))})()},[i.api]),g(Tr,{className:"ttd-dialog",onCloseRequest:()=>{n.setOpenDialog(null)},size:1520,title:!1,...t,autofocus:!1,children:P($K,{dialog:"ttd",tab:e,children:["__fallback"in t&&t.__fallback?g("p",{className:"dialog-mermaid-title",children:x("mermaid.title")}):P(GK,{children:[g(j_,{tab:"text-to-diagram",children:P("div",{className:"ttd-dialog-tab-trigger__content",children:[x("labels.textToDiagram"),g("div",{className:"ttd-dialog-tab-trigger__badge",children:x("chat.aiBeta")})]})}),g(j_,{tab:"mermaid",children:x("mermaid.label")})]}),!("__fallback"in t)&&g(Y_,{className:"ttd-dialog-content",tab:"text-to-diagram",children:g(z9e,{mermaidToExcalidrawLib:i,onTextSubmit:t.onTextSubmit,renderWelcomeScreen:t.renderWelcomeScreen,renderWarning:t.renderWarning,persistenceAdapter:t.persistenceAdapter})}),g(Y_,{className:"ttd-dialog-content",tab:"mermaid",children:g(v9e,{mermaidToExcalidrawLib:i,isActive:e==="mermaid"})})]})})}),V9e=.01,W_=10,Ol=(e,t)=>!(t==="angle"&&_e(e)),os=(e,t)=>{const n=e+t/2;return n-n%t},W5=(e,t,n)=>Object.keys(e).map(i=>({original:(n??t).get(i),latest:t.get(i)})).filter(i=>i.original!==void 0&&i.latest!==void 0),bp=(e,t,n,i,s,r,o=!0)=>{if(ln(n)&&(n.startBinding||n.endBinding)){if(Math.abs(e-n.x)<O0&&Math.abs(t-n.y)<O0)return;Cs(n,"start",i),Cs(n,"end",i)}const a=i.getNonDeletedElementsMap(),l=a.get(n.id);if(!l)return;const[c,d]=[n.x+n.width/2,n.y+n.height/2],[u,f]=Z(M(n.x,n.y),M(c,d),n.angle),h=e-u,m=t-f,[p,U]=Z(M(e,t),M(c+h,d+m),-n.angle);i.mutateElement(l,{x:p,y:U},{informMutation:o,isDragging:!1}),V0(l,i,s);const b=Ne(n,r);if(b){const y=a.get(b.id);y&&i.mutateElement(y,{x:b.x+h,y:b.y+m},{informMutation:o,isDragging:!1})}if(_e(n)){const y=br(r,n.id);y.forEach(E=>{const _=a.get(E.id);if(!_)return;const[I,k]=[E.x+E.width/2,E.y+E.height/2],[w,T]=Z(M(E.x,E.y),M(I,k),E.angle),A=Math.round(w+h),S=Math.round(T+m),[D,N]=Z(M(A,S),M(I+h,k+m),-E.angle);i.mutateElement(_,{x:D,y:N},{informMutation:o,isDragging:!1}),V0(_,i,s,{simultaneouslyUpdated:y})})}},hS=(e,t)=>{const i=zc(t).map(s=>Ot(e,s).reduce((r,o)=>(r[o.id]=!0,r),{}));return e.filter(s=>!mg(s)).forEach(s=>{i.push({[s.id]:!0})}),i},jl=({label:e,icon:t,dragInputCallback:n,value:i,elements:s,editable:r=!0,shouldKeepAspectRatio:o,property:a,scene:l,appState:c,sensitivity:d=1,dragFinishedCallback:u})=>{const f=Ir(),h=On(),m=C.useRef(null),p=C.useRef(null),[U,b]=C.useState(i.toString()),y=C.useRef(null);y.current||(y.current={originalAppState:ua(c),originalElements:s,lastUpdatedValue:U,updatePending:!1}),C.useEffect(()=>{const I=i.toString();b(I),y.current.lastUpdatedValue=I},[i]);const E=(I,k,w)=>{if(!y.current.updatePending)return!1;y.current.updatePending=!1;const T=Number(I);if(isNaN(T)){b(i.toString());return}const A=Number(T.toFixed(2)),S=Number(i);(isNaN(S)||Math.abs(A-S)>=V9e)&&(y.current.lastUpdatedValue=I,n({accumulatedChange:0,instantChange:0,originalElements:k,originalElementsMap:f.scene.getNonDeletedElementsMap(),shouldKeepAspectRatio:o,shouldChangeByStepSize:!1,scene:l,nextValue:A,property:a,originalAppState:w,setInputValue:D=>b(String(D)),app:f,setAppState:h}),f.syncActionResult({captureUpdate:q.IMMEDIATELY}))},_=C.useRef({});return _.current.handleInputValue=E,C.useEffect(()=>{const I=m.current,k=_.current;return()=>{var T;const w=I==null?void 0:I.value;w&&((T=k.handleInputValue)==null||T.call(k,w,y.current.originalElements,y.current.originalAppState)),window.removeEventListener(te.POINTER_MOVE,k.onPointerMove,!1),window.removeEventListener(te.POINTER_UP,k.onPointerUp,!1)}},[r]),r?P("div",{className:ae("drag-input-container",!r&&"disabled"),"data-testid":e,children:[g("div",{className:"drag-input-label",ref:p,onPointerDown:I=>{if(m.current&&r){document.body.classList.add("excalidraw-cursor-resize"),Number(m.current.value);let k=null,w=f.scene.getNonDeletedElements().reduce((j,Y)=>(j.set(Y.id,cd(Y)),j),new Map),T=s.map(j=>w.get(j.id));const A=ua(c);let S=0,D=0;const N=j=>{if(k&&w!==null&&T!==null){const Y=j.clientX-k.x;Y!==0&&(D+=Y,Math.abs(D)>=d&&(D=Math.sign(D)*Math.floor(Math.abs(D)/d),S+=D,n({accumulatedChange:S,instantChange:D,originalElements:T,originalElementsMap:w,shouldKeepAspectRatio:o,shouldChangeByStepSize:j.shiftKey,property:a,scene:l,originalAppState:A,setInputValue:G=>b(String(G)),app:f,setAppState:h}),D=0))}k={x:j.clientX,y:j.clientY}},L=()=>{window.removeEventListener(te.POINTER_MOVE,N,!1),f.syncActionResult({captureUpdate:q.IMMEDIATELY}),u==null||u({app:f,setAppState:h,originalElements:T,originalAppState:A}),k=null,S=0,D=0,T=null,w=null,document.body.classList.remove("excalidraw-cursor-resize"),window.removeEventListener(te.POINTER_UP,L,!1)};_.current.onPointerMove=N,_.current.onPointerUp=L,window.addEventListener(te.POINTER_MOVE,N,!1),window.addEventListener(te.POINTER_UP,L,!1)}},onPointerEnter:()=>{p.current&&(p.current.style.cursor="ew-resize")},children:t?g(E2,{icon:t}):e}),g("input",{className:"drag-input",autoComplete:"off",spellCheck:"false",onKeyDown:I=>{if(r){const k=I.target;k instanceof HTMLInputElement&&I.key===$.ENTER&&(E(k.value,s,c),f.focusContainer())}},ref:m,value:U,onChange:I=>{y.current.updatePending=!0,b(I.target.value)},onFocus:I=>{I.target.select(),y.current.originalElements=s,y.current.originalAppState=ua(c)},onBlur:I=>{U?r&&E(I.target.value,y.current.originalElements,y.current.originalAppState):b(i.toString())},disabled:!r})]}):null},$9e=15,G9e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s,app:r})=>{const o=s.getNonDeletedElementsMap(),a=t[0];if(a&&!ve(a)){const l=o.get(a.id);if(!l)return;if(i!==void 0){const m=Fc(i);s.mutateElement(l,{angle:m}),V0(l,s,r.state);const p=Ne(l,o);p&&!Te(l)&&s.mutateElement(p,{angle:m});return}const c=Math.round(Ly(a.angle)*100)/100,d=Math.round(e);let u=(c+d)%360;n&&(u=os(u,$9e)),u=u<0?u+360:u;const f=Fc(u);s.mutateElement(l,{angle:f}),V0(l,s,r.state);const h=Ne(l,o);h&&!Te(l)&&s.mutateElement(h,{angle:f})}},X9e=({element:e,scene:t,appState:n,property:i})=>g(jl,{label:"A",icon:gG,value:Math.round(Ly(e.angle)%360*100)/100,elements:[e],dragInputCallback:G9e,editable:Ol(e,"angle"),scene:t,appState:n,property:i}),aP=5,j9e=({property:e,scene:t,appState:n,setAppState:i})=>g(jl,{label:"Grid step",sensitivity:8,elements:[],dragInputCallback:({nextValue:s,instantChange:r,shouldChangeByStepSize:o,setInputValue:a})=>{i(l=>{let c;return s?c=s:r&&(c=o?os(l.gridStep+aP*Math.sign(r),aP):l.gridStep+r),c?(c=eG(c),a(c),{gridStep:c}):(a(l.gridStep),null)})},scene:t,value:n.gridStep,property:e,appState:n}),lP=10,Y9e=e=>e.type==="image",W9e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldKeepAspectRatio:i,shouldChangeByStepSize:s,nextValue:r,property:o,originalAppState:a,instantChange:l,scene:c,app:d,setAppState:u})=>{const f=c.getNonDeletedElementsMap(),h=t[0],m=f.get(h.id);if(h&&m){const p=i||Y9e(h),U=h.width/h.height;if(a.croppingElementId===h.id){const b=f.get(h.id);if(!b||!xt(b)||!b.crop)return;const y=b.crop;let E={...y};const _=b.scale[0]===-1,I=b.scale[1]===-1,{width:k,height:w}=ya(b),T=y.naturalWidth/k,A=y.naturalHeight/w,S=_?y.width+y.x:y.naturalWidth-y.x,D=I?y.height+y.y:y.naturalHeight-y.y,N=_i*T,L=_i*A;if(r!==void 0){if(o==="width"){const z=r*T,H=Ke(z,N,S);E={...E,width:H,x:_?y.x+y.width-H:y.x}}else if(o==="height"){const z=r*A,H=Ke(z,L,D);E={...E,height:H,y:I?y.y+y.height-H:y.y}}c.mutateElement(b,{crop:E,width:E.width/(y.naturalWidth/k),height:E.height/(y.naturalHeight/w)});return}const j=o==="width"?l:0,Y=o==="height"?l:0,G=Ke(y.width+j,N,S),O=Ke(y.height+Y,N,D);E={...y,x:_?y.x+y.width-G:y.x,y:I?y.y+y.height-O:y.y,width:G,height:O},c.mutateElement(b,{crop:E,width:E.width/(y.naturalWidth/k),height:E.height/(y.naturalHeight/w)});return}if(r!==void 0){const b=Math.max(o==="width"?r:p?r*U:h.width,Dr),y=Math.max(o==="height"?r:p?r/U:h.height,Dr);if(Y0(b,y,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),_e(m)){const E=ha(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap()),_=Wg(c.getElementsIncludingDeleted(),E,m,d);c.replaceAllElements(_)}return}{const b=o==="width"?e:0,y=o==="height"?e:0;let E=Math.max(0,h.width+b);o==="width"&&(s?E=os(E,lP):E=Math.round(E));let _=Math.max(0,h.height+y);if(o==="height"&&(s?_=os(_,lP):_=Math.round(_)),p&&(o==="width"?_=Math.round(E/U*100)/100:E=Math.round(_*U*100)/100),_=Math.max(Dr,_),E=Math.max(Dr,E),Y0(E,_,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),_e(m)){const I=ha(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap());u({elementsToHighlight:I})}}}},K9e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&_e(o)){const a=ha(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Wg(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},cP=({property:e,element:t,scene:n,appState:i})=>{let s=Ul(e==="width"?t.width:t.height,2);if(i.croppingElementId&&i.croppingElementId===t.id&&xt(t)&&t.crop){const{width:r,height:o}=ya(t);if(e==="width"){const a=r/t.crop.naturalWidth;s=Ul(t.crop.width*a,2)}if(e==="height"){const a=o/t.crop.naturalHeight;s=Ul(t.crop.height*a,2)}}return g(jl,{label:e==="width"?"W":"H",elements:[t],dragInputCallback:W9e,value:s,editable:Ol(t,e),scene:n,appState:i,property:e,dragFinishedCallback:K9e})},dP=4,Z9e=4,q9e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t[0];if(o){const a=r.get(o.id);if(!a||!he(a))return;let l;if(i!==void 0)l=Math.max(Math.round(i),dP);else if(o.type==="text"){const c=Math.round(o.fontSize),d=Math.round(e);l=Math.max(c+d,dP),n&&(l=os(l,Z9e))}l&&(s.mutateElement(a,{fontSize:l}),fs(a,s.getContainerElement(a),s))}},Q9e=({element:e,scene:t,appState:n,property:i})=>{const s=he(e)?e:Ki(e)?Ne(e,t.getNonDeletedElementsMap()):null;return s?g(jl,{label:"F",value:Math.round(s.fontSize*10)/10,elements:[s],dragInputCallback:q9e,icon:lE,appState:n,scene:t,property:i}):null},J9e=15,eTe=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,property:s,scene:r})=>{const o=r.getNonDeletedElementsMap(),a=t.map(c=>o.get(c.id)).filter(c=>c&&!mg(c)&&Ol(c,s)),l=t.filter(c=>!mg(c)&&Ol(c,s));if(i!==void 0){const c=Fc(i);for(const d of a){if(!d)continue;r.mutateElement(d,{angle:c});const u=Ne(d,o);u&&!Te(d)&&r.mutateElement(u,{angle:c})}r.triggerUpdate();return}for(let c=0;c<a.length;c++){const d=a[c];if(!d)continue;const u=l[c],f=Math.round(Ly(u.angle)*100)/100,h=Math.round(e);let m=(f+h)%360;n&&(m=os(m,J9e)),m=m<0?m+360:m;const p=Fc(m);r.mutateElement(d,{angle:p});const U=Ne(d,o);U&&!Te(d)&&r.mutateElement(U,{angle:p})}r.triggerUpdate()},tTe=({elements:e,scene:t,appState:n,property:i})=>{const s=e.filter(l=>!mg(l)&&Ol(l,"angle")),r=s.map(l=>Math.round(Ly(l.angle)%360*100)/100),o=new Set(r).size===1?r[0]:"Mixed",a=s.some(l=>Ol(l,"angle"));return g(jl,{label:"A",icon:gG,value:o,elements:e,dragInputCallback:eTe,editable:a,appState:n,scene:t,property:i})},Pf=10,nTe=(e,t,n,i)=>{const s=i.x-e,r=i.y-t,o=i.width*n,a=i.height*n,l=e+s*n,c=t+r*n;return{width:o,height:a,x:l,y:c,...PT(i,o,a,!1),...he(i)?{fontSize:i.fontSize*n}:{}}},iTe=(e,t,n,i,s,r,o,a)=>{const l=a.getNonDeletedElementsMap(),c=nTe(e,t,i,r);a.mutateElement(s,c);const d=Ne(r,o);if(d){const u=d.fontSize*i;pi(s,a);const f=l.get(d.id);f&&he(f)&&(a.mutateElement(f,{fontSize:u}),s2(s,a,n==="width"?"e":"s",!0))}},uP=(e,t,n,i,s,r,o,a,l,c)=>{r==="width"?t=Math.round(e/i*100)/100:e=Math.round(t*i*100)/100;const d=t/n;for(let u=0;u<a.length;u++){const f=a[u],h=o[u];iTe(s[0],s[1],r,d,h,f,l,c)}},sTe=({accumulatedChange:e,originalElements:t,originalElementsMap:n,originalAppState:i,shouldChangeByStepSize:s,nextValue:r,scene:o,property:a,setAppState:l,app:c})=>{const d=o.getNonDeletedElementsMap(),u=hS(t,i);if(r!==void 0){for(const p of u){const U=W5(p,d,n);if(U.length>1){const b=U.map(N=>N.latest),y=U.map(N=>N.original),[E,_,I,k]=Et(y),w=I-E,T=k-_,A=w/T,S=Math.max(Dr,a==="width"?Math.max(0,r):w),D=Math.max(Dr,a==="height"?Math.max(0,r):T);uP(S,D,T,A,M(E,_),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,E=b==null?void 0:b.original;if(y&&E&&Ol(y,a)){let _=a==="width"?Math.max(0,r):y.width;a==="width"&&(s?_=os(_,Pf):_=Math.round(_));let I=a==="height"?Math.max(0,r):y.height;if(a==="height"&&(s?I=os(I,Pf):I=Math.round(I)),_=Math.max(Dr,_),I=Math.max(Dr,I),Y0(_,I,y,E,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),_e(y)){const k=ha(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap()),w=Wg(o.getElementsIncludingDeleted(),k,y,c);o.replaceAllElements(w)}}}}o.triggerUpdate();return}const f=a==="width"?e:0,h=a==="height"?e:0,m=[];for(const p of u){const U=W5(p,d,n);if(U.length>1){const b=U.map(N=>N.latest),y=U.map(N=>N.original),[E,_,I,k]=Et(y),w=I-E,T=k-_,A=w/T;let S=Math.max(0,w+f);a==="width"&&(s?S=os(S,Pf):S=Math.round(S));let D=Math.max(0,T+h);a==="height"&&(s?D=os(D,Pf):D=Math.round(D)),S=Math.max(Dr,S),D=Math.max(Dr,D),uP(S,D,T,A,M(E,_),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,E=b==null?void 0:b.original;if(y&&E&&Ol(y,a)){let _=Math.max(0,E.width+f);a==="width"&&(s?_=os(_,Pf):_=Math.round(_));let I=Math.max(0,E.height+h);if(a==="height"&&(s?I=os(I,Pf):I=Math.round(I)),_=Math.max(Dr,_),I=Math.max(Dr,I),Y0(_,I,y,E,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),_e(y)){const k=ha(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap());m.push(...k)}}}}l({elementsToHighlight:m}),o.triggerUpdate()},rTe=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&_e(o)){const a=ha(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Wg(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},fP=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=C.useMemo(()=>i.map(c=>{const d=W5(c,n);if(d.length>1){const[f,h,m,p]=Et(d.map(U=>U.latest));return Math.round((e==="width"?m-f:p-h)*100)/100}const[u]=d;return Math.round((e==="width"?u.latest.width:u.latest.height)*100)/100}),[n,i,e]),a=new Set(o).size===1?Math.round(o[0]*100)/100:"Mixed",l=o.length>0;return g(jl,{label:e==="width"?"W":"H",elements:t,dragInputCallback:sTe,value:a,editable:l,appState:r,property:e,scene:s,dragFinishedCallback:rTe})},hP=4,oTe=4,aTe=(e,t)=>e.reduce((n,i)=>{if(!i||mg(i))return n;if(he(i))return n.push(i),n;if(Ki(i)){const s=Ne(i,t);if(s)return n.push(s),n}return n},[]),lTe=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t.map(l=>r.get(l.id));let a;if(i){a=Math.max(Math.round(i),hP);for(const l of o)s.mutateElement(l,{fontSize:a}),fs(l,s.getContainerElement(l),s);s.triggerUpdate()}else{const l=t;for(let c=0;c<o.length;c++){const d=o[c],u=l[c],f=Math.round(u.fontSize),h=Math.round(e);let m=Math.max(f+h,hP);n&&(m=os(m,oTe)),s.mutateElement(d,{fontSize:m}),fs(d,s.getContainerElement(d),s)}s.triggerUpdate()}},cTe=({elements:e,scene:t,appState:n,property:i,elementsMap:s})=>{const r=aTe(e,s);if(!r.length)return null;const o=r.map(c=>Math.round(c.fontSize*10)/10),a=new Set(o).size===1?o[0]:"Mixed",l=o.length>0;return g(jl,{label:"F",icon:lE,elements:r,dragInputCallback:lTe,value:a,editable:l,scene:t,property:i,appState:n})},dTe=(e,t,n,i,s,r,o)=>{for(let a=0;a<i.length;a++){const l=i[a],[c,d]=[l.x+l.width/2,l.y+l.height/2],[u,f]=Z(M(l.x,l.y),M(c,d),l.angle),h=e==="x"?Math.round(u+t):u,m=e==="y"?Math.round(f+n):f;bp(h,m,l,r,o,s,!1)}},uTe=(e,t,n,i,s,r)=>{const o=s.getNonDeletedElementsMap(),[a,l,,]=Et(n),c=e-a,d=t-l;for(let u=0;u<n.length;u++){const f=n[u],h=o.get(f.id);if(h&&(!he(h)||!h.containerId)){const[m,p]=[h.x+h.width/2,h.y+h.height/2],[U,b]=Z(M(h.x,h.y),M(m,p),h.angle);bp(U+c,b+d,f,s,r,i,!1)}}},fTe=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldChangeByStepSize:i,nextValue:s,property:r,scene:o,originalAppState:a,app:l})=>{var h,m;const c=o.getNonDeletedElementsMap();if(s!==void 0){for(const p of hS(t,a)){const U=W5(p,c,n);if(U.length>1){const[b,y,,]=Et(U.map(I=>I.latest));uTe(r==="x"?s:b,r==="y"?s:y,U.map(I=>I.original),n,o,l.state)}else{const b=(h=U[0])==null?void 0:h.original,y=(m=U[0])==null?void 0:m.latest;if(b&&y&&Ol(y,r)){const[E,_]=[b.x+b.width/2,b.y+b.height/2],[I,k]=Z(M(b.x,b.y),M(E,_),b.angle);bp(r==="x"?s:I,r==="y"?s:k,b,o,l.state,n,!1)}}}o.triggerUpdate();return}const d=i?os(e,W_):e;dTe(r,r==="x"?d:0,r==="y"?d:0,t,n,o,l.state),o.triggerUpdate()},gP=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=C.useMemo(()=>i.map(l=>{const c=Object.keys(l).map(p=>n.get(p)).filter(p=>p!==void 0);if(c.length>1){const[p,U]=Et(c);return Math.round((e==="x"?p:U)*100)/100}const[d]=c,[u,f]=[d.x+d.width/2,d.y+d.height/2],[h,m]=Z(M(d.x,d.y),M(u,f),d.angle);return Math.round((e==="x"?h:m)*100)/100}),[i,n,e]),a=new Set(o).size===1?o[0]:"Mixed";return g(jl,{label:e==="x"?"X":"Y",elements:t,dragInputCallback:fTe,value:a,property:e,scene:s,appState:r})},hTe=({accumulatedChange:e,instantChange:t,originalElements:n,originalElementsMap:i,shouldChangeByStepSize:s,nextValue:r,property:o,scene:a,originalAppState:l,app:c})=>{const d=a.getNonDeletedElementsMap(),u=n[0],[f,h]=[u.x+u.width/2,u.y+u.height/2],[m,p]=Z(M(u.x,u.y),M(f,h),u.angle);if(l.croppingElementId===u.id){const _=d.get(u.id);if(!_||!xt(_)||!_.crop)return;const I=_.crop;let k=I;const w=_.scale[0]===-1,T=_.scale[1]===-1,{width:A,height:S}=ya(_);if(r!==void 0){if(o==="x"){const L=r*(I.naturalWidth/A);w?k={...I,x:Ke(I.naturalWidth-L-I.width,0,I.naturalWidth-I.width)}:k={...I,x:Ke(r*(I.naturalWidth/A),0,I.naturalWidth-I.width)}}o==="y"&&(k={...I,y:Ke(r*(I.naturalHeight/S),0,I.naturalHeight-I.height)}),a.mutateElement(_,{crop:k});return}const D=(o==="x"?t:0)*(w?-1:1),N=(o==="y"?t:0)*(T?-1:1);k={...I,x:Ke(I.x+D,0,I.naturalWidth-I.width),y:Ke(I.y+N,0,I.naturalHeight-I.height)},a.mutateElement(_,{crop:k});return}if(r!==void 0){bp(o==="x"?r:m,o==="y"?r:p,u,a,c.state,i);return}const U=o==="x"?e:0,b=o==="y"?e:0,y=o==="x"?Math.round(s?os(u.x+U,W_):m+U):m,E=o==="y"?Math.round(s?os(u.y+b,W_):p+b):p;bp(y,E,u,a,c.state,i)},mP=({property:e,element:t,elementsMap:n,scene:i,appState:s})=>{const[r,o]=Z(M(t.x,t.y),M(t.x+t.width/2,t.y+t.height/2),t.angle);let a=Ul(e==="x"?r:o,2);if(s.croppingElementId===t.id&&xt(t)&&t.crop){const l=rde(t);l&&(a=Ul(e==="x"?l.x:l.y,2))}return g(jl,{label:e==="x"?"X":"Y",elements:[t],dragInputCallback:hTe,scene:i,value:a,property:e,appState:s})},gTe=50,tl=e=>{const t=S2(),n=e.app.scene.getSceneNonce()||1,i=e.app.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}),s=pp(e.app);return g(mTe,{...e,appState:t,sceneNonce:n,selectedElements:i,gridModeEnabled:s})},en=({children:e,columns:t=1,heading:n,style:i,...s})=>g("div",{className:ae("exc-stats__row",{"exc-stats__row--heading":n}),style:{gridTemplateColumns:`repeat(${t}, 1fr)`,...i},...s,children:e});en.displayName="StatsRow";const K5=({children:e,order:t,style:n,...i})=>g("div",{className:"exc-stats__rows",style:{order:t,...n},...i,children:e});K5.displayName="StatsRows";tl.StatsRow=en;tl.StatsRows=K5;const mTe=C.memo(({app:e,onClose:t,renderCustomStats:n,selectedElements:i,appState:s,sceneNonce:r,gridModeEnabled:o})=>{const a=e.scene,l=a.getNonDeletedElements(),c=a.getNonDeletedElementsMap(),d=On(),u=i.length===1?i[0]:null,f=i.length>1?i:null,h=s.croppingElementId&&xt(u),m=h?ya(u):null,[p,U]=C.useState({width:0,height:0}),b=C.useMemo(()=>na(_=>{const I=Et(_);U({width:Math.round(I[2])-Math.round(I[0]),height:Math.round(I[3])-Math.round(I[1])})},gTe),[]);C.useEffect(()=>{b(l)},[r,l,b]),C.useEffect(()=>()=>b.cancel(),[b]);const y=C.useMemo(()=>hS(i,s),[i,s]),E=C.useMemo(()=>bV(i),[i]);return g("div",{className:"exc-stats",children:P(fr,{padding:3,children:[P("div",{className:"title",children:[g("h2",{children:x("stats.title")}),g("div",{className:"close",onClick:t,children:lf})]}),P(T_,{label:g("h3",{children:x("stats.generalStats")}),open:!!(s.stats.panels&uh.generalStats),openTrigger:()=>d(_=>({stats:{open:!0,panels:_.stats.panels^uh.generalStats}})),children:[P(K5,{children:[g(en,{heading:!0,children:x("stats.scene")}),P(en,{columns:2,children:[g("div",{children:x("stats.shapes")}),g("div",{children:l.length})]}),P(en,{columns:2,children:[g("div",{children:x("stats.width")}),g("div",{children:p.width})]}),P(en,{columns:2,children:[g("div",{children:x("stats.height")}),g("div",{children:p.height})]}),o&&P(fe,{children:[g(en,{heading:!0,children:"Canvas"}),g(en,{children:g(j9e,{property:"gridStep",scene:a,appState:s,setAppState:d})})]})]}),n==null?void 0:n(l,s)]}),!E&&i.length>0&&g("div",{id:"elementStats",style:{marginTop:12},children:g(T_,{label:g("h3",{children:x("stats.elementProperties")}),open:!!(s.stats.panels&uh.elementProperties),openTrigger:()=>d(_=>({stats:{open:!0,panels:_.stats.panels^uh.elementProperties}})),children:P(K5,{children:[u&&P(fe,{children:[h&&g(en,{heading:!0,children:x("labels.unCroppedDimension")}),s.croppingElementId&&xt(u)&&m&&P(en,{columns:2,children:[g("div",{children:x("stats.width")}),g("div",{children:Ul(m.width,2)})]}),s.croppingElementId&&xt(u)&&m&&P(en,{columns:2,children:[g("div",{children:x("stats.height")}),g("div",{children:Ul(m.height,2)})]}),g(en,{heading:!0,"data-testid":"stats-element-type",style:{margin:"0.3125rem 0"},children:s.croppingElementId?x("labels.imageCropping"):x(`element.${u.type}`)}),g(en,{children:g(mP,{element:u,property:"x",elementsMap:c,scene:a,appState:s})}),g(en,{children:g(mP,{element:u,property:"y",elementsMap:c,scene:a,appState:s})}),g(en,{children:g(cP,{property:"width",element:u,scene:a,appState:s})}),g(en,{children:g(cP,{property:"height",element:u,scene:a,appState:s})}),g(en,{children:g(X9e,{property:"angle",element:u,scene:a,appState:s})}),g(en,{children:g(Q9e,{property:"fontSize",element:u,scene:a,appState:s})})]}),f&&P(fe,{children:[UT(f)&&g(en,{heading:!0,children:x("element.group")}),P(en,{columns:2,style:{margin:"0.3125rem 0"},children:[g("div",{children:x("stats.shapes")}),g("div",{children:i.length})]}),g(en,{children:g(gP,{property:"x",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(en,{children:g(gP,{property:"y",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(en,{children:g(fP,{property:"width",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(en,{children:g(fP,{property:"height",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(en,{children:g(tTe,{property:"angle",elements:f,scene:a,appState:s})}),g(en,{children:g(cTe,{property:"fontSize",elements:f,scene:a,appState:s,elementsMap:c})})]})]})})})]})})},(e,t)=>e.sceneNonce===t.sceneNonce&&e.selectedElements===t.selectedElements&&e.appState.stats.panels===t.appState.stats.panels&&e.gridModeEnabled===t.gridModeEnabled&&e.appState.gridStep===t.appState.gridStep&&e.appState.croppingElementId===t.appState.croppingElementId),pTe=({sourceElementId:e,onClose:t,appState:n,scene:i,generateLinkForSelection:s=LV})=>{var f;const r=i.getNonDeletedElementsMap(),o=((f=r.get(e))==null?void 0:f.link)??null,[a,l]=C.useState(o),[c,d]=C.useState(!1);C.useEffect(()=>{const h=Ze(r,n);let m=o;if(h.length>0&&s){const p=PV(h,n);p&&(m=Ur(s(p.id,p.type)))}l(m)},[r,n,n.selectedElementIds,o,s]);const u=C.useCallback(()=>{var h;if(a&&a!==((h=r.get(e))==null?void 0:h.link)){const m=r.get(e);m&&i.mutateElement(m,{link:a})}if(!a&&c&&e){const m=r.get(e);m&&i.mutateElement(m,{link:null})}t==null||t()},[e,a,r,c,i,t]);return C.useEffect(()=>{const h=m=>{var p,U;((p=n.openDialog)==null?void 0:p.name)==="elementLinkSelector"&&m.key===$.ENTER&&u(),((U=n.openDialog)==null?void 0:U.name)==="elementLinkSelector"&&m.key===$.ESCAPE&&(t==null||t())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[n,t,u]),P("div",{className:"ElementLinkDialog",children:[P("div",{className:"ElementLinkDialog__header",children:[g("h2",{children:x("elementLink.title")}),g("p",{children:x("elementLink.desc")})]}),P("div",{className:"ElementLinkDialog__input",children:[g(Xu,{value:a??"",onChange:h=>{c||d(!0),l(h)},onKeyDown:h=>{h.key===$.ENTER&&u()},className:"ElementLinkDialog__input-field",selectOnRender:!0}),o&&a&&g(qe,{type:"button",title:x("buttons.remove"),"aria-label":x("buttons.remove"),label:x("buttons.remove"),onClick:()=>{l(null),d(!0)},className:"ElementLinkDialog__remove",icon:Ia})]}),P("div",{className:"ElementLinkDialog__actions",children:[g(Ig,{label:x("buttons.cancel"),onClick:()=>{t==null||t()},style:{marginRight:10}}),g(Ig,{label:x("buttons.confirm"),onClick:u,actionType:"primary"})]})]})},gS=({children:e,onClose:t})=>{const[n,i]=C.useState(!!e),{container:s}=Ws(),r=de.useCallback(()=>{i(!1),t&&t(),s==null||s.focus()},[t,s]);return g(fe,{children:n&&g(Tr,{size:"small",onCloseRequest:r,title:x("errorDialog.title"),children:g("div",{style:{whiteSpace:"pre-wrap"},children:e})})})},UTe=()=>P("div",{className:"HelpDialog__header",children:[P("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:yR}),x("helpDialog.documentation")]}),P("a",{className:"HelpDialog__btn",href:"https://plus.excalidraw.com/blog",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:yR}),x("helpDialog.blog")]}),P("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:KT}),x("helpDialog.github")]}),P("a",{className:"HelpDialog__btn",href:"https://youtube.com/@excalidraw",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:yG}),"YouTube"]})]}),bTe=e=>P(fe,{children:[g("h3",{children:e.title}),g("div",{className:"HelpDialog__islands-container",children:e.children})]}),X7=e=>P("div",{className:`HelpDialog__island ${e.className}`,children:[g("h4",{className:"HelpDialog__island-title",children:e.caption}),g("div",{className:"HelpDialog__island-content",children:e.children})]});function*yTe(e,t){let n=!0;for(const i of e)n||(yield t),n=!1,yield i}const ETe=e=>e.replace(/\b[a-z]\b/,t=>t.toUpperCase()),pe=({label:e,shortcuts:t,isOr:n=!0})=>{const i=t.map(s=>(s.endsWith("++")?[...s.slice(0,-2).split("+"),"+"]:s.split("+")).map(o=>g(vTe,{children:ETe(o)},o)));return P("div",{className:"HelpDialog__shortcut",children:[g("div",{children:e}),g("div",{className:"HelpDialog__key-container",children:[...yTe(i,n?x("helpDialog.or"):null)]})]})},vTe=e=>g("kbd",{className:"HelpDialog__key",...e}),_Te=({onClose:e})=>{const t=de.useCallback(()=>{e&&e()},[e]);return g(fe,{children:P(Tr,{onCloseRequest:t,title:x("helpDialog.title"),className:"HelpDialog",children:[g(UTe,{}),P(bTe,{title:x("helpDialog.shortcuts"),children:[P(X7,{className:"HelpDialog__island--tools",caption:x("helpDialog.tools"),children:[g(pe,{label:x("toolBar.hand"),shortcuts:[$.H]}),g(pe,{label:x("toolBar.selection"),shortcuts:[$.V,$[1]]}),g(pe,{label:x("toolBar.rectangle"),shortcuts:[$.R,$[2]]}),g(pe,{label:x("toolBar.diamond"),shortcuts:[$.D,$[3]]}),g(pe,{label:x("toolBar.ellipse"),shortcuts:[$.O,$[4]]}),g(pe,{label:x("toolBar.arrow"),shortcuts:[$.A,$[5]]}),g(pe,{label:x("toolBar.line"),shortcuts:[$.L,$[6]]}),g(pe,{label:x("toolBar.freedraw"),shortcuts:[$.P,$[7]]}),g(pe,{label:x("toolBar.text"),shortcuts:[$.T,$[8]]}),g(pe,{label:x("toolBar.image"),shortcuts:[$[9]]}),g(pe,{label:x("toolBar.eraser"),shortcuts:[$.E,$[0]]}),g(pe,{label:x("toolBar.frame"),shortcuts:[$.F]}),g(pe,{label:x("toolBar.laser"),shortcuts:[$.K]}),g(pe,{label:x("labels.eyeDropper"),shortcuts:[$.I,"Shift+S","Shift+G"]}),g(pe,{label:x("helpDialog.editLineArrowPoints"),shortcuts:[J("CtrlOrCmd+Enter")]}),g(pe,{label:x("helpDialog.editText"),shortcuts:[J("Enter")]}),g(pe,{label:x("helpDialog.textNewLine"),shortcuts:[J("Enter"),J("Shift+Enter")]}),g(pe,{label:x("helpDialog.textFinish"),shortcuts:[J("Esc"),J("CtrlOrCmd+Enter")]}),g(pe,{label:x("helpDialog.curvedArrow"),shortcuts:["A",x("helpDialog.click"),x("helpDialog.click"),x("helpDialog.click")],isOr:!1}),g(pe,{label:x("helpDialog.curvedLine"),shortcuts:["L",x("helpDialog.click"),x("helpDialog.click"),x("helpDialog.click")],isOr:!1}),g(pe,{label:x("helpDialog.cropStart"),shortcuts:[x("helpDialog.doubleClick"),J("Enter")],isOr:!0}),g(pe,{label:x("helpDialog.cropFinish"),shortcuts:[J("Enter"),J("Escape")],isOr:!0}),g(pe,{label:x("toolBar.lock"),shortcuts:[$.Q]}),g(pe,{label:x("helpDialog.preventBinding"),shortcuts:[J("CtrlOrCmd")]}),g(pe,{label:x("toolBar.link"),shortcuts:[J("CtrlOrCmd+K")]}),g(pe,{label:x("toolBar.convertElementType"),shortcuts:["Tab","Shift+Tab"],isOr:!0})]}),P(X7,{className:"HelpDialog__island--view",caption:x("helpDialog.view"),children:[g(pe,{label:x("buttons.zoomIn"),shortcuts:[J("CtrlOrCmd++")]}),g(pe,{label:x("buttons.zoomOut"),shortcuts:[J("CtrlOrCmd+-")]}),g(pe,{label:x("buttons.resetZoom"),shortcuts:[J("CtrlOrCmd+0")]}),g(pe,{label:x("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),g(pe,{label:x("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),g(pe,{label:x("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),g(pe,{label:x("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),g(pe,{label:x("buttons.zenMode"),shortcuts:[J("Alt+Z")]}),g(pe,{label:x("buttons.objectsSnapMode"),shortcuts:[J("Alt+S")]}),g(pe,{label:x("labels.toggleGrid"),shortcuts:[J("CtrlOrCmd+'")]}),g(pe,{label:x("labels.viewMode"),shortcuts:[J("Alt+R")]}),g(pe,{label:x("labels.toggleTheme"),shortcuts:[J("Alt+Shift+D")]}),g(pe,{label:x("stats.fullTitle"),shortcuts:[J("Alt+/")]}),g(pe,{label:x("search.title"),shortcuts:[Ln("searchMenu")]}),g(pe,{label:x("commandPalette.title"),shortcuts:z0?[Ln("commandPalette")]:[Ln("commandPalette"),Ln("commandPalette",1)]})]}),P(X7,{className:"HelpDialog__island--editor",caption:x("helpDialog.editor"),children:[g(pe,{label:x("helpDialog.createFlowchart"),shortcuts:[J("CtrlOrCmd+Arrow Key")],isOr:!0}),g(pe,{label:x("helpDialog.navigateFlowchart"),shortcuts:[J("Alt+Arrow Key")],isOr:!0}),g(pe,{label:x("labels.moveCanvas"),shortcuts:[J(`Space+${x("helpDialog.drag")}`),J(`Wheel+${x("helpDialog.drag")}`)],isOr:!0}),g(pe,{label:x("buttons.clearReset"),shortcuts:[J("CtrlOrCmd+Delete")]}),g(pe,{label:x("labels.delete"),shortcuts:[J("Delete")]}),g(pe,{label:x("labels.cut"),shortcuts:[J("CtrlOrCmd+X")]}),g(pe,{label:x("labels.copy"),shortcuts:[J("CtrlOrCmd+C")]}),g(pe,{label:x("labels.paste"),shortcuts:[J("CtrlOrCmd+V")]}),g(pe,{label:x("labels.pasteAsPlaintext"),shortcuts:[J("CtrlOrCmd+Shift+V")]}),g(pe,{label:x("labels.selectAll"),shortcuts:[J("CtrlOrCmd+A")]}),g(pe,{label:x("labels.multiSelect"),shortcuts:[J(`Shift+${x("helpDialog.click")}`)]}),g(pe,{label:x("helpDialog.deepSelect"),shortcuts:[J(`CtrlOrCmd+${x("helpDialog.click")}`)]}),g(pe,{label:x("helpDialog.deepBoxSelect"),shortcuts:[J(`CtrlOrCmd+${x("helpDialog.drag")}`)]}),(QI||z0)&&g(pe,{label:x("labels.copyAsPng"),shortcuts:[J("Shift+Alt+C")]}),g(pe,{label:x("labels.copyStyles"),shortcuts:[J("CtrlOrCmd+Alt+C")]}),g(pe,{label:x("labels.pasteStyles"),shortcuts:[J("CtrlOrCmd+Alt+V")]}),g(pe,{label:x("labels.sendToBack"),shortcuts:[J(Ao?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),g(pe,{label:x("labels.bringToFront"),shortcuts:[J(Ao?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),g(pe,{label:x("labels.sendBackward"),shortcuts:[J("CtrlOrCmd+[")]}),g(pe,{label:x("labels.bringForward"),shortcuts:[J("CtrlOrCmd+]")]}),g(pe,{label:x("labels.alignTop"),shortcuts:[J("CtrlOrCmd+Shift+Up")]}),g(pe,{label:x("labels.alignBottom"),shortcuts:[J("CtrlOrCmd+Shift+Down")]}),g(pe,{label:x("labels.alignLeft"),shortcuts:[J("CtrlOrCmd+Shift+Left")]}),g(pe,{label:x("labels.alignRight"),shortcuts:[J("CtrlOrCmd+Shift+Right")]}),g(pe,{label:x("labels.duplicateSelection"),shortcuts:[J("CtrlOrCmd+D"),J(`Alt+${x("helpDialog.drag")}`)]}),g(pe,{label:x("helpDialog.toggleElementLock"),shortcuts:[J("CtrlOrCmd+Shift+L")]}),g(pe,{label:x("buttons.undo"),shortcuts:[J("CtrlOrCmd+Z")]}),g(pe,{label:x("buttons.redo"),shortcuts:Iz?[J("CtrlOrCmd+Y"),J("CtrlOrCmd+Shift+Z")]:[J("CtrlOrCmd+Shift+Z")]}),g(pe,{label:x("labels.group"),shortcuts:[J("CtrlOrCmd+G")]}),g(pe,{label:x("labels.ungroup"),shortcuts:[J("CtrlOrCmd+Shift+G")]}),g(pe,{label:x("labels.flipHorizontal"),shortcuts:[J("Shift+H")]}),g(pe,{label:x("labels.flipVertical"),shortcuts:[J("Shift+V")]}),g(pe,{label:x("labels.showStroke"),shortcuts:[J("S")]}),g(pe,{label:x("labels.showBackground"),shortcuts:[J("G")]}),g(pe,{label:x("labels.showFonts"),shortcuts:[J("Shift+F")]}),g(pe,{label:x("labels.decreaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+<")]}),g(pe,{label:x("labels.increaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+>")]})]})]})]})})},Rt=e=>Array.isArray(e)?`<kbd>${e.map(J).join(" + ")}</kbd>`:`<kbd>${J(e)}</kbd>`,wTe=({appState:e,isMobile:t,editorInterface:n,app:i})=>{var d,u,f,h,m,p;const{activeTool:s,isResizing:r,isRotating:o,lastPointerDownWith:a}=e,l=e.multiElement!==null;if(((d=e.openSidebar)==null?void 0:d.name)===Yr.name&&e.openSidebar.tab===pu&&((u=e.searchMatches)!=null&&u.matches.length))return x("hints.dismissSearch",{shortcut:Rt("Escape")});if(e.openSidebar&&!n.canFitSidebar)return null;if(Yo(e))return x("hints.eraserRevert",{shortcut:Rt("Alt")});const c=i.scene.getSelectedElements(e);if((f=e.selectedLinearElement)!=null&&f.isDragging&&((h=c[0])==null?void 0:h.type)==="arrow")return x("hints.arrowBindModifiers",{shortcut_1:Rt("Ctrl"),shortcut_2:Rt("Alt")});if(s.type==="arrow"||s.type==="line")return l?x("hints.linearElementMulti",{shortcut_1:Rt("Escape"),shortcut_2:Rt("Enter")}):s.type==="arrow"?x("hints.arrowTool",{shortcut:Rt("A")}):x("hints.linearElement");if(s.type==="freedraw")return x("hints.freeDraw");if(s.type==="text")return x("hints.text");if(s.type==="embeddable")return x("hints.embeddable");if(r&&a==="mouse"&&c.length===1){const U=c[0];return De(U)&&U.points.length===2?x("hints.lockAngle",{shortcut:Rt("Shift")}):xt(U)?x("hints.resizeImage",{shortcut_1:Rt("Shift"),shortcut_2:Rt("Alt")}):x("hints.resize",{shortcut_1:Rt("Shift"),shortcut_2:Rt("Alt")})}if(o&&a==="mouse")return x("hints.rotate",{shortcut:Rt("Shift")});if(c.length===1&&he(c[0]))return x("hints.text_selected",{shortcut:Rt("Enter")});if(e.editingTextElement)return x("hints.text_editing",{shortcut_1:Rt("Escape"),shortcut_2:Rt(["CtrlOrCmd","Enter"])});if(e.croppingElementId)return x("hints.leaveCropEditor",{shortcut_1:Rt("Enter"),shortcut_2:Rt("Escape")});if(c.length===1&&xt(c[0]))return x("hints.enterCropEditor",{shortcut:Rt("Enter")});if(s.type==="selection"){if(e.selectionElement&&!c.length&&!e.editingTextElement&&!((m=e.selectedLinearElement)!=null&&m.isEditing))return x("hints.deepBoxSelect",{shortcut:Rt("CtrlOrCmd")});if(pp(i)&&e.selectedElementsAreBeingDragged)return x("hints.disableSnapping",{shortcut:Rt("CtrlOrCmd")});if(!c.length&&!t)return x("hints.canvasPanning",{shortcut_1:Rt(x("keys.mmb")),shortcut_2:Rt("Space")});if(c.length===1){if(De(c[0]))return(p=e.selectedLinearElement)!=null&&p.isEditing?e.selectedLinearElement.selectedPointsIndices?x("hints.lineEditor_pointSelected",{shortcut_1:Rt("Delete"),shortcut_2:Rt(["CtrlOrCmd","D"])}):x("hints.lineEditor_nothingSelected",{shortcut_1:Rt("Shift"),shortcut_2:Rt("Alt")}):cn(c[0])?x("hints.lineEditor_line_info",{shortcut:Rt("Enter")}):x("hints.lineEditor_info",{shortcut_1:Rt("CtrlOrCmd"),shortcut_2:Rt(["CtrlOrCmd","Enter"])});if(!e.newElement&&!e.selectedElementsAreBeingDragged&&bu(c[0])){const U=x("hints.bindTextToElement",{shortcut:Rt("Enter")}),b=x("hints.createFlowchart",{shortcut:Rt(["CtrlOrCmd",""])});return Wy(c[0])?Yfe(c[0],i.scene.getNonDeletedElementsMap())?[U,b]:[U,b]:U}}}return null},TTe=({appState:e,isMobile:t,editorInterface:n,app:i})=>{const s=wTe({appState:e,isMobile:t,editorInterface:n,app:i});if(!s)return null;const o=(Array.isArray(s)?s.map(a=>a.replace(/\. ?$/,"")).join(", "):s).split(/(<kbd>[^<]+<\/kbd>)/g).map((a,l)=>{if(l%2===1){const c=a[0]==="<"&&a.match(/^<kbd>([^<]+)<\/kbd>$/);return g("kbd",{children:c?c[1]:a},l)}return a});return g("div",{className:"HintViewer",children:g("span",{children:o})})},ITe=2e3,mS=()=>{const[e,t]=C.useState(null),n=C.useRef(0),i=()=>{clearTimeout(n.current),t("success"),n.current=window.setTimeout(()=>{t(null)},ITe)},s=C.useCallback(()=>{t(null)},[]);return{copyStatus:e,resetCopyStatus:s,onCopy:i}},qU=({title:e,name:t,checked:n,onChange:i,disabled:s=!1})=>g("div",{className:ae("Switch",{toggled:n,disabled:s}),children:g("input",{name:t,id:t,title:e,type:"checkbox",checked:n,disabled:s,onChange:()=>i(!n),onKeyDown:r=>{r.key===" "&&i(!n)}})}),STe=()=>P("div",{children:[g("h3",{children:x("canvasError.cannotShowPreview")}),g("p",{children:g("span",{children:x("canvasError.canvasTooBig")})}),P("em",{children:["(",x("canvasError.canvasTooBigTip"),")"]})]}),CTe=({appStateSnapshot:e,elementsSnapshot:t,files:n,actionManager:i,onExportImage:s,name:r})=>{const o=oi(t,e),[a,l]=C.useState(r),[c,d]=C.useState(o),[u,f]=C.useState(e.exportBackground),[h,m]=C.useState(e.exportWithDarkMode),[p,U]=C.useState(e.exportEmbedScene),[b,y]=C.useState(e.exportScale),E=C.useRef(null),[_,I]=C.useState(null),{onCopy:k,copyStatus:w,resetCopyStatus:T}=mS();C.useEffect(()=>{T()},[a,u,h,b,p,T]);const{exportedElements:A,exportingFrame:S}=VE(t,e,c);return C.useEffect(()=>{const D=E.current;if(!D)return;const N=D.offsetWidth,L=D.offsetHeight;N&&YE({elements:A,appState:{...e,name:a,exportBackground:u,exportWithDarkMode:h,exportScale:b,exportEmbedScene:p},files:n,exportPadding:$g,maxWidthOrHeight:Math.max(N,L),exportingFrame:S}).then(j=>(I(null),k5(j).then(()=>{D.replaceChildren(j)}).catch(Y=>{throw Y.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(x("canvasError.canvasTooBig")):Y}))).catch(j=>{console.error(j),I(j)})},[e,n,A,S,a,u,h,b,p]),P("div",{className:"ImageExportModal",children:[g("h3",{children:x("imageExportDialog.header")}),P("div",{className:"ImageExportModal__preview",children:[g("div",{className:"ImageExportModal__preview__canvas",ref:E,children:_&&g(STe,{})}),g("div",{className:"ImageExportModal__preview__filename",children:!gf&&g("input",{type:"text",className:"TextInput",value:a,style:{width:"30ch"},onChange:D=>{l(D.target.value),i.executeAction($7e,"ui",D.target.value)}})})]}),P("div",{className:"ImageExportModal__settings",children:[g("h3",{children:x("imageExportDialog.header")}),o&&g(Wm,{label:x("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:g(qU,{name:"exportOnlySelected",checked:c,onChange:D=>{d(D)}})}),g(Wm,{label:x("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:g(qU,{name:"exportBackgroundSwitch",checked:u,onChange:D=>{f(D),i.executeAction(X7e,"ui",D)}})}),g(Wm,{label:x("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:g(qU,{name:"exportDarkModeSwitch",checked:h,onChange:D=>{m(D),i.executeAction(j7e,"ui",D)}})}),g(Wm,{label:x("imageExportDialog.label.embedScene"),tooltip:x("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:g(qU,{name:"exportEmbedSwitch",checked:p,onChange:D=>{U(D),i.executeAction(iW,"ui",D)}})}),g(Wm,{label:x("imageExportDialog.label.scale"),name:"exportScale",children:g(mK,{name:"exportScale",value:b,onChange:D=>{y(D),i.executeAction(G7e,"ui",D)},choices:A9.map(D=>({value:D,label:`${D}`}))})}),P("div",{className:"ImageExportModal__settings__buttons",children:[g($s,{className:"ImageExportModal__settings__buttons__button",label:x("imageExportDialog.title.exportToPng"),onClick:()=>s(y3.png,A,{exportingFrame:S}),icon:LR,children:x("imageExportDialog.button.exportToPng")}),g($s,{className:"ImageExportModal__settings__buttons__button",label:x("imageExportDialog.title.exportToSvg"),onClick:()=>s(y3.svg,A,{exportingFrame:S}),icon:LR,children:x("imageExportDialog.button.exportToSvg")}),(QI||z0)&&g($s,{className:"ImageExportModal__settings__buttons__button",label:x("imageExportDialog.title.copyPngToClipboard"),status:w,onClick:async()=>{await s(y3.clipboard,A,{exportingFrame:S}),k()},icon:f2,children:x("imageExportDialog.button.copyPngToClipboard")})]})]})]})},Wm=({label:e,children:t,tooltip:n,name:i})=>P("div",{className:"ImageExportModal__settings__setting",title:e,children:[P("label",{htmlFor:i,className:"ImageExportModal__settings__setting__label",children:[e,n&&g(Nl,{label:n,long:!0,children:Jge})]}),g("div",{className:"ImageExportModal__settings__setting__content",children:t})]}),xTe=({elements:e,appState:t,files:n,actionManager:i,onExportImage:s,onCloseRequest:r,name:o})=>{const[{appStateSnapshot:a,elementsSnapshot:l}]=C.useState(()=>({appStateSnapshot:ua(t),elementsSnapshot:ua(e)}));return g(Tr,{onCloseRequest:r,size:"wide",title:!1,children:g(CTe,{elementsSnapshot:l,appStateSnapshot:a,files:n,actionManager:i,onExportImage:s,name:o})})},j7={primary:{base:"var(--color-primary)",darker:"var(--color-primary-darker)",darkest:"var(--color-primary-darkest)"},lime:{base:"#74b816",darker:"#66a80f",darkest:"#5c940d"},pink:{base:"#d6336c",darker:"#c2255c",darkest:"#a61e4d"}},K_=({children:e,color:t})=>g("div",{className:"Card",style:{"--card-color":j7[t].base,"--card-color-darker":j7[t].darker,"--card-color-darkest":j7[t].darkest},children:e}),ATe=({elements:e,appState:t,setAppState:n,files:i,actionManager:s,exportOpts:r,canvas:o,onCloseRequest:a})=>{const{onExportToBackend:l}=r;return g("div",{className:"ExportDialog ExportDialog--json",children:P("div",{className:"ExportDialog-cards",children:[r.saveFileToDisk&&P(K_,{color:"lime",children:[g("div",{className:"Card-icon",children:rge}),g("h2",{children:x("exportDialog.disk_title")}),P("div",{className:"Card-details",children:[x("exportDialog.disk_details"),!gf&&s.renderAction("changeProjectName")]}),g(qe,{className:"Card-button",type:"button",title:x("exportDialog.disk_button"),"aria-label":x("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{s.executeAction(sW,"ui")}})]}),l&&P(K_,{color:"pink",children:[g("div",{className:"Card-icon",children:m5}),g("h2",{children:x("exportDialog.link_title")}),g("div",{className:"Card-details",children:x("exportDialog.link_details")}),g(qe,{className:"Card-button",type:"button",title:x("exportDialog.link_button"),"aria-label":x("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{at("export","link",`ui (${Yp()})`),await l(e,t,i),a()}catch(c){n({errorMessage:c.message})}}})]}),r.renderCustomUI&&r.renderCustomUI(e,t,i,o)]})})},MTe=({elements:e,appState:t,files:n,actionManager:i,exportOpts:s,canvas:r,setAppState:o})=>{var l;const a=de.useCallback(()=>{o({openDialog:null})},[o]);return g(fe,{children:((l=t.openDialog)==null?void 0:l.name)==="jsonExport"&&g(Tr,{onCloseRequest:a,title:x("buttons.export"),children:g(ATe,{elements:e,appState:t,setAppState:o,files:n,actionManager:i,onCloseRequest:a,exportOpts:s,canvas:r})})})},kTe="small",RTe=e=>P("label",{className:ae("ToolIcon ToolIcon__LaserPointer",`ToolIcon_size_${kTe}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-LaserPointer"}),g("div",{className:"ToolIcon__icon",children:Z0})]}),DTe=({UIOptions:e})=>P(Ct,{__fallback:!0,children:[g(Ct.DefaultItems.LoadScene,{}),g(Ct.DefaultItems.SaveToActiveFile,{}),e.canvasActions.export&&g(Ct.DefaultItems.Export,{}),e.canvasActions.saveAsImage&&g(Ct.DefaultItems.SaveAsImage,{}),g(Ct.DefaultItems.SearchMenu,{}),g(Ct.DefaultItems.Help,{}),g(Ct.DefaultItems.ClearCanvas,{}),g(Ct.Separator,{}),g(Ct.Group,{title:"Excalidraw links",children:g(Ct.DefaultItems.Socials,{})}),g(Ct.Separator,{}),g(Ct.DefaultItems.ToggleTheme,{}),g(Ct.DefaultItems.ChangeCanvasBackground,{})]}),LTe=()=>P(lu,{__fallback:!0,children:[g(lu.Actions.SaveToDisk,{}),g(lu.Actions.ExportToImage,{})]}),PTe=({actionManager:e,appState:t,files:n,setAppState:i,elements:s,canvas:r,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,showExitZenModeBtn:c,renderTopLeftUI:d,renderTopRightUI:u,renderCustomStats:f,UIOptions:h,onExportImage:m,renderWelcomeScreen:p,children:U,app:b,isCollaborating:y,generateLinkForSelection:E})=>{var X,Q,re;const _=Nn(),k=Na()==="compact",w=v_e(),T=k?{menuTopGap:4,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:.5,islandPadding:1,collabMarginLeft:8}:{menuTopGap:6,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:1,islandPadding:1,collabMarginLeft:8},A=w.tunnelsJotai.Provider,[S,D]=dt(wE),N=()=>h.canvasActions.export?g(MTe,{elements:s,appState:t,files:n,actionManager:e,exportOpts:h.canvasActions.export,canvas:r,setAppState:i}):null,L=()=>{var ie;return!h.canvasActions.saveAsImage||((ie=t.openDialog)==null?void 0:ie.name)!=="imageExport"?null:g(xTe,{elements:s,appState:t,files:n,actionManager:e,onExportImage:m,onCloseRequest:()=>i({openDialog:null}),name:b.getName()})},j=()=>P("div",{style:{position:"relative"},children:[g(w.MainMenuTunnel.Out,{}),p&&g(w.WelcomeScreenMenuHintTunnel.Out,{})]}),Y=()=>{const ie=k;return g(H_,{heading:"selectedShapeActions",className:ae("selected-shape-actions zen-mode-transition",{"transition-left":t.zenModeEnabled}),children:ie?g(fr,{className:ae("compact-shape-actions-island"),padding:0,style:{maxHeight:`${t.height-166}px`},children:g(T_e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b,setAppState:i})}):g(fr,{className:Wi.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${t.height-166}px`},children:g(__e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b})})})},G=()=>{var ke,ye,Ae,$e,et;const ie=yhe(t,s),me=t.stats.open&&!t.zenModeEnabled&&!t.viewModeEnabled&&((ke=t.openDialog)==null?void 0:ke.name)!=="elementLinkSelector";return g(nK,{side:"top",children:P("div",{className:"App-menu App-menu_top",children:[P(oa.Col,{gap:T.menuTopGap,className:ae("App-menu_top__left"),children:[j(),g("div",{className:ae("selected-shape-actions-container",{"selected-shape-actions-container--compact":k}),children:ie&&Y()})]}),!t.viewModeEnabled&&((ye=t.openDialog)==null?void 0:ye.name)!=="elementLinkSelector"&&g(H_,{heading:"shapes",className:"shapes-section",children:Be=>P("div",{style:{position:"relative"},children:[p&&g(w.WelcomeScreenToolbarHintTunnel.Out,{}),g(oa.Col,{gap:T.toolbarColGap,align:"start",children:P(oa.Row,{gap:T.toolbarRowGap,className:ae("App-toolbar-container",{"zen-mode":t.zenModeEnabled}),children:[P(fr,{padding:T.islandPadding,className:ae("App-toolbar",{"zen-mode":t.zenModeEnabled,"App-toolbar--compact":k}),children:[g(TTe,{appState:t,isMobile:_.formFactor==="phone",editorInterface:_,app:b}),Be,P(oa.Row,{gap:T.toolbarInnerRowGap,children:[g(iK,{zenModeEnabled:t.zenModeEnabled,checked:t.penMode,onChange:()=>l(null),title:x("toolBar.penMode"),penDetected:t.penDetected}),g(Awe,{checked:t.activeTool.locked,onChange:o,title:x("toolBar.lock")}),g("div",{className:"App-toolbar__divider"}),g(tK,{checked:_g(t),onChange:()=>a(),title:x("toolBar.hand"),isMobile:!0}),g(S_e,{setAppState:i,activeTool:t.activeTool,UIOptions:h,app:b})]})]}),y&&g(fr,{style:{marginLeft:T.collabMarginLeft,alignSelf:"center",height:"fit-content"},children:g(RTe,{title:x("toolBar.laser"),checked:t.activeTool.type===ui.laser,onChange:()=>b.setActiveTool({type:ui.laser}),isMobile:!0})})]})})]})}),P("div",{className:ae("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":t.zenModeEnabled,"layer-ui__wrapper__top-right--compact":k}),children:[t.collaborators.size>0&&g(sK,{collaborators:t.collaborators,userToFollow:((Ae=t.userToFollow)==null?void 0:Ae.socketId)||null}),u==null?void 0:u(_.formFactor==="phone",t),!t.viewModeEnabled&&(($e=t.openDialog)==null?void 0:$e.name)!=="elementLinkSelector"&&(!z||((et=t.openSidebar)==null?void 0:et.name)!==Yr.name)&&g(w.DefaultSidebarTriggerTunnel.Out,{}),me&&g(tl,{app:b,onClose:()=>{e.executeAction(N5)},renderCustomStats:f})]})]})})},O=()=>g(X5,{__fallback:!0,onDock:ie=>{at("sidebar",`toggleDock (${ie?"dock":"undock"})`,`(${_.formFactor==="phone"?"mobile":"desktop"})`)}}),z=HT(aS),H=P(fe,{children:[U,g(DTe,{UIOptions:h}),g(X5.Trigger,{__fallback:!0,icon:Mme,title:Ht(x("toolBar.library")),onToggle:ie=>{ie&&at("sidebar",`${Yr.name} (open)`,`button (${_.formFactor==="phone"?"mobile":"desktop"})`)},tab:Yr.defaultTab}),g(LTe,{}),((X=t.openDialog)==null?void 0:X.name)==="ttd"&&g(fS,{__fallback:!0}),t.isLoading&&g(eK,{delay:250}),t.errorMessage&&g(gS,{onClose:()=>i({errorMessage:null}),children:t.errorMessage}),S&&_.formFactor!=="phone"&&g(J2e,{colorPickerType:S.colorPickerType,onCancel:()=>{D(null)},onChange:(ie,me,ke,{altKey:ye})=>{if(!(ie!=="elementBackground"&&ie!=="elementStroke"))if(ke.length){for(const Ae of ke)Dn(Ae,we(s),{[ye&&S.swapPreviewOnAlt?ie==="elementBackground"?"strokeColor":"backgroundColor":ie==="elementBackground"?"backgroundColor":"strokeColor"]:me}),kn.delete(Ae);b.scene.triggerUpdate()}else i(ie==="elementBackground"?{currentItemBackgroundColor:me}:{currentItemStrokeColor:me})},onSelect:(ie,me)=>{var ke;D(ye=>ye!=null&&ye.keepOpenOnAlt&&me.altKey?ye:null),(ke=S==null?void 0:S.onSelect)==null||ke.call(S,ie,me)}}),((Q=t.openDialog)==null?void 0:Q.name)==="help"&&g(_Te,{onClose:()=>{i({openDialog:null})}}),g(k_e,{}),((re=t.openDialog)==null?void 0:re.name)==="elementLinkSelector"&&g(pTe,{sourceElementId:t.openDialog.sourceElementId,onClose:()=>{i({openDialog:null})},scene:b.scene,appState:t,generateLinkForSelection:E}),g(w.OverwriteConfirmDialogTunnel.Out,{}),L(),N(),t.pasteDialog.shown&&g(Dwe,{setAppState:i,appState:t,onClose:()=>i({pasteDialog:{shown:!1,data:null}})}),_.formFactor==="phone"&&g(Rwe,{app:b,appState:t,elements:s,actionManager:e,renderJSONExportDialog:N,renderImageExportDialog:L,setAppState:i,onHandToolToggle:a,onPenModeToggle:l,renderTopLeftUI:d,renderTopRightUI:u,renderSidebars:O,renderWelcomeScreen:p,UIOptions:h}),_.formFactor!=="phone"&&P(fe,{children:[P("div",{className:"layer-ui__wrapper",style:t.openSidebar&&z&&_.canFitSidebar?{width:"calc(100% - var(--right-sidebar-width))"}:{},children:[p&&g(w.WelcomeScreenCenterTunnel.Out,{}),G(),g(rK,{appState:t,actionManager:e,showExitZenModeBtn:c,renderWelcomeScreen:p}),t.scrolledOutside&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(ie=>({...K0(s,ie)}))},children:x("buttons.scrollBackToContent")})]}),O()]})]});return g(wj.Provider,{value:t,children:g(A,{children:g($W.Provider,{value:w,children:H})})})},pP=e=>{const{startBoundElement:t,cursorButton:n,scrollX:i,scrollY:s,...r}=e;return r},NTe=(e,t)=>{if(e.children!==t.children)return!1;const{canvas:n,appState:i,...s}=e,{canvas:r,appState:o,...a}=t;return ki(pP(i),pP(o),{selectedElementIds:ki,selectedGroupIds:ki})&&ki(s,a)},OTe=de.memo(PTe,NTe),FTe="small",Y7=e=>P("label",{className:ae("ToolIcon ToolIcon__MagicButton",`ToolIcon_size_${FTe}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:e.icon})]}),BTe=({trails:e})=>{const t=C.useRef(null);return C.useEffect(()=>{if(t.current)for(const n of e)n.start(t.current);return()=>{for(const n of e)n.stop()}},e),g("div",{className:"SVGLayer",children:g("svg",{ref:t})})},wi=class wi{static start(t,n){const i=n({deltaTime:0,state:void 0});i&&(wi.animations.set(t,{animation:n,lastTime:0,state:i}),wi.isRunning||(wi.isRunning=!0,G5()?requestAnimationFrame(wi.tick):setTimeout(wi.tick,0)))}static tick(){if(wi.animations.size>0){for(const[t,n]of wi.animations){const i=performance.now(),s=n.lastTime===0?0:i-n.lastTime,r=n.animation({deltaTime:s,state:n.state});if(r)n.lastTime=i,n.state=r;else if(wi.animations.delete(t),wi.animations.size===0){wi.isRunning=!1;return}}G5()?requestAnimationFrame(wi.tick):setTimeout(wi.tick,0)}}static running(t){return wi.animations.has(t)}static cancel(t){wi.animations.delete(t)}};B(wi,"isRunning",!1),B(wi,"animations",new Map);let Z5=wi;const zTe="#ff6b6b",HTe="#ff0000",UP=1,bP=2,VTe=(e,t)=>{if(!t.snapLines.length)return;const n=t.theme===be.LIGHT||t.zenModeEnabled?zTe:HTe,i=(t.zenModeEnabled?UP*1.5:UP)/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY);for(const s of t.snapLines)s.type==="pointer"?(e.lineWidth=i,e.strokeStyle=n,GTe(s,e,t)):s.type==="gap"?(e.lineWidth=i,e.strokeStyle=n,XTe(s.points[0],s.points[1],s.direction,t,e)):s.type==="points"&&(e.lineWidth=i,e.strokeStyle=n,$Te(s,e,t));e.restore()},$Te=(e,t,n)=>{if(!n.zenModeEnabled){const i=e.points[0],s=e.points[e.points.length-1];Mr(i,s,t)}for(const i of e.points)XK(i,n,t)},GTe=(e,t,n)=>{XK(e.points[0],n,t),n.zenModeEnabled||Mr(e.points[0],e.points[1],t)},XK=([e,t],n,i)=>{i.save();const s=(n.zenModeEnabled?bP*1.5:bP)/n.zoom.value;i.beginPath(),i.moveTo(e-s,t-s),i.lineTo(e+s,t+s),i.moveTo(e+s,t-s),i.lineTo(e-s,t+s),i.stroke(),i.restore()},Mr=(e,t,n)=>{n.beginPath(),n.lineTo(e[0],e[1]),n.lineTo(t[0],t[1]),n.stroke()},XTe=(e,t,n,i,s)=>{const r=8/i.zoom.value,o=r/2,a=r/4;if(n==="horizontal"){const l=[(e[0]+t[0])/2,e[1]];i.zenModeEnabled||Mr(M(e[0],e[1]-r),M(e[0],e[1]+r),s),Mr(M(l[0]-a,l[1]-o),M(l[0]-a,l[1]+o),s),Mr(M(l[0]+a,l[1]-o),M(l[0]+a,l[1]+o),s),i.zenModeEnabled||(Mr(M(t[0],t[1]-r),M(t[0],t[1]+r),s),Mr(e,t,s))}else{const l=[e[0],(e[1]+t[1])/2];i.zenModeEnabled||Mr(M(e[0]-r,e[1]),M(e[0]+r,e[1]),s),Mr(M(l[0]-o,l[1]-a),M(l[0]+o,l[1]-a),s),Mr(M(l[0]-o,l[1]+a),M(l[0]+o,l[1]+a),s),i.zenModeEnabled||(Mr(M(t[0]-r,t[1]),M(t[0]+r,t[1]),s),Mr(e,t,s))}},jTe=(e,t)=>{Ce(t.selectedLinearElement,"selectedLinearElement is null");const{segmentMidPointHoveredCoords:n}=t.selectedLinearElement;Ce(n,"midPointCoords is null"),e.save(),e.translate(t.scrollX,t.scrollY),pS(n,e,t),e.restore()},YTe=(e,t,n)=>{var a,l,c,d;const{elementId:i,hoverPointIndex:s}=t.selectedLinearElement;if((a=t.selectedLinearElement)!=null&&a.isEditing&&((c=(l=t.selectedLinearElement)==null?void 0:l.selectedPointsIndices)!=null&&c.includes(s))||(d=t.selectedLinearElement)!=null&&d.isDragging)return;const r=ne.getElement(i,n);if(!r)return;const o=ne.getPointAtIndexGlobalCoordinates(r,s,n);e.save(),e.translate(t.scrollX,t.scrollY),pS(o,e,t),e.restore()},pS=(e,t,n)=>{t.fillStyle="rgba(105, 101, 219, 0.4)",OE(t,e[0],e[1],ne.POINT_HANDLE_SIZE/n.zoom.value,!1)},WTe=(e,t,n)=>{e.save(),e.translate(t.scrollX,t.scrollY),pS(n,e,t),e.restore()},W7=(e,t,n,i,s,r,o)=>{var a;e.strokeStyle="#5e5ad8",e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.9)",s?e.fillStyle="rgba(134, 131, 226, 0.9)":r&&(e.fillStyle="rgba(177, 151, 252, 0.7)"),OE(e,n[0],n[1],(o?i*((a=t.selectedLinearElement)!=null&&a.isEditing?1.5:2):i)/t.zoom.value,!r,!o||s)},KTe=(e,t,n,i)=>{const s=t.frameId&&n.get(t.frameId);switch(s&&_e(s)&&(e.translate(s.x,s.y),e.beginPath(),e.roundRect?e.roundRect(-1,-1,s.width+1,s.height+1,rt.radius/i.zoom.value):e.rect(-1,-1,s.width+1,s.height+1),e.clip(),e.translate(-s.x,-s.y)),t.type){case"magicframe":case"frame":e.save(),e.translate(t.x,t.y),e.lineWidth=rt.strokeWidth/i.zoom.value,e.strokeStyle=i.theme===be.DARK?"rgba(3, 93, 161, 1)":"rgba(106, 189, 252, 1)",e.roundRect?(e.beginPath(),e.roundRect(0,0,t.width,t.height,rt.radius/i.zoom.value),e.stroke(),e.closePath()):e.strokeRect(0,0,t.width,t.height),e.restore();break;default:e.save();const r=yi(t,n);switch(e.translate(r[0],r[1]),e.rotate(t.angle),e.translate(-r[0],-r[1]),e.translate(t.x,t.y),e.lineWidth=Ke(1.75,t.strokeWidth,4)/Math.max(.25,i.zoom.value),e.strokeStyle=i.theme===be.DARK?"rgba(3, 93, 161, 1)":"rgba(106, 189, 252, 1)",t.type){case"ellipse":e.beginPath(),e.ellipse(t.width/2,t.height/2,t.width/2,t.height/2,0,0,2*Math.PI),e.closePath(),e.stroke();break;case"diamond":{const[o,a]=t2(t);o.forEach(l=>{e.beginPath(),e.moveTo(l[0][0]-t.x,l[0][1]-t.y),e.lineTo(l[1][0]-t.x,l[1][1]-t.y),e.stroke()}),a.forEach(l=>{const[c,d,u,f]=l;e.beginPath(),e.moveTo(c[0]-t.x,c[1]-t.y),e.bezierCurveTo(d[0]-t.x,d[1]-t.y,u[0]-t.x,u[1]-t.y,f[0]-t.x,f[1]-t.y),e.stroke()})}break;default:{const[o,a]=e2(t);o.forEach(l=>{e.beginPath(),e.moveTo(l[0][0]-t.x,l[0][1]-t.y),e.lineTo(l[1][0]-t.x,l[1][1]-t.y),e.stroke()}),a.forEach(l=>{const[c,d,u,f]=l;e.beginPath(),e.moveTo(c[0]-t.x,c[1]-t.y),e.bezierCurveTo(d[0]-t.x,d[1]-t.y,u[0]-t.x,u[1]-t.y,f[0]-t.x,f[1]-t.y),e.stroke()})}break}e.restore();break}},ZTe=(e,t,n,i,s,r,o)=>{const a=e.state.bindMode==="orbit"&&e.bindModeHandler!==null,l=Hf-((o==null?void 0:o.runtime)??(a?0:Hf)),c=Ke(1/Hf*l,1e-4,1),d=n.strokeWidth/2,u=n.frameId&&i.get(n.frameId);switch(u&&_e(u)&&(t.translate(u.x,u.y),t.beginPath(),t.roundRect?t.roundRect(-1,-1,u.width+1,u.height+1,rt.radius/s.zoom.value):t.rect(-1,-1,u.width+1,u.height+1),t.clip(),t.translate(-u.x,-u.y)),n.type){case"magicframe":case"frame":t.save(),t.translate(n.x,n.y),t.lineWidth=rt.strokeWidth/s.zoom.value,t.strokeStyle=s.theme===be.DARK?`rgba(3, 93, 161, ${c})`:`rgba(106, 189, 252, ${c})`,t.roundRect?(t.beginPath(),t.roundRect(0,0,n.width,n.height,rt.radius/s.zoom.value),t.stroke(),t.closePath()):t.strokeRect(0,0,n.width,n.height),t.restore();break;default:t.save();const h=yi(n,i),m=h[0]+s.scrollX,p=h[1]+s.scrollY;switch(t.translate(m,p),t.rotate(n.angle),t.translate(-m,-p),t.translate(n.x+s.scrollX-d,n.y+s.scrollY-d),t.lineWidth=Ke(2.5,n.strokeWidth*1.75,4)/Math.max(.25,s.zoom.value),t.strokeStyle=s.theme===be.DARK?`rgba(3, 93, 161, ${c/2})`:`rgba(106, 189, 252, ${c/2})`,n.type){case"ellipse":t.beginPath(),t.ellipse((n.width+d*2)/2,(n.height+d*2)/2,(n.width+d*2)/2,(n.height+d*2)/2,0,0,2*Math.PI),t.closePath(),t.stroke();break;case"diamond":{const[U,b]=t2(n,d);U.forEach(y=>{t.beginPath(),t.moveTo(y[0][0]-n.x+d,y[0][1]-n.y+d),t.lineTo(y[1][0]-n.x+d,y[1][1]-n.y+d),t.stroke()}),b.forEach(y=>{const[E,_,I,k]=y;t.beginPath(),t.moveTo(E[0]-n.x+d,E[1]-n.y+d),t.bezierCurveTo(_[0]-n.x+d,_[1]-n.y+d,I[0]-n.x+d,I[1]-n.y+d,k[0]-n.x+d,k[1]-n.y+d),t.stroke()})}break;default:{const[U,b]=e2(n,d);U.forEach(y=>{t.beginPath(),t.moveTo(y[0][0]-n.x+d,y[0][1]-n.y+d),t.lineTo(y[1][0]-n.x+d,y[1][1]-n.y+d),t.stroke()}),b.forEach(y=>{const[E,_,I,k]=y;t.beginPath(),t.moveTo(E[0]-n.x+d,E[1]-n.y+d),t.bezierCurveTo(_[0]-n.x+d,_[1]-n.y+d,I[0]-n.x+d,I[1]-n.y+d,k[0]-n.x+d,k[1]-n.y+d),t.stroke()})}break}t.restore();break}if(!a||((o==null?void 0:o.runtime)??0)>Hf)return;const f=.5*(Math.min(n.width,n.height)/2);if(!_e(n)){t.save(),t.translate(n.x+s.scrollX,n.y+s.scrollY);const h=1/Hf*l;t.strokeStyle="rgba(0, 0, 0, 0.2)",t.lineWidth=1/s.zoom.value,t.setLineDash([4/s.zoom.value,4/s.zoom.value]),t.lineDashOffset=-h*10/s.zoom.value,t.beginPath(),t.ellipse(n.width/2,n.height/2,f,f,0,0,2*Math.PI),t.stroke(),t.fillStyle="rgba(0, 0, 0, 0.04)",t.beginPath(),t.ellipse(n.width/2,n.height/2,f*(1-c),f*(1-c),0,0,2*Math.PI),t.fill(),t.restore()}return{runtime:((o==null?void 0:o.runtime)??0)+r}},qTe=(e,t,n,i,s,r,o)=>{if(Ii("COMPLEX_BINDINGS"))return ZTe(e,t,n,i,s,r,o);t.save(),t.translate(s.scrollX,s.scrollY),KTe(t,n,i,s),t.restore()},jK=(e,t,n)=>{const{angle:i,x1:s,y1:r,x2:o,y2:a,selectionColors:l,cx:c,cy:d,dashed:u,activeEmbeddable:f}=n,h=o-s,m=a-r,U=(n.padding??Cu*2)/t.zoom.value,b=8/t.zoom.value,y=4/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=(f?4:1)/t.zoom.value;const E=l.length;for(let _=0;_<E;++_)e.strokeStyle=l[_],u&&e.setLineDash([b,y+(b+y)*(E-1)]),e.lineDashOffset=(b+y)*_,zE(e,s-U,r-U,h+U*2,m+U*2,c,d,i);e.restore()},QTe=(e,t,n,i)=>{const[s,r,o,a]=je(n,i),l=o-s,c=a-r;e.strokeStyle="rgb(0,118,255)",e.lineWidth=rt.strokeWidth/t.zoom.value,e.save(),e.translate(t.scrollX,t.scrollY),zE(e,s,r,l,c,s+l/2,r+c/2,n.angle,!1,rt.radius/t.zoom.value),e.restore()},yP=(e,t,n,i)=>{const{colors:s=["rgb(0,118,255)"],dashed:r=!1}=i||{},o=n.filter(d=>d.groupIds.length===0),a=n.filter(d=>d.groupIds.length>0),l=d=>{const[u,f,h,m]=Et(d);return{angle:0,x1:u,x2:h,y1:f,y2:m,selectionColors:s,dashed:r,cx:u+(h-u)/2,cy:f+(m-f)/2,activeEmbeddable:!1}},c=d=>{const u=Ot(n,d);return l(u)};Object.entries(a2(a,t)).filter(([d,u])=>u).map(([d,u])=>d).map(d=>c(d)).concat(o.map(d=>l([d]))).forEach(d=>jK(e,t,d))},K7=(e,t,n,i)=>{var c,d;if(!t.selectedLinearElement)return;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=1/t.zoom.value;const s=ne.getPointsGlobalCoordinates(n,i),{POINT_HANDLE_SIZE:r}=ne,o=(c=t.selectedLinearElement)!=null&&c.isEditing?r:r/2,a=ve(n),l=cn(n);if(s.forEach((u,f)=>{var p,U,b,y,E,_;if(a&&f!==0&&f!==s.length-1)return;const h=f>0&&(f!==s.length-1||!l||!n.polygon)&&vr(u,f===s.length-1?s[0]:s[f-1],2/t.zoom.value);let m=!!((p=t.selectedLinearElement)!=null&&p.isEditing)&&!!((b=(U=t.selectedLinearElement)==null?void 0:U.selectedPointsIndices)!=null&&b.includes(f));l&&n.polygon&&!m&&f===n.points.length-1&&((y=t.selectedLinearElement)!=null&&y.isEditing)&&((_=(E=t.selectedLinearElement)==null?void 0:E.selectedPointsIndices)!=null&&_.includes(0))&&(m=!0),W7(e,t,u,o,m,!1,h)}),ve(n)){const u=((d=n.fixedSegments)==null?void 0:d.map(f=>f.index))||[];s.slice(0,-1).forEach((f,h)=>{ne.isSegmentTooShort(n,s[h+1],s[h],h,t.zoom)||W7(e,t,M((f[0]+s[h+1][0])/2,(f[1]+s[h+1][1])/2),r/2,!1,!u.includes(h+1),!1)})}else ne.getEditorMidPoints(n,i,t).filter((f,h,m)=>f!==null&&!(ve(n)&&(h===0||h===m.length-1))).forEach(f=>{var h;((h=t.selectedLinearElement)!=null&&h.isEditing||s.length===2)&&W7(e,t,f,r/2,!1,!0,!1)});e.restore()},JTe=(e,t,n,i)=>{e.save(),e.translate(t.scrollX,t.scrollY),e.strokeStyle="rgba(134, 131, 226, 0.6)",e.lineWidth=1/t.zoom.value,e.setLineDash([4/t.zoom.value,4/t.zoom.value]),e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(i[0],i[1]),e.stroke(),e.restore()},eIe=(e,t,n,i,s)=>{e.save(),e.translate(t.scrollX,t.scrollY),e.strokeStyle="rgba(134, 131, 226, 0.6)",e.lineWidth=1/t.zoom.value,e.setLineDash([]),e.fillStyle=s?"rgba(134, 131, 226, 0.9)":"rgba(255, 255, 255, 0.9)",OE(e,n[0],n[1],i/t.zoom.value,!0,!0),e.restore()},EP=({arrow:e,appState:t,type:n,context:i,elementsMap:s})=>{var f;const r=n==="start"?e.startBinding:e.endBinding,o=(r==null?void 0:r.elementId)&&s.get(r.elementId);if(!o||!si(o)||o.isDeleted)return;const a=Ss(r.fixedPoint,o,s);if(!j0(a,e,o,s,t))return;const l=t.selectedLinearElement,c=!!(l!=null&&l.isDragging),d=n==="start"?0:e.points.length-1,u=!!((f=l==null?void 0:l.selectedPointsIndices)!=null&&f.includes(d));if((l==null?void 0:l.hoveredFocusPointBinding)===n&&!l.draggedFocusPointBinding&&WTe(i,t,a),!(u&&c)){const h=Ss(r.fixedPoint,o,s),m=(l==null?void 0:l.hoveredFocusPointBinding)===n,p=ne.getPointAtIndexGlobalCoordinates(e,d,s);JTe(i,t,p,h),eIe(i,t,h,Zy/1.5,m)}},vP=(e,t,n,i,s)=>{Object.keys(i).forEach(r=>{const o=i[r];if(o!==void 0){const[a,l,c,d]=o;e.save(),e.lineWidth=1/n.zoom.value,t.selectionColor&&(e.strokeStyle=t.selectionColor),r==="rotation"?OE(e,a+c/2,l+d/2,c/2,!0):e.roundRect?(e.beginPath(),e.roundRect(a,l,c,d,2/n.zoom.value),e.fill(),e.stroke()):zE(e,a,l,c,d,a+c/2,l+d/2,s,!0),e.restore()}})},tIe=(e,t,n,i,s)=>{const[r,o,,,a,l]=je(i,s),c=3,d=20,u=c/n.zoom.value,f=u/2,h=a-r+u,m=l-o+u,p=Math.min(d/n.zoom.value,h),U=Math.min(d/n.zoom.value,m);e.save(),e.fillStyle=t.selectionColor,e.strokeStyle=t.selectionColor,e.lineWidth=u,[[[-h,-m],[0,f],[p,f],[f,0],[f,U]],[[h-f,-m],[f,f],[-p+f,f],[0,0],[0,U]],[[-h,m],[0,-f],[p,-f],[f,0],[f,-U]],[[h-f,m],[f,-f],[-p+f,-f],[0,0],[0,-U]]].forEach(y=>{const[[E,_],[I,k],[w,T],[A,S],[D,N]]=y;e.save(),e.translate(a,l),e.rotate(i.angle),e.beginPath(),e.moveTo(E+I,_+k),e.lineTo(E+w,_+T),e.stroke(),e.beginPath(),e.moveTo(E+A,_+S),e.lineTo(E+D,_+N),e.stroke(),e.restore()}),e.restore()},nIe=(e,t,n,i)=>{t.save();const s=Cu*2/n.zoom.value,r=e.width+s*2,o=e.height+s*2,a=e.x+r/2,l=e.y+o/2,c=-(r/2+s),d=-(o/2+s);t.translate(a+n.scrollX,l+n.scrollY),t.rotate(e.angle),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(c,d,r,o),t.restore()},iIe=({app:e,canvas:t,elementsMap:n,visibleElements:i,selectedElements:s,allElementsMap:r,scale:o,appState:a,renderConfig:l,editorInterface:c,animationState:d,deltaTime:u})=>{var I,k,w,T,A;if(t===null)return{atLeastOneVisibleElement:!1,elementsMap:n};const[f,h]=FE(t,o);let m=d;const p=BE({canvas:t,scale:o,normalizedWidth:f,normalizedHeight:h});p.save(),p.scale(a.zoom.value,a.zoom.value);let U;if(i.forEach(S=>{var D;(D=a.selectedLinearElement)!=null&&D.isEditing&&a.selectedLinearElement.elementId===S.id&&S&&(U=S)}),U&&K7(p,a,U,n),a.selectionElement&&!a.isCropping)try{zue(a.selectionElement,p,a,l.selectionColor)}catch(S){console.error(S)}if(a.editingTextElement&&he(a.editingTextElement)){const S=r.get(a.editingTextElement.id);S&&!S.autoResize&&nIe(S,p,a,l.selectionColor)}if(a.isBindingEnabled&&a.suggestedBinding?m={...d,bindingHighlight:qTe(e,p,a.suggestedBinding,r,a,u,d==null?void 0:d.bindingHighlight)}:m={...d,bindingHighlight:void 0},a.frameToHighlight&&QTe(p,a,a.frameToHighlight,n),a.elementsToHighlight&&yP(p,a,a.elementsToHighlight),a.activeLockedId){const S=r.get(a.activeLockedId),D=S?[S]:Ot(r,a.activeLockedId);yP(p,a,D,{colors:["#ced4da"],dashed:!0})}const b=s.some(S=>_e(S));s.length===1&&((I=a.selectedLinearElement)!=null&&I.isEditing)&&a.selectedLinearElement.elementId===s[0].id&&K7(p,a,s[0],n);const y=a.selectedLinearElement,E=y&&ne.getElement(y.elementId,r);if(E&&(a.selectedLinearElement.isDragging||(y.segmentMidPointHoveredCoords?jTe(p,a):(ve(E)?y.hoverPointIndex===0||y.hoverPointIndex===E.points.length-1:y.hoverPointIndex>=0)&&YTe(p,a,n)),Te(E)&&(EP({arrow:E,elementsMap:r,appState:a,context:p,type:"start"}),EP({arrow:E,elementsMap:r,appState:a,context:p,type:"end"}))),!a.multiElement&&!a.newElement&&!((k=a.selectedLinearElement)!=null&&k.isEditing)){const S=JV(s,a,c),D=s.length===1&&De(s[0]);D&&((w=a.selectedLinearElement)==null?void 0:w.elementId)===s[0].id&&!s[0].locked&&K7(p,a,s[0],n);const N=l.selectionColor||"#000";if(S){const L=we(s),j=[];for(const G of n.values()){const O=[],z=l.remoteSelectedElementIds.get(G.id);if(D&&ve(G)&&(G.startBinding||G.endBinding)||(L.has(G.id)&&!pT(a,G)&&O.push(N),z&&O.push(...z.map(H=>GE(H,a.collaborators.get(H))))),O.length){const[H,X,Q,re,ie,me]=je(G,n,!0);j.push({angle:G.angle,x1:H,y1:X,x2:Q,y2:re,selectionColors:G.locked?["#ced4da"]:O,dashed:!!z||G.locked,cx:ie,cy:me,activeEmbeddable:((T=a.activeEmbeddable)==null?void 0:T.element)===G&&a.activeEmbeddable.state==="active",padding:G.id===a.croppingElementId||xt(G)?0:void 0})}}const Y=G=>{const O=Ot(n,G),[z,H,X,Q]=Et(O);j.push({angle:0,x1:z,x2:X,y1:H,y2:Q,selectionColors:O.some(re=>re.locked)?["#ced4da"]:["#000"],dashed:!0,cx:z+(X-z)/2,cy:H+(Q-H)/2,activeEmbeddable:!1})};for(const G of zc(a))Y(G);a.editingGroupId&&Y(a.editingGroupId),j.forEach(G=>jK(p,a,G))}if(p.save(),p.translate(a.scrollX,a.scrollY),s.length===1){p.fillStyle="#fff";const L=QV(s[0],a.zoom,n,"mouse",t0(c));if(!a.viewModeEnabled&&S&&!he(a.editingTextElement)&&!a.croppingElementId&&vP(p,l,a,L,s[0].angle),a.croppingElementId&&!a.isCropping){const j=n.get(a.croppingElementId);j&&xt(j)&&tIe(p,l,a,j,n)}}else if(s.length>1&&!a.isRotating&&!s.some(L=>L.locked)){const L=Cu*2/a.zoom.value;p.fillStyle="#fff";const[j,Y,G,O]=Et(s,n),z=p.getLineDash();p.setLineDash([2/a.zoom.value]);const H=p.lineWidth;p.lineWidth=1/a.zoom.value,p.strokeStyle=N,zE(p,j-L,Y-L,G-j+L*2,O-Y+L*2,(j+G)/2,(Y+O)/2,0),p.lineWidth=H,p.setLineDash(z);const X=FT([j,Y,G,O,(j+G)/2,(Y+O)/2],0,a.zoom,"mouse",b?{...t0(c),rotation:!0}:t0(c));s.some(Q=>!Q.locked)&&vP(p,l,a,X,0)}p.restore()}(A=a.searchMatches)==null||A.matches.forEach(({id:S,focus:D,matchedLines:N})=>{const L=n.get(S);if(L){const[j,Y,,,G,O]=je(L,n,!0);p.save(),a.theme===be.LIGHT?D?p.fillStyle="rgba(255, 124, 0, 0.4)":p.fillStyle="rgba(255, 226, 0, 0.4)":D?p.fillStyle="rgba(229, 82, 0, 0.4)":p.fillStyle="rgba(99, 52, 0, 0.4)";const z=_e(L)?a.zoom.value:1;p.translate(a.scrollX,a.scrollY),p.translate(G,O),p.rotate(L.angle),N.forEach(H=>{(H.showOnCanvas||D)&&p.fillRect(j+H.offsetX/z-G,Y+H.offsetY/z-O,H.width/z,H.height/z)}),p.restore()}}),VTe(p,a),p.restore(),eve({context:p,renderConfig:l,appState:a,normalizedWidth:f,normalizedHeight:h});let _;return l.renderScrollbars&&(_=gwe(n,f,h,a),p.save(),p.fillStyle=hwe,p.strokeStyle="rgba(255,255,255,0.8)",[_.horizontal,_.vertical].forEach(S=>{S&&oW(p,S.x,S.y,S.width,S.height,Xo/2)}),p.restore()),{scrollBars:_,atLeastOneVisibleElement:i.length>0,elementsMap:n,animationState:m}},sIe=e=>{const t=iIe(e);return e.callback(t),t},_P="animateInteractiveScene",rIe=e=>{const t=C.useRef(!1),n=C.useRef(null);return C.useEffect(()=>{var c;if(!t.current){t.current=!0;return}const i=new Map,s=new Map,r=new Map,o=new Map,a=new Map;e.appState.collaborators.forEach((d,u)=>{if(d.selectedElementIds)for(const f of Object.keys(d.selectedElementIds))r.has(f)||r.set(f,[]),r.get(f).push(u);!d.pointer||d.pointer.renderCursor===!1||(d.username&&o.set(u,d.username),d.userState&&a.set(u,d.userState),s.set(u,cr({sceneX:d.pointer.x,sceneY:d.pointer.y},e.appState)),i.set(u,d.button))});const l=((c=e.containerRef)==null?void 0:c.current)&&getComputedStyle(e.containerRef.current).getPropertyValue("--color-selection")||"#6965db";n.current={app:e.app,canvas:e.canvas,elementsMap:e.elementsMap,visibleElements:e.visibleElements,selectedElements:e.selectedElements,allElementsMap:e.allElementsMap,scale:window.devicePixelRatio,appState:e.appState,renderConfig:{remotePointerViewportCoords:s,remotePointerButton:i,remoteSelectedElementIds:r,remotePointerUsernames:o,remotePointerUserStates:a,selectionColor:l,renderScrollbars:e.renderScrollbars,lastViewportPosition:e.app.lastViewportPosition},editorInterface:e.editorInterface,callback:e.renderInteractiveSceneCallback,animationState:{bindingHighlight:void 0},deltaTime:0},Z5.running(_P)||Z5.start(_P,({deltaTime:d,state:u})=>{const f=sIe({...n.current,deltaTime:d,animationState:u}).animationState;if(f){for(const h in f)if(f[h]!==void 0)return f}})}),g("canvas",{className:"excalidraw__canvas interactive",style:{width:e.appState.width,height:e.appState.height,cursor:e.appState.viewModeEnabled?Dt.GRAB:Dt.AUTO},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:e.handleCanvasRef,onContextMenu:e.onContextMenu,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onTouchMove:e.onTouchMove,onPointerDown:e.onPointerDown,onDoubleClick:e.appState.viewModeEnabled?void 0:e.onDoubleClick,children:x("labels.drawingCanvas")})},wP=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,editingGroupId:e.editingGroupId,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,selectionElement:e.selectionElement,selectedGroupIds:e.selectedGroupIds,selectedLinearElement:e.selectedLinearElement,multiElement:e.multiElement,newElement:e.newElement,isBindingEnabled:e.isBindingEnabled,suggestedBinding:e.suggestedBinding,isRotating:e.isRotating,elementsToHighlight:e.elementsToHighlight,collaborators:e.collaborators,activeEmbeddable:e.activeEmbeddable,snapLines:e.snapLines,zenModeEnabled:e.zenModeEnabled,editingTextElement:e.editingTextElement,isCropping:e.isCropping,croppingElementId:e.croppingElementId,searchMatches:e.searchMatches,activeLockedId:e.activeLockedId,hoveredElementIds:e.hoveredElementIds,frameRendering:e.frameRendering,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,exportScale:e.exportScale}),oIe=(e,t)=>e.selectionNonce!==t.selectionNonce||e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements||e.selectedElements!==t.selectedElements||e.renderScrollbars!==t.renderScrollbars?!1:ki(wP(e.appState),wP(t.appState)),aIe=de.memo(rIe,oIe),lIe=e=>{const t=C.useRef(null),n=C.useRef(!1);return C.useEffect(()=>{e.canvas.style.width=`${e.appState.width}px`,e.canvas.style.height=`${e.appState.height}px`,e.canvas.width=e.appState.width*e.scale,e.canvas.height=e.appState.height*e.scale},[e.appState.height,e.appState.width,e.canvas,e.scale]),C.useEffect(()=>{const i=t.current;if(!i)return;const s=e.canvas;n.current||(n.current=!0,i.replaceChildren(s),s.classList.add("excalidraw__canvas","static")),BY({canvas:s,rc:e.rc,scale:e.scale,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,visibleElements:e.visibleElements,appState:e.appState,renderConfig:e.renderConfig},G5())}),g("div",{className:"excalidraw__canvas-wrapper",ref:t})},TP=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,hoveredElementIds:e.hoveredElementIds,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,viewBackgroundColor:e.viewBackgroundColor,exportScale:e.exportScale,selectedElementsAreBeingDragged:e.selectedElementsAreBeingDragged,gridSize:e.gridSize,gridStep:e.gridStep,frameRendering:e.frameRendering,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,editingGroupId:e.editingGroupId,currentHoveredFontFamily:e.currentHoveredFontFamily,croppingElementId:e.croppingElementId,suggestedBinding:e.suggestedBinding}),cIe=(e,t)=>e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements?!1:ki(TP(e.appState),TP(t.appState))&&ki(e.renderConfig,t.renderConfig),dIe=de.memo(lIe,cIe),YK=({canvas:e,rc:t,newElement:n,elementsMap:i,allElementsMap:s,scale:r,appState:o,renderConfig:a})=>{var l;if(e){const[c,d]=FE(e,r),u=BE({canvas:e,scale:r,normalizedWidth:c,normalizedHeight:d});if(u.save(),u.scale(o.zoom.value,o.zoom.value),n&&n.type!=="selection"){if(_l(n))return;if((n.frameId||((l=o.frameToHighlight)==null?void 0:l.id))&&o.frameRendering.enabled&&o.frameRendering.clip){const h=n5(n,i,o);h&&B4(n,h,o,i)&&A_(h,u,a,o)}jd(n,i,s,t,u,a,o)}else u.clearRect(0,0,c,d);u.restore()}},uIe=jp(e=>{YK(e)},{trailing:!0}),fIe=(e,t)=>{if(t){uIe(e);return}YK(e)},hIe=e=>{const t=C.useRef(null);return C.useEffect(()=>{t.current&&fIe({canvas:t.current,scale:e.scale,newElement:e.appState.newElement,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,rc:e.rc,renderConfig:e.renderConfig,appState:e.appState},G5())}),g("canvas",{className:"excalidraw__canvas",style:{width:e.appState.width,height:e.appState.height},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:t})},gIe=5e3,mIe=({message:e,onClose:t,closable:n=!1,duration:i=gIe,style:s})=>{const r=C.useRef(0),o=i!==1/0,a=C.useCallback(()=>{o&&(r.current=window.setTimeout(()=>t(),i))},[t,i,o]);return C.useEffect(()=>{if(o)return a(),()=>clearTimeout(r.current)},[a,e,i,o]),P("div",{className:"Toast",onMouseEnter:o?()=>clearTimeout(r==null?void 0:r.current):void 0,onMouseLeave:o?a:void 0,style:s,children:[g("p",{className:"Toast__message",children:e}),n&&g(qe,{icon:lf,"aria-label":"close",type:"icon",onClick:t,className:"close"})]})},pIe=({app:e,activeLockedId:t})=>{const n=e.scene.getElement(t),i=n?[n]:Ot(e.scene.getNonDeletedElementsMap(),t);if(i.length===0)return null;const[s,r]=Et(i),{x:o,y:a}=cr({sceneX:s,sceneY:r},e.state);return g("div",{className:"UnlockPopup",style:{bottom:`${e.state.height+12-a+e.state.offsetTop}px`,left:`${o-e.state.offsetLeft}px`},onClick:()=>{tn.flushSync(()=>{const l=a2(i,e.state);e.setState({selectedElementIds:i.reduce((c,d)=>({...c,[d.id]:!0}),{}),selectedGroupIds:l,activeLockedId:null})}),e.actionManager.executeAction(gW)},title:x("labels.elementLock.unlock"),children:Yhe})},WK=de.createContext(null),KK=de.createContext(null),Z_={formFactor:"desktop",desktopUIMode:"full",userAgent:xz(typeof navigator<"u"?navigator.userAgent:""),isTouchScreen:!1,canFitSidebar:!1,isLandscape:!0},US=de.createContext(Z_);US.displayName="EditorInterfaceContext";const bS=de.createContext({container:null,id:null});bS.displayName="ExcalidrawContainerContext";const yS=de.createContext([]);yS.displayName="ExcalidrawElementsContext";const ES=de.createContext({...Aa(),width:0,height:0,offsetLeft:0,offsetTop:0});ES.displayName="ExcalidrawAppStateContext";const vS=de.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")});vS.displayName="ExcalidrawSetAppStateContext";const _S=de.createContext(null);_S.displayName="ExcalidrawActionManagerContext";const Ir=()=>C.useContext(WK),I2=()=>C.useContext(KK),Nn=()=>C.useContext(US),Na=()=>K1(Nn()),Ws=()=>C.useContext(bS),n8=()=>C.useContext(yS),S2=()=>C.useContext(ES),On=()=>C.useContext(vS),Ei=()=>C.useContext(_S);let Km=!1,Z7=0,Zm=null,zd=!1,qm=!1,q7=!1,Qm={horizontal:null,vertical:null},tc=0,Jm=!1;const Q7=new Map;let J7=!1,IP=0,SP=!1,Hd=null;const Tt={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null};class wS extends de.Component{constructor(n){super(n);B(this,"canvas");B(this,"interactiveCanvas",null);B(this,"rc");B(this,"unmounted",!1);B(this,"actionManager");B(this,"editorInterface",Z_);B(this,"stylesPanelMode",K1(Z_));B(this,"excalidrawContainerRef",de.createRef());B(this,"scene");B(this,"fonts");B(this,"renderer");B(this,"visibleElements");B(this,"resizeObserver");B(this,"library");B(this,"libraryItemsFromStorage");B(this,"id");B(this,"store");B(this,"history");B(this,"excalidrawContainerValue");B(this,"files",{});B(this,"imageCache",new Map);B(this,"iFrameRefs",new Map);B(this,"embedsValidationStatus",new Map);B(this,"initializedEmbeds",new Set);B(this,"handleToastClose",()=>{this.setToast(null)});B(this,"elementsPendingErasure",new Set);B(this,"flowChartCreator",new jfe);B(this,"flowChartNavigator",new Xfe);B(this,"bindModeHandler",null);B(this,"hitLinkElement");B(this,"lastPointerDownEvent",null);B(this,"lastPointerUpEvent",null);B(this,"lastPointerMoveEvent",null);B(this,"lastPointerMoveCoords",null);B(this,"previousPointerMoveCoords",null);B(this,"lastViewportPosition",{x:0,y:0});B(this,"animationFrameHandler",new X_e);B(this,"laserTrails",new dwe(this.animationFrameHandler,this));B(this,"eraserTrail",new wwe(this.animationFrameHandler,this));B(this,"lassoTrail",new _we(this.animationFrameHandler,this));B(this,"onChangeEmitter",new fo);B(this,"onPointerDownEmitter",new fo);B(this,"onPointerUpEmitter",new fo);B(this,"onUserFollowEmitter",new fo);B(this,"onScrollChangeEmitter",new fo);B(this,"missingPointerEventCleanupEmitter",new fo);B(this,"onRemoveEventListenersEmitter",new fo);B(this,"updateEditorAtom",(n,...i)=>{const s=ar.set(n,...i);return this.triggerRender(),s});B(this,"previousHoveredBindableElement",null);B(this,"getEffectiveGridSize",()=>pp(this)?this.state.gridSize:null);B(this,"updateEmbedValidationStatus",(n,i)=>{this.embedsValidationStatus.set(n.id,i),kn.delete(n)});B(this,"updateEmbeddables",()=>{const n=new Set;let i=!1;this.scene.getNonDeletedElements().filter(s=>{if(Es(s)){if(n.add(s.id),!this.embedsValidationStatus.has(s.id)){i=!0;const r=xb(s.link,this.props.validateEmbeddable);this.updateEmbedValidationStatus(s,r)}}else uc(s)&&n.add(s.id);return!1}),i&&this.scene.triggerUpdate(),this.iFrameRefs.forEach((s,r)=>{n.has(r)||this.iFrameRefs.delete(r)})});B(this,"getFrameNameDOMId",n=>`${this.id}-frame-name-${n.id}`);B(this,"frameNameBoundsCache",{get:n=>{let i=this.frameNameBoundsCache._cache.get(n.id);if(!i||i.zoom!==this.state.zoom.value||i.versionNonce!==n.versionNonce){const s=document.getElementById(this.getFrameNameDOMId(n));if(s){const r=s.getBoundingClientRect(),o=zt({clientX:r.x,clientY:r.y},this.state),a=zt({clientX:r.right,clientY:r.bottom},this.state);return i={x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,angle:0,zoom:this.state.zoom.value,versionNonce:n.versionNonce},this.frameNameBoundsCache._cache.set(n.id,i),i}return null}return i},_cache:new Map});B(this,"resetEditingFrame",n=>{var i;n&&this.scene.mutateElement(n,{name:((i=n.name)==null?void 0:i.trim())||null}),this.setState({editingFrame:null})});B(this,"renderFrameNames",()=>{var r;if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return this.state.editingFrame&&this.resetEditingFrame(null),null;const n=this.state.theme===be.DARK,i=this.scene.getNonDeletedFramesLikes(),s=i.length>0&&(r=this.state.searchMatches)!=null&&r.focusedId&&_e(this.scene.getElement(this.state.searchMatches.focusedId))?this.state.searchMatches.matches.find(o=>o.focus):null;return i.map(o=>{if(!d5(o,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap()))return this.state.editingFrame===o.id&&this.resetEditingFrame(o),null;const{x:a,y:l}=cr({sceneX:o.x,sceneY:o.y},this.state),c=6;let d;const u=UV(o);if(o.id===this.state.editingFrame){const f=u;d=g("input",{autoFocus:!0,value:f,onChange:h=>{this.scene.mutateElement(o,{name:h.target.value})},onFocus:h=>h.target.select(),onBlur:()=>this.resetEditingFrame(o),onKeyDown:h=>{(h.key===$.ESCAPE||h.key===$.ENTER)&&this.resetEditingFrame(o)},style:{background:n?Yi(this.state.viewBackgroundColor):this.state.viewBackgroundColor,zIndex:2,border:"none",display:"block",padding:`${c}px`,borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:`${rt.nameFontSize}px`,transform:`translate(-${c}px, ${c}px)`,color:n?rt.nameColorDarkTheme:rt.nameColorLightTheme,overflow:"hidden",maxWidth:`${document.body.clientWidth-a-c}px`},size:f.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"})}else d=u;return g("div",{id:this.getFrameNameDOMId(o),className:Wi.FRAME_NAME,style:{position:"absolute",bottom:`${this.state.height+rt.nameOffsetY-l+this.state.offsetTop}px`,left:`${a-this.state.offsetLeft}px`,zIndex:2,fontSize:rt.nameFontSize,color:n?rt.nameColorDarkTheme:rt.nameColorLightTheme,lineHeight:rt.nameLineHeight,width:"max-content",maxWidth:(s==null?void 0:s.id)===o.id&&(s!=null&&s.focus)?"none":`${o.width*this.state.zoom.value}px`,overflow:o.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:Dt.MOVE,pointerEvents:this.state.viewModeEnabled?Gd.disabled:Gd.enabled},onPointerDown:f=>this.handleCanvasPointerDown(f),onWheel:f=>this.handleWheel(f),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:o.id})},children:d},o.id)})});B(this,"focusContainer",()=>{var n;(n=this.excalidrawContainerRef.current)==null||n.focus()});B(this,"getSceneElementsIncludingDeleted",()=>this.scene.getElementsIncludingDeleted());B(this,"getSceneElementsMapIncludingDeleted",()=>this.scene.getElementsMapIncludingDeleted());B(this,"getSceneElements",()=>this.scene.getNonDeletedElements());B(this,"onInsertElements",n=>{this.addElementsFromPasteOrLibrary({elements:n,position:"center",files:null})});B(this,"onExportImage",async(n,i,s)=>{at("export",n,"ui");const r=await $E(n,i,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.getName(),viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:s.exportingFrame}).catch(Dz).catch(o=>{console.error(o),this.setState({errorMessage:o.message})});this.state.exportEmbedScene&&r&&KI(r)&&this.setState({fileHandle:r})});B(this,"magicGenerations",new Map);B(this,"updateMagicGeneration",({frameElement:n,data:i})=>{i.status==="pending"?this.scene.mutateElement(n,{customData:{generationData:void 0}},{informMutation:!1,isDragging:!1}):this.scene.mutateElement(n,{customData:{generationData:i}},{informMutation:!1,isDragging:!1}),this.magicGenerations.set(n.id,i),this.triggerRender()});B(this,"plugins",{});B(this,"onMagicframeToolSelect",()=>{const n=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(n.length===0)this.setActiveTool({type:ui.magicframe}),at("ai","tool-select (empty-selection)","d2c");else{const i=n.length===1&&Ib(n[0])&&n[0];if(!i&&n.some(r=>_e(r)||r.frameId)){this.setActiveTool({type:ui.magicframe});return}at("ai","tool-select (existing selection)","d2c");let s;if(i)s=i;else{const[r,o,a,l]=Et(n),c=50;s=X4({...rt,x:r-c,y:o-c,width:a-r+c*2,height:l-o+c*2,opacity:100,locked:!1}),this.scene.insertElement(s);for(const d of n)this.scene.mutateElement(d,{frameId:s.id});this.setState({selectedElementIds:{[s.id]:!0}})}this.onMagicFrameGenerate(s,"upstream")}});B(this,"openEyeDropper",({type:n})=>{this.updateEditorAtom(wE,{swapPreviewOnAlt:!0,colorPickerType:n==="stroke"?"elementStroke":"elementBackground",onSelect:(i,s)=>{const r=n==="background"&&s.altKey||n==="stroke"&&!s.altKey;!this.scene.getSelectedElements(this.state).length||this.state.activeTool.type!=="selection"?r?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:i},captureUpdate:q.IMMEDIATELY}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:i},captureUpdate:q.IMMEDIATELY}):this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(a=>this.state.selectedElementIds[a.id]?xe(a,{[r?"strokeColor":"backgroundColor"]:i}):a),captureUpdate:q.IMMEDIATELY})},keepOpenOnAlt:!1})});B(this,"dismissLinearEditor",()=>{setTimeout(()=>{var n;(n=this.state.selectedLinearElement)!=null&&n.isEditing&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isEditing:!1}})})});B(this,"syncActionResult",hn(n=>{var r,o,a,l,c,d;if(this.unmounted||n===!1)return;this.store.scheduleAction(n.captureUpdate);let i=!1,s=null;if(n.elements&&(this.scene.replaceAllElements(n.elements),i=!0),n.files&&(this.addMissingFiles(n.files,n.replaceFiles),this.addNewImagesToImageCache()),n.appState||s||this.state.contextMenu){let u=((r=n==null?void 0:n.appState)==null?void 0:r.viewModeEnabled)||!1,f=((o=n==null?void 0:n.appState)==null?void 0:o.zenModeEnabled)||!1;const h=((a=n==null?void 0:n.appState)==null?void 0:a.theme)||this.props.theme||be.LIGHT,m=((l=n==null?void 0:n.appState)==null?void 0:l.name)??this.state.name,p=((c=n==null?void 0:n.appState)==null?void 0:c.errorMessage)??this.state.errorMessage;typeof this.props.viewModeEnabled<"u"&&(u=this.props.viewModeEnabled),typeof this.props.zenModeEnabled<"u"&&(f=this.props.zenModeEnabled),s=((d=n.appState)==null?void 0:d.editingTextElement)||null,n.elements&&s&&n.elements.forEach(U=>{(s==null?void 0:s.id)===U.id&&s!==U&&t_(U)&&he(U)&&(s=U)}),s!=null&&s.isDeleted&&(s=null),this.setState(U=>{const b=n.appState||{};return{...U,...b,contextMenu:null,editingTextElement:s,viewModeEnabled:u,zenModeEnabled:f,theme:h,name:m,errorMessage:p}}),i=!0}i||this.scene.triggerUpdate()}));B(this,"onBlur",hn(()=>{zd=!1,this.setState({isBindingEnabled:!0})}));B(this,"onUnload",()=>{this.onBlur()});B(this,"disableEvent",n=>{n.preventDefault()});B(this,"resetHistory",()=>{this.history.clear()});B(this,"resetStore",()=>{this.store.clear()});B(this,"resetScene",hn(n=>{this.scene.replaceAllElements([]),this.setState(i=>({...Aa(),isLoading:n!=null&&n.resetLoadingState?!1:i.isLoading,theme:this.state.theme})),this.resetStore(),this.resetHistory()}));B(this,"initializeScene",async()=>{"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async o=>{if(!o.files.length)return;const a=o.files[0],l=await a.getFile();this.loadFileToCanvas(new File([l],l.name||"",{type:l.type}),a)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let n=null;try{typeof this.props.initialData=="function"?n=await this.props.initialData()||null:n=await this.props.initialData||null,n!=null&&n.libraryItems&&this.library.updateLibrary({libraryItems:n.libraryItems,merge:!0}).catch(o=>{console.error(o)})}catch(o){console.error(o),n={appState:{errorMessage:o.message||"Encountered an error during importing or restoring scene data"}}}const i=wr(n==null?void 0:n.elements,null,{repairBindings:!0,deleteInvisibleElements:!0});let s=Xc(n==null?void 0:n.appState,null);const r=s.activeTool;s.preferredSelectionTool.initialized||(s.preferredSelectionTool={type:this.editorInterface.formFactor==="phone"?"lasso":"selection",initialized:!0}),s={...s,theme:this.props.theme||s.theme,openSidebar:(s==null?void 0:s.openSidebar)||this.state.openSidebar,activeTool:r.type==="image"||r.type==="lasso"||r.type==="selection"?{...r,type:s.preferredSelectionTool.type}:s.activeTool,isLoading:!1,toast:this.state.toast},n!=null&&n.scrollToContent&&(s={...s,...K0(i,{...s,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.resetStore(),this.resetHistory(),this.syncActionResult({elements:i,appState:s,files:n==null?void 0:n.files,captureUpdate:q.NEVER}),this.clearImageShapeCache(),this.fonts.loadSceneFonts().then(o=>{this.fonts.onLoaded(o)}),Lh(window.location.href)&&this.scrollToContent(window.location.href,{animate:!1})});B(this,"getFormFactor",(n,i)=>{var s,r;return((r=(s=this.props.UIOptions).getFormFactor)==null?void 0:r.call(s,n,i))??Rie(n,i)});B(this,"refreshEditorInterface",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:i,height:s}=n.getBoundingClientRect(),r=Die(),o=xz(typeof navigator<"u"?navigator.userAgent:""),a=this.props.UIOptions.dockedSidebarBreakpoint!=null?this.props.UIOptions.dockedSidebarBreakpoint:Sie,l=yb(this.editorInterface,{desktopUIMode:r??this.editorInterface.desktopUIMode,formFactor:this.getFormFactor(i,s),userAgent:o,canFitSidebar:i>a,isLandscape:i>s});this.editorInterface=l,this.reconcileStylesPanelMode(l)});B(this,"reconcileStylesPanelMode",n=>{const i=K1(n);if(i===this.stylesPanelMode)return;const s=this.stylesPanelMode;this.stylesPanelMode=i,s!=="full"&&i==="full"&&this.setState(r=>({preferredSelectionTool:{type:"selection",initialized:!0}}))});B(this,"setDesktopUIMode",n=>{const i=Pie(n);this.editorInterface=yb(this.editorInterface,{desktopUIMode:i}),this.reconcileStylesPanelMode(this.editorInterface)});B(this,"onResize",hn(()=>{this.scene.getElementsIncludingDeleted().forEach(n=>kn.delete(n)),this.refreshEditorInterface(),this.updateDOMRect(),this.setState({})}));B(this,"onFullscreenChange",()=>{var n;!document.fullscreenElement&&((n=this.state.activeEmbeddable)==null?void 0:n.state)==="active"&&this.setState({activeEmbeddable:null})});B(this,"renderInteractiveSceneCallback",({atLeastOneVisibleElement:n,scrollBars:i,elementsMap:s})=>{i&&(Qm=i);const r=this.state.editingTextElement?!1:!n&&s.size>0;this.state.scrolledOutside!==r&&this.setState({scrolledOutside:r}),this.scheduleImageRefresh()});B(this,"onScroll",Al(()=>{const{offsetTop:n,offsetLeft:i}=this.getCanvasOffsets();this.setState(s=>s.offsetLeft===i&&s.offsetTop===n?null:{offsetTop:n,offsetLeft:i})},die));B(this,"onCut",hn(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||rl(n.target)||(this.actionManager.executeAction(pL,"keyboard",n),n.preventDefault(),n.stopPropagation())}));B(this,"onCopy",hn(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||rl(n.target)||(this.actionManager.executeAction($b,"keyboard",n),n.preventDefault(),n.stopPropagation())}));B(this,"onTouchStart",n=>{if(k9&&n.preventDefault(),!Km){Km=!0,n.touches.length===1&&(Zm={x:n.touches[0].clientX,y:n.touches[0].clientY}),clearTimeout(Z7),Z7=window.setTimeout(wS.resetTapTwice,aie);return}if(Km&&n.touches.length===1&&Zm){const i=n.touches[0];Qe(M(i.clientX,i.clientY),M(Zm.x,Zm.y))<=yie&&(this.lassoTrail.endPath(),this.deselectElements(),this.handleCanvasDoubleClick({clientX:i.clientX,clientY:i.clientY})),Km=!1,clearTimeout(Z7)}n.touches.length===2&&this.setState({selectedElementIds:It({},this.state),activeEmbeddable:null})});B(this,"onTouchEnd",n=>{this.resetContextMenuTimer(),n.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:It(this.state.previousSelectedElementIds,this.state)}):Tt.pointers.clear()});B(this,"pasteFromClipboard",hn(async n=>{var d;const i=!!J7,s=document.activeElement,r=(d=this.excalidrawContainerRef.current)==null?void 0:d.contains(s);if(n&&!r)return;const o=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(n&&(!(o instanceof HTMLCanvasElement)||rl(s)))return;const a=await D5(n),l=a.getFiles(),c=await tW(a,i);if(this.props.onPaste)try{if(await this.props.onPaste(c,n)===!1)return}catch(u){console.error(u)}await this.insertClipboardContent(c,l,i),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n==null||n.preventDefault()}));B(this,"addElementsFromPasteOrLibrary",n=>{var T,A;const i=wr(n.elements,null,{deleteInvisibleElements:!0}),[s,r,o,a]=Et(i),l=rs(s,o)/2,c=rs(r,a)/2,d=typeof n.position=="object"?n.position.clientX:n.position==="cursor"?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,u=typeof n.position=="object"?n.position.clientY:n.position==="cursor"?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:f,y:h}=zt({clientX:d,clientY:u},this.state),m=f-l,p=h-c,[U,b]=ci(m,p,this.getEffectiveGridSize()),{duplicatedElements:y}=J1({type:"everything",elements:i.map(S=>xe(S,{x:S.x+U-s,y:S.y+b-r})),randomizeSeed:!n.retainSeed}),E=this.scene.getElementsIncludingDeleted();let _=[...E,...y];_=((A=(T=this.props).onDuplicate)==null?void 0:A.call(T,_,E))||_,Mo(_,we(y));const k=this.getTopLayerFrameAtSceneCoords({x:f,y:h});if(k){const S=Lue(y,k);Q1(_,S,k,this.state)}this.scene.replaceAllElements(_),y.forEach(S=>{if(he(S)&&Vt(S)){const D=Gn(S,this.scene.getElementsMapIncludingDeleted());fs(S,D,this.scene)}}),Cz&&wl.loadElementsFonts(y).then(S=>{this.fonts.onLoaded(S)}),n.files&&this.addMissingFiles(n.files);const w=bT(y);this.store.scheduleCapture(),this.setState({...this.state,openSidebar:this.state.openSidebar&&this.editorInterface.canFitSidebar&&ar.get(aS)?this.state.openSidebar:null,...Fi({editingGroupId:null,selectedElementIds:w.reduce((S,D)=>(Vt(D)||(S[D.id]=!0),S),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{n.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n.fitToContent&&this.scrollToContent(y,{fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()})});B(this,"setAppState",(n,i)=>{this.setState(n,i)});B(this,"removePointer",n=>{tc&&this.resetContextMenuTimer(),Tt.pointers.delete(n.pointerId)});B(this,"toggleLock",(n="ui")=>{this.state.activeTool.locked||at("toolbar","toggleLock",`${n} (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),this.setState(i=>({activeTool:{...i.activeTool,...sn(this.state,i.activeTool.locked?{type:this.state.preferredSelectionTool.type}:i.activeTool),locked:!i.activeTool.locked}}))});B(this,"updateFrameRendering",n=>{this.setState(i=>{const s=typeof n=="function"?n(i.frameRendering):n;return{frameRendering:{enabled:(s==null?void 0:s.enabled)??i.frameRendering.enabled,clip:(s==null?void 0:s.clip)??i.frameRendering.clip,name:(s==null?void 0:s.name)??i.frameRendering.name,outline:(s==null?void 0:s.outline)??i.frameRendering.outline}}})});B(this,"togglePenMode",n=>{this.setState(i=>({penMode:n??!i.penMode,penDetected:!0}))});B(this,"onHandToolToggle",()=>{this.actionManager.executeAction(rEe)});B(this,"zoomCanvas",n=>{this.setState({...su({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:ml(n)},this.state)})});B(this,"cancelInProgressAnimation",null);B(this,"scrollToContent",(n=this.scene.getNonDeletedElements(),i)=>{var l;if(typeof n=="string"){let c;if(Lh(n)?c=Sfe(n):c=n,c){const d=this.scene.getElementsFromId(c);d!=null&&d.length?this.scrollToContent(d,{fitToContent:(i==null?void 0:i.fitToContent)??!0,animate:(i==null?void 0:i.animate)??!0}):Lh(n)&&this.setState({toast:{message:x("elementLink.notFound"),duration:3e3,closable:!0}})}return}(l=this.cancelInProgressAnimation)==null||l.call(this);const s=Array.isArray(n)?n:[n];let r=this.state.zoom,o=this.state.scrollX,a=this.state.scrollY;if(i!=null&&i.fitToContent||i!=null&&i.fitToViewport){const{appState:c}=AE({canvasOffsets:i.canvasOffsets,targetElements:s,appState:this.state,fitToViewport:!!(i!=null&&i.fitToViewport),viewportZoomFactor:i==null?void 0:i.viewportZoomFactor,minZoom:i==null?void 0:i.minZoom,maxZoom:i==null?void 0:i.maxZoom});r=c.zoom,o=c.scrollX,a=c.scrollY}else{const c=K0(s,this.state);o=c.scrollX,a=c.scrollY}if(i!=null&&i.animate){const c=this.state.scrollX,d=this.state.scrollY,u=this.state.zoom.value,f=Gie({fromValues:{scrollX:c,scrollY:d,zoom:u},toValues:{scrollX:o,scrollY:a,zoom:r.value},interpolateValue:(h,m,p,U)=>{if(U==="zoom")return h*Math.pow(m/h,Ml(p))},onStep:({scrollX:h,scrollY:m,zoom:p})=>{this.setState({scrollX:h,scrollY:m,zoom:{value:p}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:(i==null?void 0:i.duration)??500});this.cancelInProgressAnimation=()=>{f(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:o,scrollY:a,zoom:r})});B(this,"maybeUnfollowRemoteUser",()=>{this.state.userToFollow&&this.setState({userToFollow:null})});B(this,"translateCanvas",n=>{var i;(i=this.cancelInProgressAnimation)==null||i.call(this),this.maybeUnfollowRemoteUser(),this.setState(n)});B(this,"setToast",n=>{this.setState({toast:n})});B(this,"restoreFileFromShare",async()=>{try{const n=await caches.open("web-share-target"),i=await n.match("shared-file");if(i){const s=await i.blob(),r=new File([s],s.name||"",{type:s.type});this.loadFileToCanvas(r,null),await n.delete("shared-file"),window.history.replaceState(null,Bc,window.location.pathname)}}catch(n){this.setState({errorMessage:n.message})}});B(this,"addFiles",hn(n=>{const{addedFiles:i}=this.addMissingFiles(n);this.clearImageShapeCache(i),this.scene.triggerUpdate(),this.addNewImagesToImageCache()}));B(this,"addMissingFiles",(n,i=!1)=>{const s=i?{}:{...this.files},r={},o=Array.isArray(n)?n:Object.values(n);for(const a of o)if(!s[a.id]&&(r[a.id]=a,s[a.id]=a,a.mimeType===Ee.svg))try{const l=m7e(tR(p7e(a.dataURL)),Ee.svg);a.dataURL!==l&&(a.version=(a.version??1)+1,a.dataURL=l)}catch(l){console.error(l)}return this.files=s,{addedFiles:r}});B(this,"updateScene",hn(n=>{const{elements:i,appState:s,collaborators:r,captureUpdate:o}=n;if(o){const a=i||void 0,l=s?Dh({...this.store.snapshot.appState,...s}):void 0;this.store.scheduleMicroAction({action:o,elements:a,appState:l})}s&&this.setState(s),i&&this.scene.replaceAllElements(i),r&&this.setState({collaborators:r})}));B(this,"applyDeltas",(n,i)=>{const s=Ou.squash(...n),r={...this.state},o=new Map(this.scene.getElementsMapIncludingDeleted());return Ou.applyTo(s,o,r,i)});B(this,"mutateElement",(n,i,s=!0)=>this.scene.mutateElement(n,i,{informMutation:s,isDragging:!1}));B(this,"triggerRender",n=>{n===!0?this.scene.triggerUpdate():this.setState({})});B(this,"toggleSidebar",({name:n,tab:i,force:s})=>{var a,l;let r;s===void 0?r=((a=this.state.openSidebar)==null?void 0:a.name)===n&&((l=this.state.openSidebar)==null?void 0:l.tab)===i?null:n:r=s?n:null;const o=r?{name:r}:null;return o&&i&&(o.tab=i),this.setState({openSidebar:o}),!!r});B(this,"updateCurrentCursorPosition",hn(n=>{this.lastViewportPosition.x=n.clientX,this.lastViewportPosition.y=n.clientY}));B(this,"getEditorUIOffsets",()=>{var o,a,l,c,d,u,f,h,m,p;const n=((c=(l=(a=(o=this.excalidrawContainerRef)==null?void 0:o.current)==null?void 0:a.querySelector(".App-toolbar"))==null?void 0:l.getBoundingClientRect())==null?void 0:c.bottom)??0,i=(f=(u=(d=this.excalidrawContainerRef)==null?void 0:d.current)==null?void 0:u.querySelector(".sidebar"))==null?void 0:f.getBoundingClientRect(),s=(p=(m=(h=this.excalidrawContainerRef)==null?void 0:h.current)==null?void 0:m.querySelector(".App-menu__left"))==null?void 0:p.getBoundingClientRect(),r=16;return W0().rtl?{top:n+r,right:Math.max(this.state.width-((s==null?void 0:s.left)??this.state.width),0)+r,bottom:r,left:Math.max((i==null?void 0:i.right)??0,0)+r}:{top:n+r,right:Math.max(this.state.width-((i==null?void 0:i.left)??this.state.width)+r,0),bottom:r,left:Math.max((s==null?void 0:s.right)??0,0)+r}});B(this,"onKeyDown",hn(n=>{var o,a,l,c,d,u;if("Proxy"in window&&(!n.shiftKey&&/^[A-Z]$/.test(n.key)||n.shiftKey&&/^[a-z]$/.test(n.key))&&(n=new Proxy(n,{get(f,h){const m=f[h];return typeof m=="function"?m.bind(f):h==="key"?n.shiftKey?f.key.toUpperCase():f.key.toLowerCase():m}})),!h4(n.target)){if((n.key===$.ESCAPE||n.key===$.ENTER)&&this.state.croppingElementId){this.finishImageCropping();return}const f=Ze(this.scene.getNonDeletedElementsMap(),this.state);if(f.length===1&&xt(f[0])&&n.key===$.ENTER){this.startImageCropping(f[0]);return}if(n.key===$.ESCAPE)this.updateEditorAtom(el,null);else if(n.key===$.TAB&&(document.activeElement===((o=this.excalidrawContainerRef)==null?void 0:o.current)||(a=document.activeElement)!=null&&a.classList.contains(Wi.CONVERT_ELEMENT_TYPE_POPUP))){n.preventDefault();const m=XE(f);((l=ar.get(el))==null?void 0:l.type)==="panel"&&pW(this,{conversionType:m,direction:n.shiftKey?"left":"right"})&&this.store.scheduleCapture(),m&&this.updateEditorAtom(el,{type:"panel"})}if(n.key===$.ESCAPE&&this.flowChartCreator.isCreatingChart){this.flowChartCreator.clear(),this.triggerRender(!0);return}const h=f1(n.key);if(n[$.CTRL_OR_CMD]&&h&&!n.shiftKey){n.preventDefault();const m=Ze(this.scene.getNonDeletedElementsMap(),this.state);m.length===1&&Wy(m[0])&&this.flowChartCreator.createNodes(m[0],this.state,Jk(n.key),this.scene),(c=this.flowChartCreator.pendingNodes)!=null&&c.length&&!Cb(this.flowChartCreator.pendingNodes,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(this.flowChartCreator.pendingNodes,{animate:!0,duration:300,fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()});return}if(n.altKey){const m=Ze(this.scene.getNonDeletedElementsMap(),this.state);if(m.length===1&&h){n.preventDefault();const p=this.flowChartNavigator.exploreByDirection(m[0],this.scene.getNonDeletedElementsMap(),Jk(n.key));if(p){this.setState(b=>({selectedElementIds:It({[p]:!0},b)}));const U=this.scene.getNonDeletedElementsMap().get(p);U&&!Cb([U],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(U,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})}return}}}if(n[$.CTRL_OR_CMD]&&n.key===$.P&&!n.shiftKey&&!n.altKey){this.setToast({message:x("commandPalette.shortcutHint",{shortcut:Ln("commandPalette")})}),n.preventDefault();return}if(n[$.CTRL_OR_CMD]&&n.key.toLowerCase()===$.V&&(J7=n.shiftKey,clearTimeout(IP),IP=window.setTimeout(()=>{J7=!1},100)),n[$.CTRL_OR_CMD]&&rl(n.target)&&(n.code===ut.MINUS||n.code===ut.EQUAL)){n.preventDefault();return}if(rl(n.target)&&n.key!==$.ESCAPE||f1(n.key)&&h4(n.target))return;if(n.key===$.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}else if(n.key.toLowerCase()===$.E&&n.shiftKey&&n[$.CTRL_OR_CMD]){n.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(n.key===$.PAGE_UP||n.key===$.PAGE_DOWN){let f=(n.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;n.key===$.PAGE_DOWN&&(f=-f),n.shiftKey?this.translateCanvas(h=>({scrollX:h.scrollX+f})):this.translateCanvas(h=>({scrollY:h.scrollY+f}))}if(((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector"||(n.key===$.ALT&&(Ii("COMPLEX_BINDINGS")?this.handleSkipBindMode():RU({app:this,event:n})),this.actionManager.handleKeyDown(n))||this.state.viewModeEnabled)return;if(n[$.CTRL_OR_CMD]&&this.state.isBindingEnabled&&(Ii("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),tn.flushSync(()=>{this.setState({isBindingEnabled:!1})}),RU({app:this,event:n})),f1(n.key)){let f=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});const h=new Set;f.filter(b=>ln(b)).filter(b=>{const y=b.startBinding&&!f.some(_=>{var I;return _.id===((I=b.startBinding)==null?void 0:I.elementId)}),E=b.endBinding&&!f.some(_=>{var I;return _.id===((I=b.endBinding)==null?void 0:I.elementId)});return y||E}).forEach(b=>h.add(b.id)),f=f.filter(b=>!h.has(b.id));const m=this.getEffectiveGridSize()&&(n.shiftKey?qA:this.getEffectiveGridSize())||(n.shiftKey?Zne:qA);let p=0,U=0;n.key===$.ARROW_LEFT?p=-m:n.key===$.ARROW_RIGHT?p=m:n.key===$.ARROW_UP?U=-m:n.key===$.ARROW_DOWN&&(U=m),f.forEach(b=>{this.scene.mutateElement(b,{x:b.x+p,y:b.y+U},{informMutation:!1,isDragging:!1}),pi(b,this.scene,{simultaneouslyUpdated:f})}),this.scene.triggerUpdate(),n.preventDefault()}else if(n.key===$.ENTER){const f=this.scene.getSelectedElements(this.state);if(f.length===1){const h=f[0];if(n[$.CTRL_OR_CMD]||cn(h))De(h)&&(!((u=this.state.selectedLinearElement)!=null&&u.isEditing)||this.state.selectedLinearElement.elementId!==h.id)&&(this.store.scheduleCapture(),ve(h)||this.actionManager.executeAction(KU));else if(he(h)||Rde(h)){let m;he(h)||(m=h);const p=F3(h,this.state,this.scene.getNonDeletedElementsMap()),U=p.x,b=p.y;this.startTextEditing({sceneX:U,sceneY:b,container:m}),n.preventDefault();return}else _e(h)&&this.setState({editingFrame:h.id})}}else if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged){const f=j4e(n.key,this);f?(this.state.activeTool.type!==f&&at("toolbar",f,`keyboard (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),f==="arrow"&&this.state.activeTool.type==="arrow"&&this.setState(h=>({currentItemArrowType:h.currentItemArrowType===zn.sharp?zn.round:h.currentItemArrowType===zn.round?zn.elbow:zn.sharp})),this.setActiveTool({type:f}),n.stopPropagation()):n.key===$.Q&&(this.toggleLock("keyboard"),n.stopPropagation())}if(n.key===$.SPACE&&Tt.pointers.size===0&&(zd=!0,Bt(this.interactiveCanvas,Dt.GRAB),n.preventDefault()),(n.key===$.G||n.key===$.S)&&!n.altKey&&!n[$.CTRL_OR_CMD]){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;n.key===$.G&&(ld(this.state.activeTool.type)||f.some(h=>ld(h.type)))&&(this.setState({openPopup:"elementBackground"}),n.stopPropagation()),n.key===$.S&&(this.setState({openPopup:"elementStroke"}),n.stopPropagation())}if(!n[$.CTRL_OR_CMD]&&n.shiftKey&&n.key.toLowerCase()===$.F){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;(this.state.activeTool.type==="text"||f.find(h=>he(h)||Ne(h,this.scene.getNonDeletedElementsMap())))&&(n.preventDefault(),this.setState({openPopup:"fontFamily"}))}if(n.key===$.K&&!n.altKey&&!n[$.CTRL_OR_CMD]){this.state.activeTool.type==="laser"?this.setActiveTool({type:this.state.preferredSelectionTool.type}):this.setActiveTool({type:"laser"});return}n[$.CTRL_OR_CMD]&&(n.key===$.BACKSPACE||n.key===$.DELETE)&&this.updateEditorAtom(QE,"clearCanvas");const i=n.key.toLocaleLowerCase(),s=i===$.S&&n.shiftKey,r=n.key===$.I||i===$.G&&n.shiftKey;(s||r)&&this.openEyeDropper({type:s?"stroke":"background"})}));B(this,"onKeyUp",hn(n=>{var i,s,r;if(n.key===$.SPACE&&(this.state.viewModeEnabled||((i=this.state.openDialog)==null?void 0:i.name)==="elementLinkSelector"?Bt(this.interactiveCanvas,Dt.GRAB):UU(this.state.activeTool.type)?oo(this.interactiveCanvas):(Vo(this.interactiveCanvas,this.state),this.setState({selectedElementIds:It({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),zd=!1),n.key===$.ALT&&RU({app:this,event:n}),(n.key===$.ALT&&this.state.bindMode==="skip"||!n[$.CTRL_OR_CMD]&&!or(this.state))&&(this.setState({bindMode:"orbit"}),this.lastPointerMoveEvent&&Ii("COMPLEX_BINDINGS"))){const o=zt({clientX:this.lastPointerMoveEvent.clientX,clientY:this.lastPointerMoveEvent.clientY},this.state),a=Bi(M(o.x,o.y),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(this.state.selectedLinearElement){const l=ne.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());ln(l)&&this.handleDelayedBindModeChange(l,a)}}if(!n[$.CTRL_OR_CMD]&&!this.state.isBindingEnabled&&(tn.flushSync(()=>{this.setState({isBindingEnabled:!0})}),RU({app:this,event:n})),f1(n.key)){O4(this.scene.getSelectedElements(this.state).filter(Te),this.scene,this.state);const o=this.scene.getNonDeletedElementsMap();this.scene.getSelectedElements(this.state).filter(L3).forEach(a=>{a.startBinding&&this.scene.mutateElement(a,{startBinding:{...a.startBinding,...Nu(a,o.get(a.startBinding.elementId),"start",o)}}),a.endBinding&&this.scene.mutateElement(a,{endBinding:{...a.endBinding,...Nu(a,o.get(a.endBinding.elementId),"end",o)}})}),this.setState({suggestedBinding:null})}if(n.altKey||this.flowChartNavigator.isExploring&&(this.flowChartNavigator.clear(),this.syncActionResult({captureUpdate:q.IMMEDIATELY})),!n[$.CTRL_OR_CMD]&&this.flowChartCreator.isCreatingChart){(s=this.flowChartCreator.pendingNodes)!=null&&s.length&&this.scene.insertElements(this.flowChartCreator.pendingNodes);const o=(r=this.flowChartCreator.pendingNodes)==null?void 0:r[0];o&&(this.setState(a=>({selectedElementIds:It({[o.id]:!0},a)})),Cb([o],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())||this.scrollToContent(o,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})),this.flowChartCreator.clear(),this.syncActionResult({captureUpdate:q.IMMEDIATELY})}}));B(this,"isToolSupported",n=>{var i;return((i=this.props.UIOptions.tools)==null?void 0:i[n])!==!1});B(this,"setActiveTool",(n,i=!1)=>{if(!this.isToolSupported(n.type)){console.warn(`"${n.type}" tool is disabled via "UIOptions.canvasActions.tools.${n.type}"`);return}const s=sn(this.state,n);s.type==="hand"?Bt(this.interactiveCanvas,Dt.GRAB):zd||Vo(this.interactiveCanvas,{...this.state,activeTool:s}),Hie(document.activeElement)&&this.focusContainer(),FH(s.type)||this.setState({suggestedBinding:null}),s.type==="image"&&this.onImageToolbarButtonClick(),this.setState(r=>{const o={snapLines:r.snapLines.length?[]:r.snapLines,originSnapOffset:null,activeEmbeddable:null,selectedLinearElement:UU(s.type)?r.selectedLinearElement:null};return s.type==="freedraw"&&this.store.scheduleCapture(),s.type==="lasso"?{...r,...o,activeTool:s,...i?{}:{selectedElementIds:It({},r),selectedGroupIds:It({},r),editingGroupId:null,multiElement:null}}:s.type!=="selection"?{...r,...o,activeTool:s,selectedElementIds:It({},r),selectedGroupIds:It({},r),editingGroupId:null,multiElement:null}:{...r,...o,activeTool:s}})});B(this,"setOpenDialog",n=>{this.setState({openDialog:n})});B(this,"setCursor",n=>{Bt(this.interactiveCanvas,n)});B(this,"resetCursor",()=>{oo(this.interactiveCanvas)});B(this,"isTouchScreenMultiTouchGesture",()=>Tt.pointers.size>=2);B(this,"getName",()=>this.state.name||this.props.name||`${x("labels.untitled")}-${rM()}`);B(this,"onGestureStart",hn(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:It({},this.state),activeEmbeddable:null}),Tt.initialScale=this.state.zoom.value}));B(this,"onGestureChange",hn(n=>{if(n.preventDefault(),this.isTouchScreenMultiTouchGesture())return;const i=Tt.initialScale;i&&this.setState(s=>({...su({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:ml(i*n.scale)},s)}))}));B(this,"onGestureEnd",hn(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:It(this.state.previousSelectedElementIds,this.state)}),Tt.initialScale=null}));B(this,"startTextEditing",({sceneX:n,sceneY:i,insertAtParentCenter:s=!0,container:r,autoEdit:o=!0})=>{let a=!1,l=s&&this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r);r&&l&&(Ne(r,this.scene.getNonDeletedElementsMap())||(a=!0));let c=null;const d=this.scene.getSelectedElements(this.state);d.length===1?he(d[0])?c=d[0]:r?c=Ne(d[0],this.scene.getNonDeletedElementsMap()):c=this.getTextElementAtPosition(n,i):c=this.getTextElementAtPosition(n,i);const u=(c==null?void 0:c.fontFamily)||this.state.currentItemFontFamily,f=(c==null?void 0:c.lineHeight)||id(u),h=this.state.currentItemFontSize;if(!c&&a&&r&&!Te(r)){const b=jH(_t({fontSize:h,fontFamily:u}),f),y=YH(h,f),E=Math.max(r.height,y),_=Math.max(r.width,b);this.scene.mutateElement(r,{height:E,width:_}),n=r.x+_/2,i=r.y+E/2,l&&(l=this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r))}const m=this.getTopLayerFrameAtSceneCoords({x:n,y:i}),p=c||_r({x:l?l.elementCenterX:n,y:l?l.elementCenterY:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:h,fontFamily:u,textAlign:l?"center":this.state.currentItemTextAlign,verticalAlign:l?lr.MIDDLE:L6,containerId:a?r==null?void 0:r.id:void 0,groupIds:(r==null?void 0:r.groupIds)??[],lineHeight:f,angle:r?Te(r)?0:r.angle:0,frameId:m?m.id:null});if(!c&&a&&r&&this.scene.mutateElement(r,{boundElements:(r.boundElements||[]).concat({type:"text",id:p.id})}),this.setState({editingTextElement:p}),!c)if(r&&a){const U=this.scene.getElementIndex(r.id);this.scene.insertElementAtIndex(p,U+1)}else this.scene.insertElement(p);o||c||r?this.handleTextWysiwyg(p,{isExistingElement:!!c}):this.setState({newElement:p,multiElement:null})});B(this,"startImageCropping",n=>{this.store.scheduleCapture(),this.setState({croppingElementId:n.id})});B(this,"finishImageCropping",()=>{this.state.croppingElementId&&(this.store.scheduleCapture(),this.setState({croppingElementId:null}))});B(this,"handleCanvasDoubleClick",n=>{var a,l,c;if(this.state.multiElement||this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const i=this.scene.getSelectedElements(this.state);let{x:s,y:r}=zt(n,this.state);if(i.length===1&&De(i[0])){const d=i[0];if((n[$.CTRL_OR_CMD]&&L3(d)||cn(d))&&(!((a=this.state.selectedLinearElement)!=null&&a.isEditing)||this.state.selectedLinearElement.elementId!==d.id)){this.actionManager.executeAction(KU);return}else if(this.state.selectedLinearElement&&ve(i[0])){const u=ne.getSegmentMidpointHitCoords(this.state.selectedLinearElement,{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),f=u?ne.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,u,this.scene.getNonDeletedElementsMap()):-1;if(f&&f>-1){this.store.scheduleCapture(),ne.deleteFixedSegment(i[0],this.scene,f);const h=ne.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),m=h?ne.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,h,this.scene.getNonDeletedElementsMap()):null;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,segmentMidpoint:{index:m,value:u,added:!1}},segmentMidPointHoveredCoords:h}});return}}else if((l=this.state.selectedLinearElement)!=null&&l.isEditing&&this.state.selectedLinearElement.elementId===d.id&&cn(d))return}if(i.length===1&&xt(i[0])){this.startImageCropping(i[0]);return}if(oo(this.interactiveCanvas),zc(this.state).length>0){const d=this.getElementAtPosition(s,r),u=d&&uV(d,this.state.selectedGroupIds);if(u){this.store.scheduleCapture(),this.setState(f=>({...f,...Fi({editingGroupId:u,selectedElementIds:{[d.id]:!0}},this.scene.getNonDeletedElements(),f,this)}));return}}if(oo(this.interactiveCanvas),!n[$.CTRL_OR_CMD]&&!this.state.viewModeEnabled){const d=this.getElementAtPosition(s,r);if(Br(d)){this.setState({activeEmbeddable:{element:d,state:"active"}});return}if(!((c=this.state.selectedLinearElement)!=null&&c.isEditing)){const u=this.getTextBindableContainerAtPosition(s,r);if(u&&(Ki(u)||!ds(u.backgroundColor)||ol({point:M(s,r),element:u,elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(u)}))){const f=F3(u,this.state,this.scene.getNonDeletedElementsMap());s=f.x,r=f.y}this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:u})}}});B(this,"getElementLinkAtPosition",(n,i)=>{if(i&&i.locked)return;const s=this.scene.getNonDeletedElements();let r=-1;for(let o=s.length-1;o>=0;o--){const a=s[o];if(i&&a.id===i.id&&(r=o),a.link&&o>=r&&S7(a,this.scene.getNonDeletedElementsMap(),this.state,M(n.x,n.y),this.editorInterface.formFactor==="phone"))return a}});B(this,"redirectToLink",(n,i)=>{const s=Qe(M(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY),M(this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY));if(!this.hitLinkElement||s>O0)return;const r=zt(this.lastPointerDownEvent,this.state),o=this.scene.getNonDeletedElementsMap(),a=S7(this.hitLinkElement,o,this.state,M(r.x,r.y),this.editorInterface.formFactor==="phone"),l=zt(this.lastPointerUpEvent,this.state),c=S7(this.hitLinkElement,o,this.state,M(l.x,l.y),this.editorInterface.formFactor==="phone");if(a&&c){vL();let d=this.hitLinkElement.link;if(d){d=Ur(d);let u;if(this.props.onLinkOpen&&(u=Nz(te.EXCALIDRAW_LINK,n.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:d},u)),!(u!=null&&u.defaultPrevented)){const f=Vz(d)?"_self":"_blank",h=window.open(void 0,f);h&&(h.opener=null,h.location=d)}}}});B(this,"getTopLayerFrameAtSceneCoords",n=>{const i=this.scene.getNonDeletedElementsMap(),s=this.scene.getNonDeletedFramesLikes().filter(r=>!r.locked&&Ak(n,r,i));return s.length?s[s.length-1]:null});B(this,"handleCanvasPointerMove",n=>{var m,p,U,b,y,E,_,I,k,w;this.savePointer(n.clientX,n.clientY,this.state.cursorButton),this.lastPointerMoveEvent=n.nativeEvent;const i=zt(n,this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r},Tt.pointers.has(n.pointerId)&&Tt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY});const o=Tt.initialScale;if(Tt.pointers.size===2&&Tt.lastCenter&&o&&Tt.initialDistance){const T=OL(Tt.pointers),A=T.x-Tt.lastCenter.x,S=T.y-Tt.lastCenter.y;Tt.lastCenter=T;const D=FL(Array.from(Tt.pointers.values())),N=this.state.activeTool.type==="freedraw"&&this.state.penMode?1:D/Tt.initialDistance,L=N?ml(o*N):this.state.zoom.value;this.setState(j=>{const Y=su({viewportX:T.x,viewportY:T.y,nextZoom:L},j);return this.translateCanvas({zoom:Y.zoom,scrollX:Y.scrollX+2*(A/L),scrollY:Y.scrollY+2*(S/L),shouldCacheIgnoreZoom:!0}),null}),this.resetShouldCacheIgnoreZoomDebounced()}else Tt.lastCenter=Tt.initialDistance=Tt.initialScale=null;if(zd||qm||q7||_g(this.state))return;const l=KL(Qm,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop).isOverEither;if(!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.multiElement&&(l?oo(this.interactiveCanvas):Vo(this.interactiveCanvas,this.state)),!this.state.newElement&&twe(this.state.activeTool.type)){const{originOffset:T,snapLines:A}=ewe(this.scene.getNonDeletedElements(),this,{x:s,y:r},n,this.scene.getNonDeletedElementsMap());this.setState(S=>{const D=Nm(S.snapLines,A),N=S.originSnapOffset?Nm(S.originSnapOffset,T):T;return S.snapLines===D&&S.originSnapOffset===N?null:{snapLines:D,originSnapOffset:N}})}else!this.state.newElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.selectionElement&&this.setState(T=>T.snapLines.length?{snapLines:[]}:null);if((m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedLinearElement.isDragging){const T=this.state.newElement?null:ne.handlePointerMoveInEditMode(n,s,r,this);T&&T!==this.state.selectedLinearElement&&tn.flushSync(()=>{this.setState({selectedLinearElement:T})})}if(BH(this.state.activeTool.type)){const{newElement:T}=this.state;if(!T&&or(this.state)){const A=Bi(M(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),vl(this.state.zoom));A?this.setState({suggestedBinding:A}):this.state.suggestedBinding&&this.setState({suggestedBinding:null})}}if(this.state.multiElement&&this.state.selectedLinearElement){const{multiElement:T,selectedLinearElement:A}=this.state,{x:S,y:D,points:N}=T,L=N[N.length-1],{lastCommittedPoint:j}=A;if(Vo(this.interactiveCanvas,this.state),L===j)Te(this.state.newElement)&&or(this.state)&&Bi(M(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),vl(this.state.zoom))?(this.actionManager.executeAction(qs,"ui",{event:n.nativeEvent,sceneCoords:{x:s,y:r}}),this.setState({suggestedBinding:null,startBoundElement:null}),this.state.activeTool.locked||(oo(this.interactiveCanvas),this.setState(G=>({newElement:null,activeTool:sn(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:It({...G.selectedElementIds,[T.id]:!0},G),selectedLinearElement:new ne(T,this.scene.getNonDeletedElementsMap())})))):Qe(M(s-S,r-D),L)>=bb?(this.scene.mutateElement(T,{points:[...N,M(s-S,r-D)]},{informMutation:!1,isDragging:!1}),Ce((p=this.state.selectedLinearElement)==null?void 0:p.initialState,"initialState must be set"),this.setState({selectedLinearElement:{...this.state.selectedLinearElement,lastCommittedPoint:N[N.length-1],selectedPointsIndices:[T.points.length-1],initialState:{...this.state.selectedLinearElement.initialState,lastClickedPoint:T.points.length-1}}})):Bt(this.interactiveCanvas,Dt.POINTER);else if(N.length>2&&j&&Qe(M(s-S,r-D),j)<bb)Bt(this.interactiveCanvas,Dt.POINTER),this.scene.mutateElement(T,{points:N.slice(0,-1)},{informMutation:!1,isDragging:!1}),this.setState({selectedLinearElement:{...A,selectedPointsIndices:(U=A.selectedPointsIndices)!=null&&U.includes(T.points.length)?[...A.selectedPointsIndices.filter(Y=>Y!==T.points.length&&Y!==T.points.length-1),T.points.length-1]:A.selectedPointsIndices,lastCommittedPoint:T.points[T.points.length-1],initialState:{...A.initialState,lastClickedPoint:T.points.length-1}}});else{Ea(N,this.state.zoom.value)&&Bt(this.interactiveCanvas,Dt.POINTER);const Y=this.scene.getNonDeletedElementsMap();if(L3(T)){const O=Bi(M(s,r),this.scene.getNonDeletedElements(),Y);Ii("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(T,O)}Ce(this.state.selectedLinearElement,"Expected selectedLinearElement to be set to operate on a linear element");const G=ne.handlePointerMove(n.nativeEvent,this,s,r,this.state.selectedLinearElement);G&&this.setState(G)}return}if(this.state.activeTool.type==="arrow"){const T=Bi(M(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),vl(this.state.zoom));T&&!wa(M(s,r),T,this.scene.getNonDeletedElementsMap())&&this.setState({suggestedBinding:T})}if(!!n.buttons||this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.state.activeTool.type!=="text"&&this.state.activeTool.type!=="eraser")return;const d=this.scene.getNonDeletedElements(),u=this.scene.getSelectedElements(this.state);if(u.length===1&&!l&&!((b=this.state.selectedLinearElement)!=null&&b.isEditing)){if(this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,s,r),(!this.state.selectedLinearElement||this.state.selectedLinearElement.hoverPointIndex===-1)&&((y=this.state.openDialog)==null?void 0:y.name)!=="elementLinkSelector"&&!(u.length===1&&ve(u[0]))&&!(De(u[0])&&(this.editorInterface.userAgent.isMobileDevice||u[0].points.length===2))){const T=rR(d,this.state,s,r,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);if(T&&T.transformHandleType){Bt(this.interactiveCanvas,aR(T));return}}}else if(u.length>1&&!l&&((E=this.state.openDialog)==null?void 0:E.name)!=="elementLinkSelector"){const T=oR(Et(u),s,r,this.state.zoom,n.pointerType,this.editorInterface);if(T){Bt(this.interactiveCanvas,aR({transformHandleType:T}));return}}const f=this.getElementAtPosition(s,r,{preferSelected:!0,includeLockedElements:!0});let h=null;f&&f.locked?h=null:h=f,this.hitLinkElement=this.getElementLinkAtPosition(i,f),!Yo(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(Bt(this.interactiveCanvas,Dt.POINTER),hve(this.hitLinkElement,this.state,this.scene.getNonDeletedElementsMap())):(vL(),h&&(h.link||Es(h))&&this.state.selectedElementIds[h.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):this.state.activeTool.type==="text"?Bt(this.interactiveCanvas,he(h)?Dt.TEXT:Dt.CROSSHAIR):this.state.viewModeEnabled?Bt(this.interactiveCanvas,Dt.GRAB):((_=this.state.openDialog)==null?void 0:_.name)==="elementLinkSelector"?Bt(this.interactiveCanvas,Dt.AUTO):l?Bt(this.interactiveCanvas,Dt.AUTO):n[$.CTRL_OR_CMD]?Bt(this.interactiveCanvas,Dt.AUTO):(h||this.isHittingCommonBoundingBoxOfSelectedElements(i,u))&&!(h!=null&&h.locked)&&(h&&Br(h)&&this.isIframeLikeElementCenter(h,n,s,r)?(Bt(this.interactiveCanvas,Dt.POINTER),this.setState({activeEmbeddable:{element:h,state:"hover"}})):(!h||!ve(h)||!(h.startBinding||h.endBinding))&&((this.state.activeTool.type!=="lasso"||u.length>0)&&Bt(this.interactiveCanvas,Dt.MOVE),((I=this.state.activeEmbeddable)==null?void 0:I.state)==="hover"&&this.setState({activeEmbeddable:null}))),this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,s,r)),((k=this.state.openDialog)==null?void 0:k.name)==="elementLinkSelector"&&h?this.setState(T=>({hoveredElementIds:Nm(T.hoveredElementIds,Fi({editingGroupId:T.editingGroupId,selectedElementIds:{[h.id]:!0}},this.scene.getNonDeletedElements(),T,this).selectedElementIds)})):((w=this.state.openDialog)==null?void 0:w.name)==="elementLinkSelector"&&!h&&this.setState(T=>({hoveredElementIds:Nm(T.hoveredElementIds,{})})))});B(this,"handleEraser",(n,i)=>{const s=this.eraserTrail.addPointToPath(i.x,i.y,n.altKey);this.elementsPendingErasure=new Set(s),this.triggerRender()});B(this,"handleTouchMove",n=>{Jm=!0});B(this,"handleCanvasPointerDown",n=>{var m,p,U;const i=zt(n,this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r};const o=n.target;if(o.setPointerCapture&&o.setPointerCapture(n.pointerId),this.maybeCleanupAfterMissingPointerUp(n.nativeEvent),this.maybeUnfollowRemoteUser(),this.state.searchMatches&&(this.setState(b=>({searchMatches:b.searchMatches&&{focusedId:null,matches:b.searchMatches.matches.map(y=>({...y,focus:!1}))}})),this.updateEditorAtom(DK,null)),ar.get(el)&&this.updateEditorAtom(el,null),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.state.openPopup&&this.setState({openPopup:null}),this.updateGestureOnPointerDown(n),n.pointerType==="touch"&&this.state.newElement&&this.state.newElement.type==="freedraw"){const b=this.state.newElement;this.updateScene({...b.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(y=>y.id!==b.id)}:{},appState:{newElement:null,editingTextElement:null,startBoundElement:null,suggestedBinding:null,selectedElementIds:It(Object.keys(this.state.selectedElementIds).filter(y=>y!==b.id).reduce((y,E)=>(y[E]=this.state.selectedElementIds[E],y),{}),this.state)},captureUpdate:((m=this.state.openDialog)==null?void 0:m.name)==="elementLinkSelector"?q.EVENTUALLY:q.NEVER});return}const a=document.getSelection();if(a!=null&&a.anchorNode&&a.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(n),!this.state.penDetected&&n.pointerType==="pen"&&this.setState(b=>({penMode:!0,penDetected:!0})),!this.editorInterface.isTouchScreen&&["pen","touch"].includes(n.pointerType)&&(this.editorInterface=yb(this.editorInterface,{isTouchScreen:!0})),qm||(this.lastPointerDownEvent=n,this.handleCanvasPanUsingWheelOrSpaceDrag(n)))return;if(this.setState({lastPointerDownWith:n.pointerType,cursorButton:"down"}),this.savePointer(n.clientX,n.clientY,"down"),n.button===ic.ERASER&&this.state.activeTool.type!==ui.eraser){this.setState({activeTool:sn(this.state,{type:ui.eraser,lastActiveToolBeforeEraser:this.state.activeTool})},()=>{this.handleCanvasPointerDown(n);const b=()=>{y(),E==null||E(),Yo(this.state)&&this.setState({activeTool:sn(this.state,{...this.state.activeTool.lastActiveTool||{type:ui.selection},lastActiveToolBeforeEraser:null})})},y=an(window,te.POINTER_UP,b,{once:!0});let E;requestAnimationFrame(()=>{E=this.missingPointerEventCleanupEmitter.once(b)})});return}if(n.button!==ic.MAIN&&n.button!==ic.TOUCH&&n.button!==ic.ERASER||Tt.pointers.size>1)return;const l=this.initialPointerDownState(n);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(n,l)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(n),this.handleSelectionOnPointerDown(n,l))||!(!this.state.penMode||n.pointerType!=="touch"||this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"||this.state.activeTool.type==="text"||this.state.activeTool.type==="image"))return;if(this.state.activeTool.type==="lasso"){const b=l.hit.element&&this.isASelectedElement(l.hit.element);!l.hit.hasHitCommonBoundingBoxOfSelectedElements&&!l.resize.handleType&&!b&&(this.lassoTrail.startPath(l.origin.x,l.origin.y,n.shiftKey),l.drag.blockDragging=this.editorInterface.formFactor==="desktop"),this.editorInterface.formFactor!=="desktop"&&l.hit.element&&!b&&(this.setState(y=>{const E={...y.selectedElementIds,[l.hit.element.id]:!0},_=[];Object.keys(y.selectedElementIds).forEach(k=>{const w=this.scene.getElement(k);w&&_.push(w)});const I=l.hit.element;if(_e(I))br(_,I.id).forEach(k=>{delete E[k.id]});else if(I.frameId)E[I.frameId]&&delete E[I.id];else{const k=I.groupIds,w=new Set(k.flatMap(T=>Ot(this.scene.getNonDeletedElements(),T)).filter(T=>_e(T)).map(T=>T.id));w.size>0&&_.forEach(T=>{T.frameId&&w.has(T.frameId)&&(delete E[T.id],T.groupIds.flatMap(A=>Ot(this.scene.getNonDeletedElements(),A)).forEach(A=>{delete E[A.id]}))})}return{...Fi({editingGroupId:y.editingGroupId,selectedElementIds:E},this.scene.getNonDeletedElements(),y,this),showHyperlinkPopup:I.link||Es(I)?"info":!1}}),l.hit.wasAddedToSelection=!0)}else this.state.activeTool.type==="text"?this.handleTextOnPointerDown(n,l):this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line"?this.handleLinearElementOnPointerDown(n,this.state.activeTool.type,l):this.state.activeTool.type==="freedraw"?this.handleFreeDrawElementOnPointerDown(n,this.state.activeTool.type,l):this.state.activeTool.type==="custom"?Vo(this.interactiveCanvas,this.state):this.state.activeTool.type===ui.frame||this.state.activeTool.type===ui.magicframe?this.createFrameElementOnPointerDown(l,this.state.activeTool.type):this.state.activeTool.type==="laser"?this.laserTrails.startPath(l.lastCoords.x,l.lastCoords.y):this.state.activeTool.type!=="eraser"&&this.state.activeTool.type!=="hand"&&this.state.activeTool.type!=="image"&&this.createGenericElementOnPointerDown(this.state.activeTool.type,l);(U=(p=this.props)==null?void 0:p.onPointerDown)==null||U.call(p,this.state.activeTool,l),this.onPointerDownEmitter.trigger(this.state.activeTool,l,n),this.state.activeTool.type==="eraser"&&this.eraserTrail.startPath(l.lastCoords.x,l.lastCoords.y);const d=this.onPointerMoveFromPointerDownHandler(l),u=this.onPointerUpFromPointerDownHandler(l),f=this.onKeyDownFromPointerDownHandler(l),h=this.onKeyUpFromPointerDownHandler(l);this.missingPointerEventCleanupEmitter.once(b=>u(b||n.nativeEvent)),(!this.state.viewModeEnabled||this.state.activeTool.type==="laser")&&(window.addEventListener(te.POINTER_MOVE,d),window.addEventListener(te.POINTER_UP,u),window.addEventListener(te.KEYDOWN,f),window.addEventListener(te.KEYUP,h),l.eventListeners.onMove=d,l.eventListeners.onUp=u,l.eventListeners.onKeyUp=h,l.eventListeners.onKeyDown=f)});B(this,"handleCanvasPointerUp",n=>{var a;Ii("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),this.removePointer(n),this.lastPointerUpEvent=n;const i=zt({clientX:n.clientX,clientY:n.clientY},this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r};const o=n.timeStamp-(((a=this.lastPointerDownEvent)==null?void 0:a.timeStamp)??0);if(this.editorInterface.formFactor==="phone"&&o<300){const l=this.getElementAtPosition(i.x,i.y);if(Br(l)&&this.isIframeLikeElementCenter(l,n,i.x,i.y)){this.handleEmbeddableCenterClick(l);return}}if(this.editorInterface.isTouchScreen){const l=this.getElementAtPosition(i.x,i.y,{includeLockedElements:!0});this.hitLinkElement=this.getElementLinkAtPosition(i,l)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?o<300&&Br(this.hitLinkElement)&&!NY(this.hitLinkElement,this.scene.getNonDeletedElementsMap(),this.state,M(i.x,i.y))?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(n,this.editorInterface.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})});B(this,"maybeOpenContextMenuAfterPointerDownOnTouchDevices",n=>{n.pointerType==="touch"&&(Jm=!1,tc?Jm=!0:tc=window.setTimeout(()=>{tc=0,Jm||this.handleCanvasContextMenu(n)},lie))});B(this,"resetContextMenuTimer",()=>{clearTimeout(tc),tc=0,Jm=!1});B(this,"maybeCleanupAfterMissingPointerUp",n=>{Hd==null||Hd(),this.missingPointerEventCleanupEmitter.trigger(n).clear()});B(this,"handleCanvasPanUsingWheelOrSpaceDrag",n=>{if(!(Tt.pointers.size<=1&&(n.button===ic.WHEEL||n.button===ic.MAIN&&zd||_g(this.state)||this.state.viewModeEnabled)))return!1;qm=!0,this.focusContainer(),this.state.editingTextElement||n.preventDefault();let i=!1;const s=typeof window===void 0?!1:/Linux/.test(window.navigator.platform);Bt(this.interactiveCanvas,Dt.GRABBING);let{clientX:r,clientY:o}=n;const a=P7(c=>{const d=r-c.clientX,u=o-c.clientY;if(r=c.clientX,o=c.clientY,s&&!i&&(Math.abs(d)>1||Math.abs(u)>1)){i=!0;const f=m=>{document.body.removeEventListener(te.PASTE,f),m.stopPropagation()},h=()=>{setTimeout(()=>{document.body.removeEventListener(te.PASTE,f),window.removeEventListener(te.POINTER_UP,h)},100)};document.body.addEventListener(te.PASTE,f),window.addEventListener(te.POINTER_UP,h)}this.translateCanvas({scrollX:this.state.scrollX-d/this.state.zoom.value,scrollY:this.state.scrollY-u/this.state.zoom.value})}),l=hn(Hd=()=>{Hd=null,qm=!1,zd||(this.state.viewModeEnabled?Bt(this.interactiveCanvas,Dt.GRAB):Vo(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,a),window.removeEventListener(te.POINTER_UP,l),window.removeEventListener(te.BLUR,l),a.flush()});return window.addEventListener(te.BLUR,l),window.addEventListener(te.POINTER_MOVE,a,{passive:!0}),window.addEventListener(te.POINTER_UP,l),!0});B(this,"clearSelectionIfNotUsingSelection",()=>{UU(this.state.activeTool.type)||this.setState({selectedElementIds:It({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})});B(this,"handleSelectionOnPointerDown",(n,i)=>{var s,r,o,a,l,c;if(UU(this.state.activeTool.type)){const d=this.scene.getNonDeletedElements(),u=this.scene.getNonDeletedElementsMap(),f=this.scene.getSelectedElements(this.state);if(f.length===1&&!((s=this.state.selectedLinearElement)!=null&&s.isEditing)&&!ve(f[0])&&!(De(f[0])&&(this.editorInterface.userAgent.isMobileDevice||f[0].points.length===2))&&!(this.state.selectedLinearElement&&this.state.selectedLinearElement.hoverPointIndex!==-1)){const h=rR(d,this.state,i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);h!=null&&(h.transformHandleType==="rotation"?(this.setState({resizingElement:h.element}),i.resize.handleType=h.transformHandleType):(this.state.croppingElementId||this.setState({resizingElement:h.element}),i.resize.handleType=h.transformHandleType))}else f.length>1&&(i.resize.handleType=oR(Et(f),i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.editorInterface));if(i.resize.handleType)i.resize.isResizing=!0,i.resize.offset=_3(uhe(i.resize.handleType,f,u,i.origin.x,i.origin.y)),f.length===1&&De(f[0])&&f[0].points.length===2&&(i.resize.arrowDirection=fhe(i.resize.handleType,f[0]));else{if(this.state.selectedLinearElement){const y=this.state.selectedLinearElement,E=ne.handlePointerDown(n,this,this.store,i.origin,y,this.scene);if(E.hitElement&&(i.hit.element=E.hitElement),E.linearElementEditor&&this.setState({selectedLinearElement:E.linearElementEditor}),E.didAddPoint)return!0;const _=this.scene.getNonDeletedElementsMap(),I=ne.getElement(y.elementId,_);if(I&&ln(I)){const{hitFocusPoint:k,pointerOffset:w}=nhe(I,i,_,this.state);if(k)return this.setState({selectedLinearElement:{...y,hoveredFocusPointBinding:k,draggedFocusPointBinding:k,pointerOffset:w}}),!1}}const h=this.getElementsAtPosition(i.origin.x,i.origin.y,{includeLockedElements:!0}),m=h.filter(y=>!y.locked),p=this.getElementAtPosition(i.origin.x,i.origin.y,{allHitElements:h});if((!p||p.id!==this.state.activeLockedId)&&this.setState({activeLockedId:null}),p&&p.locked&&!m.some(y=>this.state.selectedElementIds[y.id])?i.hit.element=null:i.hit.element=i.hit.element??this.getElementAtPosition(i.origin.x,i.origin.y),this.hitLinkElement=this.getElementLinkAtPosition(i.origin,p),this.hitLinkElement)return!0;if(this.state.croppingElementId&&((r=i.hit.element)==null?void 0:r.id)!==this.state.croppingElementId&&this.finishImageCropping(),i.hit.element&&this.getElementLinkAtPosition({x:i.origin.x,y:i.origin.y},i.hit.element))return!1;i.hit.allHitElements=m;const U=i.hit.element,b=i.hit.allHitElements.some(y=>this.isASelectedElement(y));if((U===null||!b)&&!n.shiftKey&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(!((o=this.state.selectedLinearElement)!=null&&o.isEditing)||U&&(U==null?void 0:U.id)!==((a=this.state.selectedLinearElement)==null?void 0:a.elementId))&&this.clearSelection(U),(l=this.state.selectedLinearElement)!=null&&l.isEditing)this.setState(y=>{var E;return{selectedLinearElement:y.selectedLinearElement?{...y.selectedLinearElement,isEditing:!!U&&U.id===((E=this.state.selectedLinearElement)==null?void 0:E.elementId)}:null,selectedElementIds:y.selectedLinearElement?It({[y.selectedLinearElement.elementId]:!0},this.state):It({},y)}});else if(U!=null){if(n[$.CTRL_OR_CMD])return n.altKey?(((c=this.state.openDialog)==null?void 0:c.name)==="elementLinkSelector"&&this.setOpenDialog(null),this.lassoTrail.startPath(i.origin.x,i.origin.y,n.shiftKey),this.setActiveTool({type:"lasso",fromSelection:!0}),!1):(this.state.selectedElementIds[U.id]||(i.hit.wasAddedToSelection=!0),this.setState(y=>({...Tue(y,U),previousSelectedElementIds:this.state.selectedElementIds})),!1);this.state.selectedElementIds[U.id]||(this.state.editingGroupId&&!$0(U,this.state.editingGroupId)&&this.setState({selectedElementIds:It({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),!b&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(this.setState(y=>{var I;let E={...y.selectedElementIds,[U.id]:!0};const _=[];if(Object.keys(y.selectedElementIds).forEach(k=>{const w=this.scene.getElement(k);w&&_.push(w)}),_e(U))br(_,U.id).forEach(k=>{delete E[k.id]});else if(U.frameId)E[U.frameId]&&delete E[U.id];else{const k=U.groupIds,w=new Set(k.flatMap(T=>Ot(this.scene.getNonDeletedElements(),T)).filter(T=>_e(T)).map(T=>T.id));w.size>0&&_.forEach(T=>{T.frameId&&w.has(T.frameId)&&(delete E[T.id],T.groupIds.flatMap(A=>Ot(this.scene.getNonDeletedElements(),A)).forEach(A=>{delete E[A.id]}))})}return((I=y.openDialog)==null?void 0:I.name)==="elementLinkSelector"&&(U.groupIds.some(k=>y.selectedGroupIds[k])||(E={[U.id]:!0})),{...Fi({editingGroupId:y.editingGroupId,selectedElementIds:E},this.scene.getNonDeletedElements(),y,this),showHyperlinkPopup:U.link||Es(U)?"info":!1}}),i.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1});B(this,"handleTextOnPointerDown",(n,i)=>{if(this.state.editingTextElement)return;let s=i.origin.x,r=i.origin.y;const o=this.getElementAtPosition(s,r,{includeBoundTextElement:!0});let a=this.getTextBindableContainerAtPosition(s,r);Ki(o)&&(a=o,s=o.x+o.width/2,r=o.y+o.height/2),this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:a,autoEdit:!1}),oo(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:sn(this.state,{type:this.state.preferredSelectionTool.type})})});B(this,"handleFreeDrawElementOnPointerDown",(n,i,s)=>{const[r,o]=ci(s.origin.x,s.origin.y,null),a=this.getTopLayerFrameAtSceneCoords({x:r,y:o}),l=n.pressure===.5,c=Mfe({type:i,x:r,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:l,locked:!1,frameId:a?a.id:null,points:[M(0,0)],pressures:l?[]:[n.pressure]});this.scene.insertElement(c),this.setState(u=>{const f={...u.selectedElementIds};return delete f[c.id],{selectedElementIds:It(f,u)}});const d=Bi(M(s.origin.x,s.origin.y),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());this.setState({newElement:c,startBoundElement:d,suggestedBinding:null})});B(this,"insertIframeElement",({sceneX:n,sceneY:i,width:s,height:r})=>{var c;const[o,a]=ci(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=Cfe({type:"iframe",x:o,y:a,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:s,height:r});return this.scene.insertElement(l),l});B(this,"insertEmbeddableElement",({sceneX:n,sceneY:i,link:s})=>{var c;const[r,o]=ci(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=ph(s);if(!a)return;a.error instanceof URIError&&this.setToast({message:x("toast.unrecognizedLinkFormat"),closable:!0});const l=Yk({type:"embeddable",x:r,y:o,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:a.intrinsicSize.w,height:a.intrinsicSize.h,link:s});return this.scene.insertElement(l),l});B(this,"newImagePlaceholder",({sceneX:n,sceneY:i,addToFrameUnderCursor:s=!0})=>{var c;const[r,o]=ci(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=s?this.getTopLayerFrameAtSceneCoords({x:r,y:o}):null,l=100/this.state.zoom.value;return FV({type:"image",strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:a?a.id:null,x:r-l/2,y:o-l/2,width:l,height:l})});B(this,"handleLinearElementOnPointerDown",(n,i,s)=>{var r,o;if(n.ctrlKey&&tn.flushSync(()=>{this.setState({isBindingEnabled:!1})}),this.state.multiElement){const{multiElement:a,selectedLinearElement:l}=this.state;if(Ce(l,"selectedLinearElement is expected to be set"),a.type==="line"&&Ea(a.points,this.state.zoom.value)){tn.flushSync(()=>{this.setState({selectedLinearElement:{...l,lastCommittedPoint:a.points[a.points.length-1],initialState:{...l.initialState,lastClickedPoint:-1}}})}),this.actionManager.executeAction(qs);return}if(ve(a)&&a.points.length>1){this.actionManager.executeAction(qs,"ui",{event:n.nativeEvent,sceneCoords:{x:s.origin.x,y:s.origin.y}});return}const{x:c,y:d}=a,{lastCommittedPoint:u}=l,f=or(this.state)&&Bi(M(((r=this.lastPointerMoveCoords)==null?void 0:r.x)??c+a.points[a.points.length-1][0],((o=this.lastPointerMoveCoords)==null?void 0:o.y)??d+a.points[a.points.length-1][1]),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(ln(a)&&f||a.points.length>1&&u&&Qe(M(s.origin.x-c,s.origin.y-d),u)<bb){this.actionManager.executeAction(qs,"ui",{event:n.nativeEvent,sceneCoords:{x:s.origin.x,y:s.origin.y}});return}this.setState(h=>({selectedElementIds:It({...h.selectedElementIds,[a.id]:!0},h)})),Bt(this.interactiveCanvas,Dt.POINTER)}else{const[a,l]=ci(s.origin.x,s.origin.y,n[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),c=this.getTopLayerFrameAtSceneCoords({x:a,y:l}),{currentItemStartArrowhead:d,currentItemEndArrowhead:u}=this.state,[f,h]=i==="arrow"?[d,u]:[null,null],m=i==="arrow"?Ph({type:i,x:a,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemArrowType===zn.round?{type:wn.PROPORTIONAL_RADIUS}:null,startArrowhead:f,endArrowhead:h,locked:!1,frameId:c?c.id:null,elbowed:this.state.currentItemArrowType===zn.elbow,fixedSegments:this.state.currentItemArrowType===zn.elbow?[]:null}):Hc({type:i,x:a,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemRoundness==="round"?{type:wn.PROPORTIONAL_RADIUS}:null,locked:!1,frameId:c?c.id:null}),p=M(s.origin.x,s.origin.y),U=this.scene.getNonDeletedElementsMap(),b=or(this.state)?Bi(p,this.scene.getNonDeletedElements(),U):null;this.scene.mutateElement(m,{points:[M(0,0),M(0,0)]}),this.scene.insertElement(m),ln(m)&&gT(m,new Map([[0,{point:M(0,0),isDragging:!1}]]),p[0],p[1],this.scene,this.state,{newArrow:!0,altKey:n.altKey,initialBinding:!0,angleLocked:bc(n.nativeEvent)}),tn.flushSync(()=>{this.setState(y=>{let E=null,_=y.selectedElementIds;if(De(m)){E=new ne(m,this.scene.getNonDeletedElementsMap());const I=m.points.length-1;E={...E,selectedPointsIndices:[I],initialState:{...E.initialState,arrowStartIsInside:n.altKey,lastClickedPoint:I,origin:M(s.origin.x,s.origin.y)}}}return _=this.state.activeTool.locked?y.selectedElementIds:It({[m.id]:!0},y),{...y,bindMode:"orbit",newElement:m,startBoundElement:b,suggestedBinding:b||null,selectedElementIds:_,selectedLinearElement:E}})}),ln(m)&&Ii("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(m,b)}});B(this,"createGenericElementOnPointerDown",(n,i)=>{var c;const[s,r]=ci(i.origin.x,i.origin.y,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o=this.getTopLayerFrameAtSceneCoords({x:s,y:r}),a={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(n),locked:!1,frameId:o?o.id:null};let l;n==="embeddable"?l=Yk({type:"embeddable",...a}):l=Ta({type:n,...a}),l.type==="selection"?this.setState({selectionElement:l}):(this.scene.insertElement(l),this.setState({multiElement:null,newElement:l}))});B(this,"createFrameElementOnPointerDown",(n,i)=>{var l;const[s,r]=ci(n.origin.x,n.origin.y,(l=this.lastPointerDownEvent)!=null&&l[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o={x:s,y:r,opacity:this.state.currentItemOpacity,locked:!1,...rt},a=i===ui.magicframe?X4(o):LT(o);this.scene.insertElement(a),this.setState({multiElement:null,newElement:a})});B(this,"restoreReadyToEraseElements",()=>{this.elementsPendingErasure=new Set,this.triggerRender()});B(this,"eraseElements",()=>{let n=!1;this.elementsPendingErasure.forEach(s=>{var o;const r=this.scene.getElement(s);if(ln(r)){if(r.startBinding){const a=this.scene.getElement(r.startBinding.elementId);Dn(a,this.scene.getElementsMapIncludingDeleted(),{boundElements:a.boundElements.filter(l=>l.id!==r.id)})}if(r.endBinding){const a=this.scene.getElement(r.endBinding.elementId);Dn(a,this.scene.getElementsMapIncludingDeleted(),{boundElements:a.boundElements.filter(l=>l.id!==r.id)})}}else si(r)&&((o=r.boundElements)==null||o.forEach(a=>{var l,c;if(a.type==="arrow"){const d=this.scene.getElement(a.id);((l=d==null?void 0:d.startBinding)==null?void 0:l.elementId)===r.id&&Dn(d,this.scene.getElementsMapIncludingDeleted(),{startBinding:null}),((c=d==null?void 0:d.endBinding)==null?void 0:c.elementId)===r.id&&Dn(d,this.scene.getElementsMapIncludingDeleted(),{endBinding:null})}}))});const i=this.scene.getElementsIncludingDeleted().map(s=>this.elementsPendingErasure.has(s.id)||s.frameId&&this.elementsPendingErasure.has(s.frameId)||Vt(s)&&this.elementsPendingErasure.has(s.containerId)?(n=!0,xe(s,{isDeleted:!0})):s);this.elementsPendingErasure=new Set,n&&(this.store.scheduleCapture(),this.scene.replaceAllElements(i))});B(this,"initializeImage",async(n,i)=>{var l,c,d;if(!up(i))throw new Error(x("errors.unsupportedFileType"));const s=i.type;if(Bt(this.interactiveCanvas,"wait"),s===Ee.svg)try{i=dL(tR(await i.text()),i.name)}catch(u){throw console.warn(u),new Error(x("errors.svgImageInsertError"))}const r=await(((c=(l=this.props).generateIdForFile)==null?void 0:c.call(l,i))||g7e(i));if(!r)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),new Error(x("errors.imageInsertError"));const o=this.files[r];if(!(o!=null&&o.dataURL)){try{i=await ZY(i,{maxWidthOrHeight:fie})}catch(u){console.error("Error trying to resizing image file on insertion",u)}if(i.size>nM)throw new Error(x("errors.fileTooBig",{maxSize:`${Math.trunc(nM/1024/1024)}MB`}))}const a=((d=this.files[r])==null?void 0:d.dataURL)||await KY(i);return new Promise(async(u,f)=>{var h,m;try{let p=this.getLatestInitializedImageElement(n,r);if(this.addMissingFiles([{mimeType:s,id:r,dataURL:a,created:Date.now(),lastRetrieved:Date.now()}]),!this.imageCache.get(r)){this.addNewImagesToImageCache();const{erroredFiles:b}=await this.updateImageCache([p]);if(b.size)throw new Error("Image cache update resulted with an error.")}const U=await((h=this.imageCache.get(r))==null?void 0:h.image);if(U&&((m=this.state.newElement)==null?void 0:m.id)!==p.id){p=this.getLatestInitializedImageElement(n,r);const b=this.getImageNaturalDimensions(p,U);Object.assign(p,b)}u(p)}catch(p){console.error(p),f(new Error(x("errors.imageInsertError")))}})});B(this,"getLatestInitializedImageElement",(n,i)=>{const s=this.scene.getElement(n.id)??n;return xe(s,{fileId:i})});B(this,"onImageToolbarButtonClick",async()=>{try{const n=this.state.width/2+this.state.offsetLeft,i=this.state.height/2+this.state.offsetTop,{x:s,y:r}=zt({clientX:n,clientY:i},this.state),o=await XI({description:"Image",extensions:Object.keys(ng),multiple:!0});this.insertImages(o,s,r)}catch(n){n.name!=="AbortError"?console.error(n):console.warn(n),this.setState({newElement:null,activeTool:sn(this.state,{type:this.state.preferredSelectionTool.type})},()=>{this.actionManager.executeAction(qs)})}});B(this,"getImageNaturalDimensions",(n,i)=>{const s=Math.max(this.state.height-120,160),r=Math.min(s,Math.floor(this.state.height*.5)/this.state.zoom.value),o=Math.min(i.naturalHeight,r),a=o*(i.naturalWidth/i.naturalHeight),l=n.x+n.width/2-a/2,c=n.y+n.height/2-o/2;return{x:l,y:c,width:a,height:o,crop:null}});B(this,"updateImageCache",async(n,i=this.files)=>{const{updatedFiles:s,erroredFiles:r}=await WV({imageCache:this.imageCache,fileIds:n.map(o=>o.fileId),files:i});return r.size&&(this.store.scheduleAction(q.NEVER),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(o=>Jn(o)&&r.has(o.fileId)?xe(o,{status:"error"}):o))),{updatedFiles:s,erroredFiles:r}});B(this,"addNewImagesToImageCache",async(n=KV(this.scene.getNonDeletedElements()),i=this.files)=>{const s=n.filter(r=>!r.isDeleted&&!this.imageCache.has(r.fileId));if(s.length){const{updatedFiles:r}=await this.updateImageCache(s,i);if(r.size)for(const o of s)r.has(o.fileId)&&kn.delete(o);r.size&&this.scene.triggerUpdate()}});B(this,"scheduleImageRefresh",na(()=>{this.addNewImagesToImageCache()},oie));B(this,"updateBindingEnabledOnPointerMove",n=>{const i=tue(n);this.state.isBindingEnabled!==i&&this.setState({isBindingEnabled:i})});B(this,"handleInteractiveCanvasRef",n=>{var i,s;n!==null?(this.interactiveCanvas=n,this.interactiveCanvas.addEventListener(te.TOUCH_START,this.onTouchStart,{passive:!1}),this.interactiveCanvas.addEventListener(te.TOUCH_END,this.onTouchEnd)):((i=this.interactiveCanvas)==null||i.removeEventListener(te.TOUCH_START,this.onTouchStart),(s=this.interactiveCanvas)==null||s.removeEventListener(te.TOUCH_END,this.onTouchEnd))});B(this,"insertImages",async(n,i,s)=>{const r=50/this.state.zoom.value,o=nR(n.map(()=>this.newImagePlaceholder({sceneX:i,sceneY:s})),i,s,r);o.forEach(f=>this.scene.insertElement(f));const a=await Promise.all(o.map(async(f,h)=>{try{return await this.initializeImage(f,await fp(n[h]))}catch(m){return this.setState({errorMessage:m.message||x("errors.imageInsertError")}),xe(f,{isDeleted:!0})}})),l=we(a),c=nR(a.filter(f=>!f.isDeleted),i,s,r),d=we(c),u=this.scene.getElementsIncludingDeleted().map(f=>d.get(f.id)??l.get(f.id)??f);this.updateScene({appState:{selectedElementIds:It(Object.fromEntries(c.map(f=>[f.id,!0])),this.state)},elements:u,captureUpdate:q.IMMEDIATELY}),this.setState({},()=>{this.actionManager.executeAction(qs)})});B(this,"handleAppOnDrop",async n=>{var u;const{x:i,y:s}=zt(n,this.state),r=await D5(n),o=r.getFiles();if(o.length===1){const{file:f,fileHandle:h}=o[0];if(f&&(f.type===Ee.png||f.type===Ee.svg))try{const m=await ZI(f,this.state,this.scene.getElementsIncludingDeleted(),h);this.syncActionResult({...m,appState:{...m.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:q.IMMEDIATELY});return}catch(m){if(m.name!=="EncodingError")throw new Error(x("alerts.couldNotLoadInvalidFile"))}}const a=o.map(f=>f.file).filter(f=>up(f));if(a.length>0&&this.isToolSupported("image"))return this.insertImages(a,i,s);const l=r.getData(Ee.excalidrawlibIds),c=r.getData(Ee.excalidrawlib);if(l||c){try{let f=null;if(l){const{itemIds:h}=JSON.parse(l);f=(await this.library.getLatestLibrary()).filter(p=>h.includes(p.id))}else c&&(f=WY(c));f!=null&&f.length&&(f=f.map(h=>({...h,elements:J1({type:"everything",elements:h.elements,randomizeSeed:!0}).duplicatedElements})),this.addElementsFromPasteOrLibrary({elements:iS(f),position:n,files:null}))}catch(f){this.setState({errorMessage:f.message})}return}if(o.length>0){const{file:f,fileHandle:h}=o[0];f&&await this.loadFileToCanvas(f,h)}const d=r.findByType(Ee.text);if(d){const f=d.value;if(f&&xb(f,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(f)||((u=ph(f))==null?void 0:u.type)==="video")){const h=this.insertEmbeddableElement({sceneX:i,sceneY:s,link:Ur(f)});h&&(this.store.scheduleCapture(),this.setState({selectedElementIds:{[h.id]:!0}}))}}});B(this,"loadFileToCanvas",async(n,i)=>{n=await fp(n);try{const s=this.scene.getElementsIncludingDeleted();let r;try{r=await YY(n,this.state,s,i)}catch(o){const a=o instanceof iu;if(a&&o.code==="IMAGE_NOT_CONTAINS_SCENE_DATA"&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:x("errors.imageToolNotSupported")});return}const l=x(a?"alerts.cannotRestoreFromImage":"alerts.couldNotLoadInvalidFile");this.setState({isLoading:!1,errorMessage:l})}if(!r)return;r.type===Ee.excalidraw?(Ad(s.concat(r.data.elements)),this.store.scheduleMicroAction({action:q.NEVER,elements:s,appState:void 0}),this.setState({isLoading:!0}),this.syncActionResult({...r.data,appState:{...r.data.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:q.IMMEDIATELY})):r.type===Ee.excalidrawlib&&await this.library.updateLibrary({libraryItems:n,merge:!0,openLibraryMenu:!0}).catch(o=>{console.error(o),this.setState({errorMessage:x("errors.importLibraryError")})})}catch(s){this.setState({isLoading:!1,errorMessage:s.message})}});B(this,"handleCanvasContextMenu",n=>{if(n.preventDefault(),("pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="touch"||"pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="pen"&&n.button!==ic.SECONDARY)&&this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const{x:i,y:s}=zt(n,this.state),r=this.getElementAtPosition(i,s,{preferSelected:!0,includeLockedElements:!0}),o=this.scene.getSelectedElements(this.state),a=this.isHittingCommonBoundingBoxOfSelectedElements({x:i,y:s},o),l=r||a?"element":"canvas",c=this.excalidrawContainerRef.current,{top:d,left:u}=c.getBoundingClientRect(),f=n.clientX-u,h=n.clientY-d;at("contextMenu","openContextMenu",l),this.setState({...r&&!this.state.selectedElementIds[r.id]?{...this.state,...Fi({editingGroupId:this.state.editingGroupId,selectedElementIds:{[r.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:De(r)?new ne(r,this.scene.getNonDeletedElementsMap()):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:h,left:f,items:this.getContextMenuItems(l)}})})});B(this,"maybeDragNewGenericElement",(n,i,s=!0)=>{var m,p,U;const r=this.state.selectionElement,o=n.lastCoords;if(r&&n.boxSelection.hasOccurred&&this.state.activeTool.type!=="eraser"){jk({newElement:r,elementType:this.state.activeTool.type,originX:n.origin.x,originY:n.origin.y,x:o.x,y:o.y,width:rs(n.origin.x,o.x),height:rs(n.origin.y,o.y),shouldMaintainAspectRatio:Pm(i),shouldResizeFromCenter:!1,scene:this.scene,zoom:this.state.zoom.value,informMutation:!1});return}const a=this.state.newElement;if(!a)return;let[l,c]=ci(o.x,o.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=Jn(a)&&((m=this.imageCache.get(a.fileId))==null?void 0:m.image),u=d&&!(d instanceof Promise)?d.width/d.height:null;this.maybeCacheReferenceSnapPoints(i,[a]);const{snapOffset:f,snapLines:h}=J_e(a,this,i,{x:n.originInGrid.x+(((p=this.state.originSnapOffset)==null?void 0:p.x)??0),y:n.originInGrid.y+(((U=this.state.originSnapOffset)==null?void 0:U.y)??0)},{x:l-n.originInGrid.x,y:c-n.originInGrid.y},this.scene.getNonDeletedElementsMap());l+=f.x,c+=f.y,this.setState({snapLines:h}),ln(a)||jk({newElement:a,elementType:this.state.activeTool.type,originX:n.originInGrid.x,originY:n.originInGrid.y,x:l,y:c,width:rs(n.originInGrid.x,l),height:rs(n.originInGrid.y,c),shouldMaintainAspectRatio:xt(a)?!Pm(i):Pm(i),shouldResizeFromCenter:iM(i),zoom:this.state.zoom.value,scene:this.scene,widthAspectRatio:u,originOffset:this.state.originSnapOffset,informMutation:s}),this.setState({newElement:a}),(this.state.activeTool.type===ui.frame||this.state.activeTool.type===ui.magicframe)&&this.setState({elementsToHighlight:ha(this.scene.getNonDeletedElements(),a,this.state,this.scene.getNonDeletedElementsMap())})});B(this,"maybeHandleCrop",(n,i)=>{var c;if(!this.state.croppingElementId)return!1;const s=n.resize.handleType,r=n.lastCoords,[o,a]=ci(r.x-n.resize.offset.x,r.y-n.resize.offset.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(s&&l&&xt(l)){const d=n.originalElements.get(l.id),u=Jn(l)&&((c=this.imageCache.get(l.fileId))==null?void 0:c.image);if(d&&xt(d)&&u&&!(u instanceof Promise)){const[f,h]=ci(r.x,r.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),m={x:f-n.originInGrid.x,y:h-n.originInGrid.y};this.maybeCacheReferenceSnapPoints(i,[l]);const{snapOffset:p,snapLines:U}=$L([l],[d],this,i,m,s);this.scene.mutateElement(l,tde(l,this.scene.getNonDeletedElementsMap(),s,u.naturalWidth,u.naturalHeight,o+p.x,a+p.y,i.shiftKey?d.width/d.height:void 0)),pi(l,this.scene),this.setState({isCropping:s&&s!=="rotation",snapLines:U})}return!0}return!1});B(this,"maybeHandleResize",(n,i)=>{const s=this.scene.getSelectedElements(this.state),r=s.filter(u=>_e(u)),o=n.resize.handleType;if(r.length>0&&o==="rotation"||s.length===1&&ve(s[0])||this.state.croppingElementId)return!1;this.setState({isResizing:o&&o!=="rotation",isRotating:o==="rotation",activeEmbeddable:null});const a=n.lastCoords;let[l,c]=ci(a.x-n.resize.offset.x,a.y-n.resize.offset.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=new Map;if(r.forEach(u=>{br(this.scene.getNonDeletedElements(),u.id).forEach(h=>{d.set(u.id+h.id,{x:h.x-u.x,y:h.y-u.y})})}),!this.state.selectedElementsAreBeingDragged){const[u,f]=ci(a.x,a.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),h={x:u-n.originInGrid.x,y:f-n.originInGrid.y},m=[...n.originalElements.values()];this.maybeCacheReferenceSnapPoints(i,s);const{snapOffset:p,snapLines:U}=$L(s,Ze(m,this.state),this,i,h,o);l+=p.x,c+=p.y,this.setState({snapLines:U})}if(ahe(n.originalElements,o,s,this.scene,bc(i),iM(i),s.some(u=>xt(u))?!Pm(i):Pm(i),l,c,n.resize.center.x,n.resize.center.y)){const u=new Set;return r.forEach(f=>{ha(this.scene.getNonDeletedElements(),f,this.state,this.scene.getNonDeletedElementsMap()).forEach(h=>u.add(h))}),this.setState({elementsToHighlight:[...u]}),!0}return!1});B(this,"getContextMenuItems",n=>{const i=[];if(i.push(bL,UL),n==="canvas")return this.state.viewModeEnabled?[...i,k_,P5,B5,N5]:[mL,di,bL,UL,yL,di,Vme,pve,di,k_,dW,P5,B5,N5];if(i.push(yL),this.state.viewModeEnabled)return[$b,...i];const s=this.editorInterface.formFactor==="desktop"?[di,Fme,Bme,zme,Hme]:[];return[di,pL,$b,mL,di,F_e,B_e,z_e,di,O_e,di,...i,di,Y7e,W7e,di,Z7e,$_e,rve,ove,cve,q7e,di,tve,...s,di,nve,ive,di,KU,di,hW,yW,di,$me,gW,di,TG]});B(this,"handleWheel",hn(n=>{if(!(n.target instanceof HTMLCanvasElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLIFrameElement||n.target instanceof HTMLElement&&n.target.classList.contains(Wi.FRAME_NAME))){n[$.CTRL_OR_CMD]&&n.preventDefault();return}if(n.preventDefault(),qm)return;const{deltaX:i,deltaY:s}=n;if(n.metaKey||n.ctrlKey){const r=Math.sign(s),o=Ny*100,a=Math.abs(s);let l=s;a>o&&(l=o*r);let c=this.state.zoom.value-l/100;c+=Math.log10(Math.max(1,this.state.zoom.value))*-r*Math.min(1,a/20),this.translateCanvas(d=>({...su({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:ml(c)},d),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(n.shiftKey){this.translateCanvas(({zoom:r,scrollX:o})=>({scrollX:o-(s||i)/r.value}));return}this.translateCanvas(({zoom:r,scrollX:o,scrollY:a})=>({scrollX:o-i/r.value,scrollY:a-s/r.value}))}));B(this,"savePointer",(n,i,s)=>{var l,c;if(!n||!i)return;const{x:r,y:o}=zt({clientX:n,clientY:i},this.state),a={x:r,y:o,tool:this.state.activeTool.type==="laser"?"laser":"pointer"};(c=(l=this.props).onPointerUpdate)==null||c.call(l,{pointer:a,button:s,pointersMap:Tt.pointers})});B(this,"resetShouldCacheIgnoreZoomDebounced",Al(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300));B(this,"updateDOMRect",n=>{var i;if((i=this.excalidrawContainerRef)!=null&&i.current){const s=this.excalidrawContainerRef.current,{width:r,height:o,left:a,top:l}=s.getBoundingClientRect(),{width:c,height:d,offsetTop:u,offsetLeft:f}=this.state;if(r===c&&o===d&&a===f&&l===u){n&&n();return}this.setState({width:r,height:o,offsetLeft:a,offsetTop:l},()=>{n&&n()})}});B(this,"refresh",()=>{this.setState({...this.getCanvasOffsets()})});B(this,"watchState",()=>{});const i=Aa(),{excalidrawAPI:s,viewModeEnabled:r=!1,zenModeEnabled:o=!1,gridModeEnabled:a=!1,objectsSnapModeEnabled:l=!1,theme:c=i.theme,name:d=`${x("labels.untitled")}-${rM()}`}=n;if(this.state={...i,theme:c,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:r,zenModeEnabled:o,objectsSnapModeEnabled:l,gridModeEnabled:a??i.gridModeEnabled,name:d,width:window.innerWidth,height:window.innerHeight},this.refreshEditorInterface(),this.stylesPanelMode=K1(this.editorInterface),this.id=PH(),this.library=new c4e(this),this.actionManager=new G_e(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new u5,this.canvas=document.createElement("canvas"),this.rc=Id.canvas(this.canvas),this.renderer=new GL(this.scene),this.visibleElements=[],this.store=new ffe(this),this.history=new au(this.store),s){const u={updateScene:this.updateScene,applyDeltas:this.applyDeltas,mutateElement:this.mutateElement,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,getSceneElementsMapIncludingDeleted:this.getSceneElementsMapIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,getName:this.getName,registerAction:f=>{this.actionManager.registerAction(f)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,getEditorInterface:()=>this.editorInterface,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:f=>this.onChangeEmitter.on(f),onIncrement:f=>this.store.onStoreIncrementEmitter.on(f),onPointerDown:f=>this.onPointerDownEmitter.on(f),onPointerUp:f=>this.onPointerUpEmitter.on(f),onScrollChange:f=>this.onScrollChangeEmitter.on(f),onUserFollow:f=>this.onUserFollowEmitter.on(f)};typeof s=="function"?s(u):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new wl(this.scene),this.history=new au(this.store),this.actionManager.registerAll(g_),this.actionManager.registerAction(H_e(this.history)),this.actionManager.registerAction(V_e(this.history))}onWindowMessage(n){if(n.origin!=="https://player.vimeo.com"&&n.origin!=="https://www.youtube.com")return;let i=null;try{i=JSON.parse(n.data)}catch{}if(i)switch(n.origin){case"https://player.vimeo.com":if(i.method==="paused"){let s=null;const r=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!r)break;for(const o of r)o.contentWindow===n.source&&(s=o.contentWindow);s==null||s.postMessage(JSON.stringify({method:i.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if(i.event==="infoDelivery"&&i.info&&i.id&&typeof i.info.playerState=="number"){const s=i.id,r=i.info.playerState;Object.values(mU).includes(r)&&Q7.set(s,r)}break}}handleSkipBindMode(){var n,i,s,r;if((n=this.state.selectedLinearElement)!=null&&n.initialState&&!this.state.selectedLinearElement.initialState.arrowStartIsInside){Ce(this.lastPointerMoveCoords,"Missing last pointer move coords when changing bind skip mode for arrow start");const o=this.scene.getNonDeletedElementsMap(),a=Bi(M(this.lastPointerMoveCoords.x,this.lastPointerMoveCoords.y),this.scene.getNonDeletedElements(),o),l=ne.getElement(this.state.selectedLinearElement.elementId,o);l!=null&&l.startBinding&&(a==null?void 0:a.id)===l.startBinding.elementId&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,arrowStartIsInside:!0}}})}if(this.state.bindMode==="orbit"&&(this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),tn.flushSync(()=>{this.setState({bindMode:"skip"})}),this.lastPointerMoveCoords&&((i=this.state.selectedLinearElement)!=null&&i.selectedPointsIndices)&&((s=this.state.selectedLinearElement)!=null&&s.selectedPointsIndices.length))){const{x:o,y:a}=this.lastPointerMoveCoords,l=this.lastPointerMoveEvent??((r=this.lastPointerDownEvent)==null?void 0:r.nativeEvent);Ce(l,"Last event must exist");const c=o-this.state.selectedLinearElement.pointerOffset.x,d=a-this.state.selectedLinearElement.pointerOffset.y,u=this.state.multiElement?ne.handlePointerMove(l,this,c,d,this.state.selectedLinearElement):ne.handlePointDragging(l,this,c,d,this.state.selectedLinearElement);u&&this.setState(u)}}resetDelayedBindMode(){this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),this.state.bindMode!=="orbit"&&setTimeout(()=>this.setState({bindMode:"orbit"}))}handleDelayedBindModeChange(n,i){var u,f,h,m,p,U,b,y,E,_,I,k,w;if(n.isDeleted||ve(n))return;const s=()=>{var D,N,L;if(this.bindModeHandler=null,Ce(this.lastPointerMoveCoords,"Expected lastPointerMoveCoords to be set"),!this.state.multiElement){if(!this.state.selectedLinearElement||!this.state.selectedLinearElement.selectedPointsIndices||!this.state.selectedLinearElement.selectedPointsIndices.length)return;const j=this.state.selectedLinearElement.selectedPointsIndices.includes(0),Y=this.state.selectedLinearElement.selectedPointsIndices.includes(n.points.length-1);if(!j&&!Y||j&&Y)return}const{x:T,y:A}=this.lastPointerMoveCoords,S=Bi(M(T,A),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(S&&this.state.bindMode!=="skip"){Ce(((D=this.state.selectedLinearElement)==null?void 0:D.elementId)===n.id,"The selectedLinearElement is expected to not change while a bind mode timeout is ticking");const j=this.state.selectedLinearElement.initialState.arrowStartIsInside||((N=n.startBinding)==null?void 0:N.elementId)===S.id;tn.flushSync(()=>{Ce(this.state.selectedLinearElement,"this.state.selectedLinearElement must exist"),this.setState({bindMode:"inside",selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,arrowStartIsInside:j}}})});const Y=this.lastPointerMoveEvent??((L=this.lastPointerDownEvent)==null?void 0:L.nativeEvent);Ce(Y,"Last event must exist");const G=T-this.state.selectedLinearElement.pointerOffset.x,O=A-this.state.selectedLinearElement.pointerOffset.y,z=this.state.multiElement?ne.handlePointerMove(Y,this,G,O,this.state.selectedLinearElement):ne.handlePointDragging(Y,this,G,O,this.state.selectedLinearElement);z&&this.setState(z)}};let r=!1;if((u=this.state.selectedLinearElement)!=null&&u.selectedPointsIndices){const T=this.scene.getNonDeletedElementsMap(),A=this.state.selectedLinearElement.selectedPointsIndices.includes(0),S=this.state.selectedLinearElement.selectedPointsIndices.includes(n.points.length-1),D=A?i:n.startBinding&&T.get(n.startBinding.elementId),N=S?i:n.endBinding&&T.get(n.endBinding.elementId),L=D&&Pn(D,T),j=N&&Pn(N,T);r=!!(L&&j&&D.id!==N.id&&xd(L,j))}const o=(h=(f=this.state.selectedLinearElement)==null?void 0:f.selectedPointsIndices)==null?void 0:h.includes(0),a=(p=(m=this.state.selectedLinearElement)==null?void 0:m.selectedPointsIndices)==null?void 0:p.includes(n.points.length-1),l=o?"startBinding":a?"endBinding":null,c=o?"endBinding":a?"startBinding":null,d=c&&((U=n[c])==null?void 0:U.mode)==="inside"&&((b=n[c])==null?void 0:b.elementId)===(i==null?void 0:i.id)||l&&((y=n[l])==null?void 0:y.mode)==="inside"&&(i==null?void 0:i.id)===((E=n[l])==null?void 0:E.elementId);l&&c&&((_=n[l])==null?void 0:_.mode)==="inside"&&(i==null?void 0:i.id)!==((I=n[l])==null?void 0:I.elementId)&&((k=n[c])==null?void 0:k.elementId)!==((w=n[l])==null?void 0:w.elementId)&&this.scene.mutateElement(n,{[l]:{...n[l],mode:"orbit"}},{informMutation:!1,isDragging:!0}),!i||this.previousHoveredBindableElement&&i.id!==this.previousHoveredBindableElement.id?(this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),this.state.bindMode==="inside"&&tn.flushSync(()=>{this.setState({bindMode:"orbit"})}),this.previousHoveredBindableElement=null):!this.bindModeHandler&&(!this.state.newElement||!n.startBinding||r)&&!d&&(this.bindModeHandler=setTimeout(s,Hf)),this.previousHoveredBindableElement=i}cacheEmbeddableRef(n,i){i&&this.iFrameRefs.set(n.id,i)}getHTMLIFrameElement(n){return this.iFrameRefs.get(n.id)}handleEmbeddableCenterClick(n){var s,r,o,a;if(((s=this.state.activeEmbeddable)==null?void 0:s.element)===n&&((r=this.state.activeEmbeddable)==null?void 0:r.state)==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:n,state:"active"},selectedElementIds:{[n.id]:!0},newElement:null,selectionElement:null})},100),uc(n)))return;const i=this.getHTMLIFrameElement(n);if(i!=null&&i.contentWindow){if(i.src.includes("youtube")){const l=Q7.get(n.id);switch(l||(Q7.set(n.id,mU.UNSTARTED),i.contentWindow.postMessage(JSON.stringify({event:"listening",id:n.id}),"*")),l){case mU.PLAYING:case mU.BUFFERING:(o=i.contentWindow)==null||o.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:(a=i.contentWindow)==null||a.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}i.src.includes("player.vimeo.com")&&i.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(n,i,s,r){var o,a;return n&&!i.altKey&&!i.shiftKey&&!i.metaKey&&!i.ctrlKey&&(((o=this.state.activeEmbeddable)==null?void 0:o.element)!==n||((a=this.state.activeEmbeddable)==null?void 0:a.state)==="hover"||!this.state.activeEmbeddable)&&s>=n.x+n.width/3&&s<=n.x+2*n.width/3&&r>=n.y+n.height/3&&r<=n.y+2*n.height/3}renderEmbeddables(){const n=this.state.zoom.value,i=this.state.width,s=this.state.height,r=this.scene.getNonDeletedElements().filter(o=>Es(o)&&this.embedsValidationStatus.get(o.id)===!0||uc(o));return g(fe,{children:r.map(o=>{var p,U,b,y,E,_,I,k,w;const{x:a,y:l}=cr({sceneX:o.x,sceneY:o.y},this.state),c=d5(o,i,s,this.state,this.scene.getNonDeletedElementsMap()),d=this.initializedEmbeds.has(o.id);if(c&&!d&&this.initializedEmbeds.add(o.id),!(c||d))return null;let f;if(uc(o)){f=null;const T=(((p=o.customData)==null?void 0:p.generationData)??this.magicGenerations.get(o.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if(T.status==="done"){const A=T.html;f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>A}}else if(T.status==="pending")f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>e0(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme===be.DARK?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let A;T.code==="ERR_GENERATION_INTERRUPTED"?A="Generation was interrupted...":A=T.message||"Generation failed",f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>e0(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Je.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${A}</h3>
                  `)}}}else f=ph(P9(o.link||""));const h=((U=this.state.activeEmbeddable)==null?void 0:U.element)===o&&((b=this.state.activeEmbeddable)==null?void 0:b.state)==="active",m=((y=this.state.activeEmbeddable)==null?void 0:y.element)===o&&((E=this.state.activeEmbeddable)==null?void 0:E.state)==="hover";return g("div",{className:ae("excalidraw__embeddable-container",{"is-hovered":m}),style:{transform:c?`translate(${a-this.state.offsetLeft}px, ${l-this.state.offsetTop}px) scale(${n})`:"none",display:c?"block":"none",opacity:yV(o,Vs(o,this.scene.getNonDeletedElementsMap()),this.elementsPendingErasure,null,((_=this.state.openDialog)==null?void 0:_.name)==="elementLinkSelector"?vz:1),"--embeddable-radius":`${fa(Math.min(o.width,o.height),o)}px`},children:P("div",{className:"excalidraw__embeddable-container__inner",style:{width:c?`${o.width}px`:0,height:c?`${o.height}px`:0,transform:c?`rotate(${o.angle}rad)`:"none",pointerEvents:h?Gd.enabled:Gd.disabled},children:[m&&g("div",{className:"excalidraw__embeddable-hint",children:x("buttons.embeddableInteractionButton")}),g("div",{className:"excalidraw__embeddable__outer",style:{padding:`${o.strokeWidth}px`},children:(Es(o)?(k=(I=this.props).renderEmbeddable)==null?void 0:k.call(I,o,this.state):null)??g("iframe",{ref:T=>this.cacheEmbeddableRef(o,T),className:"excalidraw__embeddable",srcDoc:(f==null?void 0:f.type)==="document"?f.srcdoc(this.state.theme):void 0,src:(f==null?void 0:f.type)!=="document"?(f==null?void 0:f.link)??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:`${(w=f==null?void 0:f.sandbox)!=null&&w.allowSameOrigin?"allow-same-origin":""} allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads`})})]})},o.id)})})}toggleOverscrollBehavior(n){document.documentElement.style.overscrollBehaviorX=n.type==="pointerenter"?"none":"auto"}render(){var h,m,p,U,b,y,E,_,I;const n=this.scene.getSelectedElements(this.state),{renderTopRightUI:i,renderTopLeftUI:s,renderCustomStats:r}=this.props,o=this.scene.getSceneNonce(),{elementsMap:a,visibleElements:l}=this.renderer.getRenderableElements({sceneNonce:o,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingTextElement:this.state.editingTextElement,newElementId:(h=this.state.newElement)==null?void 0:h.id});this.visibleElements=l;const c=this.scene.getNonDeletedElementsMap(),d="setPointerCapture"in HTMLElement.prototype?!1:this.state.selectionElement||this.state.newElement||this.state.selectedElementsAreBeingDragged||this.state.resizingElement||this.state.activeTool.type==="laser"&&this.state.cursorButton==="down",u=n[0],f=((m=ar.get(el))==null?void 0:m.type)==="panel";return g("div",{translate:"no",className:ae("excalidraw excalidraw-container notranslate",{"excalidraw--view-mode":this.state.viewModeEnabled||((p=this.state.openDialog)==null?void 0:p.name)==="elementLinkSelector","excalidraw--mobile":this.editorInterface.formFactor==="phone"}),style:{"--ui-pointerEvents":d?Gd.disabled:Gd.enabled,"--right-sidebar-width":"302px"},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,onPointerEnter:this.toggleOverscrollBehavior,onPointerLeave:this.toggleOverscrollBehavior,children:g(WK.Provider,{value:this,children:g(KK.Provider,{value:this.props,children:g(bS.Provider,{value:this.excalidrawContainerValue,children:g(US.Provider,{value:this.editorInterface,children:g(vS.Provider,{value:this.setAppState,children:g(ES.Provider,{value:this.state,children:P(yS.Provider,{value:this.scene.getNonDeletedElements(),children:[P(_S.Provider,{value:this.actionManager,children:[g(OTe,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:W0().code,renderTopLeftUI:s,renderTopRightUI:i,renderCustomStats:r,showExitZenModeBtn:typeof((U=this.props)==null?void 0:U.zenModeEnabled)>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&this.state.activeTool.type===this.state.preferredSelectionTool.type&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,generateLinkForSelection:this.props.generateLinkForSelection,children:this.props.children}),g("div",{className:"excalidraw-textEditorContainer"}),g("div",{className:"excalidraw-contextMenuContainer"}),g("div",{className:"excalidraw-eye-dropper-container"}),g(BTe,{trails:[this.laserTrails,this.lassoTrail,this.eraserTrail]}),n.length===1&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&this.state.showHyperlinkPopup&&g(fve,{element:u,scene:this.scene,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast,updateEmbedValidationStatus:this.updateEmbedValidationStatus},u.id),this.props.aiEnabled!==!1&&n.length===1&&Ib(u)&&g(XL,{element:u,elementsMap:a,children:g(Y7,{title:x("labels.convertToCode"),icon:p5,checked:!1,onChange:()=>this.onMagicFrameGenerate(u,"button")})}),n.length===1&&uc(u)&&((E=(y=u.customData)==null?void 0:y.generationData)==null?void 0:E.status)==="done"&&P(XL,{element:u,elementsMap:a,children:[g(Y7,{title:x("labels.copySource"),icon:f2,checked:!1,onChange:()=>this.onIframeSrcCopy(u)}),g(Y7,{title:"Enter fullscreen",icon:ome,checked:!1,onChange:()=>{const k=this.getHTMLIFrameElement(u);if(k)try{k.requestFullscreen(),this.setState({activeEmbeddable:{element:u,state:"active"},selectedElementIds:{[u.id]:!0},newElement:null,selectionElement:null})}catch(w){console.warn(w),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),this.state.toast!==null&&g(mIe,{message:this.state.toast.message,onClose:this.handleToastClose,duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&g(Swe,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:k=>{this.setState({contextMenu:null},()=>{this.focusContainer(),k==null||k()})}}),g(dIe,{canvas:this.canvas,rc:this.rc,elementsMap:a,allElementsMap:c,visibleElements:l,sceneNonce:o,selectionNonce:(_=this.state.selectionElement)==null?void 0:_.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:pp(this),canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:this.flowChartCreator.pendingNodes,theme:this.state.theme}}),this.state.newElement&&g(hIe,{appState:this.state,scale:window.devicePixelRatio,rc:this.rc,elementsMap:a,allElementsMap:c,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!1,canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:null,theme:this.state.theme}}),g(aIe,{app:this,containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elementsMap:a,visibleElements:l,allElementsMap:c,selectedElements:n,sceneNonce:o,selectionNonce:(I=this.state.selectionElement)==null?void 0:I.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderScrollbars:this.props.renderScrollbars===!0,editorInterface:this.editorInterface,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&g(Cwe,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames(),this.state.activeLockedId&&g(pIe,{app:this,activeLockedId:this.state.activeLockedId}),f&&g(wve,{app:this})]}),this.renderEmbeddables()]})})})})})})})})}setPlugins(n){Object.assign(this.plugins,n)}async onMagicFrameGenerate(n,i){var a;const s=(a=this.plugins.diagramToCode)==null?void 0:a.generate;if(!s){this.setState({errorMessage:"No diagram to code plugin found"});return}const r=IT(this.scene.getNonDeletedElements(),n).filter(l=>!Ib(l));if(!r.length){i==="button"?(this.setState({errorMessage:"Cannot generate from an empty frame"}),at("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}const o=this.insertIframeElement({sceneX:n.x+n.width+30,sceneY:n.y,width:n.width,height:n.height});if(o){this.updateMagicGeneration({frameElement:o,data:{status:"pending"}}),this.setState({selectedElementIds:{[o.id]:!0}}),at("ai","generate (start)","d2c");try{const{html:l}=await s({frame:n,children:r});if(at("ai","generate (success)","d2c"),!l.trim()){this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}const c=l.includes("<!DOCTYPE html>")&&l.includes("</html>")?l.slice(l.indexOf("<!DOCTYPE html>"),l.indexOf("</html>")+7):l;this.updateMagicGeneration({frameElement:o,data:{status:"done",html:c}})}catch(l){at("ai","generate (failed)","d2c"),this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:l.message||"Unknown error during generation"}})}}}onIframeSrcCopy(n){var i,s;((s=(i=n.customData)==null?void 0:i.generationData)==null?void 0:s.status)==="done"&&(kd(n.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}clearImageShapeCache(n){const i=n??this.files;this.scene.getNonDeletedElements().forEach(s=>{Jn(s)&&i[s.fileId]&&(this.imageCache.delete(s.fileId),kn.delete(s))})}async componentDidMount(){var s;this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,this.store.onDurableIncrementEmitter.on(r=>{this.history.record(r.delta)});const{onIncrement:n}=this.props;n&&this.store.onStoreIncrementEmitter.on(r=>{n(r)}),this.scene.onUpdate(this.triggerRender),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),cz&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorInterface(),this.updateDOMRect()}),(s=this.resizeObserver)==null||s.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),xie()&&!gde()&&this.setState({errorMessage:g(Twe,{})})}componentWillUnmount(){var n,i;(n=window.launchQueue)==null||n.setConsumer(()=>{}),this.renderer.destroy(),this.scene.destroy(),this.scene=new u5,this.fonts=new wl(this.scene),this.renderer=new GL(this.scene),this.files={},this.imageCache.clear(),(i=this.resizeObserver)==null||i.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.library.destroy(),this.laserTrails.stop(),this.eraserTrail.stop(),this.onChangeEmitter.clear(),this.store.onStoreIncrementEmitter.clear(),this.store.onDurableIncrementEmitter.clear(),kn.destroy(),ho.destroy(),clearTimeout(tc),oi.clearCache(),Fi.clearCache(),tc=0,document.documentElement.style.overscrollBehaviorX=""}removeEventListeners(){this.onRemoveEventListenersEmitter.trigger()}addEventListeners(){this.removeEventListeners(),this.props.handleKeyboardGlobally&&this.onRemoveEventListenersEmitter.once(an(document,te.KEYDOWN,this.onKeyDown,!1)),this.onRemoveEventListenersEmitter.once(an(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),an(window,te.MESSAGE,this.onWindowMessage,!1),an(document,te.POINTER_UP,this.removePointer,{passive:!1}),an(document,te.COPY,this.onCopy,{passive:!1}),an(document,te.KEYUP,this.onKeyUp,{passive:!0}),an(document,te.POINTER_MOVE,this.updateCurrentCursorPosition,{passive:!1}),an(document.fonts,"loadingdone",n=>{const i=n.fontfaces;this.fonts.onLoaded(i)},{passive:!1}),an(document,te.GESTURE_START,this.onGestureStart,!1),an(document,te.GESTURE_CHANGE,this.onGestureChange,!1),an(document,te.GESTURE_END,this.onGestureEnd,!1),an(window,te.FOCUS,()=>{this.maybeCleanupAfterMissingPointerUp(null),this.triggerRender(!0)},{passive:!1})),!this.state.viewModeEnabled&&(this.onRemoveEventListenersEmitter.once(an(document,te.FULLSCREENCHANGE,this.onFullscreenChange,{passive:!1}),an(document,te.PASTE,this.pasteFromClipboard,{passive:!1}),an(document,te.CUT,this.onCut,{passive:!1}),an(window,te.RESIZE,this.onResize,!1),an(window,te.UNLOAD,this.onUnload,!1),an(window,te.BLUR,this.onBlur,!1),an(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),an(this.excalidrawContainerRef.current,te.DRAG_OVER,this.disableEvent,!1),an(this.excalidrawContainerRef.current,te.DROP,this.disableEvent,!1)),this.props.detectScroll&&this.onRemoveEventListenersEmitter.once(an(Zie(this.excalidrawContainerRef.current),te.SCROLL,this.onScroll,{passive:!1})))}componentDidUpdate(n,i){var a,l,c,d,u,f,h,m,p,U,b;this.updateEmbeddables();const s=this.scene.getElementsIncludingDeleted(),r=this.scene.getElementsMapIncludingDeleted();!this.state.showWelcomeScreen&&!s.length&&this.setState({showWelcomeScreen:!0}),i.userToFollow&&!this.state.collaborators.has(i.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(i.zoom.value!==this.state.zoom.value||i.scrollX!==this.state.scrollX||i.scrollY!==this.state.scrollY)&&((l=(a=this.props)==null?void 0:a.onScrollChange)==null||l.call(a,this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),i.userToFollow!==this.state.userToFollow&&(i.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:i.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&Yo(this.state)&&this.setState({activeTool:sn(this.state,{type:"selection"})}),this.state.activeTool.type==="eraser"&&i.theme!==this.state.theme&&Fj(this.interactiveCanvas,this.state.theme),i.activeTool.type==="selection"&&this.state.activeTool.type!=="selection"&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),n.langCode!==this.props.langCode&&this.updateLanguage(),Yo(i)&&!Yo(this.state)&&this.eraserTrail.endPath(),n.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),i.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),(((c=i.openDialog)==null?void 0:c.name)==="elementLinkSelector"||((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector")&&((u=i.openDialog)==null?void 0:u.name)!==((f=this.state.openDialog)==null?void 0:f.name)&&(this.deselectElements(),this.setState({hoveredElementIds:{}})),n.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),n.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),(h=this.excalidrawContainerRef.current)==null||h.classList.toggle("theme--dark",this.state.theme===be.DARK),(m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&setTimeout(()=>{var y;(y=this.state.selectedLinearElement)!=null&&y.isEditing&&this.actionManager.executeAction(qs)}),(p=this.state.editingTextElement)!=null&&p.isDeleted&&this.setState({editingTextElement:null}),this.store.commit(r,this.state),this.state.isLoading||((b=(U=this.props).onChange)==null||b.call(U,s,this.state,this.files),this.onChangeEmitter.trigger(s,this.state,this.files))}static resetTapTwice(){Km=!1,Zm=null}async insertClipboardContent(n,i,s){const{x:r,y:o}=zt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state);if(n.errorMessage){this.setState({errorMessage:n.errorMessage});return}if(i.length===0&&!s&&n.mixedContent){await this.addElementsFromMixedContentPaste(n.mixedContent,{isPlainPaste:s,sceneX:r,sceneY:o});return}if(n.spreadsheet&&!s){this.setState({pasteDialog:{data:n.spreadsheet,shown:!0}});return}const a=i.map(d=>d.file);if(a.length===0&&n.text&&!s){const d=n.text.trim();d.startsWith("<svg")&&d.endsWith("</svg>")&&a.push(dL(d))}if(a.length>0){this.isToolSupported("image")?await this.insertImages(a,r,o):this.setState({errorMessage:x("errors.imageToolNotSupported")});return}if(n.elements){const d=n.programmaticAPI?e_(n.elements):n.elements;this.addElementsFromPasteOrLibrary({elements:d,files:n.files||null,position:this.editorInterface.formFactor==="desktop"?"cursor":"center",retainSeed:s});return}if(!n.text)return;if(!s&&mwe(n.text)){const d=await Ue(()=>import("./mermaid-to-excalidraw-C2eqzxpF.js").then(u=>u.bG),__vite__mapDeps([]));try{const{elements:u,files:f}=await d.parseMermaidToExcalidraw(n.text),h=e_(u,{regenerateIds:!0});this.addElementsFromPasteOrLibrary({elements:h,files:f,position:this.editorInterface.formFactor==="desktop"?"cursor":"center"});return}catch(u){console.warn(`parsing pasted text as mermaid definition failed: ${u.message}`)}}const l=Fz(n.text).split(/\n+/).map(d=>d.trim()).filter(Boolean),c=l.map(d=>Hfe(d)).filter(d=>{var u;return xb(d,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(d)||((u=ph(d))==null?void 0:u.type)==="video")});if(!s&&c.length>0&&c.length===l.length){const d=[];for(const u of c){const f=d[d.length-1],h=this.insertEmbeddableElement({sceneX:f?f.x+f.width+20:r,sceneY:o,link:Ur(u)});h&&d.push(h)}d.length&&(this.store.scheduleCapture(),this.setState({selectedElementIds:Object.fromEntries(d.map(u=>[u.id,!0]))}));return}this.addTextFromPaste(n.text,s)}async addElementsFromMixedContentPaste(n,{isPlainPaste:i,sceneX:s,sceneY:r}){if(!i&&n.some(o=>o.type==="imageUrl")&&this.isToolSupported("image")){const o=n.filter(d=>d.type==="imageUrl").map(d=>d.value),a=await Promise.all(o.map(async d=>{try{return{file:await U7e(d)}}catch(u){let f=u.message;return u.cause==="FETCH_ERROR"?f=x("errors.failedToFetchImage"):u.cause==="UNSUPPORTED"&&(f=x("errors.unsupportedFileType")),{errorMessage:f}}})),l=a.filter(d=>!!d.file).map(d=>d.file);await this.insertImages(l,s,r);const c=a.find(d=>!!d.errorMessage);c&&c.errorMessage&&this.setState({errorMessage:c.errorMessage})}else{const o=n.filter(a=>a.type==="text");o.length&&this.addTextFromPaste(o.map(a=>a.value).join(`

`),i)}}addTextFromPaste(n,i=!1){const{x:s,y:r}=zt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),o={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:n,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:$p,verticalAlign:L6,locked:!1},a=_t({fontSize:o.fontSize,fontFamily:o.fontFamily}),l=id(o.fontFamily),[c,,d]=SV(this.state),u=Math.max(Math.min((d-c)*.5,800),200),f=10;let h=r;const m=i?[n]:n.split(`
`),p=m.reduce((U,b,y)=>{var _;const E=fg(b).trim();if(E.length){const I=this.getTopLayerFrameAtSceneCoords({x:s,y:h});let k=ri(E,a,l);const w=k.width>u,T=w?Sd(E,a,u):E;k=w?ri(T,a,l):k;const A=s-k.width/2,S=h-k.height/2,D=_r({...o,x:A,y:S,text:T,originalText:E,lineHeight:l,autoResize:!w,frameId:I?I.id:null});U.push(D),h+=D.height+f}else((_=m[y-1])==null?void 0:_.trim())&&(h+=n2(o.fontSize,l)+f);return U},[]);p.length!==0&&(this.scene.insertElements(p),this.store.scheduleCapture(),this.setState({selectedElementIds:It(Object.fromEntries(p.map(U=>[U.id,!0])),this.state)}),!i&&p.length>1&&SP===!1&&this.editorInterface.formFactor!=="phone"&&(this.setToast({message:x("toast.pasteAsSingleElement",{shortcut:J("CtrlOrCmd+Shift+V")}),duration:5e3}),SP=!0))}handleTextWysiwyg(n,{isExistingElement:i=!1}){const s=this.scene.getElementsMapIncludingDeleted(),r=(o,a)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===n.id&&he(l)?xe(l,{originalText:o,isDeleted:a??l.isDeleted,...OV(l,Gn(l,s),s,o)}):l)])};fwe({id:n.id,canvas:this.canvas,getViewportCoords:(o,a)=>{const{x:l,y:c}=cr({sceneX:o,sceneY:a},this.state);return[l-this.state.offsetLeft,c-this.state.offsetTop]},onChange:hn(o=>{r(o,!1),t_(n)&&pi(n,this.scene)}),onSubmit:hn(({viaKeyboard:o,nextOriginalText:a})=>{const l=!a.trim();if(r(a,l),!l&&o){const c=n.containerId?n.containerId:n.id;tn.flushSync(()=>{this.setState(d=>({selectedElementIds:It({...d.selectedElementIds,[c]:!0},d)}))})}l&&lV(this.scene.getNonDeletedElements(),[n]),(!l||i)&&this.store.scheduleCapture(),tn.flushSync(()=>{this.setState({newElement:null,editingTextElement:null})}),this.state.activeTool.locked&&Vo(this.interactiveCanvas,this.state),this.focusContainer()}),element:n,excalidrawContainer:this.excalidrawContainerRef.current,app:this,autoSelect:!this.editorInterface.isTouchScreen}),this.deselectElements(),r(n.originalText,!1)}deselectElements(){this.setState({selectedElementIds:It({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(n,i){const s=this.getElementAtPosition(n,i,{includeBoundTextElement:!0});return s&&he(s)&&!s.isDeleted?s:null}getElementAtPosition(n,i,s){let r=[];if(s&&"allHitElements"in s?r=(s==null?void 0:s.allHitElements)||[]:r=this.getElementsAtPosition(n,i,{includeBoundTextElement:s==null?void 0:s.includeBoundTextElement,includeLockedElements:s==null?void 0:s.includeLockedElements}),r.length>1){if(s!=null&&s.preferSelected){for(let a=r.length-1;a>-1;a--)if(this.state.selectedElementIds[r[a].id])return r[a]}const o=r[r.length-1];return ol({point:M(n,i),element:o,threshold:this.getElementHitThreshold(o)/2,elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:_e(o)?this.frameNameBoundsCache.get(o):null})?o:r[r.length-2]}return r.length===1?r[0]:null}getElementsAtPosition(n,i,s){const r=[],o=this.scene.getNonDeletedElementsMap();return(s!=null&&s.includeBoundTextElement&&(s!=null&&s.includeLockedElements)?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(l=>((s==null?void 0:s.includeLockedElements)||!l.locked)&&((s==null?void 0:s.includeBoundTextElement)||!(he(l)&&l.containerId)))).filter(l=>this.hitElement(n,i,l)).filter(l=>{const c=Vs(l,o);return c&&this.state.frameRendering.enabled&&this.state.frameRendering.clip?Ak({x:n,y:i},c,o):!0}).filter(l=>uc(l)?(r.push(l),!1):!0).concat(r)}getElementHitThreshold(n){return Math.max(n.strokeWidth/2+.1,.85*(QA/this.state.zoom.value))}hitElement(n,i,s,r=!0){return r&&this.state.selectedElementIds[s.id]&&JV([s],this.state,this.editorInterface)&&Ky(M(n,i),s,this.scene.getNonDeletedElementsMap(),this.getElementHitThreshold(s))||ZH(M(n,i),s,this.scene.getNonDeletedElementsMap())?!0:ol({point:M(n,i),element:s,threshold:this.getElementHitThreshold(s),elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:_e(s)?this.frameNameBoundsCache.get(s):null})}getTextBindableContainerAtPosition(n,i){const s=this.scene.getNonDeletedElements(),r=this.scene.getSelectedElements(this.state);if(r.length===1)return bu(r[0],!1)?r[0]:null;let o=null;for(let a=s.length-1;a>=0;--a){if(s[a].isDeleted)continue;const[l,c,d,u]=je(s[a],this.scene.getNonDeletedElementsMap());if(Te(s[a])&&ol({point:M(n,i),element:s[a],elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(s[a])})){o=s[a];break}else if(l<n&&n<d&&c<i&&i<u){o=s[a];break}}return bu(o,!1)?o:null}handleHoverSelectedLinearElement(n,i,s){const r=this.scene.getNonDeletedElementsMap(),o=ne.getElement(n.elementId,r);if(o)if(this.state.selectedLinearElement){let a=-1,l=null;ol({point:M(i,s),element:o,elementsMap:r,threshold:this.getElementHitThreshold(o)})?(a=ne.getPointIndexUnderCursor(o,r,this.state.zoom,i,s),l=ne.getSegmentMidpointHitCoords(n,{x:i,y:s},this.state,this.scene.getNonDeletedElementsMap()),(ve(o)?a===0||a===o.points.length-1:a>=0)||l?Bt(this.interactiveCanvas,Dt.POINTER):this.hitElement(i,s,o)&&(!ve(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Bt(this.interactiveCanvas,Dt.MOVE)):this.hitElement(i,s,o)&&(!ve(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Bt(this.interactiveCanvas,Dt.MOVE),this.state.selectedLinearElement.hoverPointIndex!==a&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:a}}),ne.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,l)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:l}});let c=null;const d=o;(d.startBinding||d.endBinding)&&(c=she(o,i,s,this.scene,this.state)),this.state.selectedLinearElement.hoveredFocusPointBinding!==c&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!1,hoveredFocusPointBinding:c}}),c&&Bt(this.interactiveCanvas,Dt.POINTER)}else Bt(this.interactiveCanvas,Dt.AUTO)}updateGestureOnPointerDown(n){Tt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY}),Tt.pointers.size===2&&(Tt.lastCenter=OL(Tt.pointers),Tt.initialScale=this.state.zoom.value,Tt.initialDistance=FL(Array.from(Tt.pointers.values())))}initialPointerDownState(n){const i=zt(n,this.state),s=this.scene.getSelectedElements(this.state),[r,o,a,l]=Et(s),c=s.findIndex(ve)===0;return{origin:i,withCmdOrCtrl:n[$.CTRL_OR_CMD],originInGrid:_3(ci(i.x,i.y,n[$.CTRL_OR_CMD]||c?null:this.getEffectiveGridSize())),scrollbars:KL(Qm,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop),lastCoords:{...i},originalElements:this.scene.getNonDeletedElements().reduce((d,u)=>(d.set(u.id,cd(u)),d),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(a+r)/2,y:(l+o)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(i,s)},drag:{hasOccurred:!1,offset:null,origin:{...i},blockDragging:!1},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1}}}handleDraggingScrollBar(n,i){if(!(i.scrollbars.isOverEither&&!this.state.multiElement))return!1;q7=!0,i.lastCoords.x=n.clientX,i.lastCoords.y=n.clientY;const s=P7(o=>{o.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(o,i)}),r=hn(()=>{Hd=null,q7=!1,Vo(this.interactiveCanvas,this.state),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,s),window.removeEventListener(te.POINTER_UP,r),s.flush()});return Hd=r,window.addEventListener(te.POINTER_MOVE,s),window.addEventListener(te.POINTER_UP,r),!0}isASelectedElement(n){return n!=null&&this.state.selectedElementIds[n.id]}isHittingCommonBoundingBoxOfSelectedElements(n,i){if(i.length<2)return!1;const s=Math.max(QA/this.state.zoom.value,1),[r,o,a,l]=Et(i);return n.x>r-s&&n.x<a+s&&n.y>o-s&&n.y<l+s}getCurrentItemRoundness(n){return this.state.currentItemRoundness==="round"?{type:of(n)?wn.ADAPTIVE_RADIUS:wn.PROPORTIONAL_RADIUS}:null}maybeCacheReferenceSnapPoints(n,i,s=!1){md({event:n,app:this,selectedElements:i})&&(s||!ho.getReferenceSnapPoints())&&ho.setReferenceSnapPoints(K_e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}maybeCacheVisibleGaps(n,i,s=!1){md({event:n,app:this,selectedElements:i})&&(s||!ho.getVisibleGaps())&&ho.setVisibleGaps(W_e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}onKeyDownFromPointerDownHandler(n){return hn(i=>{this.maybeHandleResize(n,i)||this.maybeDragNewGenericElement(n,i)})}onKeyUpFromPointerDownHandler(n){return hn(i=>{i.key===$.ALT&&i.preventDefault(),!this.maybeHandleResize(n,i)&&this.maybeDragNewGenericElement(n,i)})}onPointerMoveFromPointerDownHandler(n){return P7(i=>{var f,h,m,p,U,b,y,E,_,I,k,w,T,A,S,D,N,L,j,Y,G;if(((f=this.state.openDialog)==null?void 0:f.name)==="elementLinkSelector")return;const s=zt(i,this.state);if(this.state.activeLockedId&&this.setState({activeLockedId:null}),this.state.selectedLinearElement&&this.state.selectedLinearElement.elbowed&&this.state.selectedLinearElement.initialState.segmentMidpoint.index){const[O,z]=ci(s.x,s.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());let H=this.state.selectedLinearElement.initialState.segmentMidpoint.index;if(H<0){const Q=ne.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:O,y:z},this.state,this.scene.getNonDeletedElementsMap());H=Q?ne.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,Q,this.scene.getNonDeletedElementsMap()):-1}const X=ne.moveFixedSegment(this.state.selectedLinearElement,H,O,z,this.scene);this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!0,segmentMidPointHoveredCoords:X.segmentMidPointHoveredCoords,initialState:X.initialState}});return}const r=this.previousPointerMoveCoords??n.origin;if(this.previousPointerMoveCoords=s,n.drag.offset===null&&(n.drag.offset=_3(Ife(this.scene.getSelectedElements(this.state),n.origin.x,n.origin.y))),!(i.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(i,n))return;if(Yo(this.state)){this.handleEraser(i,s);return}this.state.activeTool.type==="laser"&&this.laserTrails.addPointToPath(s.x,s.y);const[a,l]=ci(s.x,s.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());if(n.resize.isResizing&&(n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeHandleCrop(n,i)||this.maybeHandleResize(n,i)))return!0;const c=this.scene.getNonDeletedElementsMap();if(this.state.selectedLinearElement){const O=this.state.selectedLinearElement;if(O.draggedFocusPointBinding){YV(O,c,s,this.scene,this.state,this.getEffectiveGridSize(),i.altKey),this.setState({selectedLinearElement:{...O,isDragging:!1,selectedPointsIndices:[],initialState:{...O.initialState,lastClickedPoint:-1}}});return}if(ne.shouldAddMidpoint(this.state.selectedLinearElement,s,this.state,c)){const z=ne.addMidpoint(this.state.selectedLinearElement,s,this,!i[$.CTRL_OR_CMD],this.scene);if(!z)return;tn.flushSync(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:z.pointerDownState,selectedPointsIndices:z.selectedPointsIndices,segmentMidPointHoveredCoords:null}})});return}else{if(O.initialState.segmentMidpoint.value!==null&&!O.initialState.segmentMidpoint.added)return;if(O.initialState.lastClickedPoint>-1){const z=ne.getElement(O.elementId,c);if(z!=null&&z.isDeleted)return;if(ln(z)){const X=Bi(M(s.x,s.y),this.scene.getNonDeletedElements(),c);Ii("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(z,X)}if(i.altKey&&!((m=(h=this.state.selectedLinearElement)==null?void 0:h.initialState)!=null&&m.arrowStartIsInside)&&Ii("COMPLEX_BINDINGS")&&this.handleSkipBindMode(),O.initialState.lastClickedPoint===-1)return;const H=ne.handlePointDragging(i,this,s.x,s.y,O);if(H){n.lastCoords.x=s.x,n.lastCoords.y=s.y,n.drag.hasOccurred=!0,(H.suggestedBinding!==this.state.suggestedBinding||!ki(((p=H.selectedLinearElement)==null?void 0:p.selectedPointsIndices)??[],((U=this.state.selectedLinearElement)==null?void 0:U.selectedPointsIndices)??[])||((b=H.selectedLinearElement)==null?void 0:b.hoverPointIndex)!==((y=this.state.selectedLinearElement)==null?void 0:y.hoverPointIndex)||((E=H.selectedLinearElement)==null?void 0:E.customLineAngle)!==((_=this.state.selectedLinearElement)==null?void 0:_.customLineAngle)||this.state.selectedLinearElement.isDragging!==((I=H.selectedLinearElement)==null?void 0:I.isDragging)||((w=(k=this.state.selectedLinearElement)==null?void 0:k.initialState)==null?void 0:w.altFocusPoint)!==((A=(T=H.selectedLinearElement)==null?void 0:T.initialState)==null?void 0:A.altFocusPoint))&&this.setState(H);return}}}}const d=n.hit.allHitElements.some(O=>this.isASelectedElement(O)),u=((S=this.state.selectedLinearElement)==null?void 0:S.isEditing)&&i.shiftKey&&this.state.selectedLinearElement.elementId===((D=n.hit.element)==null?void 0:D.id);if((d||n.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!u&&!n.drag.blockDragging){const O=this.scene.getSelectedElements(this.state);if(O.length>0&&O.every(Q=>Q.locked))return;const z=O.find(Q=>_e(Q)),H=this.getTopLayerFrameAtSceneCoords(s),X=H&&!z?H:null;if(this.state.frameToHighlight!==X&&tn.flushSync(()=>{this.setState({frameToHighlight:X})}),n.drag.hasOccurred=!0,this.state.activeTool.type==="lasso"&&this.lassoTrail.hasCurrentTrail&&!(this.editorInterface.formFactor!=="desktop"&&n.hit.element)&&!this.state.activeTool.fromSelection)return;if(this.state.activeTool.type==="lasso"&&O.length>0&&n.drag.hasOccurred&&!this.state.activeTool.fromSelection&&this.lassoTrail.endPath(),O.length>0&&!n.withCmdOrCtrl&&!this.state.editingTextElement&&((N=this.state.activeEmbeddable)==null?void 0:N.state)!=="active"){const Q={x:s.x-n.drag.origin.x,y:s.y-n.drag.origin.y},re=[...n.originalElements.values()],ie=i.shiftKey;if(ie){const ye=Math.abs(Q.x),Ae=Math.abs(Q.y),$e=ie&&ye<Ae,et=ie&&ye>Ae;$e&&(Q.x=0),et&&(Q.y=0)}if(this.state.croppingElementId){const ye=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(ye&&xt(ye)&&ye.crop!==null&&n.hit.element===ye){const Ae=ye.crop,$e=Jn(ye)&&((L=this.imageCache.get(ye.fileId))==null?void 0:L.image);if($e&&!($e instanceof Promise)){const et=ya(ye),Be=An(s.x-r.x,s.y-r.y);Be[0]*=$e.naturalWidth/et.width,Be[1]*=$e.naturalHeight/et.height;const[We,bn,Jt,Pi,Yn,Sr]=je(ye,c),wt=Me(Z(M(We,bn),M(Yn,Sr),ye.angle)),vi=Me(Z(M(Jt,bn),M(Yn,Sr),ye.angle)),Rs=Me(Z(M(We,Pi),M(Yn,Sr),ye.angle)),Yl=To(C6(vi,wt)),D2=To(C6(Rs,wt)),L2=An(Y1(Be,Yl),Y1(Be,D2)),dm={...Ae,x:Ke(Ae.x-L2[0]*Math.sign(ye.scale[0]),0,$e.naturalWidth-Ae.width),y:Ke(Ae.y-L2[1]*Math.sign(ye.scale[1]),0,$e.naturalHeight-Ae.height)};this.scene.mutateElement(ye,{crop:dm});return}}}this.maybeCacheVisibleGaps(i,O),this.maybeCacheReferenceSnapPoints(i,O);const{snapOffset:me,snapLines:ke}=Z_e(re,Q,this,i,this.scene.getNonDeletedElementsMap());if(this.setState({snapLines:ke}),this.state.editingFrame||wfe(n,O,Q,this.scene,me,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),this.setState({selectedElementsAreBeingDragged:!0,selectionElement:null}),i.altKey&&!n.hit.hasBeenDuplicated){n.hit.hasBeenDuplicated=!0;const ye=this.scene.getElementsIncludingDeleted(),Ae=n.hit.element,$e=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});Ae&&n.hit.wasAddedToSelection&&!$e.find(wt=>wt.id===Ae.id)&&$e.push(Ae);const et=new Map($e.map(wt=>[wt.id,wt])),{duplicatedElements:Be,duplicateElementsMap:We,elementsWithDuplicates:bn,origIdToDuplicateId:Jt}=J1({type:"in-place",elements:ye,appState:this.state,randomizeSeed:!0,idsOfElementsToDuplicate:et,overrides:({duplicateElement:wt,origElement:vi})=>({frameId:wt.frameId??vi.frameId,seed:to()})});Be.forEach(wt=>{n.originalElements.set(wt.id,cd(wt))});const Pi=bn.map(wt=>{if(et.has(wt.id)){const vi=n.originalElements.get(wt.id);if(vi)return xe(wt,{x:vi.x,y:vi.y})}return wt}),Yn=(Y=(j=this.props).onDuplicate)==null?void 0:Y.call(j,Pi,ye),Sr=Mo(Yn||Pi,we(Be));tn.flushSync(()=>{if(n.hit.element){const wt=Jt.get(n.hit.element.id),vi=wt&&We.get(wt);n.hit.element=vi||null}n.hit.allHitElements=n.hit.allHitElements.reduce((wt,vi)=>{const Rs=Jt.get(vi.id),Yl=Rs&&We.get(Rs);return Yl&&wt.push(Yl),wt},[]),n.drag.origin=zt(i,this.state),this.setState(wt=>({...gV(Be,this.scene.getNonDeletedElements(),wt)})),this.scene.replaceAllElements(Sr),$e.forEach(wt=>{var vi;si(wt)&&((vi=wt.boundElements)!=null&&vi.some(Rs=>Rs.type==="arrow"))&&pi(wt,this.scene)}),this.maybeCacheVisibleGaps(i,$e,!0),this.maybeCacheReferenceSnapPoints(i,$e,!0)})}return}}if(this.state.selectionElement){if(n.lastCoords.x=s.x,n.lastCoords.y=s.y,i.altKey){this.setActiveTool({type:"lasso",fromSelection:!0},i.shiftKey),this.lassoTrail.startPath(n.origin.x,n.origin.y,i.shiftKey),this.setAppState({selectionElement:null});return}this.maybeDragNewGenericElement(n,i)}else if(this.state.activeTool.type==="lasso")!i.altKey&&this.state.activeTool.fromSelection?(this.setActiveTool({type:"selection"}),this.createGenericElementOnPointerDown("selection",n),n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i),this.lassoTrail.endPath()):this.lassoTrail.addPointToPath(s.x,s.y,i.shiftKey);else{const O=this.state.newElement;if(!O)return;if(O.type==="freedraw"){const z=O.points,H=s.x-O.x,X=s.y-O.y,Q=z.length>0&&z[z.length-1];if(!(Q&&Q[0]===H&&Q[1]===X)){const ie=O.simulatePressure?O.pressures:[...O.pressures,i.pressure];this.scene.mutateElement(O,{points:[...z,M(H,X)],pressures:ie},{informMutation:!1,isDragging:!1}),this.setState({newElement:O})}}else if(De(O)&&!O.isDeleted){n.drag.hasOccurred=!0;const z=O.points;Ce(z.length>1,"Do not create linear elements with less than 2 points");let H=this.state.selectedLinearElement;H||(H=new ne(O,this.scene.getNonDeletedElementsMap()),H={...H,selectedPointsIndices:[1],initialState:{...H.initialState,lastClickedPoint:1}}),this.setState({newElement:O,...ne.handlePointDragging(i,this,a,l,H)})}else n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i,!1)}if(this.state.activeTool.type==="selection"){n.boxSelection.hasOccurred=!0;const O=this.scene.getNonDeletedElements();if((G=this.state.selectedLinearElement)!=null&&G.isEditing)ne.handleBoxSelection(i,this.state,this.setState.bind(this),this.scene.getNonDeletedElementsMap());else{let z=!0;!i.shiftKey&&oi(O,this.state)&&(n.withCmdOrCtrl&&n.hit.element?this.setState(X=>Fi({...X,selectedElementIds:{[n.hit.element.id]:!0}},this.scene.getNonDeletedElements(),X,this)):z=!1);const H=this.state.selectionElement?yT(O,this.state.selectionElement,this.scene.getNonDeletedElementsMap(),!1):[];this.setState(X=>{const Q={...z&&X.selectedElementIds,...H.reduce((re,ie)=>(re[ie.id]=!0,re),{})};return n.hit.element&&(H.length?delete Q[n.hit.element.id]:Q[n.hit.element.id]=!0),X=z?X:{...X,selectedGroupIds:{},editingGroupId:null},{...Fi({editingGroupId:X.editingGroupId,selectedElementIds:Q},this.scene.getNonDeletedElements(),X,this),selectedLinearElement:H.length===1&&De(H[0])?new ne(H[0],this.scene.getNonDeletedElementsMap()):null,showHyperlinkPopup:H.length===1&&(H[0].link||Es(H[0]))?"info":!1}})}}})}handlePointerMoveOverScrollbars(n,i){var s,r;if(i.scrollbars.isOverHorizontal){const o=n.clientX,a=o-i.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-a*(((s=Qm.horizontal)==null?void 0:s.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.x=o,!0}if(i.scrollbars.isOverVertical){const o=n.clientY,a=o-i.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-a*(((r=Qm.vertical)==null?void 0:r.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.y=o,!0}return!1}onPointerUpFromPointerDownHandler(n){return hn(i=>{var y,E,_,I,k,w,T,A,S,D,N,L,j,Y,G;const s=this.scene.getNonDeletedElementsMap();this.removePointer(i),n.drag.blockDragging=!1,n.eventListeners.onMove&&n.eventListeners.onMove.flush();const{newElement:r,resizingElement:o,croppingElementId:a,multiElement:l,activeTool:c,isResizing:d,isRotating:u,isCropping:f}=this.state;this.setState(O=>({isResizing:!1,isRotating:!1,isCropping:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",snapLines:Nm(O.snapLines,[]),originSnapOffset:null})),this.lassoTrail.endPath(),this.previousPointerMoveCoords=null,ho.setReferenceSnapPoints(null),ho.setVisibleGaps(null),this.savePointer(i.clientX,i.clientY,"up");const h=n.hit.allHitElements,m=zt({clientX:i.clientX,clientY:i.clientY},this.state);if(this.state.activeTool.type==="selection"&&!n.boxSelection.hasOccurred&&!n.resize.isResizing&&!h.some(O=>this.state.selectedElementIds[O.id])){const O=this.getElementAtPosition(m.x,m.y,{includeLockedElements:!0});this.store.scheduleCapture(),O!=null&&O.locked?this.setState({activeLockedId:O.groupIds.length>0?O.groupIds.at(-1)||"":O.id}):this.setState({activeLockedId:null})}else this.setState({activeLockedId:null});if(Ii("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),this.setState({selectedElementsAreBeingDragged:!1,bindMode:"orbit"}),n.drag.hasOccurred&&((E=(y=n.hit)==null?void 0:y.element)!=null&&E.id)){const O=s.get(n.hit.element.id);si(O)&&((_=O.boundElements)==null||_.filter(z=>z.type==="arrow").map(z=>s.get(z.id)).filter(z=>ve(z)).forEach(z=>{z&&this.scene.mutateElement(z,{})}))}if((I=this.state.selectedLinearElement)!=null&&I.isEditing&&!this.state.newElement&&this.state.selectedLinearElement.draggedFocusPointBinding===null)if(!n.boxSelection.hasOccurred&&((w=(k=n.hit)==null?void 0:k.element)==null?void 0:w.id)!==this.state.selectedLinearElement.elementId&&this.state.selectedLinearElement.draggedFocusPointBinding===null)this.actionManager.executeAction(qs);else{const O=ne.handlePointerUp(i,this.state.selectedLinearElement,this.state,this.scene);this.actionManager.executeAction(qs,"ui",{event:i,sceneCoords:m}),O!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:O,suggestedBinding:null})}else if(this.state.selectedLinearElement){if(this.state.selectedLinearElement.elbowed){const O=ne.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());O&&this.scene.mutateElement(O,{})}if(this.state.selectedLinearElement.draggedFocusPointBinding?(ihe(this.state.selectedLinearElement,this.scene),this.setState({selectedLinearElement:{...this.state.selectedLinearElement,draggedFocusPointBinding:null}})):((A=(T=n.hit)==null?void 0:T.element)==null?void 0:A.id)!==this.state.selectedLinearElement.elementId?this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null}):this.state.selectedLinearElement.isDragging&&(this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!1}}),this.actionManager.executeAction(qs,"ui",{event:i,sceneCoords:m})),this.state.newElement&&this.state.multiElement&&De(this.state.newElement)&&this.state.selectedLinearElement){const{multiElement:O}=this.state;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,lastCommittedPoint:O.points[O.points.length-1]}})}}if(this.missingPointerEventCleanupEmitter.clear(),window.removeEventListener(te.POINTER_MOVE,n.eventListeners.onMove),window.removeEventListener(te.POINTER_UP,n.eventListeners.onUp),window.removeEventListener(te.KEYDOWN,n.eventListeners.onKeyDown),window.removeEventListener(te.KEYUP,n.eventListeners.onKeyUp),(D=(S=this.props)==null?void 0:S.onPointerUp)==null||D.call(S,c,n),this.onPointerUpEmitter.trigger(this.state.activeTool,n,i),(r==null?void 0:r.type)==="freedraw"){const O=zt(i,this.state),z=r.points;let H=O.x-r.x,X=O.y-r.y;H===z[0][0]&&X===z[0][1]&&(X+=1e-4,H+=1e-4);const Q=r.simulatePressure?[]:[...r.pressures,i.pressure];this.scene.mutateElement(r,{points:[...z,M(H,X)],pressures:Q}),this.actionManager.executeAction(qs);return}if(De(r)){r.points.length>1&&r.points[1][0]!==0&&r.points[1][1]!==0&&this.store.scheduleCapture();const O=zt(i,this.state),z=Qe(M(O.x,O.y),M(n.origin.x,n.origin.y))*this.state.zoom.value;if((!n.drag.hasOccurred||z<Kne)&&r&&!l)if(this.editorInterface.isTouchScreen){const H=Math.min(this.state.width*.7/this.state.zoom.value,100);this.scene.mutateElement(r,{x:r.x-H/2,points:[M(0,0),M(H,0)]},{informMutation:!1,isDragging:!1}),this.actionManager.executeAction(qs)}else{const H=O.x-r.x,X=O.y-r.y;this.scene.mutateElement(r,{points:[r.points[0],M(H,X)]},{informMutation:!1,isDragging:!1}),this.setState({multiElement:r,newElement:r})}else n.drag.hasOccurred&&!l&&(De(r)&&this.actionManager.executeAction(qs,"ui",{event:i,sceneCoords:m}),this.setState({suggestedBinding:null,startBoundElement:null}),c.locked?this.setState(H=>({newElement:null})):(oo(this.interactiveCanvas),this.setState(H=>({newElement:null,activeTool:sn(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:It({...H.selectedElementIds,[r.id]:!0},H),selectedLinearElement:new ne(r,this.scene.getNonDeletedElementsMap())}))),this.scene.triggerUpdate());return}if(he(r)){const O=nT(_t({fontSize:r.fontSize,fontFamily:r.fontFamily}),r.lineHeight);r.width<O&&this.scene.mutateElement(r,{autoResize:!0}),this.resetCursor(),this.handleTextWysiwyg(r,{isExistingElement:!0})}if(c.type!=="selection"&&r&&_l(r)){this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(O=>O.id!==r.id),appState:{newElement:null},captureUpdate:q.NEVER});return}if(_e(r)){const O=Rue(this.scene.getElementsIncludingDeleted(),r,this.scene.getNonDeletedElementsMap());this.scene.replaceAllElements(Q1(this.scene.getElementsMapIncludingDeleted(),O,r,this.state))}if(r&&(this.scene.mutateElement(r,CV(r),{informMutation:!1,isDragging:!1}),this.scene.triggerUpdate()),n.drag.hasOccurred){const O=zt(i,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){const z=this.scene.getElement(this.state.selectedLinearElement.elementId);if(z!=null&&z.frameId){const H=Vs(z,s);H&&z&&(ad(z,H,this.scene.getNonDeletedElementsMap())||(this.scene.mutateElement(z,{groupIds:[]}),Jy([z],this.scene.getNonDeletedElementsMap()),this.scene.triggerUpdate()))}}else{const z=this.getTopLayerFrameAtSceneCoords(O),H=this.scene.getSelectedElements(this.state);let X=this.scene.getElementsMapIncludingDeleted();const Q=re=>{if(re.length>0){for(const ie of re){const me=ie.groupIds.indexOf(this.state.editingGroupId);this.scene.mutateElement(ie,{groupIds:ie.groupIds.slice(0,me)},{informMutation:!1,isDragging:!1})}X.forEach(ie=>{ie.groupIds.length&&Ot(X,ie.groupIds[ie.groupIds.length-1]).length<2&&this.scene.mutateElement(ie,{groupIds:[]},{informMutation:!1,isDragging:!1})}),this.setState({editingGroupId:null})}};if(z&&!this.state.selectedElementIds[z.id]){const re=H.filter(ie=>ie.frameId!==z.id&&i5(ie,X,this.state));this.state.editingGroupId&&Q(re),X=Q1(X,re,z,this.state)}else if(!z&&this.state.editingGroupId){const re=H.filter(ie=>ie.frameId&&!i5(ie,X,this.state));Q(re)}X=pg(X,this.state,this),this.scene.replaceAllElements(X)}}if(o&&this.store.scheduleCapture(),o&&_l(o)&&this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(O=>O.id!==o.id),captureUpdate:q.NEVER}),n.resize.isResizing){let O=pg(this.scene.getElementsIncludingDeleted(),this.state,this);const z=this.scene.getSelectedElements(this.state).filter(H=>_e(H));for(const H of z)O=Wg(O,ha(this.scene.getElementsIncludingDeleted(),H,this.state,s),H,this);this.scene.replaceAllElements(O)}const p=n.hit.element;((N=this.state.selectedLinearElement)==null?void 0:N.elementId)!==(p==null?void 0:p.id)&&De(p)&&this.scene.getSelectedElements(this.state).length===1&&this.setState({selectedLinearElement:new ne(p,this.scene.getNonDeletedElementsMap())}),(!a||a&&(!p&&!f||p&&p.id!==a))&&this.finishImageCropping();const U=this.lastPointerDownEvent,b=this.lastPointerUpEvent||this.lastPointerMoveEvent;if(Yo(this.state)&&U&&b){if(this.eraserTrail.endPath(),Qe(M(U.clientX,U.clientY),M(b.clientX,b.clientY))===0){const z=zt({clientX:b.clientX,clientY:b.clientY},this.state);this.getElementsAtPosition(z.x,z.y).forEach(X=>this.elementsPendingErasure.add(X.id))}this.eraseElements();return}else this.elementsPendingErasure.size&&this.restoreReadyToEraseElements();if(p&&!n.drag.hasOccurred&&!n.hit.wasAddedToSelection&&(!((L=this.state.selectedLinearElement)!=null&&L.isEditing)||!n.boxSelection.hasOccurred)&&this.state.activeTool.type!=="lasso"&&(i.shiftKey&&!((j=this.state.selectedLinearElement)!=null&&j.isEditing)?this.state.selectedElementIds[p.id]?pT(this.state,p)?this.setState(O=>{const z={...O.selectedElementIds};for(const H of p.groupIds.flatMap(X=>Ot(this.scene.getNonDeletedElements(),X)))delete z[H.id];return{selectedGroupIds:{...O.selectedElementIds,...p.groupIds.map(H=>({[H]:!1})).reduce((H,X)=>({...H,...X}),{})},selectedElementIds:It(z,O)}}):(Y=this.state.selectedLinearElement)!=null&&Y.isDragging||this.setState(O=>{const z={...O.selectedElementIds};delete z[p.id];const H=Ze(this.scene.getNonDeletedElements(),{selectedElementIds:z});return{...Fi({editingGroupId:O.editingGroupId,selectedElementIds:z},this.scene.getNonDeletedElements(),O,this),selectedLinearElement:H.length===1&&De(H[0])?new ne(H[0],this.scene.getNonDeletedElementsMap()):O.selectedLinearElement}}):p.frameId&&this.state.selectedElementIds[p.frameId]?this.setState(O=>{var H;const z={...O.selectedElementIds,[p.id]:!0};return delete z[p.frameId],(((H=this.scene.getElement(p.frameId))==null?void 0:H.groupIds)??[]).flatMap(X=>Ot(this.scene.getNonDeletedElements(),X)).forEach(X=>{delete z[X.id]}),{...Fi({editingGroupId:O.editingGroupId,selectedElementIds:z},this.scene.getNonDeletedElements(),O,this),showHyperlinkPopup:p.link||Es(p)?"info":!1}}):this.setState(O=>({selectedElementIds:It({...O.selectedElementIds,[p.id]:!0},O)})):this.setState(O=>{var z;return{...Fi({editingGroupId:O.editingGroupId,selectedElementIds:{[p.id]:!0}},this.scene.getNonDeletedElements(),O,this),selectedLinearElement:De(p)&&((z=O.selectedLinearElement)==null?void 0:z.elementId)!==p.id?new ne(p,this.scene.getNonDeletedElementsMap()):O.selectedLinearElement}})),this.state.activeTool.type!=="lasso"&&!(p&&ve(p))&&!n.drag.hasOccurred&&!this.state.isResizing&&(p&&Ode({point:M(n.origin.x,n.origin.y),element:p,elementsMap:s,threshold:this.getElementHitThreshold(p),frameNameBound:_e(p)?this.frameNameBoundsCache.get(p):null},s)||!p&&n.hit.hasHitCommonBoundingBoxOfSelectedElements)){(G=this.state.selectedLinearElement)!=null&&G.isEditing?this.actionManager.executeAction(KU):this.setState({selectedElementIds:It({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),Bt(this.interactiveCanvas,Dt.AUTO);return}if(!c.locked&&c.type!=="freedraw"&&r&&this.setState(O=>({selectedElementIds:It({...O.selectedElementIds,[r.id]:!0},O),showHyperlinkPopup:Es(r)&&!r.link?"editor":O.showHyperlinkPopup})),(c.type!=="selection"||oi(this.scene.getNonDeletedElements(),this.state)||!ki(this.state.previousSelectedElementIds,this.state.selectedElementIds))&&this.store.scheduleCapture(),n.drag.hasOccurred&&!this.state.selectedLinearElement||d||u||f){const O=this.scene.getSelectedElements(this.state).filter(Te);O4(O,this.scene,this.state)}if(c.type==="laser"){this.laserTrails.endPath();return}!c.locked&&c.type!=="freedraw"&&(c.type!=="lasso"||c.type==="lasso"&&c.fromSelection)?(oo(this.interactiveCanvas),this.setState({newElement:null,suggestedBinding:null,activeTool:sn(this.state,{type:this.state.preferredSelectionTool.type})})):this.setState({newElement:null,suggestedBinding:null}),p&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&Tt.pointers.size<=1&&Br(p)&&this.isIframeLikeElementCenter(p,this.lastPointerUpEvent,n.origin.x,n.origin.y)&&this.handleEmbeddableCenterClick(p)})}clearSelection(n){this.setState(i=>({selectedElementIds:It({},i),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:i.editingGroupId&&n!=null&&$0(n,i.editingGroupId)?i.editingGroupId:null})),this.setState({selectedElementIds:It({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds,selectedLinearElement:null})}getTextWysiwygSnappedToCenterPosition(n,i,s,r){if(r){let o=r.x+r.width/2,a=r.y+r.height/2;const l=F3(r,s,this.scene.getNonDeletedElementsMap());if(l&&(o=l.x,a=l.y),Math.hypot(n-o,i-a)<qne){const{x:u,y:f}=cr({sceneX:o,sceneY:a},s);return{viewportX:u,viewportY:f,elementCenterX:o,elementCenterY:a}}}}getCanvasOffsets(){var n;if((n=this.excalidrawContainerRef)!=null&&n.current){const i=this.excalidrawContainerRef.current,{left:s,top:r}=i.getBoundingClientRect();return{offsetLeft:s,offsetTop:r}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){const n=sE.find(i=>i.code===this.props.langCode)||af;await q$(n),this.setAppState({})}}const UIe=e=>{const[t,n]=C.useState(!0);return C.useEffect(()=>{const i=async()=>{await q$(s),n(!1)},s=sE.find(r=>r.code===e.langCode)||af;i()},[e.langCode]),t?g(eK,{theme:e.theme}):e.children},ZK=({children:e})=>{const{FooterCenterTunnel:t}=gs(),n=Qt();return g(t.In,{children:g("div",{className:ae("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:e})})};ZK.displayName="FooterCenter";const qK=({isCollaborating:e,onSelect:t,editorInterface:n,...i})=>{const s=Qt(),r=(n==null?void 0:n.formFactor)!=="desktop"||s.width<Iie;return P(gd,{...i,className:ae("collab-button",{active:e}),type:"button",onSelect:t,style:{position:"relative",width:r?void 0:"auto"},title:x("labels.liveCollaboration"),children:[r?qT:x("labels.share"),s.collaborators.size>0&&g("div",{className:"CollabButton-collaborators",children:s.collaborators.size})]})};qK.displayName="LiveCollaborationTrigger";const bIe=()=>g("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),yIe=()=>P("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[g("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),QK=({style:e,size:t="small",withText:n})=>P("div",{className:`ExcalidrawLogo is-${t}`,style:e,children:[g(bIe,{}),n&&g(yIe,{})]}),TS=({icon:e,shortcut:t,children:n})=>{const i=Nn();return P(fe,{children:[g("div",{className:"welcome-screen-menu-item__icon",children:e}),g("div",{className:"welcome-screen-menu-item__text",children:n}),t&&i.formFactor!=="phone"&&g("div",{className:"welcome-screen-menu-item__shortcut",children:t})]})};TS.displayName="WelcomeScreenMenuItemContent";const C2=({onSelect:e,children:t,icon:n,shortcut:i,className:s="",...r})=>g("button",{...r,type:"button",className:`welcome-screen-menu-item ${s}`,onClick:e,children:g(TS,{icon:n,shortcut:i,children:t})});C2.displayName="WelcomeScreenMenuItem";const JK=({children:e,href:t,icon:n,shortcut:i,className:s="",...r})=>g("a",{...r,className:`welcome-screen-menu-item ${s}`,href:t,target:"_blank",rel:"noopener",children:g(TS,{icon:n,shortcut:i,children:e})});JK.displayName="WelcomeScreenMenuItemLink";const Oo=({children:e})=>{const{WelcomeScreenCenterTunnel:t}=gs();return g(t.In,{children:g("div",{className:"welcome-screen-center",children:e||P(fe,{children:[g(IS,{}),g(SS,{children:x("welcomeScreen.defaults.center_heading")}),P(CS,{children:[g(AS,{}),g(xS,{})]})]})})})};Oo.displayName="Center";const IS=({children:e})=>g("div",{className:"welcome-screen-center__logo excalifont welcome-screen-decor",children:e||g(QK,{withText:!0})});IS.displayName="Logo";const SS=({children:e})=>g("div",{className:"welcome-screen-center__heading welcome-screen-decor excalifont",children:e});SS.displayName="Heading";const CS=({children:e})=>g("div",{className:"welcome-screen-menu",children:e});CS.displayName="Menu";const xS=()=>{const e=Ei();return g(C2,{onSelect:()=>e.executeAction(JI),shortcut:"?",icon:WT,children:x("helpDialog.title")})};xS.displayName="MenuItemHelp";const AS=()=>{const e=Qt(),t=Ei();return e.viewModeEnabled?null:g(C2,{onSelect:()=>t.executeAction(M_),shortcut:Ln("loadScene"),icon:ZT,children:x("buttons.load")})};AS.displayName="MenuItemLoadScene";const eZ=({onSelect:e})=>{const{t}=Ft();return g(C2,{shortcut:null,onSelect:e,icon:QT,children:t("labels.liveCollaboration")})};eZ.displayName="MenuItemLiveCollaborationTrigger";Oo.Logo=IS;Oo.Heading=SS;Oo.Menu=CS;Oo.MenuItem=C2;Oo.MenuItemLink=JK;Oo.MenuItemHelp=xS;Oo.MenuItemLoadScene=AS;Oo.MenuItemLiveCollaborationTrigger=eZ;const MS=({children:e})=>{const{WelcomeScreenMenuHintTunnel:t}=gs();return g(t.In,{children:P("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[Whe,g("div",{className:"welcome-screen-decor-hint__label",children:e||x("welcomeScreen.defaults.menuHint")})]})})};MS.displayName="MenuHint";const kS=({children:e})=>{const{WelcomeScreenToolbarHintTunnel:t}=gs();return g(t.In,{children:P("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[g("div",{className:"welcome-screen-decor-hint__label",children:e||x("welcomeScreen.defaults.toolbarHint")}),Zhe]})})};kS.displayName="ToolbarHint";const RS=({children:e})=>{const{WelcomeScreenHelpHintTunnel:t}=gs();return g(t.In,{children:P("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[g("div",{children:e||x("welcomeScreen.defaults.helpHint")}),Khe]})})};RS.displayName="HelpHint";const ys=e=>g(fe,{children:e.children||P(fe,{children:[g(Oo,{}),g(MS,{}),g(kS,{}),g(RS,{})]})});ys.displayName="WelcomeScreen";ys.Center=Oo;ys.Hints={MenuHint:MS,ToolbarHint:kS,HelpHint:RS};const tZ=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.innerHTML="",this.append(...e)})},EIe=(e,t,n)=>{var i,s,r;return!!(t&&(t.id===((i=e.editingTextElement)==null?void 0:i.id)||t.id===((s=e.resizingElement)==null?void 0:s.id)||t.id===((r=e.newElement)==null?void 0:r.id)||t.version>n.version||t.version===n.version&&t.versionNonce<=n.versionNonce))},vIe=na((e,t,n)=>{if(window!=null&&window.DEBUG_FRACTIONAL_INDICES){const i=Ad(e.map(s=>({...s})));kT(i,{shouldThrow:D9(),includeBoundTextValidation:!0,reconciliationContext:{localElements:t,remoteElements:n}})}},1e3*60,{leading:!0,trailing:!1}),DS=(e,t,n)=>{const i=we(e),s=[],r=new Set;for(const a of t)if(!r.has(a.id)){const l=i.get(a.id),c=EIe(n,l,a);l&&c?(s.push(l),r.add(l.id)):(s.push(a),r.add(a.id))}for(const a of e)r.has(a.id)||(s.push(a),r.add(a.id));const o=RT(s);return vIe(o,e,t),Ad(o),o},nZ=({children:e,icon:t})=>{const{t:n}=Ft(),{TTDDialogTriggerTunnel:i}=gs(),s=On();return g(i.In,{children:g(Oe.Item,{onSelect:()=>{at("ai","dialog open","ttd"),s({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:t??lme,badge:g(Oe.Item.Badge,{children:"AI"}),children:e??n("labels.textToDiagram")})})};nZ.displayName="TTDDialogTrigger";function _Ie(e){const t=e.get("X-Ratelimit-Limit"),n=e.get("X-Ratelimit-Remaining");return{rateLimit:t?parseInt(t,10):void 0,rateLimitRemaining:n?parseInt(n,10):void 0}}async function*wIe(e){const t=new TextDecoder;let n="";try{for(;;){const{done:i,value:s}=await e.read();if(i)break;n+=t.decode(s,{stream:!0});const r=n.split(`
`);n=r.pop()||"";for(const o of r){const a=o.trim();a&&a.startsWith("data: ")&&(yield a.slice(6))}}}finally{e.releaseLock()}}async function TIe(e){var a;const{url:t,messages:n,onChunk:i,onStreamCreated:s,extractRateLimits:r=!0,signal:o}=e;try{let l="",c={},d=null;const u=await fetch(t,{method:"POST",headers:{Accept:"text/event-stream","Content-Type":"application/json"},body:JSON.stringify({messages:n}),signal:o});if(r&&(c=_Ie(u.headers)),!u.ok){if(u.status===429)return{...c,error:new ja({message:"Rate limit exceeded",status:429})};const h=await u.text();throw new ja({message:h||"Generation failed...",status:u.status})}const f=(a=u.body)==null?void 0:a.getReader();if(!f)throw new ja({message:"Couldn't get reader from response body",status:500});s==null||s();try{for await(const h of wIe(f)){if(h==="[DONE]")break;try{const m=JSON.parse(h);if(m===null)break;switch(m.type){case"content":{const p=m.delta;p&&(l+=p,i==null||i(p));break}case"error":d=new ja({message:m.error.message,status:500});break;case"done":break}}catch(m){console.warn("Failed to parse SSE data:",h,m)}}}catch(h){h.name==="AbortError"?d=new ja({message:"Request aborted",status:499}):d=new ja({message:h.message||"Streaming error",status:500})}return d?{...c,error:d}:l?{generatedResponse:l,error:null,...c}:{...c,error:new ja({message:"Generation failed...",status:u.status})}}catch(l){return l.name==="AbortError"?{error:new ja({message:"Request aborted",status:499})}:{error:new ja({message:l.message||"Request failed",status:500})}}}const IIe=e=>{const t=Ir();return C.useLayoutEffect(()=>{t.setPlugins({diagramToCode:{generate:e.generate}})},[t,e.generate]),null};tZ();const SIe=e=>{var Q,re,ie,me;const{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r=!1,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c=af.code,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,onPaste:b,detectScroll:y=!0,handleKeyboardGlobally:E=!1,onLibraryChange:_,autoFocus:I=!1,generateIdForFile:k,onLinkOpen:w,generateLinkForSelection:T,onPointerDown:A,onPointerUp:S,onScrollChange:D,onDuplicate:N,children:L,validateEmbeddable:j,renderEmbeddable:Y,aiEnabled:G,showDeprecatedFonts:O,renderScrollbars:z}=e,H=(Q=e.UIOptions)==null?void 0:Q.canvasActions,X={...e.UIOptions,canvasActions:{...tM.canvasActions,...H},tools:{image:((ie=(re=e.UIOptions)==null?void 0:re.tools)==null?void 0:ie.image)??!0}};return H!=null&&H.export&&(X.canvasActions.export.saveFileToDisk=((me=H.export)==null?void 0:me.saveFileToDisk)??tM.canvasActions.export.saveFileToDisk),X.canvasActions.toggleTheme===null&&typeof m>"u"&&(X.canvasActions.toggleTheme=!0),C.useEffect(()=>{(async()=>{await Ue(()=>import("./roundRect-0PYZxl1G.js"),__vite__mapDeps([]))})();const ye=Ae=>{typeof Ae.scale=="number"&&Ae.scale!==1&&Ae.preventDefault()};return document.addEventListener("touchmove",ye,{passive:!1}),()=>{document.removeEventListener("touchmove",ye)}},[]),g(Ohe,{store:ar,children:g(UIe,{langCode:c,theme:m,children:g(wS,{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,UIOptions:X,onPaste:b,detectScroll:y,handleKeyboardGlobally:E,onLibraryChange:_,autoFocus:I,generateIdForFile:k,onLinkOpen:w,generateLinkForSelection:T,onPointerDown:A,onPointerUp:S,onScrollChange:D,onDuplicate:N,validateEmbeddable:j,renderEmbeddable:Y,aiEnabled:G!==!1,showDeprecatedFonts:O,renderScrollbars:z,children:L})})})},CIe=(e,t)=>{if(e.children!==t.children)return!1;const{initialData:n,UIOptions:i={},...s}=e,{initialData:r,UIOptions:o={},...a}=t,l=Object.keys(i),c=Object.keys(o);return l.length!==c.length?!1:l.every(u=>u==="getFormFactor"?!0:u==="canvasActions"?Object.keys(i.canvasActions).every(h=>{var m,p,U,b;return h==="export"&&((m=i==null?void 0:i.canvasActions)!=null&&m.export)&&((p=o==null?void 0:o.canvasActions)!=null&&p.export)?i.canvasActions.export.saveFileToDisk===o.canvasActions.export.saveFileToDisk:((U=i==null?void 0:i.canvasActions)==null?void 0:U[h])===((b=o==null?void 0:o.canvasActions)==null?void 0:b[h])}):i[u]===o[u])&&ki(s,a)},iZ=de.memo(SIe,CIe);iZ.displayName="Excalidraw";const xIe=({link:e,onCloseRequest:t,setErrorMessage:n})=>{const{t:i}=Ft(),[,s]=C.useState(!1),r=C.useRef(0),o=C.useRef(null),a=async()=>{var d;try{await kd(e)}catch{n(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(d=o.current)==null||d.select()},{onCopy:l,copyStatus:c}=mS();return g(Tr,{onCloseRequest:t,title:!1,size:"small",children:P("div",{className:"ShareableLinkDialog",children:[g("h3",{children:"Shareable link"}),P("div",{className:"ShareableLinkDialog__linkRow",children:[g(Xu,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:e,selectOnRender:!0}),g($s,{size:"large",label:i("buttons.copyLink"),icon:f2,status:c,onClick:()=>{l(),a()}})]}),P("div",{className:"ShareableLinkDialog__description",children:[" ",i("alerts.uploadedSecurly")]})]})})},AIe=300,MIe=5e3,kIe=300,RIe=500,CP=2e4,DIe=50,LIe=33,PIe=24*60*60*1e3,LS=4*1024*1024,NIe=31536e3,jb={SERVER_VOLATILE:"server-volatile-broadcast",SERVER:"server-broadcast",USER_FOLLOW_CHANGE:"user-follow",USER_FOLLOW_ROOM_CHANGE:"user-follow-room-change"};var vs=(e=>(e.INVALID_RESPONSE="INVALID_RESPONSE",e.INIT="SCENE_INIT",e.UPDATE="SCENE_UPDATE",e.MOUSE_LOCATION="MOUSE_LOCATION",e.IDLE_STATUS="IDLE_STATUS",e.USER_VISIBLE_SCENE_BOUNDS="USER_VISIBLE_SCENE_BOUNDS",e))(vs||{});const sZ={shareLinkFiles:"/files/shareLinks",collabFiles:"/files/rooms"},OIe=10,Tn={LOCAL_STORAGE_ELEMENTS:"excalidraw",LOCAL_STORAGE_APP_STATE:"excalidraw-state",LOCAL_STORAGE_COLLAB:"excalidraw-collab",LOCAL_STORAGE_THEME:"excalidraw-theme",LOCAL_STORAGE_DEBUG:"excalidraw-debug",VERSION_DATA_STATE:"version-dataState",VERSION_FILES:"version-files",IDB_LIBRARY:"excalidraw-library",IDB_TTD_CHATS:"excalidraw-ttd-chats",__LEGACY_LOCAL_STORAGE_LIBRARY:"excalidraw-library"},FIe={AUTH_STATE_COOKIE:"excplus-auth"},ju=document.cookie.includes(FIe.AUTH_STATE_COOKIE),BIe=e=>{try{localStorage.setItem(Tn.LOCAL_STORAGE_COLLAB,JSON.stringify({username:e}))}catch(t){console.error(t)}},rZ=()=>{try{const e=localStorage.getItem(Tn.LOCAL_STORAGE_COLLAB);if(e)return JSON.parse(e).username}catch(e){console.error(e)}return null},oZ=()=>{let e=null,t=null;try{e=localStorage.getItem(Tn.LOCAL_STORAGE_ELEMENTS),t=localStorage.getItem(Tn.LOCAL_STORAGE_APP_STATE)}catch(s){console.error(s)}let n=[];if(e)try{n=JSON.parse(e)}catch(s){console.error(s)}let i=null;if(t)try{i={...Aa(),...Dj(JSON.parse(t))}}catch(s){console.error(s)}return{elements:n,appState:i}},aZ=()=>{try{const e=localStorage.getItem(Tn.LOCAL_STORAGE_ELEMENTS);return(e==null?void 0:e.length)||0}catch(e){return console.error(e),0}},zIe=()=>{try{const e=localStorage.getItem(Tn.LOCAL_STORAGE_APP_STATE),t=localStorage.getItem(Tn.LOCAL_STORAGE_COLLAB),n=(e==null?void 0:e.length)||0,i=(t==null?void 0:t.length)||0;return n+i+aZ()}catch(e){return console.error(e),0}},HIe=500,xP=Al(e=>{e({scene:aZ(),total:zIe()})},HIe),VIe=e=>{const[t,n]=C.useState({scene:0,total:0});C.useEffect(()=>{xP(o=>{n(o)})},[e.elements,e.appState]),C.useEffect(()=>()=>xP.cancel(),[]);const i=g4();let s,r;return i!==mz?(r=i.slice(0,16).replace("T"," "),s=i.slice(21)):r=x("stats.versionNotAvailable"),P(tl.StatsRows,{order:-1,children:[g(tl.StatsRow,{heading:!0,children:x("stats.version")}),P(tl.StatsRow,{style:{textAlign:"center",cursor:"pointer"},onClick:async()=>{try{await kd(g4()),e.setToast(x("toast.copyToClipboard"))}catch{}},title:x("stats.versionCopy"),children:[r,g("br",{}),s]}),g(tl.StatsRow,{heading:!0,children:x("stats.storage")}),P(tl.StatsRow,{columns:2,children:[g("div",{children:x("stats.scene")}),g("div",{children:aM(t.scene,1)})]}),P(tl.StatsRow,{columns:2,children:[g("div",{children:x("stats.total")}),g("div",{children:aM(t.total,1)})]})]})},go=c2(),$Ie=(e,t)=>{const[n,i]=bg(e);return C.useLayoutEffect(()=>{i(typeof t=="function"?t():t)},[]),[n,i]};class lZ{constructor({getFiles:t,saveFiles:n}){B(this,"fetchingFiles",new Map);B(this,"erroredFiles_fetch",new Map);B(this,"savingFiles",new Map);B(this,"savedFiles",new Map);B(this,"erroredFiles_save",new Map);B(this,"_getFiles");B(this,"_saveFiles");B(this,"isFileTracked",t=>this.savedFiles.has(t)||this.savingFiles.has(t)||this.fetchingFiles.has(t)||this.erroredFiles_fetch.has(t)||this.erroredFiles_save.has(t));B(this,"isFileSavedOrBeingSaved",t=>{const n=this.getFileVersion(t);return this.savedFiles.get(t.id)===n||this.savingFiles.get(t.id)===n});B(this,"getFileVersion",t=>t.version??1);B(this,"saveFiles",async({elements:t,files:n})=>{const i=new Map;for(const s of t){const r=Jn(s)&&n[s.fileId];r&&!this.isFileSavedOrBeingSaved(r)&&(i.set(s.fileId,n[s.fileId]),this.savingFiles.set(s.fileId,this.getFileVersion(r)))}try{const{savedFiles:s,erroredFiles:r}=await this._saveFiles({addedFiles:i});for(const[o,a]of s)this.savedFiles.set(o,this.getFileVersion(a));for(const[o,a]of r)this.erroredFiles_save.set(o,this.getFileVersion(a));return{savedFiles:s,erroredFiles:r}}finally{for(const[s]of i)this.savingFiles.delete(s)}});B(this,"getFiles",async t=>{if(!t.length)return{loadedFiles:[],erroredFiles:new Map};for(const n of t)this.fetchingFiles.set(n,!0);try{const{loadedFiles:n,erroredFiles:i}=await this._getFiles(t);for(const s of n)this.savedFiles.set(s.id,this.getFileVersion(s));for(const[s]of i)this.erroredFiles_fetch.set(s,!0);return{loadedFiles:n,erroredFiles:i}}finally{for(const n of t)this.fetchingFiles.delete(n)}});B(this,"shouldPreventUnload",t=>t.some(n=>Jn(n)&&!n.isDeleted&&this.savingFiles.has(n.fileId)));B(this,"shouldUpdateImageElementStatus",t=>Jn(t)&&this.savedFiles.has(t.fileId)&&t.status==="pending");this._getFiles=t,this._saveFiles=n}reset(){this.fetchingFiles.clear(),this.savingFiles.clear(),this.savedFiles.clear(),this.erroredFiles_fetch.clear(),this.erroredFiles_save.clear()}}const PS=async({files:e,maxBytes:t,encryptionKey:n})=>{const i=[];for(const[s,r]of e){const o=new TextEncoder().encode(r.dataURL),a=await MY(o,{encryptionKey:n,metadata:{id:s,mimeType:r.mimeType,created:Date.now(),lastRetrieved:Date.now()}});if(o.byteLength>t)throw new Error(x("errors.fileTooBig",{maxSize:`${Math.trunc(t/1024/1024)}MB`}));i.push({id:s,buffer:a})}return i},I1=e=>{e.erroredFiles.size&&e.excalidrawAPI.updateScene({elements:e.excalidrawAPI.getSceneElementsIncludingDeleted().map(t=>Jn(t)&&e.erroredFiles.has(t.fileId)?xe(t,{status:"error"}):t),captureUpdate:q.NEVER})};var AP={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cZ=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},GIe=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=e[n++],o=e[n++],a=e[n++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},dZ={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<e.length;s+=3){const r=e[s],o=s+1<e.length,a=o?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,d=r>>2,u=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,h=c&63;l||(h=64,o||(f=64)),i.push(n[d],n[u],n[f],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(cZ(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):GIe(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<e.length;){const r=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const c=s<e.length?n[e.charAt(s)]:64;++s;const u=s<e.length?n[e.charAt(s)]:64;if(++s,r==null||a==null||c==null||u==null)throw new XIe;const f=r<<2|a>>4;if(i.push(f),c!==64){const h=a<<4&240|c>>2;if(i.push(h),u!==64){const m=c<<6&192|u;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class XIe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jIe=function(e){const t=cZ(e);return dZ.encodeByteArray(t,!0)},q5=function(e){return jIe(e).replace(/\./g,"")},YIe=function(e){try{return dZ.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WIe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KIe=()=>WIe().__FIREBASE_DEFAULTS__,ZIe=()=>{if(typeof process>"u"||typeof AP>"u")return;const e=AP.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},qIe=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&YIe(e[1]);return t&&JSON.parse(t)},NS=()=>{try{return KIe()||ZIe()||qIe()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},QIe=e=>{var t,n;return(n=(t=NS())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},uZ=e=>{const t=QIe(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},fZ=()=>{var e;return(e=NS())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JIe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hZ(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",s=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[q5(JSON.stringify(n)),q5(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eSe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tSe(){var e;const t=(e=NS())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nSe(){return!tSe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function iSe(){try{return typeof indexedDB=="object"}catch{return!1}}function sSe(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var r;t(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rSe="FirebaseError";class pf extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=rSe,Object.setPrototypeOf(this,pf.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gZ.prototype.create)}}class gZ{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?oSe(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new pf(s,a,i)}}function oSe(e,t){return e.replace(aSe,(n,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const aSe=/\{\$([^}]+)}/g;function q_(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const r=e[s],o=t[s];if(MP(r)&&MP(o)){if(!q_(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function MP(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(e){return e&&e._delegate?e._delegate:e}class xg{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lSe{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new JIe;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(dSe(t))try{this.getOrInitializeService({instanceIdentifier:Yd})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Yd){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Yd){return this.instances.has(t)}getOptions(t=Yd){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,n){var i;const s=this.normalizeInstanceIdentifier(n),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(t),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&t(o,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const s of i)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:cSe(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Yd){return this.component?this.component.multipleInstances?t:Yd:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cSe(e){return e===Yd?void 0:e}function dSe(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uSe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new lSe(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(bt||(bt={}));const fSe={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},hSe=bt.INFO,gSe={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},mSe=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),s=gSe[t];if(s)console[s](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class mZ{constructor(t){this.name=t,this._logLevel=hSe,this._logHandler=mSe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in bt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?fSe[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...t),this._logHandler(this,bt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...t),this._logHandler(this,bt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...t),this._logHandler(this,bt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...t),this._logHandler(this,bt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...t),this._logHandler(this,bt.ERROR,...t)}}const pSe=(e,t)=>t.some(n=>e instanceof n);let kP,RP;function USe(){return kP||(kP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bSe(){return RP||(RP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pZ=new WeakMap,Q_=new WeakMap,UZ=new WeakMap,ev=new WeakMap,OS=new WeakMap;function ySe(e){const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{n(Wc(e.result)),s()},o=()=>{i(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&pZ.set(n,e)}).catch(()=>{}),OS.set(t,e),t}function ESe(e){if(Q_.has(e))return;const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{n(),s()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)});Q_.set(e,t)}let J_={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Q_.get(e);if(t==="objectStoreNames")return e.objectStoreNames||UZ.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wc(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function vSe(e){J_=e(J_)}function _Se(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(tv(this),t,...n);return UZ.set(i,t.sort?t.sort():[t]),Wc(i)}:bSe().includes(e)?function(...t){return e.apply(tv(this),t),Wc(pZ.get(this))}:function(...t){return Wc(e.apply(tv(this),t))}}function wSe(e){return typeof e=="function"?_Se(e):(e instanceof IDBTransaction&&ESe(e),pSe(e,USe())?new Proxy(e,J_):e)}function Wc(e){if(e instanceof IDBRequest)return ySe(e);if(ev.has(e))return ev.get(e);const t=wSe(e);return t!==e&&(ev.set(e,t),OS.set(t,e)),t}const tv=e=>OS.get(e);function TSe(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=Wc(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Wc(o.result),l.oldVersion,l.newVersion,Wc(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const ISe=["get","getKey","getAll","getAllKeys","count"],SSe=["put","add","delete","clear"],nv=new Map;function DP(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(nv.get(t))return nv.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=SSe.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||ISe.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return nv.set(t,r),r}vSe(e=>({...e,get:(t,n,i)=>DP(t,n)||e.get(t,n,i),has:(t,n)=>!!DP(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CSe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xSe(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function xSe(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ew="@firebase/app",LP="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=new mZ("@firebase/app"),ASe="@firebase/app-compat",MSe="@firebase/analytics-compat",kSe="@firebase/analytics",RSe="@firebase/app-check-compat",DSe="@firebase/app-check",LSe="@firebase/auth",PSe="@firebase/auth-compat",NSe="@firebase/database",OSe="@firebase/data-connect",FSe="@firebase/database-compat",BSe="@firebase/functions",zSe="@firebase/functions-compat",HSe="@firebase/installations",VSe="@firebase/installations-compat",$Se="@firebase/messaging",GSe="@firebase/messaging-compat",XSe="@firebase/performance",jSe="@firebase/performance-compat",YSe="@firebase/remote-config",WSe="@firebase/remote-config-compat",KSe="@firebase/storage",ZSe="@firebase/storage-compat",qSe="@firebase/firestore",QSe="@firebase/vertexai",JSe="@firebase/firestore-compat",eCe="firebase",tCe="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="[DEFAULT]",nCe={[ew]:"fire-core",[ASe]:"fire-core-compat",[kSe]:"fire-analytics",[MSe]:"fire-analytics-compat",[DSe]:"fire-app-check",[RSe]:"fire-app-check-compat",[LSe]:"fire-auth",[PSe]:"fire-auth-compat",[NSe]:"fire-rtdb",[OSe]:"fire-data-connect",[FSe]:"fire-rtdb-compat",[BSe]:"fire-fn",[zSe]:"fire-fn-compat",[HSe]:"fire-iid",[VSe]:"fire-iid-compat",[$Se]:"fire-fcm",[GSe]:"fire-fcm-compat",[XSe]:"fire-perf",[jSe]:"fire-perf-compat",[YSe]:"fire-rc",[WSe]:"fire-rc-compat",[KSe]:"fire-gcs",[ZSe]:"fire-gcs-compat",[qSe]:"fire-fst",[JSe]:"fire-fst-compat",[QSe]:"fire-vertex","fire-js":"fire-js",[eCe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=new Map,iCe=new Map,nw=new Map;function PP(e,t){try{e.container.addComponent(t)}catch(n){Fl.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function yp(e){const t=e.name;if(nw.has(t))return Fl.debug(`There were multiple attempts to register component ${t}.`),!1;nw.set(t,e);for(const n of Q5.values())PP(n,e);for(const n of iCe.values())PP(n,e);return!0}function bZ(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function yZ(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sCe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kc=new gZ("app","Firebase",sCe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rCe{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new xg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Kc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EZ=tCe;function vZ(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:tw,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Kc.create("bad-app-name",{appName:String(s)});if(n||(n=fZ()),!n)throw Kc.create("no-options");const r=Q5.get(s);if(r){if(q_(n,r.options)&&q_(i,r.config))return r;throw Kc.create("duplicate-app",{appName:s})}const o=new uSe(s);for(const l of nw.values())o.addComponent(l);const a=new rCe(n,i,o);return Q5.set(s,a),a}function _Z(e=tw){const t=Q5.get(e);if(!t&&e===tw&&fZ())return vZ();if(!t)throw Kc.create("no-app",{appName:e});return t}function Zc(e,t,n){var i;let s=(i=nCe[e])!==null&&i!==void 0?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${t}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Fl.warn(a.join(" "));return}yp(new xg(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oCe="firebase-heartbeat-database",aCe=1,Ep="firebase-heartbeat-store";let iv=null;function wZ(){return iv||(iv=TSe(oCe,aCe,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Ep)}catch(n){console.warn(n)}}}}).catch(e=>{throw Kc.create("idb-open",{originalErrorMessage:e.message})})),iv}async function lCe(e){try{const n=(await wZ()).transaction(Ep),i=await n.objectStore(Ep).get(TZ(e));return await n.done,i}catch(t){if(t instanceof pf)Fl.warn(t.message);else{const n=Kc.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Fl.warn(n.message)}}}async function NP(e,t){try{const i=(await wZ()).transaction(Ep,"readwrite");await i.objectStore(Ep).put(t,TZ(e)),await i.done}catch(n){if(n instanceof pf)Fl.warn(n.message);else{const i=Kc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fl.warn(i.message)}}}function TZ(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cCe=1024,dCe=30;class uCe{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hCe(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=OP();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>dCe){const o=gCe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Fl.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=OP(),{heartbeatsToSend:i,unsentEntries:s}=fCe(this._heartbeatsCache.heartbeats),r=q5(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return Fl.warn(n),""}}}function OP(){return new Date().toISOString().substring(0,10)}function fCe(e,t=cCe){const n=[];let i=e.slice();for(const s of e){const r=n.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),FP(n)>t){r.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),FP(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class hCe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return iSe()?sSe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await lCe(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return NP(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return NP(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function FP(e){return q5(JSON.stringify({version:2,heartbeats:e})).length}function gCe(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mCe(e){yp(new xg("platform-logger",t=>new CSe(t),"PRIVATE")),yp(new xg("heartbeat",t=>new uCe(t),"PRIVATE")),Zc(ew,LP,e),Zc(ew,LP,"esm2017"),Zc("fire-js","")}mCe("");var pCe="firebase",UCe="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zc(pCe,UCe,"app");var BP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qc,IZ;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(w,T){function A(){}A.prototype=T.prototype,w.D=T.prototype,w.prototype=new A,w.prototype.constructor=w,w.C=function(S,D,N){for(var L=Array(arguments.length-2),j=2;j<arguments.length;j++)L[j-2]=arguments[j];return T.prototype[D].apply(S,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,T,A){A||(A=0);var S=Array(16);if(typeof T=="string")for(var D=0;16>D;++D)S[D]=T.charCodeAt(A++)|T.charCodeAt(A++)<<8|T.charCodeAt(A++)<<16|T.charCodeAt(A++)<<24;else for(D=0;16>D;++D)S[D]=T[A++]|T[A++]<<8|T[A++]<<16|T[A++]<<24;T=w.g[0],A=w.g[1],D=w.g[2];var N=w.g[3],L=T+(N^A&(D^N))+S[0]+3614090360&4294967295;T=A+(L<<7&4294967295|L>>>25),L=N+(D^T&(A^D))+S[1]+3905402710&4294967295,N=T+(L<<12&4294967295|L>>>20),L=D+(A^N&(T^A))+S[2]+606105819&4294967295,D=N+(L<<17&4294967295|L>>>15),L=A+(T^D&(N^T))+S[3]+3250441966&4294967295,A=D+(L<<22&4294967295|L>>>10),L=T+(N^A&(D^N))+S[4]+4118548399&4294967295,T=A+(L<<7&4294967295|L>>>25),L=N+(D^T&(A^D))+S[5]+1200080426&4294967295,N=T+(L<<12&4294967295|L>>>20),L=D+(A^N&(T^A))+S[6]+2821735955&4294967295,D=N+(L<<17&4294967295|L>>>15),L=A+(T^D&(N^T))+S[7]+4249261313&4294967295,A=D+(L<<22&4294967295|L>>>10),L=T+(N^A&(D^N))+S[8]+1770035416&4294967295,T=A+(L<<7&4294967295|L>>>25),L=N+(D^T&(A^D))+S[9]+2336552879&4294967295,N=T+(L<<12&4294967295|L>>>20),L=D+(A^N&(T^A))+S[10]+4294925233&4294967295,D=N+(L<<17&4294967295|L>>>15),L=A+(T^D&(N^T))+S[11]+2304563134&4294967295,A=D+(L<<22&4294967295|L>>>10),L=T+(N^A&(D^N))+S[12]+1804603682&4294967295,T=A+(L<<7&4294967295|L>>>25),L=N+(D^T&(A^D))+S[13]+4254626195&4294967295,N=T+(L<<12&4294967295|L>>>20),L=D+(A^N&(T^A))+S[14]+2792965006&4294967295,D=N+(L<<17&4294967295|L>>>15),L=A+(T^D&(N^T))+S[15]+1236535329&4294967295,A=D+(L<<22&4294967295|L>>>10),L=T+(D^N&(A^D))+S[1]+4129170786&4294967295,T=A+(L<<5&4294967295|L>>>27),L=N+(A^D&(T^A))+S[6]+3225465664&4294967295,N=T+(L<<9&4294967295|L>>>23),L=D+(T^A&(N^T))+S[11]+643717713&4294967295,D=N+(L<<14&4294967295|L>>>18),L=A+(N^T&(D^N))+S[0]+3921069994&4294967295,A=D+(L<<20&4294967295|L>>>12),L=T+(D^N&(A^D))+S[5]+3593408605&4294967295,T=A+(L<<5&4294967295|L>>>27),L=N+(A^D&(T^A))+S[10]+38016083&4294967295,N=T+(L<<9&4294967295|L>>>23),L=D+(T^A&(N^T))+S[15]+3634488961&4294967295,D=N+(L<<14&4294967295|L>>>18),L=A+(N^T&(D^N))+S[4]+3889429448&4294967295,A=D+(L<<20&4294967295|L>>>12),L=T+(D^N&(A^D))+S[9]+568446438&4294967295,T=A+(L<<5&4294967295|L>>>27),L=N+(A^D&(T^A))+S[14]+3275163606&4294967295,N=T+(L<<9&4294967295|L>>>23),L=D+(T^A&(N^T))+S[3]+4107603335&4294967295,D=N+(L<<14&4294967295|L>>>18),L=A+(N^T&(D^N))+S[8]+1163531501&4294967295,A=D+(L<<20&4294967295|L>>>12),L=T+(D^N&(A^D))+S[13]+2850285829&4294967295,T=A+(L<<5&4294967295|L>>>27),L=N+(A^D&(T^A))+S[2]+4243563512&4294967295,N=T+(L<<9&4294967295|L>>>23),L=D+(T^A&(N^T))+S[7]+1735328473&4294967295,D=N+(L<<14&4294967295|L>>>18),L=A+(N^T&(D^N))+S[12]+2368359562&4294967295,A=D+(L<<20&4294967295|L>>>12),L=T+(A^D^N)+S[5]+4294588738&4294967295,T=A+(L<<4&4294967295|L>>>28),L=N+(T^A^D)+S[8]+2272392833&4294967295,N=T+(L<<11&4294967295|L>>>21),L=D+(N^T^A)+S[11]+1839030562&4294967295,D=N+(L<<16&4294967295|L>>>16),L=A+(D^N^T)+S[14]+4259657740&4294967295,A=D+(L<<23&4294967295|L>>>9),L=T+(A^D^N)+S[1]+2763975236&4294967295,T=A+(L<<4&4294967295|L>>>28),L=N+(T^A^D)+S[4]+1272893353&4294967295,N=T+(L<<11&4294967295|L>>>21),L=D+(N^T^A)+S[7]+4139469664&4294967295,D=N+(L<<16&4294967295|L>>>16),L=A+(D^N^T)+S[10]+3200236656&4294967295,A=D+(L<<23&4294967295|L>>>9),L=T+(A^D^N)+S[13]+681279174&4294967295,T=A+(L<<4&4294967295|L>>>28),L=N+(T^A^D)+S[0]+3936430074&4294967295,N=T+(L<<11&4294967295|L>>>21),L=D+(N^T^A)+S[3]+3572445317&4294967295,D=N+(L<<16&4294967295|L>>>16),L=A+(D^N^T)+S[6]+76029189&4294967295,A=D+(L<<23&4294967295|L>>>9),L=T+(A^D^N)+S[9]+3654602809&4294967295,T=A+(L<<4&4294967295|L>>>28),L=N+(T^A^D)+S[12]+3873151461&4294967295,N=T+(L<<11&4294967295|L>>>21),L=D+(N^T^A)+S[15]+530742520&4294967295,D=N+(L<<16&4294967295|L>>>16),L=A+(D^N^T)+S[2]+3299628645&4294967295,A=D+(L<<23&4294967295|L>>>9),L=T+(D^(A|~N))+S[0]+4096336452&4294967295,T=A+(L<<6&4294967295|L>>>26),L=N+(A^(T|~D))+S[7]+1126891415&4294967295,N=T+(L<<10&4294967295|L>>>22),L=D+(T^(N|~A))+S[14]+2878612391&4294967295,D=N+(L<<15&4294967295|L>>>17),L=A+(N^(D|~T))+S[5]+4237533241&4294967295,A=D+(L<<21&4294967295|L>>>11),L=T+(D^(A|~N))+S[12]+1700485571&4294967295,T=A+(L<<6&4294967295|L>>>26),L=N+(A^(T|~D))+S[3]+2399980690&4294967295,N=T+(L<<10&4294967295|L>>>22),L=D+(T^(N|~A))+S[10]+4293915773&4294967295,D=N+(L<<15&4294967295|L>>>17),L=A+(N^(D|~T))+S[1]+2240044497&4294967295,A=D+(L<<21&4294967295|L>>>11),L=T+(D^(A|~N))+S[8]+1873313359&4294967295,T=A+(L<<6&4294967295|L>>>26),L=N+(A^(T|~D))+S[15]+4264355552&4294967295,N=T+(L<<10&4294967295|L>>>22),L=D+(T^(N|~A))+S[6]+2734768916&4294967295,D=N+(L<<15&4294967295|L>>>17),L=A+(N^(D|~T))+S[13]+1309151649&4294967295,A=D+(L<<21&4294967295|L>>>11),L=T+(D^(A|~N))+S[4]+4149444226&4294967295,T=A+(L<<6&4294967295|L>>>26),L=N+(A^(T|~D))+S[11]+3174756917&4294967295,N=T+(L<<10&4294967295|L>>>22),L=D+(T^(N|~A))+S[2]+718787259&4294967295,D=N+(L<<15&4294967295|L>>>17),L=A+(N^(D|~T))+S[9]+3951481745&4294967295,w.g[0]=w.g[0]+T&4294967295,w.g[1]=w.g[1]+(D+(L<<21&4294967295|L>>>11))&4294967295,w.g[2]=w.g[2]+D&4294967295,w.g[3]=w.g[3]+N&4294967295}i.prototype.u=function(w,T){T===void 0&&(T=w.length);for(var A=T-this.blockSize,S=this.B,D=this.h,N=0;N<T;){if(D==0)for(;N<=A;)s(this,w,N),N+=this.blockSize;if(typeof w=="string"){for(;N<T;)if(S[D++]=w.charCodeAt(N++),D==this.blockSize){s(this,S),D=0;break}}else for(;N<T;)if(S[D++]=w[N++],D==this.blockSize){s(this,S),D=0;break}}this.h=D,this.o+=T},i.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var T=1;T<w.length-8;++T)w[T]=0;var A=8*this.o;for(T=w.length-8;T<w.length;++T)w[T]=A&255,A/=256;for(this.u(w),w=Array(16),T=A=0;4>T;++T)for(var S=0;32>S;S+=8)w[A++]=this.g[T]>>>S&255;return w};function r(w,T){var A=a;return Object.prototype.hasOwnProperty.call(A,w)?A[w]:A[w]=T(w)}function o(w,T){this.h=T;for(var A=[],S=!0,D=w.length-1;0<=D;D--){var N=w[D]|0;S&&N==T||(A[D]=N,S=!1)}this.g=A}var a={};function l(w){return-128<=w&&128>w?r(w,function(T){return new o([T|0],0>T?-1:0)}):new o([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return u;if(0>w)return U(c(-w));for(var T=[],A=1,S=0;w>=A;S++)T[S]=w/A|0,A*=4294967296;return new o(T,0)}function d(w,T){if(w.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w.charAt(0)=="-")return U(d(w.substring(1),T));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(T,8)),S=u,D=0;D<w.length;D+=8){var N=Math.min(8,w.length-D),L=parseInt(w.substring(D,D+N),T);8>N?(N=c(Math.pow(T,N)),S=S.j(N).add(c(L))):(S=S.j(A),S=S.add(c(L)))}return S}var u=l(0),f=l(1),h=l(16777216);e=o.prototype,e.m=function(){if(p(this))return-U(this).m();for(var w=0,T=1,A=0;A<this.g.length;A++){var S=this.i(A);w+=(0<=S?S:4294967296+S)*T,T*=4294967296}return w},e.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(m(this))return"0";if(p(this))return"-"+U(this).toString(w);for(var T=c(Math.pow(w,6)),A=this,S="";;){var D=_(A,T).g;A=b(A,D.j(T));var N=((0<A.g.length?A.g[0]:A.h)>>>0).toString(w);if(A=D,m(A))return N+S;for(;6>N.length;)N="0"+N;S=N+S}},e.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function m(w){if(w.h!=0)return!1;for(var T=0;T<w.g.length;T++)if(w.g[T]!=0)return!1;return!0}function p(w){return w.h==-1}e.l=function(w){return w=b(this,w),p(w)?-1:m(w)?0:1};function U(w){for(var T=w.g.length,A=[],S=0;S<T;S++)A[S]=~w.g[S];return new o(A,~w.h).add(f)}e.abs=function(){return p(this)?U(this):this},e.add=function(w){for(var T=Math.max(this.g.length,w.g.length),A=[],S=0,D=0;D<=T;D++){var N=S+(this.i(D)&65535)+(w.i(D)&65535),L=(N>>>16)+(this.i(D)>>>16)+(w.i(D)>>>16);S=L>>>16,N&=65535,L&=65535,A[D]=L<<16|N}return new o(A,A[A.length-1]&-2147483648?-1:0)};function b(w,T){return w.add(U(T))}e.j=function(w){if(m(this)||m(w))return u;if(p(this))return p(w)?U(this).j(U(w)):U(U(this).j(w));if(p(w))return U(this.j(U(w)));if(0>this.l(h)&&0>w.l(h))return c(this.m()*w.m());for(var T=this.g.length+w.g.length,A=[],S=0;S<2*T;S++)A[S]=0;for(S=0;S<this.g.length;S++)for(var D=0;D<w.g.length;D++){var N=this.i(S)>>>16,L=this.i(S)&65535,j=w.i(D)>>>16,Y=w.i(D)&65535;A[2*S+2*D]+=L*Y,y(A,2*S+2*D),A[2*S+2*D+1]+=N*Y,y(A,2*S+2*D+1),A[2*S+2*D+1]+=L*j,y(A,2*S+2*D+1),A[2*S+2*D+2]+=N*j,y(A,2*S+2*D+2)}for(S=0;S<T;S++)A[S]=A[2*S+1]<<16|A[2*S];for(S=T;S<2*T;S++)A[S]=0;return new o(A,0)};function y(w,T){for(;(w[T]&65535)!=w[T];)w[T+1]+=w[T]>>>16,w[T]&=65535,T++}function E(w,T){this.g=w,this.h=T}function _(w,T){if(m(T))throw Error("division by zero");if(m(w))return new E(u,u);if(p(w))return T=_(U(w),T),new E(U(T.g),U(T.h));if(p(T))return T=_(w,U(T)),new E(U(T.g),T.h);if(30<w.g.length){if(p(w)||p(T))throw Error("slowDivide_ only works with positive integers.");for(var A=f,S=T;0>=S.l(w);)A=I(A),S=I(S);var D=k(A,1),N=k(S,1);for(S=k(S,2),A=k(A,2);!m(S);){var L=N.add(S);0>=L.l(w)&&(D=D.add(A),N=L),S=k(S,1),A=k(A,1)}return T=b(w,D.j(T)),new E(D,T)}for(D=u;0<=w.l(T);){for(A=Math.max(1,Math.floor(w.m()/T.m())),S=Math.ceil(Math.log(A)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),N=c(A),L=N.j(T);p(L)||0<L.l(w);)A-=S,N=c(A),L=N.j(T);m(N)&&(N=f),D=D.add(N),w=b(w,L)}return new E(D,w)}e.A=function(w){return _(this,w).h},e.and=function(w){for(var T=Math.max(this.g.length,w.g.length),A=[],S=0;S<T;S++)A[S]=this.i(S)&w.i(S);return new o(A,this.h&w.h)},e.or=function(w){for(var T=Math.max(this.g.length,w.g.length),A=[],S=0;S<T;S++)A[S]=this.i(S)|w.i(S);return new o(A,this.h|w.h)},e.xor=function(w){for(var T=Math.max(this.g.length,w.g.length),A=[],S=0;S<T;S++)A[S]=this.i(S)^w.i(S);return new o(A,this.h^w.h)};function I(w){for(var T=w.g.length+1,A=[],S=0;S<T;S++)A[S]=w.i(S)<<1|w.i(S-1)>>>31;return new o(A,w.h)}function k(w,T){var A=T>>5;T%=32;for(var S=w.g.length-A,D=[],N=0;N<S;N++)D[N]=0<T?w.i(N+A)>>>T|w.i(N+A+1)<<32-T:w.i(N+A);return new o(D,w.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,IZ=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,qc=o}).apply(typeof BP<"u"?BP:typeof self<"u"?self:typeof window<"u"?window:{});var QU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var SZ,S1,CZ,Yb,iw,xZ,AZ,MZ;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,R,F){return v==Array.prototype||v==Object.prototype||(v[R]=F.value),v};function n(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof QU=="object"&&QU];for(var R=0;R<v.length;++R){var F=v[R];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var i=n(this);function s(v,R){if(R)e:{var F=i;v=v.split(".");for(var V=0;V<v.length-1;V++){var K=v[V];if(!(K in F))break e;F=F[K]}v=v[v.length-1],V=F[v],R=R(V),R!=V&&R!=null&&t(F,v,{configurable:!0,writable:!0,value:R})}}function r(v,R){v instanceof String&&(v+="");var F=0,V=!1,K={next:function(){if(!V&&F<v.length){var ee=F++;return{value:R(ee,v[ee]),done:!1}}return V=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}s("Array.prototype.values",function(v){return v||function(){return r(this,function(R,F){return F})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(v){var R=typeof v;return R=R!="object"?R:v?Array.isArray(v)?"array":R:"null",R=="array"||R=="object"&&typeof v.length=="number"}function c(v){var R=typeof v;return R=="object"&&v!=null||R=="function"}function d(v,R,F){return v.call.apply(v.bind,arguments)}function u(v,R,F){if(!v)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,V),v.apply(R,K)}}return function(){return v.apply(R,arguments)}}function f(v,R,F){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:u,f.apply(null,arguments)}function h(v,R){var F=Array.prototype.slice.call(arguments,1);return function(){var V=F.slice();return V.push.apply(V,arguments),v.apply(this,V)}}function m(v,R){function F(){}F.prototype=R.prototype,v.aa=R.prototype,v.prototype=new F,v.prototype.constructor=v,v.Qb=function(V,K,ee){for(var ge=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)ge[Wt-2]=arguments[Wt];return R.prototype[K].apply(V,ge)}}function p(v){const R=v.length;if(0<R){const F=Array(R);for(let V=0;V<R;V++)F[V]=v[V];return F}return[]}function U(v,R){for(let F=1;F<arguments.length;F++){const V=arguments[F];if(l(V)){const K=v.length||0,ee=V.length||0;v.length=K+ee;for(let ge=0;ge<ee;ge++)v[K+ge]=V[ge]}else v.push(V)}}class b{constructor(R,F){this.i=R,this.j=F,this.h=0,this.g=null}get(){let R;return 0<this.h?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function y(v){return/^[\s\xa0]*$/.test(v)}function E(){var v=a.navigator;return v&&(v=v.userAgent)?v:""}function _(v){return _[" "](v),v}_[" "]=function(){};var I=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function k(v,R,F){for(const V in v)R.call(F,v[V],V,v)}function w(v,R){for(const F in v)R.call(void 0,v[F],F,v)}function T(v){const R={};for(const F in v)R[F]=v[F];return R}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(v,R){let F,V;for(let K=1;K<arguments.length;K++){V=arguments[K];for(F in V)v[F]=V[F];for(let ee=0;ee<A.length;ee++)F=A[ee],Object.prototype.hasOwnProperty.call(V,F)&&(v[F]=V[F])}}function D(v){var R=1;v=v.split(":");const F=[];for(;0<R&&v.length;)F.push(v.shift()),R--;return v.length&&F.push(v.join(":")),F}function N(v){a.setTimeout(()=>{throw v},0)}function L(){var v=H;let R=null;return v.g&&(R=v.g,v.g=v.g.next,v.g||(v.h=null),R.next=null),R}class j{constructor(){this.h=this.g=null}add(R,F){const V=Y.get();V.set(R,F),this.h?this.h.next=V:this.g=V,this.h=V}}var Y=new b(()=>new G,v=>v.reset());class G{constructor(){this.next=this.g=this.h=null}set(R,F){this.h=R,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let O,z=!1,H=new j,X=()=>{const v=a.Promise.resolve(void 0);O=()=>{v.then(Q)}};var Q=()=>{for(var v;v=L();){try{v.h.call(v.g)}catch(F){N(F)}var R=Y;R.j(v),100>R.h&&(R.h++,v.next=R.g,R.g=v)}z=!1};function re(){this.s=this.s,this.C=this.C}re.prototype.s=!1,re.prototype.ma=function(){this.s||(this.s=!0,this.N())},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(v,R){this.type=v,this.g=this.target=R,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var me=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var v=!1,R=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const F=()=>{};a.addEventListener("test",F,R),a.removeEventListener("test",F,R)}catch{}return v}();function ke(v,R){if(ie.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v){var F=this.type=v.type,V=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;if(this.target=v.target||v.srcElement,this.g=R,R=v.relatedTarget){if(I){e:{try{_(R.nodeName);var K=!0;break e}catch{}K=!1}K||(R=null)}}else F=="mouseover"?R=v.fromElement:F=="mouseout"&&(R=v.toElement);this.relatedTarget=R,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=typeof v.pointerType=="string"?v.pointerType:ye[v.pointerType]||"",this.state=v.state,this.i=v,v.defaultPrevented&&ke.aa.h.call(this)}}m(ke,ie);var ye={2:"touch",3:"pen",4:"mouse"};ke.prototype.h=function(){ke.aa.h.call(this);var v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),$e=0;function et(v,R,F,V,K){this.listener=v,this.proxy=null,this.src=R,this.type=F,this.capture=!!V,this.ha=K,this.key=++$e,this.da=this.fa=!1}function Be(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function We(v){this.src=v,this.g={},this.h=0}We.prototype.add=function(v,R,F,V,K){var ee=v.toString();v=this.g[ee],v||(v=this.g[ee]=[],this.h++);var ge=Jt(v,R,V,K);return-1<ge?(R=v[ge],F||(R.fa=!1)):(R=new et(R,this.src,ee,!!V,K),R.fa=F,v.push(R)),R};function bn(v,R){var F=R.type;if(F in v.g){var V=v.g[F],K=Array.prototype.indexOf.call(V,R,void 0),ee;(ee=0<=K)&&Array.prototype.splice.call(V,K,1),ee&&(Be(R),v.g[F].length==0&&(delete v.g[F],v.h--))}}function Jt(v,R,F,V){for(var K=0;K<v.length;++K){var ee=v[K];if(!ee.da&&ee.listener==R&&ee.capture==!!F&&ee.ha==V)return K}return-1}var Pi="closure_lm_"+(1e6*Math.random()|0),Yn={};function Sr(v,R,F,V,K){if(Array.isArray(R)){for(var ee=0;ee<R.length;ee++)Sr(v,R[ee],F,V,K);return null}return F=TC(F),v&&v[Ae]?v.K(R,F,c(V)?!!V.capture:!1,K):wt(v,R,F,!1,V,K)}function wt(v,R,F,V,K,ee){if(!R)throw Error("Invalid event type");var ge=c(K)?!!K.capture:!!K,Wt=dm(v);if(Wt||(v[Pi]=Wt=new We(v)),F=Wt.add(R,F,V,ge,ee),F.proxy)return F;if(V=vi(),F.proxy=V,V.src=v,V.listener=F,v.addEventListener)me||(K=ge),K===void 0&&(K=!1),v.addEventListener(R.toString(),V,K);else if(v.attachEvent)v.attachEvent(D2(R.toString()),V);else if(v.addListener&&v.removeListener)v.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return F}function vi(){function v(F){return R.call(v.src,v.listener,F)}const R=L2;return v}function Rs(v,R,F,V,K){if(Array.isArray(R))for(var ee=0;ee<R.length;ee++)Rs(v,R[ee],F,V,K);else V=c(V)?!!V.capture:!!V,F=TC(F),v&&v[Ae]?(v=v.i,R=String(R).toString(),R in v.g&&(ee=v.g[R],F=Jt(ee,F,V,K),-1<F&&(Be(ee[F]),Array.prototype.splice.call(ee,F,1),ee.length==0&&(delete v.g[R],v.h--)))):v&&(v=dm(v))&&(R=v.g[R.toString()],v=-1,R&&(v=Jt(R,F,V,K)),(F=-1<v?R[v]:null)&&Yl(F))}function Yl(v){if(typeof v!="number"&&v&&!v.da){var R=v.src;if(R&&R[Ae])bn(R.i,v);else{var F=v.type,V=v.proxy;R.removeEventListener?R.removeEventListener(F,V,v.capture):R.detachEvent?R.detachEvent(D2(F),V):R.addListener&&R.removeListener&&R.removeListener(V),(F=dm(R))?(bn(F,v),F.h==0&&(F.src=null,R[Pi]=null)):Be(v)}}}function D2(v){return v in Yn?Yn[v]:Yn[v]="on"+v}function L2(v,R){if(v.da)v=!0;else{R=new ke(R,this);var F=v.listener,V=v.ha||v.src;v.fa&&Yl(v),v=F.call(V,R)}return v}function dm(v){return v=v[Pi],v instanceof We?v:null}var b8="__closure_events_fn_"+(1e9*Math.random()>>>0);function TC(v){return typeof v=="function"?v:(v[b8]||(v[b8]=function(R){return v.handleEvent(R)}),v[b8])}function Qi(){re.call(this),this.i=new We(this),this.M=this,this.F=null}m(Qi,re),Qi.prototype[Ae]=!0,Qi.prototype.removeEventListener=function(v,R,F,V){Rs(this,v,R,F,V)};function ms(v,R){var F,V=v.F;if(V)for(F=[];V;V=V.F)F.push(V);if(v=v.M,V=R.type||R,typeof R=="string")R=new ie(R,v);else if(R instanceof ie)R.target=R.target||v;else{var K=R;R=new ie(V,v),S(R,K)}if(K=!0,F)for(var ee=F.length-1;0<=ee;ee--){var ge=R.g=F[ee];K=P2(ge,V,!0,R)&&K}if(ge=R.g=v,K=P2(ge,V,!0,R)&&K,K=P2(ge,V,!1,R)&&K,F)for(ee=0;ee<F.length;ee++)ge=R.g=F[ee],K=P2(ge,V,!1,R)&&K}Qi.prototype.N=function(){if(Qi.aa.N.call(this),this.i){var v=this.i,R;for(R in v.g){for(var F=v.g[R],V=0;V<F.length;V++)Be(F[V]);delete v.g[R],v.h--}}this.F=null},Qi.prototype.K=function(v,R,F,V){return this.i.add(String(v),R,!1,F,V)},Qi.prototype.L=function(v,R,F,V){return this.i.add(String(v),R,!0,F,V)};function P2(v,R,F,V){if(R=v.i.g[String(R)],!R)return!0;R=R.concat();for(var K=!0,ee=0;ee<R.length;++ee){var ge=R[ee];if(ge&&!ge.da&&ge.capture==F){var Wt=ge.listener,Ni=ge.ha||ge.src;ge.fa&&bn(v.i,ge),K=Wt.call(Ni,V)!==!1&&K}}return K&&!V.defaultPrevented}function IC(v,R,F){if(typeof v=="function")F&&(v=f(v,F));else if(v&&typeof v.handleEvent=="function")v=f(v.handleEvent,v);else throw Error("Invalid listener argument");return 2147483647<Number(R)?-1:a.setTimeout(v,R||0)}function SC(v){v.g=IC(()=>{v.g=null,v.i&&(v.i=!1,SC(v))},v.l);const R=v.h;v.h=null,v.m.apply(null,R)}class _Q extends re{constructor(R,F){super(),this.m=R,this.l=F,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:SC(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function um(v){re.call(this),this.h=v,this.g={}}m(um,re);var CC=[];function xC(v){k(v.g,function(R,F){this.g.hasOwnProperty(F)&&Yl(R)},v),v.g={}}um.prototype.N=function(){um.aa.N.call(this),xC(this)},um.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var y8=a.JSON.stringify,wQ=a.JSON.parse,TQ=class{stringify(v){return a.JSON.stringify(v,void 0)}parse(v){return a.JSON.parse(v,void 0)}};function E8(){}E8.prototype.h=null;function AC(v){return v.h||(v.h=v.i())}function MC(){}var fm={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function v8(){ie.call(this,"d")}m(v8,ie);function _8(){ie.call(this,"c")}m(_8,ie);var Dd={},kC=null;function N2(){return kC=kC||new Qi}Dd.La="serverreachability";function RC(v){ie.call(this,Dd.La,v)}m(RC,ie);function hm(v){const R=N2();ms(R,new RC(R))}Dd.STAT_EVENT="statevent";function DC(v,R){ie.call(this,Dd.STAT_EVENT,v),this.stat=R}m(DC,ie);function ps(v){const R=N2();ms(R,new DC(R,v))}Dd.Ma="timingevent";function LC(v,R){ie.call(this,Dd.Ma,v),this.size=R}m(LC,ie);function gm(v,R){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){v()},R)}function mm(){this.g=!0}mm.prototype.xa=function(){this.g=!1};function IQ(v,R,F,V,K,ee){v.info(function(){if(v.g)if(ee)for(var ge="",Wt=ee.split("&"),Ni=0;Ni<Wt.length;Ni++){var Mt=Wt[Ni].split("=");if(1<Mt.length){var Ji=Mt[0];Mt=Mt[1];var es=Ji.split("_");ge=2<=es.length&&es[1]=="type"?ge+(Ji+"="+Mt+"&"):ge+(Ji+"=redacted&")}}else ge=null;else ge=ee;return"XMLHTTP REQ ("+V+") [attempt "+K+"]: "+R+`
`+F+`
`+ge})}function SQ(v,R,F,V,K,ee,ge){v.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+K+"]: "+R+`
`+F+`
`+ee+" "+ge})}function vf(v,R,F,V){v.info(function(){return"XMLHTTP TEXT ("+R+"): "+xQ(v,F)+(V?" "+V:"")})}function CQ(v,R){v.info(function(){return"TIMEOUT: "+R})}mm.prototype.info=function(){};function xQ(v,R){if(!v.g)return R;if(!R)return null;try{var F=JSON.parse(R);if(F){for(v=0;v<F.length;v++)if(Array.isArray(F[v])){var V=F[v];if(!(2>V.length)){var K=V[1];if(Array.isArray(K)&&!(1>K.length)){var ee=K[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var ge=1;ge<K.length;ge++)K[ge]=""}}}}return y8(F)}catch{return R}}var O2={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},PC={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},w8;function F2(){}m(F2,E8),F2.prototype.g=function(){return new XMLHttpRequest},F2.prototype.i=function(){return{}},w8=new F2;function Wl(v,R,F,V){this.j=v,this.i=R,this.l=F,this.R=V||1,this.U=new um(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new NC}function NC(){this.i=null,this.g="",this.h=!1}var OC={},T8={};function I8(v,R,F){v.L=1,v.v=V2(Oa(R)),v.m=F,v.P=!0,FC(v,null)}function FC(v,R){v.F=Date.now(),B2(v),v.A=Oa(v.v);var F=v.A,V=v.R;Array.isArray(V)||(V=[String(V)]),QC(F.i,"t",V),v.C=0,F=v.j.J,v.h=new NC,v.g=px(v.j,F?R:null,!v.m),0<v.O&&(v.M=new _Q(f(v.Y,v,v.g),v.O)),R=v.U,F=v.g,V=v.ca;var K="readystatechange";Array.isArray(K)||(K&&(CC[0]=K.toString()),K=CC);for(var ee=0;ee<K.length;ee++){var ge=Sr(F,K[ee],V||R.handleEvent,!1,R.h||R);if(!ge)break;R.g[ge.key]=ge}R=v.H?T(v.H):{},v.m?(v.u||(v.u="POST"),R["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.A,v.u,v.m,R)):(v.u="GET",v.g.ea(v.A,v.u,null,R)),hm(),IQ(v.i,v.u,v.A,v.l,v.R,v.m)}Wl.prototype.ca=function(v){v=v.target;const R=this.M;R&&Fa(v)==3?R.j():this.Y(v)},Wl.prototype.Y=function(v){try{if(v==this.g)e:{const es=Fa(this.g);var R=this.g.Ba();const Tf=this.g.Z();if(!(3>es)&&(es!=3||this.g&&(this.h.h||this.g.oa()||rx(this.g)))){this.J||es!=4||R==7||(R==8||0>=Tf?hm(3):hm(2)),S8(this);var F=this.g.Z();this.X=F;t:if(BC(this)){var V=rx(this.g);v="";var K=V.length,ee=Fa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ld(this),pm(this);var ge="";break t}this.h.i=new a.TextDecoder}for(R=0;R<K;R++)this.h.h=!0,v+=this.h.i.decode(V[R],{stream:!(ee&&R==K-1)});V.length=0,this.h.g+=v,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=F==200,SQ(this.i,this.u,this.A,this.l,this.R,es,F),this.o){if(this.T&&!this.K){t:{if(this.g){var Wt,Ni=this.g;if((Wt=Ni.g?Ni.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Wt)){var Mt=Wt;break t}}Mt=null}if(F=Mt)vf(this.i,this.l,F,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,C8(this,F);else{this.o=!1,this.s=3,ps(12),Ld(this),pm(this);break e}}if(this.P){F=!0;let io;for(;!this.J&&this.C<ge.length;)if(io=AQ(this,ge),io==T8){es==4&&(this.s=4,ps(14),F=!1),vf(this.i,this.l,null,"[Incomplete Response]");break}else if(io==OC){this.s=4,ps(15),vf(this.i,this.l,ge,"[Invalid Chunk]"),F=!1;break}else vf(this.i,this.l,io,null),C8(this,io);if(BC(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),es!=4||ge.length!=0||this.h.h||(this.s=1,ps(16),F=!1),this.o=this.o&&F,!F)vf(this.i,this.l,ge,"[Invalid Chunked Response]"),Ld(this),pm(this);else if(0<ge.length&&!this.W){this.W=!0;var Ji=this.j;Ji.g==this&&Ji.ba&&!Ji.M&&(Ji.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),D8(Ji),Ji.M=!0,ps(11))}}else vf(this.i,this.l,ge,null),C8(this,ge);es==4&&Ld(this),this.o&&!this.J&&(es==4?fx(this.j,this):(this.o=!1,B2(this)))}else jQ(this.g),F==400&&0<ge.indexOf("Unknown SID")?(this.s=3,ps(12)):(this.s=0,ps(13)),Ld(this),pm(this)}}}catch{}finally{}};function BC(v){return v.g?v.u=="GET"&&v.L!=2&&v.j.Ca:!1}function AQ(v,R){var F=v.C,V=R.indexOf(`
`,F);return V==-1?T8:(F=Number(R.substring(F,V)),isNaN(F)?OC:(V+=1,V+F>R.length?T8:(R=R.slice(V,V+F),v.C=V+F,R)))}Wl.prototype.cancel=function(){this.J=!0,Ld(this)};function B2(v){v.S=Date.now()+v.I,zC(v,v.I)}function zC(v,R){if(v.B!=null)throw Error("WatchDog timer not null");v.B=gm(f(v.ba,v),R)}function S8(v){v.B&&(a.clearTimeout(v.B),v.B=null)}Wl.prototype.ba=function(){this.B=null;const v=Date.now();0<=v-this.S?(CQ(this.i,this.A),this.L!=2&&(hm(),ps(17)),Ld(this),this.s=2,pm(this)):zC(this,this.S-v)};function pm(v){v.j.G==0||v.J||fx(v.j,v)}function Ld(v){S8(v);var R=v.M;R&&typeof R.ma=="function"&&R.ma(),v.M=null,xC(v.U),v.g&&(R=v.g,v.g=null,R.abort(),R.ma())}function C8(v,R){try{var F=v.j;if(F.G!=0&&(F.g==v||x8(F.h,v))){if(!v.K&&x8(F.h,v)&&F.G==3){try{var V=F.Da.g.parse(R)}catch{V=null}if(Array.isArray(V)&&V.length==3){var K=V;if(K[0]==0){e:if(!F.u){if(F.g)if(F.g.F+3e3<v.F)W2(F),j2(F);else break e;R8(F),ps(18)}}else F.za=K[1],0<F.za-F.T&&37500>K[2]&&F.F&&F.v==0&&!F.C&&(F.C=gm(f(F.Za,F),6e3));if(1>=$C(F.h)&&F.ca){try{F.ca()}catch{}F.ca=void 0}}else Nd(F,11)}else if((v.K||F.g==v)&&W2(F),!y(R))for(K=F.Da.g.parse(R),R=0;R<K.length;R++){let Mt=K[R];if(F.T=Mt[0],Mt=Mt[1],F.G==2)if(Mt[0]=="c"){F.K=Mt[1],F.ia=Mt[2];const Ji=Mt[3];Ji!=null&&(F.la=Ji,F.j.info("VER="+F.la));const es=Mt[4];es!=null&&(F.Aa=es,F.j.info("SVER="+F.Aa));const Tf=Mt[5];Tf!=null&&typeof Tf=="number"&&0<Tf&&(V=1.5*Tf,F.L=V,F.j.info("backChannelRequestTimeoutMs_="+V)),V=F;const io=v.g;if(io){const Z2=io.g?io.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Z2){var ee=V.h;ee.g||Z2.indexOf("spdy")==-1&&Z2.indexOf("quic")==-1&&Z2.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(A8(ee,ee.h),ee.h=null))}if(V.D){const L8=io.g?io.g.getResponseHeader("X-HTTP-Session-Id"):null;L8&&(V.ya=L8,on(V.I,V.D,L8))}}F.G=3,F.l&&F.l.ua(),F.ba&&(F.R=Date.now()-v.F,F.j.info("Handshake RTT: "+F.R+"ms")),V=F;var ge=v;if(V.qa=mx(V,V.J?V.ia:null,V.W),ge.K){GC(V.h,ge);var Wt=ge,Ni=V.L;Ni&&(Wt.I=Ni),Wt.B&&(S8(Wt),B2(Wt)),V.g=ge}else dx(V);0<F.i.length&&Y2(F)}else Mt[0]!="stop"&&Mt[0]!="close"||Nd(F,7);else F.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?Nd(F,7):k8(F):Mt[0]!="noop"&&F.l&&F.l.ta(Mt),F.v=0)}}hm(4)}catch{}}var MQ=class{constructor(v,R){this.g=v,this.map=R}};function HC(v){this.l=v||10,a.PerformanceNavigationTiming?(v=a.performance.getEntriesByType("navigation"),v=0<v.length&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function VC(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function $C(v){return v.h?1:v.g?v.g.size:0}function x8(v,R){return v.h?v.h==R:v.g?v.g.has(R):!1}function A8(v,R){v.g?v.g.add(R):v.h=R}function GC(v,R){v.h&&v.h==R?v.h=null:v.g&&v.g.has(R)&&v.g.delete(R)}HC.prototype.cancel=function(){if(this.i=XC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function XC(v){if(v.h!=null)return v.i.concat(v.h.D);if(v.g!=null&&v.g.size!==0){let R=v.i;for(const F of v.g.values())R=R.concat(F.D);return R}return p(v.i)}function kQ(v){if(v.V&&typeof v.V=="function")return v.V();if(typeof Map<"u"&&v instanceof Map||typeof Set<"u"&&v instanceof Set)return Array.from(v.values());if(typeof v=="string")return v.split("");if(l(v)){for(var R=[],F=v.length,V=0;V<F;V++)R.push(v[V]);return R}R=[],F=0;for(V in v)R[F++]=v[V];return R}function RQ(v){if(v.na&&typeof v.na=="function")return v.na();if(!v.V||typeof v.V!="function"){if(typeof Map<"u"&&v instanceof Map)return Array.from(v.keys());if(!(typeof Set<"u"&&v instanceof Set)){if(l(v)||typeof v=="string"){var R=[];v=v.length;for(var F=0;F<v;F++)R.push(F);return R}R=[],F=0;for(const V in v)R[F++]=V;return R}}}function jC(v,R){if(v.forEach&&typeof v.forEach=="function")v.forEach(R,void 0);else if(l(v)||typeof v=="string")Array.prototype.forEach.call(v,R,void 0);else for(var F=RQ(v),V=kQ(v),K=V.length,ee=0;ee<K;ee++)R.call(void 0,V[ee],F&&F[ee],v)}var YC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function DQ(v,R){if(v){v=v.split("&");for(var F=0;F<v.length;F++){var V=v[F].indexOf("="),K=null;if(0<=V){var ee=v[F].substring(0,V);K=v[F].substring(V+1)}else ee=v[F];R(ee,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Pd(v){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,v instanceof Pd){this.h=v.h,z2(this,v.j),this.o=v.o,this.g=v.g,H2(this,v.s),this.l=v.l;var R=v.i,F=new ym;F.i=R.i,R.g&&(F.g=new Map(R.g),F.h=R.h),WC(this,F),this.m=v.m}else v&&(R=String(v).match(YC))?(this.h=!1,z2(this,R[1]||"",!0),this.o=Um(R[2]||""),this.g=Um(R[3]||"",!0),H2(this,R[4]),this.l=Um(R[5]||"",!0),WC(this,R[6]||"",!0),this.m=Um(R[7]||"")):(this.h=!1,this.i=new ym(null,this.h))}Pd.prototype.toString=function(){var v=[],R=this.j;R&&v.push(bm(R,KC,!0),":");var F=this.g;return(F||R=="file")&&(v.push("//"),(R=this.o)&&v.push(bm(R,KC,!0),"@"),v.push(encodeURIComponent(String(F)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.s,F!=null&&v.push(":",String(F))),(F=this.l)&&(this.g&&F.charAt(0)!="/"&&v.push("/"),v.push(bm(F,F.charAt(0)=="/"?NQ:PQ,!0))),(F=this.i.toString())&&v.push("?",F),(F=this.m)&&v.push("#",bm(F,FQ)),v.join("")};function Oa(v){return new Pd(v)}function z2(v,R,F){v.j=F?Um(R,!0):R,v.j&&(v.j=v.j.replace(/:$/,""))}function H2(v,R){if(R){if(R=Number(R),isNaN(R)||0>R)throw Error("Bad port number "+R);v.s=R}else v.s=null}function WC(v,R,F){R instanceof ym?(v.i=R,BQ(v.i,v.h)):(F||(R=bm(R,OQ)),v.i=new ym(R,v.h))}function on(v,R,F){v.i.set(R,F)}function V2(v){return on(v,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),v}function Um(v,R){return v?R?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function bm(v,R,F){return typeof v=="string"?(v=encodeURI(v).replace(R,LQ),F&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function LQ(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var KC=/[#\/\?@]/g,PQ=/[#\?:]/g,NQ=/[#\?]/g,OQ=/[#\?@]/g,FQ=/#/g;function ym(v,R){this.h=this.g=null,this.i=v||null,this.j=!!R}function Kl(v){v.g||(v.g=new Map,v.h=0,v.i&&DQ(v.i,function(R,F){v.add(decodeURIComponent(R.replace(/\+/g," ")),F)}))}e=ym.prototype,e.add=function(v,R){Kl(this),this.i=null,v=_f(this,v);var F=this.g.get(v);return F||this.g.set(v,F=[]),F.push(R),this.h+=1,this};function ZC(v,R){Kl(v),R=_f(v,R),v.g.has(R)&&(v.i=null,v.h-=v.g.get(R).length,v.g.delete(R))}function qC(v,R){return Kl(v),R=_f(v,R),v.g.has(R)}e.forEach=function(v,R){Kl(this),this.g.forEach(function(F,V){F.forEach(function(K){v.call(R,K,V,this)},this)},this)},e.na=function(){Kl(this);const v=Array.from(this.g.values()),R=Array.from(this.g.keys()),F=[];for(let V=0;V<R.length;V++){const K=v[V];for(let ee=0;ee<K.length;ee++)F.push(R[V])}return F},e.V=function(v){Kl(this);let R=[];if(typeof v=="string")qC(this,v)&&(R=R.concat(this.g.get(_f(this,v))));else{v=Array.from(this.g.values());for(let F=0;F<v.length;F++)R=R.concat(v[F])}return R},e.set=function(v,R){return Kl(this),this.i=null,v=_f(this,v),qC(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[R]),this.h+=1,this},e.get=function(v,R){return v?(v=this.V(v),0<v.length?String(v[0]):R):R};function QC(v,R,F){ZC(v,R),0<F.length&&(v.i=null,v.g.set(_f(v,R),p(F)),v.h+=F.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],R=Array.from(this.g.keys());for(var F=0;F<R.length;F++){var V=R[F];const ee=encodeURIComponent(String(V)),ge=this.V(V);for(V=0;V<ge.length;V++){var K=ee;ge[V]!==""&&(K+="="+encodeURIComponent(String(ge[V]))),v.push(K)}}return this.i=v.join("&")};function _f(v,R){return R=String(R),v.j&&(R=R.toLowerCase()),R}function BQ(v,R){R&&!v.j&&(Kl(v),v.i=null,v.g.forEach(function(F,V){var K=V.toLowerCase();V!=K&&(ZC(this,V),QC(this,K,F))},v)),v.j=R}function zQ(v,R){const F=new mm;if(a.Image){const V=new Image;V.onload=h(Zl,F,"TestLoadImage: loaded",!0,R,V),V.onerror=h(Zl,F,"TestLoadImage: error",!1,R,V),V.onabort=h(Zl,F,"TestLoadImage: abort",!1,R,V),V.ontimeout=h(Zl,F,"TestLoadImage: timeout",!1,R,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=v}else R(!1)}function HQ(v,R){const F=new mm,V=new AbortController,K=setTimeout(()=>{V.abort(),Zl(F,"TestPingServer: timeout",!1,R)},1e4);fetch(v,{signal:V.signal}).then(ee=>{clearTimeout(K),ee.ok?Zl(F,"TestPingServer: ok",!0,R):Zl(F,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(K),Zl(F,"TestPingServer: error",!1,R)})}function Zl(v,R,F,V,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),V(F)}catch{}}function VQ(){this.g=new TQ}function $Q(v,R,F){const V=F||"";try{jC(v,function(K,ee){let ge=K;c(K)&&(ge=y8(K)),R.push(V+ee+"="+encodeURIComponent(ge))})}catch(K){throw R.push(V+"type="+encodeURIComponent("_badmap")),K}}function $2(v){this.l=v.Ub||null,this.j=v.eb||!1}m($2,E8),$2.prototype.g=function(){return new G2(this.l,this.j)},$2.prototype.i=function(v){return function(){return v}}({});function G2(v,R){Qi.call(this),this.D=v,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(G2,Qi),e=G2.prototype,e.open=function(v,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=v,this.A=R,this.readyState=1,vm(this)},e.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const R={headers:this.u,method:this.B,credentials:this.m,cache:void 0};v&&(R.body=v),(this.D||a).fetch(new Request(this.A,R)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Em(this)),this.readyState=0},e.Sa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,vm(this)),this.g&&(this.readyState=3,vm(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;JC(this)}else v.text().then(this.Ra.bind(this),this.ga.bind(this))};function JC(v){v.j.read().then(v.Pa.bind(v)).catch(v.ga.bind(v))}e.Pa=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var R=v.value?v.value:new Uint8Array(0);(R=this.v.decode(R,{stream:!v.done}))&&(this.response=this.responseText+=R)}v.done?Em(this):vm(this),this.readyState==3&&JC(this)}},e.Ra=function(v){this.g&&(this.response=this.responseText=v,Em(this))},e.Qa=function(v){this.g&&(this.response=v,Em(this))},e.ga=function(){this.g&&Em(this)};function Em(v){v.readyState=4,v.l=null,v.j=null,v.v=null,vm(v)}e.setRequestHeader=function(v,R){this.u.append(v,R)},e.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],R=this.h.entries();for(var F=R.next();!F.done;)F=F.value,v.push(F[0]+": "+F[1]),F=R.next();return v.join(`\r
`)};function vm(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(G2.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function ex(v){let R="";return k(v,function(F,V){R+=V,R+=":",R+=F,R+=`\r
`}),R}function M8(v,R,F){e:{for(V in F){var V=!1;break e}V=!0}V||(F=ex(F),typeof v=="string"?F!=null&&encodeURIComponent(String(F)):on(v,R,F))}function In(v){Qi.call(this),this.headers=new Map,this.o=v||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(In,Qi);var GQ=/^https?$/i,XQ=["POST","PUT"];e=In.prototype,e.Ha=function(v){this.J=v},e.ea=function(v,R,F,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);R=R?R.toUpperCase():"GET",this.D=v,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():w8.g(),this.v=this.o?AC(this.o):AC(w8),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(R,String(v),!0),this.B=!1}catch(ee){tx(this,ee);return}if(v=F||"",F=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var K in V)F.set(K,V[K]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ee of V.keys())F.set(ee,V.get(ee));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(F.keys()).find(ee=>ee.toLowerCase()=="content-type"),K=a.FormData&&v instanceof a.FormData,!(0<=Array.prototype.indexOf.call(XQ,R,void 0))||V||K||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,ge]of F)this.g.setRequestHeader(ee,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sx(this),this.u=!0,this.g.send(v),this.u=!1}catch(ee){tx(this,ee)}};function tx(v,R){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=R,v.m=5,nx(v),X2(v)}function nx(v){v.A||(v.A=!0,ms(v,"complete"),ms(v,"error"))}e.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=v||7,ms(this,"complete"),ms(this,"abort"),X2(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),X2(this,!0)),In.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?ix(this):this.bb())},e.bb=function(){ix(this)};function ix(v){if(v.h&&typeof o<"u"&&(!v.v[1]||Fa(v)!=4||v.Z()!=2)){if(v.u&&Fa(v)==4)IC(v.Ea,0,v);else if(ms(v,"readystatechange"),Fa(v)==4){v.h=!1;try{const ge=v.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var F;if(!(F=R)){var V;if(V=ge===0){var K=String(v.D).match(YC)[1]||null;!K&&a.self&&a.self.location&&(K=a.self.location.protocol.slice(0,-1)),V=!GQ.test(K?K.toLowerCase():"")}F=V}if(F)ms(v,"complete"),ms(v,"success");else{v.m=6;try{var ee=2<Fa(v)?v.g.statusText:""}catch{ee=""}v.l=ee+" ["+v.Z()+"]",nx(v)}}finally{X2(v)}}}}function X2(v,R){if(v.g){sx(v);const F=v.g,V=v.v[0]?()=>{}:null;v.g=null,v.v=null,R||ms(v,"ready");try{F.onreadystatechange=V}catch{}}}function sx(v){v.I&&(a.clearTimeout(v.I),v.I=null)}e.isActive=function(){return!!this.g};function Fa(v){return v.g?v.g.readyState:0}e.Z=function(){try{return 2<Fa(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(v){if(this.g){var R=this.g.responseText;return v&&R.indexOf(v)==0&&(R=R.substring(v.length)),wQ(R)}};function rx(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.H){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function jQ(v){const R={};v=(v.g&&2<=Fa(v)&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<v.length;V++){if(y(v[V]))continue;var F=D(v[V]);const K=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const ee=R[K]||[];R[K]=ee,ee.push(F)}w(R,function(V){return V.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function _m(v,R,F){return F&&F.internalChannelParams&&F.internalChannelParams[v]||R}function ox(v){this.Aa=0,this.i=[],this.j=new mm,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=_m("failFast",!1,v),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=_m("baseRetryDelayMs",5e3,v),this.cb=_m("retryDelaySeedMs",1e4,v),this.Wa=_m("forwardChannelMaxRetries",2,v),this.wa=_m("forwardChannelRequestTimeoutMs",2e4,v),this.pa=v&&v.xmlHttpFactory||void 0,this.Xa=v&&v.Tb||void 0,this.Ca=v&&v.useFetchStreams||!1,this.L=void 0,this.J=v&&v.supportsCrossDomainXhr||!1,this.K="",this.h=new HC(v&&v.concurrentRequestLimit),this.Da=new VQ,this.P=v&&v.fastHandshake||!1,this.O=v&&v.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=v&&v.Rb||!1,v&&v.xa&&this.j.xa(),v&&v.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&v&&v.detectBufferingProxy||!1,this.ja=void 0,v&&v.longPollingTimeout&&0<v.longPollingTimeout&&(this.ja=v.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=ox.prototype,e.la=8,e.G=1,e.connect=function(v,R,F,V){ps(0),this.W=v,this.H=R||{},F&&V!==void 0&&(this.H.OSID=F,this.H.OAID=V),this.F=this.X,this.I=mx(this,null,this.W),Y2(this)};function k8(v){if(ax(v),v.G==3){var R=v.U++,F=Oa(v.I);if(on(F,"SID",v.K),on(F,"RID",R),on(F,"TYPE","terminate"),wm(v,F),R=new Wl(v,v.j,R),R.L=2,R.v=V2(Oa(F)),F=!1,a.navigator&&a.navigator.sendBeacon)try{F=a.navigator.sendBeacon(R.v.toString(),"")}catch{}!F&&a.Image&&(new Image().src=R.v,F=!0),F||(R.g=px(R.j,null),R.g.ea(R.v)),R.F=Date.now(),B2(R)}gx(v)}function j2(v){v.g&&(D8(v),v.g.cancel(),v.g=null)}function ax(v){j2(v),v.u&&(a.clearTimeout(v.u),v.u=null),W2(v),v.h.cancel(),v.s&&(typeof v.s=="number"&&a.clearTimeout(v.s),v.s=null)}function Y2(v){if(!VC(v.h)&&!v.s){v.s=!0;var R=v.Ga;O||X(),z||(O(),z=!0),H.add(R,v),v.B=0}}function YQ(v,R){return $C(v.h)>=v.h.j-(v.s?1:0)?!1:v.s?(v.i=R.D.concat(v.i),!0):v.G==1||v.G==2||v.B>=(v.Va?0:v.Wa)?!1:(v.s=gm(f(v.Ga,v,R),hx(v,v.B)),v.B++,!0)}e.Ga=function(v){if(this.s)if(this.s=null,this.G==1){if(!v){this.U=Math.floor(1e5*Math.random()),v=this.U++;const K=new Wl(this,this.j,v);let ee=this.o;if(this.S&&(ee?(ee=T(ee),S(ee,this.S)):ee=this.S),this.m!==null||this.O||(K.H=ee,ee=null),this.P)e:{for(var R=0,F=0;F<this.i.length;F++){t:{var V=this.i[F];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(R+=V,4096<R){R=F;break e}if(R===4096||F===this.i.length-1){R=F+1;break e}}R=1e3}else R=1e3;R=cx(this,K,R),F=Oa(this.I),on(F,"RID",v),on(F,"CVER",22),this.D&&on(F,"X-HTTP-Session-Id",this.D),wm(this,F),ee&&(this.O?R="headers="+encodeURIComponent(String(ex(ee)))+"&"+R:this.m&&M8(F,this.m,ee)),A8(this.h,K),this.Ua&&on(F,"TYPE","init"),this.P?(on(F,"$req",R),on(F,"SID","null"),K.T=!0,I8(K,F,null)):I8(K,F,R),this.G=2}}else this.G==3&&(v?lx(this,v):this.i.length==0||VC(this.h)||lx(this))};function lx(v,R){var F;R?F=R.l:F=v.U++;const V=Oa(v.I);on(V,"SID",v.K),on(V,"RID",F),on(V,"AID",v.T),wm(v,V),v.m&&v.o&&M8(V,v.m,v.o),F=new Wl(v,v.j,F,v.B+1),v.m===null&&(F.H=v.o),R&&(v.i=R.D.concat(v.i)),R=cx(v,F,1e3),F.I=Math.round(.5*v.wa)+Math.round(.5*v.wa*Math.random()),A8(v.h,F),I8(F,V,R)}function wm(v,R){v.H&&k(v.H,function(F,V){on(R,V,F)}),v.l&&jC({},function(F,V){on(R,V,F)})}function cx(v,R,F){F=Math.min(v.i.length,F);var V=v.l?f(v.l.Na,v.l,v):null;e:{var K=v.i;let ee=-1;for(;;){const ge=["count="+F];ee==-1?0<F?(ee=K[0].g,ge.push("ofs="+ee)):ee=0:ge.push("ofs="+ee);let Wt=!0;for(let Ni=0;Ni<F;Ni++){let Mt=K[Ni].g;const Ji=K[Ni].map;if(Mt-=ee,0>Mt)ee=Math.max(0,K[Ni].g-100),Wt=!1;else try{$Q(Ji,ge,"req"+Mt+"_")}catch{V&&V(Ji)}}if(Wt){V=ge.join("&");break e}}}return v=v.i.splice(0,F),R.D=v,V}function dx(v){if(!v.g&&!v.u){v.Y=1;var R=v.Fa;O||X(),z||(O(),z=!0),H.add(R,v),v.v=0}}function R8(v){return v.g||v.u||3<=v.v?!1:(v.Y++,v.u=gm(f(v.Fa,v),hx(v,v.v)),v.v++,!0)}e.Fa=function(){if(this.u=null,ux(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var v=2*this.R;this.j.info("BP detection timer enabled: "+v),this.A=gm(f(this.ab,this),v)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ps(10),j2(this),ux(this))};function D8(v){v.A!=null&&(a.clearTimeout(v.A),v.A=null)}function ux(v){v.g=new Wl(v,v.j,"rpc",v.Y),v.m===null&&(v.g.H=v.o),v.g.O=0;var R=Oa(v.qa);on(R,"RID","rpc"),on(R,"SID",v.K),on(R,"AID",v.T),on(R,"CI",v.F?"0":"1"),!v.F&&v.ja&&on(R,"TO",v.ja),on(R,"TYPE","xmlhttp"),wm(v,R),v.m&&v.o&&M8(R,v.m,v.o),v.L&&(v.g.I=v.L);var F=v.g;v=v.ia,F.L=1,F.v=V2(Oa(R)),F.m=null,F.P=!0,FC(F,v)}e.Za=function(){this.C!=null&&(this.C=null,j2(this),R8(this),ps(19))};function W2(v){v.C!=null&&(a.clearTimeout(v.C),v.C=null)}function fx(v,R){var F=null;if(v.g==R){W2(v),D8(v),v.g=null;var V=2}else if(x8(v.h,R))F=R.D,GC(v.h,R),V=1;else return;if(v.G!=0){if(R.o)if(V==1){F=R.m?R.m.length:0,R=Date.now()-R.F;var K=v.B;V=N2(),ms(V,new LC(V,F)),Y2(v)}else dx(v);else if(K=R.s,K==3||K==0&&0<R.X||!(V==1&&YQ(v,R)||V==2&&R8(v)))switch(F&&0<F.length&&(R=v.h,R.i=R.i.concat(F)),K){case 1:Nd(v,5);break;case 4:Nd(v,10);break;case 3:Nd(v,6);break;default:Nd(v,2)}}}function hx(v,R){let F=v.Ta+Math.floor(Math.random()*v.cb);return v.isActive()||(F*=2),F*R}function Nd(v,R){if(v.j.info("Error code "+R),R==2){var F=f(v.fb,v),V=v.Xa;const K=!V;V=new Pd(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||z2(V,"https"),V2(V),K?zQ(V.toString(),F):HQ(V.toString(),F)}else ps(2);v.G=0,v.l&&v.l.sa(R),gx(v),ax(v)}e.fb=function(v){v?(this.j.info("Successfully pinged google.com"),ps(2)):(this.j.info("Failed to ping google.com"),ps(1))};function gx(v){if(v.G=0,v.ka=[],v.l){const R=XC(v.h);(R.length!=0||v.i.length!=0)&&(U(v.ka,R),U(v.ka,v.i),v.h.i.length=0,p(v.i),v.i.length=0),v.l.ra()}}function mx(v,R,F){var V=F instanceof Pd?Oa(F):new Pd(F);if(V.g!="")R&&(V.g=R+"."+V.g),H2(V,V.s);else{var K=a.location;V=K.protocol,R=R?R+"."+K.hostname:K.hostname,K=+K.port;var ee=new Pd(null);V&&z2(ee,V),R&&(ee.g=R),K&&H2(ee,K),F&&(ee.l=F),V=ee}return F=v.D,R=v.ya,F&&R&&on(V,F,R),on(V,"VER",v.la),wm(v,V),V}function px(v,R,F){if(R&&!v.J)throw Error("Can't create secondary domain capable XhrIo object.");return R=v.Ca&&!v.pa?new In(new $2({eb:F})):new In(v.pa),R.Ha(v.J),R}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ux(){}e=Ux.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function K2(){}K2.prototype.g=function(v,R){return new Ks(v,R)};function Ks(v,R){Qi.call(this),this.g=new ox(R),this.l=v,this.h=R&&R.messageUrlParams||null,v=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(v?v["X-WebChannel-Content-Type"]=R.messageContentType:v={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.va&&(v?v["X-WebChannel-Client-Profile"]=R.va:v={"X-WebChannel-Client-Profile":R.va}),this.g.S=v,(v=R&&R.Sb)&&!y(v)&&(this.g.m=v),this.v=R&&R.supportsCrossDomainXhr||!1,this.u=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!y(R)&&(this.g.D=R,v=this.h,v!==null&&R in v&&(v=this.h,R in v&&delete v[R])),this.j=new wf(this)}m(Ks,Qi),Ks.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ks.prototype.close=function(){k8(this.g)},Ks.prototype.o=function(v){var R=this.g;if(typeof v=="string"){var F={};F.__data__=v,v=F}else this.u&&(F={},F.__data__=y8(v),v=F);R.i.push(new MQ(R.Ya++,v)),R.G==3&&Y2(R)},Ks.prototype.N=function(){this.g.l=null,delete this.j,k8(this.g),delete this.g,Ks.aa.N.call(this)};function bx(v){v8.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var R=v.__sm__;if(R){e:{for(const F in R){v=F;break e}v=void 0}(this.i=v)&&(v=this.i,R=R!==null&&v in R?R[v]:void 0),this.data=R}else this.data=v}m(bx,v8);function yx(){_8.call(this),this.status=1}m(yx,_8);function wf(v){this.g=v}m(wf,Ux),wf.prototype.ua=function(){ms(this.g,"a")},wf.prototype.ta=function(v){ms(this.g,new bx(v))},wf.prototype.sa=function(v){ms(this.g,new yx)},wf.prototype.ra=function(){ms(this.g,"b")},K2.prototype.createWebChannel=K2.prototype.g,Ks.prototype.send=Ks.prototype.o,Ks.prototype.open=Ks.prototype.m,Ks.prototype.close=Ks.prototype.close,MZ=function(){return new K2},AZ=function(){return N2()},xZ=Dd,iw={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},O2.NO_ERROR=0,O2.TIMEOUT=8,O2.HTTP_ERROR=6,Yb=O2,PC.COMPLETE="complete",CZ=PC,MC.EventType=fm,fm.OPEN="a",fm.CLOSE="b",fm.ERROR="c",fm.MESSAGE="d",Qi.prototype.listen=Qi.prototype.K,S1=MC,In.prototype.listenOnce=In.prototype.L,In.prototype.getLastError=In.prototype.Ka,In.prototype.getLastErrorCode=In.prototype.Ba,In.prototype.getStatus=In.prototype.Z,In.prototype.getResponseJson=In.prototype.Oa,In.prototype.getResponseText=In.prototype.oa,In.prototype.send=In.prototype.ea,In.prototype.setWithCredentials=In.prototype.Ha,SZ=In}).apply(typeof QU<"u"?QU:typeof self<"u"?self:typeof window<"u"?window:{});const zP="@firebase/firestore",HP="4.7.8";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ss.UNAUTHENTICATED=new ss(null),ss.GOOGLE_CREDENTIALS=new ss("google-credentials-uid"),ss.FIRST_PARTY=new ss("first-party-uid"),ss.MOCK_USER=new ss("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let om="11.3.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=new mZ("@firebase/firestore");function Gf(){return Yu.logLevel}function Ie(e,...t){if(Yu.logLevel<=bt.DEBUG){const n=t.map(FS);Yu.debug(`Firestore (${om}): ${e}`,...n)}}function Bl(e,...t){if(Yu.logLevel<=bt.ERROR){const n=t.map(FS);Yu.error(`Firestore (${om}): ${e}`,...n)}}function Ag(e,...t){if(Yu.logLevel<=bt.WARN){const n=t.map(FS);Yu.warn(`Firestore (${om}): ${e}`,...n)}}function FS(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(e="Unexpected state"){const t=`FIRESTORE (${om}) INTERNAL ASSERTION FAILED: `+e;throw Bl(t),new Error(t)}function Zt(e,t){e||ze()}function ft(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Le extends pf{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kZ{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class bCe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(ss.UNAUTHENTICATED))}shutdown(){}}class yCe{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class ECe{constructor(t){this.t=t,this.currentUser=ss.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){Zt(this.o===void 0);let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let r=new Qc;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Qc,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Qc)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Zt(typeof i.accessToken=="string"),new kZ(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Zt(t===null||typeof t=="string"),new ss(t)}}class vCe{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=ss.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class _Ce{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new vCe(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(ss.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class VP{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wCe{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,yZ(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){Zt(this.o===void 0);const i=r=>{r.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,Ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>i(r))};const s=r=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?s(r):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new VP(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(Zt(typeof n.token=="string"),this.R=n.token,new VP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TCe(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RZ{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=TCe(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<n&&(i+=t.charAt(s[r]%62))}return i}}function yt(e,t){return e<t?-1:e>t?1:0}function Mg(e,t,n){return e.length===t.length&&e.every((i,s)=>n(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=-62135596800,GP=1e6;class Di{static now(){return Di.fromMillis(Date.now())}static fromDate(t){return Di.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*GP);return new Di(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<$P)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/GP}_compareTo(t){return this.seconds===t.seconds?yt(this.nanoseconds,t.nanoseconds):yt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-$P;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{static fromTimestamp(t){return new Ge(t)}static min(){return new Ge(new Di(0,0))}static max(){return new Ge(new Di(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP="__name__";class Wo{constructor(t,n,i){n===void 0?n=0:n>t.length&&ze(),i===void 0?i=t.length-n:i>t.length-n&&ze(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Wo.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Wo?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let s=0;s<i;s++){const r=Wo.compareSegments(t.get(s),n.get(s));if(r!==0)return r}return Math.sign(t.length-n.length)}static compareSegments(t,n){const i=Wo.isNumericId(t),s=Wo.isNumericId(n);return i&&!s?-1:!i&&s?1:i&&s?Wo.extractNumericId(t).compare(Wo.extractNumericId(n)):t<n?-1:t>n?1:0}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return qc.fromString(t.substring(4,t.length-2))}}class pn extends Wo{construct(t,n,i){return new pn(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new Le(ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(s=>s.length>0))}return new pn(n)}static emptyPath(){return new pn([])}}const ICe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class as extends Wo{construct(t,n,i){return new as(t,n,i)}static isValidIdentifier(t){return ICe.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),as.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===XP}static keyField(){return new as([XP])}static fromServerFormat(t){const n=[];let i="",s=0;const r=()=>{if(i.length===0)throw new Le(ce.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new Le(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Le(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new Le(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new as(n)}static emptyPath(){return new as([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(t){this.path=t}static fromPath(t){return new He(pn.fromString(t))}static fromName(t){return new He(pn.fromString(t).popFirst(5))}static empty(){return new He(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&pn.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return pn.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new He(new pn(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp=-1;function SCe(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=Ge.fromTimestamp(i===1e9?new Di(n+1,0):new Di(n,i));return new pd(s,He.empty(),t)}function CCe(e){return new pd(e.readTime,e.key,vp)}class pd{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new pd(Ge.min(),He.empty(),vp)}static max(){return new pd(Ge.max(),He.empty(),vp)}}function xCe(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=He.comparator(e.documentKey,t.documentKey),n!==0?n:yt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ACe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MCe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i8(e){if(e.code!==ce.FAILED_PRECONDITION||e.message!==ACe)throw e;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&ze(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new oe((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(n,r).next(i,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof oe?n:oe.resolve(n)}catch(n){return oe.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):oe.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):oe.reject(n)}static resolve(t){return new oe((n,i)=>{n(t)})}static reject(t){return new oe((n,i)=>{i(t)})}static waitFor(t){return new oe((n,i)=>{let s=0,r=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&n()},l=>i(l))}),o=!0,r===s&&n()})}static or(t){let n=oe.resolve(!1);for(const i of t)n=n.next(s=>s?oe.resolve(s):i());return n}static forEach(t,n){const i=[];return t.forEach((s,r)=>{i.push(n.call(this,s,r))}),this.waitFor(i)}static mapArray(t,n){return new oe((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;n(t[c]).next(d=>{o[c]=d,++a,a===r&&i(o)},d=>s(d))}})}static doWhile(t,n){return new oe((i,s)=>{const r=()=>{t()===!0?n().next(()=>{r()},s):i()};r()})}}function kCe(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function am(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}s8.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RCe=-1;function x2(e){return e==null}function J5(e){return e===0&&1/e==-1/0}function DCe(e){return typeof e=="number"&&Number.isInteger(e)&&!J5(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DZ="";function LCe(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=jP(t)),t=PCe(e.get(n),t);return jP(t)}function PCe(e,t){let n=t;const i=e.length;for(let s=0;s<i;s++){const r=e.charAt(s);switch(r){case"\0":n+="";break;case DZ:n+="";break;default:n+=r}}return n}function jP(e){return e+DZ+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YP(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Uf(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function LZ(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(t,n){this.comparator=t,this.root=n||Vi.EMPTY}insert(t,n){return new Xn(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Vi.BLACK,null,null))}remove(t){return new Xn(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Vi.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new JU(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new JU(this.root,t,this.comparator,!1)}getReverseIterator(){return new JU(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new JU(this.root,t,this.comparator,!0)}}class JU{constructor(t,n,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=n?i(t.key,n):1,n&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Vi{constructor(t,n,i,s,r){this.key=t,this.value=n,this.color=i??Vi.RED,this.left=s??Vi.EMPTY,this.right=r??Vi.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,s,r){return new Vi(t??this.key,n??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,n,i),null):r===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vi.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Vi.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ze();const t=this.left.check();if(t!==this.right.check())throw ze();return t+(this.isRed()?0:1)}}Vi.EMPTY=null,Vi.RED=!0,Vi.BLACK=!1;Vi.EMPTY=new class{constructor(){this.size=0}get key(){throw ze()}get value(){throw ze()}get color(){throw ze()}get left(){throw ze()}get right(){throw ze()}copy(t,n,i,s,r){return this}insert(t,n,i){return new Vi(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(t){this.comparator=t,this.data=new Xn(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new WP(this.data.getIterator())}getIteratorFrom(t){return new WP(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof Ui)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ui(this.comparator);return n.data=t,n}}class WP{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this.fields=t,t.sort(as.comparator)}static empty(){return new Xr([])}unionWith(t){let n=new Ui(as.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new Xr(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Mg(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new PZ("Invalid base64 string: "+r):r}}(t);return new Zi(n)}static fromUint8Array(t){const n=function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r}(t);return new Zi(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return yt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Zi.EMPTY_BYTE_STRING=new Zi("");const NCe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ud(e){if(Zt(!!e),typeof e=="string"){let t=0;const n=NCe.exec(e);if(Zt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Vn(e.seconds),nanos:Vn(e.nanos)}}function Vn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function bd(e){return typeof e=="string"?Zi.fromBase64String(e):Zi.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NZ="server_timestamp",OZ="__type__",FZ="__previous_value__",BZ="__local_write_time__";function BS(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[OZ])===null||n===void 0?void 0:n.stringValue)===NZ}function r8(e){const t=e.mapValue.fields[FZ];return BS(t)?r8(t):t}function _p(e){const t=Ud(e.mapValue.fields[BZ].timestampValue);return new Di(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OCe{constructor(t,n,i,s,r,o,a,l,c){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const ey="(default)";class wp{constructor(t,n){this.projectId=t,this.database=n||ey}static empty(){return new wp("","")}get isDefaultDatabase(){return this.database===ey}isEqual(t){return t instanceof wp&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zZ="__type__",FCe="__max__",eb={mapValue:{}},HZ="__vector__",ty="value";function yd(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?BS(e)?4:zCe(e)?9007199254740991:BCe(e)?10:11:ze()}function Ma(e,t){if(e===t)return!0;const n=yd(e);if(n!==yd(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return _p(e).isEqual(_p(t));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=Ud(s.timestampValue),a=Ud(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,r){return bd(s.bytesValue).isEqual(bd(r.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,r){return Vn(s.geoPointValue.latitude)===Vn(r.geoPointValue.latitude)&&Vn(s.geoPointValue.longitude)===Vn(r.geoPointValue.longitude)}(e,t);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return Vn(s.integerValue)===Vn(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=Vn(s.doubleValue),a=Vn(r.doubleValue);return o===a?J5(o)===J5(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return Mg(e.arrayValue.values||[],t.arrayValue.values||[],Ma);case 10:case 11:return function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(YP(o)!==YP(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ma(o[l],a[l])))return!1;return!0}(e,t);default:return ze()}}function Tp(e,t){return(e.values||[]).find(n=>Ma(n,t))!==void 0}function kg(e,t){if(e===t)return 0;const n=yd(e),i=yd(t);if(n!==i)return yt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return yt(e.booleanValue,t.booleanValue);case 2:return function(r,o){const a=Vn(r.integerValue||r.doubleValue),l=Vn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(e,t);case 3:return KP(e.timestampValue,t.timestampValue);case 4:return KP(_p(e),_p(t));case 5:return yt(e.stringValue,t.stringValue);case 6:return function(r,o){const a=bd(r),l=bd(o);return a.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=yt(a[c],l[c]);if(d!==0)return d}return yt(a.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(r,o){const a=yt(Vn(r.latitude),Vn(o.latitude));return a!==0?a:yt(Vn(r.longitude),Vn(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ZP(e.arrayValue,t.arrayValue);case 10:return function(r,o){var a,l,c,d;const u=r.fields||{},f=o.fields||{},h=(a=u[ty])===null||a===void 0?void 0:a.arrayValue,m=(l=f[ty])===null||l===void 0?void 0:l.arrayValue,p=yt(((c=h==null?void 0:h.values)===null||c===void 0?void 0:c.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:ZP(h,m)}(e.mapValue,t.mapValue);case 11:return function(r,o){if(r===eb.mapValue&&o===eb.mapValue)return 0;if(r===eb.mapValue)return 1;if(o===eb.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let u=0;u<l.length&&u<d.length;++u){const f=yt(l[u],d[u]);if(f!==0)return f;const h=kg(a[l[u]],c[d[u]]);if(h!==0)return h}return yt(l.length,d.length)}(e.mapValue,t.mapValue);default:throw ze()}}function KP(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return yt(e,t);const n=Ud(e),i=Ud(t),s=yt(n.seconds,i.seconds);return s!==0?s:yt(n.nanos,i.nanos)}function ZP(e,t){const n=e.values||[],i=t.values||[];for(let s=0;s<n.length&&s<i.length;++s){const r=kg(n[s],i[s]);if(r)return r}return yt(n.length,i.length)}function Rg(e){return sw(e)}function sw(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=Ud(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return bd(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return He.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",s=!0;for(const r of n.values||[])s?s=!1:i+=",",i+=sw(r);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${sw(n.fields[o])}`;return s+"}"}(e.mapValue):ze()}function Wb(e){switch(yd(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=r8(e);return t?16+Wb(t):16;case 5:return 2*e.stringValue.length;case 6:return bd(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,r)=>s+Wb(r),0)}(e.arrayValue);case 10:case 11:return function(i){let s=0;return Uf(i.fields,(r,o)=>{s+=r.length+Wb(o)}),s}(e.mapValue);default:throw ze()}}function rw(e){return!!e&&"integerValue"in e}function zS(e){return!!e&&"arrayValue"in e}function qP(e){return!!e&&"nullValue"in e}function QP(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function sv(e){return!!e&&"mapValue"in e}function BCe(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[zZ])===null||n===void 0?void 0:n.stringValue)===HZ}function h0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Uf(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=h0(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=h0(e.arrayValue.values[n]);return t}return Object.assign({},e)}function zCe(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===FCe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(t){this.value=t}static empty(){return new Fs({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!sv(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=h0(n)}setAll(t){let n=as.emptyPath(),i={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,s),i={},s=[],n=a.popLast()}o?i[a.lastSegment()]=h0(o):s.push(a.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,i,s)}delete(t){const n=this.field(t.popLast());sv(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Ma(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=n.mapValue.fields[t.get(i)];sv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,i){Uf(n,(s,r)=>t[s]=r);for(const s of i)delete t[s]}clone(){return new Fs(h0(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(t,n,i,s,r,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Ai(t,0,Ge.min(),Ge.min(),Ge.min(),Fs.empty(),0)}static newFoundDocument(t,n,i,s){return new Ai(t,1,n,Ge.min(),i,s,0)}static newNoDocument(t,n){return new Ai(t,2,n,Ge.min(),Ge.min(),Fs.empty(),0)}static newUnknownDocument(t,n){return new Ai(t,3,n,Ge.min(),Ge.min(),Fs.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Fs.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Fs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ai&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ai(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(t,n){this.position=t,this.inclusive=n}}function JP(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(r.field.isKeyField()?i=He.comparator(He.fromName(o.referenceValue),n.key):i=kg(o,n.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function eN(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ma(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(t,n="asc"){this.field=t,this.dir=n}}function HCe(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VZ{}class mi extends VZ{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new $Ce(t,n,i):n==="array-contains"?new jCe(t,i):n==="in"?new YCe(t,i):n==="not-in"?new WCe(t,i):n==="array-contains-any"?new KCe(t,i):new mi(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new GCe(t,i):new XCe(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(kg(n,this.value)):n!==null&&yd(this.value)===yd(n)&&this.matchesComparison(kg(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return ze()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ka extends VZ{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new ka(t,n)}matches(t){return $Z(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function $Z(e){return e.op==="and"}function GZ(e){return VCe(e)&&$Z(e)}function VCe(e){for(const t of e.filters)if(t instanceof ka)return!1;return!0}function ow(e){if(e instanceof mi)return e.field.canonicalString()+e.op.toString()+Rg(e.value);if(GZ(e))return e.filters.map(t=>ow(t)).join(",");{const t=e.filters.map(n=>ow(n)).join(",");return`${e.op}(${t})`}}function XZ(e,t){return e instanceof mi?function(i,s){return s instanceof mi&&i.op===s.op&&i.field.isEqual(s.field)&&Ma(i.value,s.value)}(e,t):e instanceof ka?function(i,s){return s instanceof ka&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((r,o,a)=>r&&XZ(o,s.filters[a]),!0):!1}(e,t):void ze()}function jZ(e){return e instanceof mi?function(n){return`${n.field.canonicalString()} ${n.op} ${Rg(n.value)}`}(e):e instanceof ka?function(n){return n.op.toString()+" {"+n.getFilters().map(jZ).join(" ,")+"}"}(e):"Filter"}class $Ce extends mi{constructor(t,n,i){super(t,n,i),this.key=He.fromName(i.referenceValue)}matches(t){const n=He.comparator(t.key,this.key);return this.matchesComparison(n)}}class GCe extends mi{constructor(t,n){super(t,"in",n),this.keys=YZ("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class XCe extends mi{constructor(t,n){super(t,"not-in",n),this.keys=YZ("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function YZ(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>He.fromName(i.referenceValue))}class jCe extends mi{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return zS(n)&&Tp(n.arrayValue,this.value)}}class YCe extends mi{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Tp(this.value.arrayValue,n)}}class WCe extends mi{constructor(t,n){super(t,"not-in",n)}matches(t){if(Tp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Tp(this.value.arrayValue,n)}}class KCe extends mi{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!zS(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Tp(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZCe{constructor(t,n=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.le=null}}function tN(e,t=null,n=[],i=[],s=null,r=null,o=null){return new ZCe(e,t,n,i,s,r,o)}function HS(e){const t=ft(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>ow(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),x2(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Rg(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Rg(i)).join(",")),t.le=n}return t.le}function VS(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!HCe(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!XZ(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!eN(e.startAt,t.startAt)&&eN(e.endAt,t.endAt)}function aw(e){return He.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(t,n=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function qCe(e,t,n,i,s,r,o,a){return new o8(e,t,n,i,s,r,o,a)}function $S(e){return new o8(e)}function nN(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function QCe(e){return e.collectionGroup!==null}function g0(e){const t=ft(e);if(t.he===null){t.he=[];const n=new Set;for(const r of t.explicitOrderBy)t.he.push(r),n.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ui(as.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||t.he.push(new iy(r,i))}),n.has(as.keyField().canonicalString())||t.he.push(new iy(as.keyField(),i))}return t.he}function ma(e){const t=ft(e);return t.Pe||(t.Pe=JCe(t,g0(e))),t.Pe}function JCe(e,t){if(e.limitType==="F")return tN(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const r=s.dir==="desc"?"asc":"desc";return new iy(s.field,r)});const n=e.endAt?new ny(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new ny(e.startAt.position,e.startAt.inclusive):null;return tN(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function lw(e,t,n){return new o8(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function a8(e,t){return VS(ma(e),ma(t))&&e.limitType===t.limitType}function WZ(e){return`${HS(ma(e))}|lt:${e.limitType}`}function Xf(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(s=>jZ(s)).join(", ")}]`),x2(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(s=>Rg(s)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(s=>Rg(s)).join(",")),`Target(${i})`}(ma(e))}; limitType=${e.limitType})`}function l8(e,t){return t.isFoundDocument()&&function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):He.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(e,t)&&function(i,s){for(const r of g0(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(e,t)&&function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0}(e,t)&&function(i,s){return!(i.startAt&&!function(o,a,l){const c=JP(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,g0(i),s)||i.endAt&&!function(o,a,l){const c=JP(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,g0(i),s))}(e,t)}function exe(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function KZ(e){return(t,n)=>{let i=!1;for(const s of g0(e)){const r=txe(s,t,n);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function txe(e,t,n){const i=e.field.isKeyField()?He.comparator(t.key,n.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?kg(l,c):ze()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return ze()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Uf(this.inner,(n,i)=>{for(const[s,r]of i)t(s,r)})}isEmpty(){return LZ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nxe=new Xn(He.comparator);function Ed(){return nxe}const ZZ=new Xn(He.comparator);function C1(...e){let t=ZZ;for(const n of e)t=t.insert(n.key,n);return t}function ixe(e){let t=ZZ;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function cu(){return m0()}function qZ(){return m0()}function m0(){return new bf(e=>e.toString(),(e,t)=>e.isEqual(t))}const sxe=new Ui(He.comparator);function At(...e){let t=sxe;for(const n of e)t=t.add(n);return t}const rxe=new Ui(yt);function oxe(){return rxe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:J5(t)?"-0":t}}function QZ(e){return{integerValue:""+e}}function axe(e,t){return DCe(t)?QZ(t):GS(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(){this._=void 0}}function lxe(e,t,n){return e instanceof sy?function(s,r){const o={fields:{[OZ]:{stringValue:NZ},[BZ]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&BS(r)&&(r=r8(r)),r&&(o.fields[FZ]=r),{mapValue:o}}(n,t):e instanceof Ip?JZ(e,t):e instanceof Sp?eq(e,t):function(s,r){const o=dxe(s,r),a=iN(o)+iN(s.Ie);return rw(o)&&rw(s.Ie)?QZ(a):GS(s.serializer,a)}(e,t)}function cxe(e,t,n){return e instanceof Ip?JZ(e,t):e instanceof Sp?eq(e,t):n}function dxe(e,t){return e instanceof ry?function(i){return rw(i)||function(r){return!!r&&"doubleValue"in r}(i)}(t)?t:{integerValue:0}:null}class sy extends c8{}class Ip extends c8{constructor(t){super(),this.elements=t}}function JZ(e,t){const n=tq(t);for(const i of e.elements)n.some(s=>Ma(s,i))||n.push(i);return{arrayValue:{values:n}}}class Sp extends c8{constructor(t){super(),this.elements=t}}function eq(e,t){let n=tq(t);for(const i of e.elements)n=n.filter(s=>!Ma(s,i));return{arrayValue:{values:n}}}class ry extends c8{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function iN(e){return Vn(e.integerValue||e.doubleValue)}function tq(e){return zS(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function uxe(e,t){return e.field.isEqual(t.field)&&function(i,s){return i instanceof Ip&&s instanceof Ip||i instanceof Sp&&s instanceof Sp?Mg(i.elements,s.elements,Ma):i instanceof ry&&s instanceof ry?Ma(i.Ie,s.Ie):i instanceof sy&&s instanceof sy}(e.transform,t.transform)}class Hr{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Hr}static exists(t){return new Hr(void 0,t)}static updateTime(t){return new Hr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Kb(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class d8{}function nq(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new XS(e.key,Hr.none()):new A2(e.key,e.data,Hr.none());{const n=e.data,i=Fs.empty();let s=new Ui(as.comparator);for(let r of t.fields)if(!s.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new yf(e.key,i,new Xr(s.toArray()),Hr.none())}}function fxe(e,t,n){e instanceof A2?function(s,r,o){const a=s.value.clone(),l=rN(s.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof yf?function(s,r,o){if(!Kb(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=rN(s.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(iq(s)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function p0(e,t,n,i){return e instanceof A2?function(r,o,a,l){if(!Kb(r.precondition,o))return a;const c=r.value.clone(),d=oN(r.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,i):e instanceof yf?function(r,o,a,l){if(!Kb(r.precondition,o))return a;const c=oN(r.fieldTransforms,l,o),d=o.data;return d.setAll(iq(r)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(e,t,n,i):function(r,o,a){return Kb(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function sN(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Mg(i,s,(r,o)=>uxe(r,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class A2 extends d8{constructor(t,n,i,s=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yf extends d8{constructor(t,n,i,s,r=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function iq(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function rN(e,t,n){const i=new Map;Zt(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,cxe(o,a,n[s]))}return i}function oN(e,t,n){const i=new Map;for(const s of e){const r=s.transform,o=n.data.field(s.field);i.set(s.field,lxe(r,o,t))}return i}class XS extends d8{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sq extends d8{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hxe{constructor(t,n,i,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&fxe(r,t,i[s])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=p0(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=p0(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=qZ();return this.mutations.forEach(s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=n.has(s.key)?null:a;const l=nq(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Ge.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),At())}isEqual(t){return this.batchId===t.batchId&&Mg(this.mutations,t.mutations,(n,i)=>sN(n,i))&&Mg(this.baseMutations,t.baseMutations,(n,i)=>sN(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gxe{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mxe{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kn,Ut;function pxe(e){switch(e){case ce.OK:return ze();case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return ze()}}function rq(e){if(e===void 0)return Bl("GRPC error has no .code"),ce.UNKNOWN;switch(e){case Kn.OK:return ce.OK;case Kn.CANCELLED:return ce.CANCELLED;case Kn.UNKNOWN:return ce.UNKNOWN;case Kn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Kn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Kn.INTERNAL:return ce.INTERNAL;case Kn.UNAVAILABLE:return ce.UNAVAILABLE;case Kn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Kn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Kn.NOT_FOUND:return ce.NOT_FOUND;case Kn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Kn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Kn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Kn.ABORTED:return ce.ABORTED;case Kn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Kn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Kn.DATA_LOSS:return ce.DATA_LOSS;default:return ze()}}(Ut=Kn||(Kn={}))[Ut.OK=0]="OK",Ut[Ut.CANCELLED=1]="CANCELLED",Ut[Ut.UNKNOWN=2]="UNKNOWN",Ut[Ut.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ut[Ut.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ut[Ut.NOT_FOUND=5]="NOT_FOUND",Ut[Ut.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ut[Ut.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ut[Ut.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ut[Ut.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ut[Ut.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ut[Ut.ABORTED=10]="ABORTED",Ut[Ut.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ut[Ut.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ut[Ut.INTERNAL=13]="INTERNAL",Ut[Ut.UNAVAILABLE=14]="UNAVAILABLE",Ut[Ut.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uxe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bxe=new qc([4294967295,4294967295],0);function aN(e){const t=Uxe().encode(e),n=new IZ;return n.update(t),new Uint8Array(n.digest())}function lN(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new qc([n,i],0),new qc([s,r],0)]}class jS{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new x1(`Invalid padding: ${n}`);if(i<0)throw new x1(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new x1(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new x1(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=qc.fromNumber(this.Ee)}Ae(t,n,i){let s=t.add(n.multiply(qc.fromNumber(i)));return s.compare(bxe)===1&&(s=new qc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=aN(t),[i,s]=lN(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);if(!this.Re(o))return!1}return!0}static create(t,n,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new jS(r,s,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.Ee===0)return;const n=aN(t),[i,s]=lN(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);this.Ve(o)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class x1 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(t,n,i,s,r){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const s=new Map;return s.set(t,M2.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new u8(Ge.min(),s,new Xn(yt),Ed(),At())}}class M2{constructor(t,n,i,s,r){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new M2(i,n,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(t,n,i,s){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=s}}class oq{constructor(t,n){this.targetId=t,this.ge=n}}class aq{constructor(t,n,i=Zi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=s}}class cN{constructor(){this.pe=0,this.ye=dN(),this.we=Zi.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=At(),n=At(),i=At();return this.ye.forEach((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:ze()}}),new M2(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=dN()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,Zt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class yxe{constructor(t){this.ke=t,this.qe=new Map,this.Qe=Ed(),this.$e=tb(),this.Ke=tb(),this.Ue=new Xn(yt)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:ze()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,s)=>{this.Je(s)&&n(s)})}Ze(t){const n=t.targetId,i=t.ge.count,s=this.Xe(n);if(s){const r=s.target;if(aw(r))if(i===0){const o=new He(r.path);this.ze(n,o,Ai.newNoDocument(o,Ge.min()))}else Zt(i===1);else{const o=this.et(n);if(o!==i){const a=this.tt(t),l=a?this.nt(a,t,o):1;if(l!==0){this.Ye(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(n,c)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=n;let o,a;try{o=bd(i).toUint8Array()}catch(l){if(l instanceof PZ)return Ag("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new jS(o,s,r)}catch(l){return Ag(l instanceof x1?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let s=0;return i.forEach(r=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.ze(n,r,null),s++)}),s}ot(t){const n=new Map;this.qe.forEach((r,o)=>{const a=this.Xe(o);if(a){if(r.current&&aw(a.target)){const l=new He(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,Ai.newNoDocument(l,t))}r.ve&&(n.set(o,r.Fe()),r.Me())}});let i=At();this.Ke.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(t));const s=new u8(t,n,this.Ue,this.Qe,i);return this.Qe=Ed(),this.$e=tb(),this.Ke=tb(),this.Ue=new Xn(yt),s}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ke=this.Ke.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const s=this.He(t);this.ut(t,n)?s.xe(n,1):s.Oe(n),this.Ke=this.Ke.insert(n,this.ct(n).delete(t)),this.Ke=this.Ke.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new cN,this.qe.set(t,n)),n}ct(t){let n=this.Ke.get(t);return n||(n=new Ui(yt),this.Ke=this.Ke.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new Ui(yt),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||Ie("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new cN),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function tb(){return new Xn(He.comparator)}function dN(){return new Xn(He.comparator)}const Exe={asc:"ASCENDING",desc:"DESCENDING"},vxe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_xe={and:"AND",or:"OR"};class wxe{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function cw(e,t){return e.useProto3Json||x2(t)?t:{value:t}}function oy(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function lq(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Txe(e,t){return oy(e,t.toTimestamp())}function Tl(e){return Zt(!!e),Ge.fromTimestamp(function(n){const i=Ud(n);return new Di(i.seconds,i.nanos)}(e))}function YS(e,t){return dw(e,t).canonicalString()}function dw(e,t){const n=function(s){return new pn(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function cq(e){const t=pn.fromString(e);return Zt(gq(t)),t}function ay(e,t){return YS(e.databaseId,t.path)}function U0(e,t){const n=cq(t);if(n.get(1)!==e.databaseId.projectId)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new He(uq(n))}function dq(e,t){return YS(e.databaseId,t)}function Ixe(e){const t=cq(e);return t.length===4?pn.emptyPath():uq(t)}function uN(e){return new pn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function uq(e){return Zt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function fN(e,t,n){return{name:ay(e,t),fields:n.value.mapValue.fields}}function Sxe(e,t){return"found"in t?function(i,s){Zt(!!s.found),s.found.name,s.found.updateTime;const r=U0(i,s.found.name),o=Tl(s.found.updateTime),a=s.found.createTime?Tl(s.found.createTime):Ge.min(),l=new Fs({mapValue:{fields:s.found.fields}});return Ai.newFoundDocument(r,o,a,l)}(e,t):"missing"in t?function(i,s){Zt(!!s.missing),Zt(!!s.readTime);const r=U0(i,s.missing),o=Tl(s.readTime);return Ai.newNoDocument(r,o)}(e,t):ze()}function Cxe(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ze()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(c,d){return c.useProto3Json?(Zt(d===void 0||typeof d=="string"),Zi.fromBase64String(d||"")):(Zt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Zi.fromUint8Array(d||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const d=c.code===void 0?ce.UNKNOWN:rq(c.code);return new Le(d,c.message||"")}(o);n=new aq(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=U0(e,i.document.name),r=Tl(i.document.updateTime),o=i.document.createTime?Tl(i.document.createTime):Ge.min(),a=new Fs({mapValue:{fields:i.document.fields}}),l=Ai.newFoundDocument(s,r,o,a),c=i.targetIds||[],d=i.removedTargetIds||[];n=new Zb(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=U0(e,i.document),r=i.readTime?Tl(i.readTime):Ge.min(),o=Ai.newNoDocument(s,r),a=i.removedTargetIds||[];n=new Zb([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=U0(e,i.document),r=i.removedTargetIds||[];n=new Zb([],r,s,null)}else{if(!("filter"in t))return ze();{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new mxe(s,r),a=i.targetId;n=new oq(a,o)}}return n}function xxe(e,t){let n;if(t instanceof A2)n={update:fN(e,t.key,t.value)};else if(t instanceof XS)n={delete:ay(e,t.key)};else if(t instanceof yf)n={update:fN(e,t.key,t.data),updateMask:Nxe(t.fieldMask)};else{if(!(t instanceof sq))return ze();n={verify:ay(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(r,o){const a=o.transform;if(a instanceof sy)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ip)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Sp)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ry)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ze()}(0,i))),t.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:Txe(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:ze()}(e,t.precondition)),n}function Axe(e,t){return{documents:[dq(e,t.path)]}}function Mxe(e,t){const n={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=dq(e,s);const r=function(c){if(c.length!==0)return hq(ka.create(c,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:jf(f.field),direction:Dxe(f.dir)}}(d))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=cw(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ht:n,parent:s}}function kxe(e){let t=Ixe(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Zt(i===1);const d=n.from[0];d.allDescendants?s=d.collectionId:t=t.child(d.collectionId)}let r=[];n.where&&(r=function(u){const f=fq(u);return f instanceof ka&&GZ(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(f=>function(m){return new iy(Yf(m.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,x2(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,h=u.values||[];return new ny(h,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,h=u.values||[];return new ny(h,f)}(n.endAt)),qCe(t,s,o,r,a,"F",l,c)}function Rxe(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function fq(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Yf(n.unaryFilter.field);return mi.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Yf(n.unaryFilter.field);return mi.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Yf(n.unaryFilter.field);return mi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Yf(n.unaryFilter.field);return mi.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ze()}}(e):e.fieldFilter!==void 0?function(n){return mi.create(Yf(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ze()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ka.create(n.compositeFilter.filters.map(i=>fq(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ze()}}(n.compositeFilter.op))}(e):ze()}function Dxe(e){return Exe[e]}function Lxe(e){return vxe[e]}function Pxe(e){return _xe[e]}function jf(e){return{fieldPath:e.canonicalString()}}function Yf(e){return as.fromServerFormat(e.fieldPath)}function hq(e){return e instanceof mi?function(n){if(n.op==="=="){if(QP(n.value))return{unaryFilter:{field:jf(n.field),op:"IS_NAN"}};if(qP(n.value))return{unaryFilter:{field:jf(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(QP(n.value))return{unaryFilter:{field:jf(n.field),op:"IS_NOT_NAN"}};if(qP(n.value))return{unaryFilter:{field:jf(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jf(n.field),op:Lxe(n.op),value:n.value}}}(e):e instanceof ka?function(n){const i=n.getFilters().map(s=>hq(s));return i.length===1?i[0]:{compositeFilter:{op:Pxe(n.op),filters:i}}}(e):ze()}function Nxe(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function gq(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(t,n,i,s,r=Ge.min(),o=Ge.min(),a=Zi.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new xc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oxe{constructor(t){this.Tt=t}}function Fxe(e){const t=kxe({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?lw(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bxe{constructor(){this.Tn=new zxe}addToCollectionParentIndex(t,n){return this.Tn.add(n),oe.resolve()}getCollectionParents(t,n){return oe.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return oe.resolve()}deleteFieldIndex(t,n){return oe.resolve()}deleteAllFieldIndexes(t){return oe.resolve()}createTargetIndexes(t,n){return oe.resolve()}getDocumentsMatchingTarget(t,n){return oe.resolve(null)}getIndexType(t,n){return oe.resolve(0)}getFieldIndexes(t,n){return oe.resolve([])}getNextCollectionGroupToUpdate(t){return oe.resolve(null)}getMinOffset(t,n){return oe.resolve(pd.min())}getMinOffsetFromCollectionGroup(t,n){return oe.resolve(pd.min())}updateCollectionGroup(t,n,i){return oe.resolve()}updateIndexEntries(t,n){return oe.resolve()}}class zxe{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n]||new Ui(pn.comparator),r=!s.has(i);return this.index[n]=s.add(i),r}has(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(t){return(this.index[t]||new Ui(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mq=41943040;class Os{static withCacheSize(t){return new Os(t,Os.DEFAULT_COLLECTION_PERCENTILE,Os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os.DEFAULT_COLLECTION_PERCENTILE=10,Os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Os.DEFAULT=new Os(mq,Os.DEFAULT_COLLECTION_PERCENTILE,Os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Os.DISABLED=new Os(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Kn(){return new Dg(0)}static Un(){return new Dg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="LruGarbageCollector",Hxe=1048576;function mN([e,t],[n,i]){const s=yt(e,n);return s===0?yt(t,i):s}class Vxe{constructor(t){this.Hn=t,this.buffer=new Ui(mN),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();mN(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class $xe{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){Ie(gN,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){am(n)?Ie(gN,"Ignoring IndexedDB error during garbage collection: ",n):await i8(n)}await this.er(3e5)})}}class Gxe{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return oe.resolve(s8.ae);const i=new Vxe(n);return this.tr.forEachTarget(t,s=>i.Zn(s.sequenceNumber)).next(()=>this.tr.rr(t,s=>i.Zn(s))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(Ie("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(hN)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(Ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hN):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,s,r,o,a,l,c;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(Ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),s=this.params.maximumSequenceNumbersToCollect):s=u,o=Date.now(),this.nthSequenceNumber(t,s))).next(u=>(i=u,a=Date.now(),this.removeTargets(t,i,n))).next(u=>(r=u,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(u=>(c=Date.now(),Gf()<=bt.DEBUG&&Ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${u} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:u})))}}function Xxe(e,t){return new Gxe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jxe{constructor(){this.changes=new bf(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Ai.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?oe.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yxe{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wxe{constructor(t,n,i,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(i!==null&&p0(i.mutation,s,Xr.empty(),Di.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,At()).next(()=>i))}getLocalViewOfDocuments(t,n,i=At()){const s=cu();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,i).next(r=>{let o=C1();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=cu();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,At()))}populateOverlays(t,n,i){const s=[];return i.forEach(r=>{n.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(t,s).next(r=>{r.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,s){let r=Ed();const o=m0(),a=function(){return m0()}();return n.forEach((l,c)=>{const d=i.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof yf)?r=r.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),p0(d.mutation,c,d.mutation.getFieldMask(),Di.now())):o.set(c.key,Xr.empty())}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var u;return a.set(c,new Yxe(d,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(t,n){const i=m0();let s=new Xn((o,a)=>o-a),r=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=i.get(l)||Xr.empty();d=a.applyToLocalView(c,d),i.set(l,d);const u=(s.get(a.batchId)||At()).add(l);s=s.insert(a.batchId,u)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,u=qZ();d.forEach(f=>{if(!r.has(f)){const h=nq(n.get(f),i.get(f));h!==null&&u.set(f,h),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,u))}return oe.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,s){return function(o){return He.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):QCe(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,s):this.getDocumentsMatchingCollectionQuery(t,n,i,s)}getNextDocuments(t,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,s-r.size):oe.resolve(cu());let a=vp,l=r;return o.next(c=>oe.forEach(c,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),r.get(d)?oe.resolve():this.remoteDocumentCache.getEntry(t,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,At())).next(d=>({batchId:a,changes:ixe(d)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new He(n)).next(i=>{let s=C1();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,i,s){const r=n.collectionGroup;let o=C1();return this.indexManager.getCollectionParents(t,r).next(a=>oe.forEach(a,l=>{const c=function(u,f){return new o8(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,l.child(r));return this.getDocumentsMatchingCollectionQuery(t,c,i,s).next(d=>{d.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,r,s))).next(o=>{r.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Ai.newInvalidDocument(d)))});let a=C1();return o.forEach((l,c)=>{const d=r.get(l);d!==void 0&&p0(d.mutation,c,Xr.empty(),Di.now()),l8(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kxe{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return oe.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Tl(s.createTime)}}(n)),oe.resolve()}getNamedQuery(t,n){return oe.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(s){return{name:s.name,query:Fxe(s.bundledQuery),readTime:Tl(s.readTime)}}(n)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zxe{constructor(){this.overlays=new Xn(He.comparator),this.Rr=new Map}getOverlay(t,n){return oe.resolve(this.overlays.get(n))}getOverlays(t,n){const i=cu();return oe.forEach(n,s=>this.getOverlay(t,s).next(r=>{r!==null&&i.set(s,r)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((s,r)=>{this.Et(t,n,r)}),oe.resolve()}removeOverlaysForBatchId(t,n,i){const s=this.Rr.get(i);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(i)),oe.resolve()}getOverlaysForCollection(t,n,i){const s=cu(),r=n.length+1,o=new He(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return oe.resolve(s)}getOverlaysForCollectionGroup(t,n,i,s){let r=new Xn((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let d=r.get(c.largestBatchId);d===null&&(d=cu(),r=r.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=cu(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return oe.resolve(a)}Et(t,n,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Rr.get(s.largestBatchId).delete(i.key);this.Rr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new gxe(n,i));let r=this.Rr.get(n);r===void 0&&(r=At(),this.Rr.set(n,r)),this.Rr.set(n,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qxe{constructor(){this.sessionToken=Zi.EMPTY_BYTE_STRING}getSessionToken(t){return oe.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(){this.Vr=new Ui(Si.mr),this.gr=new Ui(Si.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new Si(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new Si(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new He(new pn([])),i=new Si(n,t),s=new Si(n,t+1),r=[];return this.gr.forEachInRange([i,s],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new He(new pn([])),i=new Si(n,t),s=new Si(n,t+1);let r=At();return this.gr.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(t){const n=new Si(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class Si{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return He.comparator(t.key,n.key)||yt(t.Cr,n.Cr)}static pr(t,n){return yt(t.Cr,n.Cr)||He.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qxe{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new Ui(Si.mr)}checkEmpty(t){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,s){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new hxe(r,n,i,s);this.mutationQueue.push(o);for(const a of s)this.Mr=this.Mr.add(new Si(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return oe.resolve(o)}lookupMutationBatch(t,n){return oe.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,s=this.Nr(i),r=s<0?0:s;return oe.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?RCe:this.Fr-1)}getAllMutationBatches(t){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new Si(n,0),s=new Si(n,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([i,s],o=>{const a=this.Or(o.Cr);r.push(a)}),oe.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new Ui(yt);return n.forEach(s=>{const r=new Si(s,0),o=new Si(s,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],a=>{i=i.add(a.Cr)})}),oe.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,s=i.length+1;let r=i;He.isDocumentKey(r)||(r=r.child(""));const o=new Si(new He(r),0);let a=new Ui(yt);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Cr)),!0)},o),oe.resolve(this.Br(a))}Br(t){const n=[];return t.forEach(i=>{const s=this.Or(i);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){Zt(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return oe.forEach(n.mutations,s=>{const r=new Si(s.key,n.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new Si(n,0),s=this.Mr.firstAfterOrEqual(i);return oe.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,oe.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jxe{constructor(t){this.kr=t,this.docs=function(){return new Xn(He.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,s=this.docs.get(i),r=s?s.size:0,o=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return oe.resolve(i?i.document.mutableCopy():Ai.newInvalidDocument(n))}getEntries(t,n){let i=Ed();return n.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():Ai.newInvalidDocument(s))}),oe.resolve(i)}getDocumentsMatchingQuery(t,n,i,s){let r=Ed();const o=n.path,a=new He(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||xCe(CCe(d),i)<=0||(s.has(d.key)||l8(n,d))&&(r=r.insert(d.key,d.mutableCopy()))}return oe.resolve(r)}getAllFromCollectionGroup(t,n,i,s){ze()}qr(t,n){return oe.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new eAe(this)}getSize(t){return oe.resolve(this.size)}}class eAe extends jxe{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?n.push(this.Ir.addEntry(t,s)):this.Ir.removeEntry(i)}),oe.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tAe{constructor(t){this.persistence=t,this.Qr=new bf(n=>HS(n),VS),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.$r=0,this.Kr=new WS,this.targetCount=0,this.Ur=Dg.Kn()}forEachTarget(t,n){return this.Qr.forEach((i,s)=>n(s)),oe.resolve()}getLastRemoteSnapshotVersion(t){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return oe.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Ur.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),oe.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Ur=new Dg(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,oe.resolve()}updateTargetData(t,n){return this.zn(n),oe.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Kr.br(n.targetId),this.targetCount-=1,oe.resolve()}removeTargets(t,n,i){let s=0;const r=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),oe.waitFor(r).next(()=>s)}getTargetCount(t){return oe.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return oe.resolve(i)}addMatchingKeys(t,n,i){return this.Kr.yr(n,i),oe.resolve()}removeMatchingKeys(t,n,i){this.Kr.Sr(n,i);const s=this.persistence.referenceDelegate,r=[];return s&&n.forEach(o=>{r.push(s.markPotentiallyOrphaned(t,o))}),oe.waitFor(r)}removeMatchingKeysForTargetId(t,n){return this.Kr.br(n),oe.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Kr.vr(n);return oe.resolve(i)}containsKey(t,n){return oe.resolve(this.Kr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new s8(0),this.zr=!1,this.zr=!0,this.jr=new qxe,this.referenceDelegate=t(this),this.Hr=new tAe(this),this.indexManager=new Bxe,this.remoteDocumentCache=function(s){return new Jxe(s)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new Oxe(n),this.Yr=new Kxe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Zxe,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new Qxe(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){Ie("MemoryPersistence","Starting transaction:",t);const s=new nAe(this.Gr.next());return this.referenceDelegate.Zr(),i(s).next(r=>this.referenceDelegate.Xr(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}ei(t,n){return oe.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class nAe extends MCe{constructor(t){super(),this.currentSequenceNumber=t}}class KS{constructor(t){this.persistence=t,this.ti=new WS,this.ni=null}static ri(t){return new KS(t)}get ii(){if(this.ni)return this.ni;throw ze()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),oe.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),oe.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(s=>this.ii.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(r=>this.ii.add(r.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.ii,i=>{const s=He.fromPath(i);return this.si(t,s).next(r=>{r||n.removeEntry(s,Ge.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return oe.or([()=>oe.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class ly{constructor(t,n){this.persistence=t,this.oi=new bf(i=>LCe(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=Xxe(this,n)}static ri(t,n){return new ly(t,n)}Zr(){}Xr(t){return oe.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(s=>i+s))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return oe.forEach(this.oi,(i,s)=>this.ar(t,i,s).next(r=>r?oe.resolve():n(s)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.qr(t,o=>this.ar(t,o,n).next(a=>{a||(i++,r.removeEntry(o,Ge.min()))})).next(()=>r.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),oe.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),oe.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),oe.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),oe.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Wb(t.data.value)),n}ar(t,n,i){return oe.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const s=this.oi.get(n);return oe.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(t,n,i,s){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=s}static Yi(t,n){let i=At(),s=At();for(const r of n.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new ZS(t,n.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iAe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sAe{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return nSe()?8:kCe(eSe())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,s){const r={result:null};return this.rs(t,n).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(t,n,s,i).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new iAe;return this._s(t,n,o).next(a=>{if(r.result=a,this.Xi)return this.us(t,n,o,a.size)})}).next(()=>r.result)}us(t,n,i,s){return i.documentReadCount<this.es?(Gf()<=bt.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",Xf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),oe.resolve()):(Gf()<=bt.DEBUG&&Ie("QueryEngine","Query:",Xf(n),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ts*s?(Gf()<=bt.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",Xf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ma(n))):oe.resolve())}rs(t,n){if(nN(n))return oe.resolve(null);let i=ma(n);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=lw(n,null,"F"),i=ma(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(r=>{const o=At(...r);return this.ns.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.cs(n,a);return this.ls(n,c,o,l.readTime)?this.rs(t,lw(n,null,"F")):this.hs(t,c,n,l)}))})))}ss(t,n,i,s){return nN(n)||s.isEqual(Ge.min())?oe.resolve(null):this.ns.getDocuments(t,i).next(r=>{const o=this.cs(n,r);return this.ls(n,o,i,s)?oe.resolve(null):(Gf()<=bt.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xf(n)),this.hs(t,o,n,SCe(s,vp)).next(a=>a))})}cs(t,n){let i=new Ui(KZ(t));return n.forEach((s,r)=>{l8(t,r)&&(i=i.add(r))}),i}ls(t,n,i,s){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const r=t.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}_s(t,n,i){return Gf()<=bt.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",Xf(n)),this.ns.getDocumentsMatchingQuery(t,n,pd.min(),i)}hs(t,n,i,s){return this.ns.getDocumentsMatchingQuery(t,i,s).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS="LocalStore",rAe=3e8;class oAe{constructor(t,n,i,s){this.persistence=t,this.Ps=n,this.serializer=s,this.Ts=new Xn(yt),this.Is=new bf(r=>HS(r),VS),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Wxe(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function aAe(e,t,n,i){return new oAe(e,t,n,i)}async function Uq(e,t){const n=ft(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next(r=>(s=r,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=At();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of r){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(i,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function bq(e){const t=ft(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function lAe(e,t){const n=ft(e),i=t.snapshotVersion;let s=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});s=n.Ts;const a=[];t.targetChanges.forEach((d,u)=>{const f=s.get(u);if(!f)return;a.push(n.Hr.removeMatchingKeys(r,d.removedDocuments,u).next(()=>n.Hr.addMatchingKeys(r,d.addedDocuments,u)));let h=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(u)!==null?h=h.withResumeToken(Zi.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,i)),s=s.insert(u,h),function(p,U,b){return p.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=rAe?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(f,h,d)&&a.push(n.Hr.updateTargetData(r,h))});let l=Ed(),c=At();if(t.documentUpdates.forEach(d=>{t.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(r,d))}),a.push(cAe(r,o,t.documentUpdates).next(d=>{l=d.Vs,c=d.fs})),!i.isEqual(Ge.min())){const d=n.Hr.getLastRemoteSnapshotVersion(r).next(u=>n.Hr.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(d)}return oe.waitFor(a).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(n.Ts=s,r))}function cAe(e,t,n){let i=At(),s=At();return n.forEach(r=>i=i.add(r)),t.getEntries(e,i).next(r=>{let o=Ed();return n.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Ge.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):Ie(qS,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:s}})}function dAe(e,t){const n=ft(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return n.Hr.getTargetData(i,t).next(r=>r?(s=r,oe.resolve(s)):n.Hr.allocateTargetId(i).next(o=>(s=new xc(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=n.Ts.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function uw(e,t,n){const i=ft(e),s=i.Ts.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!am(o))throw o;Ie(qS,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ts=i.Ts.remove(t),i.Is.delete(s.target)}function pN(e,t,n){const i=ft(e);let s=Ge.min(),r=At();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const u=ft(l),f=u.Is.get(d);return f!==void 0?oe.resolve(u.Ts.get(f)):u.Hr.getTargetData(c,d)}(i,o,ma(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i.Ps.getDocumentsMatchingQuery(o,t,n?s:Ge.min(),n?r:At())).next(a=>(uAe(i,exe(t),a),{documents:a,gs:r})))}function uAe(e,t,n){let i=e.Es.get(t)||Ge.min();n.forEach((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),e.Es.set(t,i)}class UN{constructor(){this.activeTargetIds=oxe()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class fAe{constructor(){this.ho=new UN,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new UN,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hAe{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN="ConnectivityMonitor";class yN{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ie(bN,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){Ie(bN,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nb=null;function fw(){return nb===null?nb=function(){return 268435456+Math.round(2147483648*Math.random())}():nb++,"0x"+nb.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="RestConnection",gAe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class mAe{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${s}`,this.wo=this.databaseId.database===ey?`project_id=${i}`:`project_id=${i}&database_id=${s}`}So(t,n,i,s,r){const o=fw(),a=this.bo(t,n.toUriEncodedString());Ie(rv,`Sending RPC '${t}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,s,r),this.vo(t,a,l,i).then(c=>(Ie(rv,`Received RPC '${t}' ${o}: `,c),c),c=>{throw Ag(rv,`RPC '${t}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}Co(t,n,i,s,r,o){return this.So(t,n,i,s,r)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+om}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,r)=>t[r]=s),i&&i.headers.forEach((s,r)=>t[r]=s)}bo(t,n){const i=gAe[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pAe{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Ko(t){this.ko(t)}Uo(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="WebChannelConnection";class UAe extends mAe{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,s){const r=fw();return new Promise((o,a)=>{const l=new SZ;l.setWithCredentials(!0),l.listenOnce(CZ.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Yb.NO_ERROR:const d=l.getResponseJson();Ie(ns,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(d)),o(d);break;case Yb.TIMEOUT:Ie(ns,`RPC '${t}' ${r} timed out`),a(new Le(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Yb.HTTP_ERROR:const u=l.getStatus();if(Ie(ns,`RPC '${t}' ${r} failed with status:`,u,"response text:",l.getResponseText()),u>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(U){const b=U.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(b)>=0?b:ce.UNKNOWN}(h.status);a(new Le(m,h.message))}else a(new Le(ce.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Le(ce.UNAVAILABLE,"Connection failed."));break;default:ze()}}finally{Ie(ns,`RPC '${t}' ${r} completed.`)}});const c=JSON.stringify(s);Ie(ns,`RPC '${t}' ${r} sending request:`,s),l.send(n,"POST",c,i,15)})}Wo(t,n,i){const s=fw(),r=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=MZ(),a=AZ(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const d=r.join("");Ie(ns,`Creating RPC '${t}' stream ${s}: ${d}`,l);const u=o.createWebChannel(d,l);let f=!1,h=!1;const m=new pAe({Fo:U=>{h?Ie(ns,`Not sending because RPC '${t}' stream ${s} is closed:`,U):(f||(Ie(ns,`Opening RPC '${t}' stream ${s} transport.`),u.open(),f=!0),Ie(ns,`RPC '${t}' stream ${s} sending:`,U),u.send(U))},Mo:()=>u.close()}),p=(U,b,y)=>{U.listen(b,E=>{try{y(E)}catch(_){setTimeout(()=>{throw _},0)}})};return p(u,S1.EventType.OPEN,()=>{h||(Ie(ns,`RPC '${t}' stream ${s} transport opened.`),m.Qo())}),p(u,S1.EventType.CLOSE,()=>{h||(h=!0,Ie(ns,`RPC '${t}' stream ${s} transport closed`),m.Ko())}),p(u,S1.EventType.ERROR,U=>{h||(h=!0,Ag(ns,`RPC '${t}' stream ${s} transport errored:`,U),m.Ko(new Le(ce.UNAVAILABLE,"The operation could not be completed")))}),p(u,S1.EventType.MESSAGE,U=>{var b;if(!h){const y=U.data[0];Zt(!!y);const E=y,_=(E==null?void 0:E.error)||((b=E[0])===null||b===void 0?void 0:b.error);if(_){Ie(ns,`RPC '${t}' stream ${s} received error:`,_);const I=_.status;let k=function(A){const S=Kn[A];if(S!==void 0)return rq(S)}(I),w=_.message;k===void 0&&(k=ce.INTERNAL,w="Unknown error status: "+I+" with message "+_.message),h=!0,m.Ko(new Le(k,w)),u.close()}else Ie(ns,`RPC '${t}' stream ${s} received:`,y),m.Uo(y)}}),p(a,xZ.STAT_EVENT,U=>{U.stat===iw.PROXY?Ie(ns,`RPC '${t}' stream ${s} detected buffering proxy`):U.stat===iw.NOPROXY&&Ie(ns,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.$o()},0),m}}function ov(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f8(e){return new wxe(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(t,n,i=1e3,s=1.5,r=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=s,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),s=Math.max(0,n-i);s>0&&Ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,s,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="PersistentStream";class bAe{constructor(t,n,i,s,r,o,a,l){this.Ti=t,this.n_=i,this.r_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new QS(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===ce.RESOURCE_EXHAUSTED?(Bl(n.toString()),Bl("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.i_===n&&this.V_(i,s)},i=>{t(()=>{const s=new Le(ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(s)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(s=>{i(()=>this.m_(s))}),this.stream.onMessage(s=>{i(()=>++this.__==1?this.g_(s):this.onNext(s))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return Ie(EN,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(Ie(EN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yAe extends bAe{constructor(t,n,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,o),this.serializer=r}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=Cxe(this.serializer,t),i=function(r){if(!("targetChange"in r))return Ge.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?Ge.min():o.readTime?Tl(o.readTime):Ge.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=uN(this.serializer),n.addTarget=function(r,o){let a;const l=o.target;if(a=aw(l)?{documents:Axe(r,l)}:{query:Mxe(r,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=lq(r,o.resumeToken);const c=cw(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ge.min())>0){a.readTime=oy(r,o.snapshotVersion.toTimestamp());const c=cw(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const i=Rxe(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=uN(this.serializer),n.removeTarget=t,this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EAe{}class vAe extends EAe{constructor(t,n,i,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=s,this.F_=!1}M_(){if(this.F_)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.So(t,dw(n,i),s,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Le(ce.UNKNOWN,r.toString())})}Co(t,n,i,s,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(t,dw(n,i),s,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Le(ce.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class _Ae{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Bl(n),this.N_=!1):Ie("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="RemoteStore";class wAe{constructor(t,n,i,s,r){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{i.enqueueAndForget(async()=>{R2(this)&&(Ie(Lg,"Restarting streams for network reachability change."),await async function(l){const c=ft(l);c.W_.add(4),await k2(c),c.j_.set("Unknown"),c.W_.delete(4),await h8(c)}(this))})}),this.j_=new _Ae(i,s)}}async function h8(e){if(R2(e))for(const t of e.G_)await t(!0)}async function k2(e){for(const t of e.G_)await t(!1)}function yq(e,t){const n=ft(e);n.U_.has(t.targetId)||(n.U_.set(t.targetId,t),nC(n)?tC(n):lm(n).c_()&&eC(n,t))}function JS(e,t){const n=ft(e),i=lm(n);n.U_.delete(t),i.c_()&&Eq(n,t),n.U_.size===0&&(i.c_()?i.P_():R2(n)&&n.j_.set("Unknown"))}function eC(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ge.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}lm(e).y_(t)}function Eq(e,t){e.H_.Ne(t),lm(e).w_(t)}function tC(e){e.H_=new yxe({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.U_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),lm(e).start(),e.j_.B_()}function nC(e){return R2(e)&&!lm(e).u_()&&e.U_.size>0}function R2(e){return ft(e).W_.size===0}function vq(e){e.H_=void 0}async function TAe(e){e.j_.set("Online")}async function IAe(e){e.U_.forEach((t,n)=>{eC(e,t)})}async function SAe(e,t){vq(e),nC(e)?(e.j_.q_(t),tC(e)):e.j_.set("Unknown")}async function CAe(e,t,n){if(e.j_.set("Online"),t instanceof aq&&t.state===2&&t.cause)try{await async function(s,r){const o=r.cause;for(const a of r.targetIds)s.U_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.U_.delete(a),s.H_.removeTarget(a))}(e,t)}catch(i){Ie(Lg,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await vN(e,i)}else if(t instanceof Zb?e.H_.We(t):t instanceof oq?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Ge.min()))try{const i=await bq(e.localStore);n.compareTo(i)>=0&&await function(r,o){const a=r.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=r.U_.get(c);d&&r.U_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=r.U_.get(l);if(!d)return;r.U_.set(l,d.withResumeToken(Zi.EMPTY_BYTE_STRING,d.snapshotVersion)),Eq(r,l);const u=new xc(d.target,l,c,d.sequenceNumber);eC(r,u)}),r.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){Ie(Lg,"Failed to raise snapshot:",i),await vN(e,i)}}async function vN(e,t,n){if(!am(t))throw t;e.W_.add(1),await k2(e),e.j_.set("Offline"),n||(n=()=>bq(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ie(Lg,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await h8(e)})}async function _N(e,t){const n=ft(e);n.asyncQueue.verifyOperationInProgress(),Ie(Lg,"RemoteStore received new credentials");const i=R2(n);n.W_.add(3),await k2(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await h8(n)}async function xAe(e,t){const n=ft(e);t?(n.W_.delete(2),await h8(n)):t||(n.W_.add(2),await k2(n),n.j_.set("Unknown"))}function lm(e){return e.J_||(e.J_=function(n,i,s){const r=ft(n);return r.M_(),new yAe(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(e.datastore,e.asyncQueue,{xo:TAe.bind(null,e),No:IAe.bind(null,e),Lo:SAe.bind(null,e),p_:CAe.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),nC(e)?tC(e):e.j_.set("Unknown")):(await e.J_.stop(),vq(e))})),e.J_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(t,n,i,s,r){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new Qc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,s,r){const o=Date.now()+i,a=new iC(t,n,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Le(ce.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _q(e,t){if(Bl("AsyncQueue",`${t}: ${e}`),am(e))return new Le(ce.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{static emptySet(t){return new Xh(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||He.comparator(n.key,i.key):(n,i)=>He.comparator(n.key,i.key),this.keyedMap=C1(),this.sortedSet=new Xn(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Xh)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Xh;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(){this.Z_=new Xn(He.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):ze():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class Pg{constructor(t,n,i,s,r,o,a,l,c){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,i,s,r){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Pg(t,n,Xh.emptySet(n),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&a8(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AAe{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class MAe{constructor(){this.queries=TN(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const s=ft(n),r=s.queries;s.queries=TN(),r.forEach((o,a)=>{for(const l of a.ta)l.onError(i)})})(this,new Le(ce.ABORTED,"Firestore shutting down"))}}function TN(){return new bf(e=>WZ(e),a8)}async function kAe(e,t){const n=ft(e);let i=3;const s=t.query;let r=n.queries.get(s);r?!r.na()&&t.ra()&&(i=2):(r=new AAe,i=t.ra()?0:1);try{switch(i){case 0:r.ea=await n.onListen(s,!0);break;case 1:r.ea=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=_q(o,`Initialization of query '${Xf(t.query)}' failed`);return void t.onError(a)}n.queries.set(s,r),r.ta.push(t),t.sa(n.onlineState),r.ea&&t.oa(r.ea)&&sC(n)}async function RAe(e,t){const n=ft(e),i=t.query;let s=3;const r=n.queries.get(i);if(r){const o=r.ta.indexOf(t);o>=0&&(r.ta.splice(o,1),r.ta.length===0?s=t.ra()?0:1:!r.na()&&t.ra()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function DAe(e,t){const n=ft(e);let i=!1;for(const s of t){const r=s.query,o=n.queries.get(r);if(o){for(const a of o.ta)a.oa(s)&&(i=!0);o.ea=s}}i&&sC(n)}function LAe(e,t,n){const i=ft(e),s=i.queries.get(t);if(s)for(const r of s.ta)r.onError(n);i.queries.delete(t)}function sC(e){e.ia.forEach(t=>{t.next()})}var hw,IN;(IN=hw||(hw={}))._a="default",IN.Cache="cache";class PAe{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Pg(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=Pg.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==hw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(t){this.key=t}}class Tq{constructor(t){this.key=t}}class NAe{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=At(),this.mutatedKeys=At(),this.ya=KZ(t),this.wa=new Xh(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new wN,s=n?n.wa:this.wa;let r=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((d,u)=>{const f=s.get(d),h=l8(this.query,u)?u:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let U=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(i.track({type:3,doc:h}),U=!0):this.va(f,h)||(i.track({type:2,doc:h}),U=!0,(l&&this.ya(h,l)>0||c&&this.ya(h,c)<0)&&(a=!0)):!f&&h?(i.track({type:0,doc:h}),U=!0):f&&!h&&(i.track({type:1,doc:f}),U=!0,(l||c)&&(a=!0)),U&&(h?(o=o.add(h),r=p?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),i.track({type:1,doc:d})}return{wa:o,Da:i,ls:a,mutatedKeys:r}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,s){const r=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const o=t.Da.X_();o.sort((d,u)=>function(h,m){const p=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze()}};return p(h)-p(m)}(d.type,u.type)||this.ya(d.doc,u.doc)),this.Ca(i),s=s!=null&&s;const a=n&&!s?this.Fa():[],l=this.pa.size===0&&this.current&&!s?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new Pg(this.query,t.wa,r,o,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new wN,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=At(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new Tq(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new wq(i))}),n}Oa(t){this.fa=t.gs,this.pa=At();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return Pg.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const rC="SyncEngine";class OAe{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class FAe{constructor(t){this.key=t,this.Ba=!1}}class BAe{constructor(t,n,i,s,r,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new bf(a=>WZ(a),a8),this.qa=new Map,this.Qa=new Set,this.$a=new Xn(He.comparator),this.Ka=new Map,this.Ua=new WS,this.Wa={},this.Ga=new Map,this.za=Dg.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function zAe(e,t,n=!0){const i=Aq(e);let s;const r=i.ka.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.Na()):s=await Iq(i,t,n,!0),s}async function HAe(e,t){const n=Aq(e);await Iq(n,t,!0,!1)}async function Iq(e,t,n,i){const s=await dAe(e.localStore,ma(t)),r=s.targetId,o=e.sharedClientState.addLocalQueryTarget(r,n);let a;return i&&(a=await VAe(e,t,r,o==="current",s.resumeToken)),e.isPrimaryClient&&n&&yq(e.remoteStore,s),a}async function VAe(e,t,n,i,s){e.Ha=(u,f,h)=>async function(p,U,b,y){let E=U.view.ba(b);E.ls&&(E=await pN(p.localStore,U.query,!1).then(({documents:w})=>U.view.ba(w,E)));const _=y&&y.targetChanges.get(U.targetId),I=y&&y.targetMismatches.get(U.targetId)!=null,k=U.view.applyChanges(E,p.isPrimaryClient,_,I);return CN(p,U.targetId,k.Ma),k.snapshot}(e,u,f,h);const r=await pN(e.localStore,t,!0),o=new NAe(t,r.gs),a=o.ba(r.documents),l=M2.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",s),c=o.applyChanges(a,e.isPrimaryClient,l);CN(e,n,c.Ma);const d=new OAe(t,n,o);return e.ka.set(t,d),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function $Ae(e,t,n){const i=ft(e),s=i.ka.get(t),r=i.qa.get(s.targetId);if(r.length>1)return i.qa.set(s.targetId,r.filter(o=>!a8(o,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await uw(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),n&&JS(i.remoteStore,s.targetId),gw(i,s.targetId)}).catch(i8)):(gw(i,s.targetId),await uw(i.localStore,s.targetId,!0))}async function GAe(e,t){const n=ft(e),i=n.ka.get(t),s=n.qa.get(i.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),JS(n.remoteStore,i.targetId))}async function Sq(e,t){const n=ft(e);try{const i=await lAe(n.localStore,t);t.targetChanges.forEach((s,r)=>{const o=n.Ka.get(r);o&&(Zt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ba=!0:s.modifiedDocuments.size>0?Zt(o.Ba):s.removedDocuments.size>0&&(Zt(o.Ba),o.Ba=!1))}),await xq(n,i,t)}catch(i){await i8(i)}}function SN(e,t,n){const i=ft(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.ka.forEach((r,o)=>{const a=o.view.sa(t);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ft(o);l.onlineState=a;let c=!1;l.queries.forEach((d,u)=>{for(const f of u.ta)f.sa(a)&&(c=!0)}),c&&sC(l)}(i.eventManager,t),s.length&&i.La.p_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function XAe(e,t,n){const i=ft(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.Ka.get(t),r=s&&s.key;if(r){let o=new Xn(He.comparator);o=o.insert(r,Ai.newNoDocument(r,Ge.min()));const a=At().add(r),l=new u8(Ge.min(),new Map,new Xn(yt),o,a);await Sq(i,l),i.$a=i.$a.remove(r),i.Ka.delete(t),oC(i)}else await uw(i.localStore,t,!1).then(()=>gw(i,t,n)).catch(i8)}function gw(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ua.br(t).forEach(i=>{e.Ua.containsKey(i)||Cq(e,i)})}function Cq(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(JS(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ka.delete(n),oC(e))}function CN(e,t,n){for(const i of n)i instanceof wq?(e.Ua.addReference(i.key,t),jAe(e,i)):i instanceof Tq?(Ie(rC,"Document no longer in limbo: "+i.key),e.Ua.removeReference(i.key,t),e.Ua.containsKey(i.key)||Cq(e,i.key)):ze()}function jAe(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(Ie(rC,"New document in limbo: "+n),e.Qa.add(i),oC(e))}function oC(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new He(pn.fromString(t)),i=e.za.next();e.Ka.set(i,new FAe(n)),e.$a=e.$a.insert(n,i),yq(e.remoteStore,new xc(ma($S(n.path)),i,"TargetPurposeLimboResolution",s8.ae))}}async function xq(e,t,n){const i=ft(e),s=[],r=[],o=[];i.ka.isEmpty()||(i.ka.forEach((a,l)=>{o.push(i.Ha(l,t,n).then(c=>{var d;if((c||n)&&i.isPrimaryClient){const u=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=ZS.Yi(l.targetId,c);r.push(u)}}))}),await Promise.all(o),i.La.p_(s),await async function(l,c){const d=ft(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>oe.forEach(c,f=>oe.forEach(f.Hi,h=>d.persistence.referenceDelegate.addReference(u,f.targetId,h)).next(()=>oe.forEach(f.Ji,h=>d.persistence.referenceDelegate.removeReference(u,f.targetId,h)))))}catch(u){if(!am(u))throw u;Ie(qS,"Failed to update sequence numbers: "+u)}for(const u of c){const f=u.targetId;if(!u.fromCache){const h=d.Ts.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.Ts=d.Ts.insert(f,p)}}}(i.localStore,r))}async function YAe(e,t){const n=ft(e);if(!n.currentUser.isEqual(t)){Ie(rC,"User change. New user:",t.toKey());const i=await Uq(n.localStore,t);n.currentUser=t,function(r,o){r.Ga.forEach(a=>{a.forEach(l=>{l.reject(new Le(ce.CANCELLED,o))})}),r.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await xq(n,i.Rs)}}function WAe(e,t){const n=ft(e),i=n.Ka.get(t);if(i&&i.Ba)return At().add(i.key);{let s=At();const r=n.qa.get(t);if(!r)return s;for(const o of r){const a=n.ka.get(o);s=s.unionWith(a.view.Sa)}return s}}function Aq(e){const t=ft(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Sq.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=WAe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=XAe.bind(null,t),t.La.p_=DAe.bind(null,t.eventManager),t.La.Ja=LAe.bind(null,t.eventManager),t}class cy{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=f8(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return aAe(this.persistence,new sAe,t.initialUser,this.serializer)}Xa(t){return new pq(KS.ri,this.serializer)}Za(t){return new fAe}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cy.provider={build:()=>new cy};class KAe extends cy{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){Zt(this.persistence.referenceDelegate instanceof ly);const i=this.persistence.referenceDelegate.garbageCollector;return new $xe(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?Os.withCacheSize(this.cacheSizeBytes):Os.DEFAULT;return new pq(i=>ly.ri(i,n),this.serializer)}}class mw{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>SN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=YAe.bind(null,this.syncEngine),await xAe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new MAe}()}createDatastore(t){const n=f8(t.databaseInfo.databaseId),i=function(r){return new UAe(r)}(t.databaseInfo);return function(r,o,a,l){return new vAe(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,s,r,o,a){return new wAe(i,s,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>SN(this.syncEngine,n,0),function(){return yN.D()?new yN:new hAe}())}createSyncEngine(t,n){return function(s,r,o,a,l,c,d){const u=new BAe(s,r,o,a,l,c);return d&&(u.ja=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(s){const r=ft(s);Ie(Lg,"RemoteStore shutting down."),r.W_.add(5),await k2(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}mw.provider={build:()=>new mw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZAe{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):Bl("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qAe{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Le(ce.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,r){const o=ft(s),a={documents:r.map(u=>ay(o.serializer,u))},l=await o.Co("BatchGetDocuments",o.serializer.databaseId,pn.emptyPath(),a,r.length),c=new Map;l.forEach(u=>{const f=Sxe(o.serializer,u);c.set(f.key.toString(),f)});const d=[];return r.forEach(u=>{const f=c.get(u.toString());Zt(!!f),d.push(f)}),d}(this.datastore,t);return n.forEach(i=>this.recordVersion(i)),n}set(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new XS(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,i)=>{const s=He.fromPath(i);this.mutations.push(new sq(s,this.precondition(s)))}),await async function(i,s){const r=ft(i),o={writes:s.map(a=>xxe(r.serializer,a))};await r.So("Commit",r.serializer.databaseId,pn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw ze();n=Ge.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!n.isEqual(i))throw new Le(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)}precondition(t){const n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?n.isEqual(Ge.min())?Hr.exists(!1):Hr.updateTime(n):Hr.none()}preconditionForUpdate(t){const n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(Ge.min()))throw new Le(ce.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Hr.updateTime(n)}return Hr.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QAe{constructor(t,n,i,s,r){this.asyncQueue=t,this.datastore=n,this.options=i,this.updateFunction=s,this.deferred=r,this.Tu=i.maxAttempts,this.a_=new QS(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(async()=>{const t=new qAe(this.datastore),n=this.du(t);n&&n.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(s=>{this.Au(s)}))}).catch(i=>{this.Au(i)})})}du(t){try{const n=this.updateFunction(t);return!x2(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Au(t){this.Tu>0&&this.Ru(t)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(t)}Ru(t){if(t.name==="FirebaseError"){const n=t.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!pxe(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd="FirestoreClient";class JAe{constructor(t,n,i,s,r){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=s,this.user=ss.UNAUTHENTICATED,this.clientId=RZ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,async o=>{Ie(vd,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(Ie(vd,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Qc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=_q(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function av(e,t){e.asyncQueue.verifyOperationInProgress(),Ie(vd,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async s=>{i.isEqual(s)||(await Uq(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function xN(e,t){e.asyncQueue.verifyOperationInProgress();const n=await eMe(e);Ie(vd,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>_N(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>_N(t.remoteStore,s)),e._onlineComponents=t}async function eMe(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ie(vd,"Using user provided OfflineComponentProvider");try{await av(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(s){return s.name==="FirebaseError"?s.code===ce.FAILED_PRECONDITION||s.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ag("Error using user provided cache. Falling back to memory cache: "+n),await av(e,new cy)}}else Ie(vd,"Using default OfflineComponentProvider"),await av(e,new KAe(void 0));return e._offlineComponents}async function Mq(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ie(vd,"Using user provided OnlineComponentProvider"),await xN(e,e._uninitializedComponentsProvider._online)):(Ie(vd,"Using default OnlineComponentProvider"),await xN(e,new mw))),e._onlineComponents}function tMe(e){return Mq(e).then(t=>t.datastore)}async function nMe(e){const t=await Mq(e),n=t.eventManager;return n.onListen=zAe.bind(null,t.syncEngine),n.onUnlisten=$Ae.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=HAe.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=GAe.bind(null,t.syncEngine),n}function iMe(e,t,n={}){const i=new Qc;return e.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const d=new ZAe({next:f=>{d.su(),o.enqueueAndForget(()=>RAe(r,u));const h=f.docs.has(a);!h&&f.fromCache?c.reject(new Le(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&l&&l.source==="server"?c.reject(new Le(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),u=new PAe($S(a.path),d,{includeMetadataChanges:!0,Ta:!0});return kAe(r,u)}(await nMe(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kq(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sMe(e,t,n){if(!n)throw new Le(ce.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function rMe(e,t,n,i){if(t===!0&&i===!0)throw new Le(ce.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function MN(e){if(!He.isDocumentKey(e))throw new Le(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function aC(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":ze()}function dy(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Le(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=aC(e);throw new Le(ce.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rq="firestore.googleapis.com",kN=!0;class RN{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Le(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rq,this.ssl=kN}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:kN;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=mq;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Hxe)throw new Le(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}rMe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kq((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class lC{constructor(t,n,i,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RN({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Le(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Le(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RN(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new bCe;switch(i.type){case"firstParty":return new _Ce(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Le(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=AN.get(n);i&&(Ie("ComponentProvider","Removing Datastore"),AN.delete(n),i.terminate())}(this),Promise.resolve()}}function oMe(e,t,n,i={}){var s;const r=(e=dy(e,lC))._getSettings(),o=`${t}:${n}`;if(r.host!==Rq&&r.host!==o&&Ag("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=ss.MOCK_USER;else{a=hZ(i.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Le(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ss(c)}e._authCredentials=new yCe(new kZ(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new cC(this.firestore,t,this._query)}}class Qr{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cp(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Qr(this.firestore,t,this._key)}}class Cp extends cC{constructor(t,n,i){super(t,n,$S(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Qr(this.firestore,null,new He(t))}withConverter(t){return new Cp(this.firestore,t,this._path)}}function Dq(e,t,...n){if(e=Lo(e),arguments.length===1&&(t=RZ.newId()),sMe("doc","path",t),e instanceof lC){const i=pn.fromString(t,...n);return MN(i),new Qr(e,null,new He(i))}{if(!(e instanceof Qr||e instanceof Cp))throw new Le(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(pn.fromString(t,...n));return MN(i),new Qr(e.firestore,e instanceof Cp?e.converter:null,new He(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN="AsyncQueue";class LN{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new QS(this,"async_queue_retry"),this.Su=()=>{const i=ov();i&&Ie(DN,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=ov();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=ov();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Qc;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!am(t))throw t;Ie(DN,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw Bl("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const s=iC.createAndSchedule(this,t,n,i,r=>this.Fu(r));return this.fu.push(s),s}Du(){this.gu&&ze()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}class dC extends lC{constructor(t,n,i,s){super(t,n,i,s),this.type="firestore",this._queue=new LN,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new LN(t),this._firestoreClient=void 0,await t}}}function aMe(e,t){const n=typeof e=="object"?e:_Z(),i=typeof e=="string"?e:ey,s=bZ(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=uZ("firestore");r&&oMe(s,...r)}return s}function Lq(e){if(e._terminated)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||lMe(e),e._firestoreClient}function lMe(e){var t,n,i;const s=e._freezeSettings(),r=function(a,l,c,d){return new OCe(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,kq(d.experimentalLongPollingOptions),d.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new JAe(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new zl(Zi.fromBase64String(t))}catch(n){throw new Le(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new zl(Zi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new Le(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new as(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new Le(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Le(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return yt(this._lat,t._lat)||yt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cMe=/^__.*__$/;class dMe{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new yf(t,this.data,this.fieldMask,n,this.fieldTransforms):new A2(t,this.data,n,this.fieldTransforms)}}class Pq{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new yf(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function Nq(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze()}}class gC{constructor(t,n,i,s,r,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new gC(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.$u(t),s}Ku(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.Bu(),s}Uu(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return uy(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(Nq(this.Lu)&&cMe.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class uMe{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||f8(t)}ju(t,n,i,s=!1){return new gC({Lu:t,methodName:n,zu:i,path:as.emptyPath(),Qu:!1,Gu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fMe(e){const t=e._freezeSettings(),n=f8(e._databaseId);return new uMe(e._databaseId,!!t.ignoreUndefinedProperties,n)}function hMe(e,t,n,i,s,r={}){const o=e.ju(r.merge||r.mergeFields?2:0,t,n,s);mC("Data must be an object, but it was:",o,i);const a=Oq(i,o);let l,c;if(r.merge)l=new Xr(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const u of r.mergeFields){const f=pw(t,u,n);if(!o.contains(f))throw new Le(ce.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Bq(d,f)||d.push(f)}l=new Xr(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new dMe(new Fs(a),l,c)}class m8 extends uC{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof m8}}function gMe(e,t,n,i){const s=e.ju(1,t,n);mC("Data must be an object, but it was:",s,i);const r=[],o=Fs.empty();Uf(i,(l,c)=>{const d=pC(t,l,n);c=Lo(c);const u=s.Ku(d);if(c instanceof m8)r.push(d);else{const f=p8(c,u);f!=null&&(r.push(d),o.set(d,f))}});const a=new Xr(r);return new Pq(o,a,s.fieldTransforms)}function mMe(e,t,n,i,s,r){const o=e.ju(1,t,n),a=[pw(t,i,n)],l=[s];if(r.length%2!=0)throw new Le(ce.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(pw(t,r[f])),l.push(r[f+1]);const c=[],d=Fs.empty();for(let f=a.length-1;f>=0;--f)if(!Bq(c,a[f])){const h=a[f];let m=l[f];m=Lo(m);const p=o.Ku(h);if(m instanceof m8)c.push(h);else{const U=p8(m,p);U!=null&&(c.push(h),d.set(h,U))}}const u=new Xr(c);return new Pq(d,u,o.fieldTransforms)}function p8(e,t){if(Fq(e=Lo(e)))return mC("Unsupported field value:",t,e),Oq(e,t);if(e instanceof uC)return function(i,s){if(!Nq(s.Lu))throw s.Wu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Wu(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,s){const r=[];let o=0;for(const a of i){let l=p8(a,s.Uu(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(e,t)}return function(i,s){if((i=Lo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return axe(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=Di.fromDate(i);return{timestampValue:oy(s.serializer,r)}}if(i instanceof Di){const r=new Di(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:oy(s.serializer,r)}}if(i instanceof fC)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof zl)return{bytesValue:lq(s.serializer,i._byteString)};if(i instanceof Qr){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:YS(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof hC)return function(o,a){return{mapValue:{fields:{[zZ]:{stringValue:HZ},[ty]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return GS(a.serializer,c)})}}}}}}(i,s);throw s.Wu(`Unsupported field value: ${aC(i)}`)}(e,t)}function Oq(e,t){const n={};return LZ(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Uf(e,(i,s)=>{const r=p8(s,t.qu(i));r!=null&&(n[i]=r)}),{mapValue:{fields:n}}}function Fq(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Di||e instanceof fC||e instanceof zl||e instanceof Qr||e instanceof uC||e instanceof hC)}function mC(e,t,n){if(!Fq(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const i=aC(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function pw(e,t,n){if((t=Lo(t))instanceof g8)return t._internalPath;if(typeof t=="string")return pC(e,t);throw uy("Field path arguments must be of type string or ",e,!1,void 0,n)}const pMe=new RegExp("[~\\*/\\[\\]]");function pC(e,t,n){if(t.search(pMe)>=0)throw uy(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new g8(...t.split("."))._internalPath}catch{throw uy(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function uy(e,t,n,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new Le(ce.INVALID_ARGUMENT,a+e+l)}function Bq(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(t,n,i,s,r){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Qr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new UMe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(zq("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class UMe extends fy{data(){return super.data()}}function zq(e,t){return typeof t=="string"?pC(e,t):t instanceof g8?t._internalPath:t._delegate._internalPath}class Hq{convertValue(t,n="none"){switch(yd(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(bd(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw ze()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Uf(t,(s,r)=>{i[s]=this.convertValue(r,n)}),i}convertVectorValue(t){var n,i,s;const r=(s=(i=(n=t.fields)===null||n===void 0?void 0:n[ty].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(o=>Vn(o.doubleValue));return new hC(r)}convertGeoPoint(t){return new fC(Vn(t.latitude),Vn(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=r8(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(_p(t));default:return null}}convertTimestamp(t){const n=Ud(t);return new Di(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=pn.fromString(t);Zt(gq(i));const s=new wp(i.get(1),i.get(3)),r=new He(i.popFirst(5));return s.isEqual(n)||Bl(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bMe(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class yMe extends Hq{constructor(t){super(),this.firestore=t}convertBytes(t){return new zl(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Qr(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class UC extends fy{constructor(t,n,i,s,r,o){super(t,n,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new EMe(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(zq("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class EMe extends UC{data(t={}){return super.data(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vMe(e){e=dy(e,Qr);const t=dy(e.firestore,dC);return iMe(Lq(t),e._key).then(n=>_Me(t,e,n))}class $q extends Hq{constructor(t){super(),this.firestore=t}convertBytes(t){return new zl(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Qr(this.firestore,null,n)}}function _Me(e,t,n){const i=n.docs.get(t._key),s=new $q(e);return new UC(e,s,t._key,i,new Vq(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wMe={maxAttempts:5};function A1(e,t){if((e=Lo(e)).firestore!==t)throw new Le(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TMe{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=fMe(t)}get(t){const n=A1(t,this._firestore),i=new yMe(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return ze();const r=s[0];if(r.isFoundDocument())return new fy(this._firestore,i,r.key,r,n.converter);if(r.isNoDocument())return new fy(this._firestore,i,n._key,null,n.converter);throw ze()})}set(t,n,i){const s=A1(t,this._firestore),r=bMe(s.converter,n,i),o=hMe(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(t,n,i,...s){const r=A1(t,this._firestore);let o;return o=typeof(n=Lo(n))=="string"||n instanceof g8?mMe(this._dataReader,"Transaction.update",r._key,n,i,s):gMe(this._dataReader,"Transaction.update",r._key,n),this._transaction.update(r._key,o),this}delete(t){const n=A1(t,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IMe extends TMe{constructor(t,n){super(t,n),this._firestore=t}get(t){const n=A1(t,this._firestore),i=new $q(this._firestore);return super.get(t).then(s=>new UC(this._firestore,i,n._key,s._document,new Vq(!1,!1),n.converter))}}function SMe(e,t,n){e=dy(e,dC);const i=Object.assign(Object.assign({},wMe),n);return function(r){if(r.maxAttempts<1)throw new Le(ce.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,o,a){const l=new Qc;return r.asyncQueue.enqueueAndForget(async()=>{const c=await tMe(r);new QAe(r.asyncQueue,c,a,o,l).Iu()}),l.promise}(Lq(e),s=>t(new IMe(e,s)),i)}(function(t,n=!0){(function(s){om=s})(EZ),yp(new xg("firestore",(i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new dC(new ECe(i.getProvider("auth-internal")),new wCe(o,i.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Le(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wp(c.options.projectId,d)}(o,s),o);return r=Object.assign({useFetchStreams:n},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Zc(zP,HP,t),Zc(zP,HP,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq="firebasestorage.googleapis.com",Xq="storageBucket",CMe=2*60*1e3,xMe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends pf{constructor(t,n,i=0){super(lv(t),`Firebase Storage: ${n} (${lv(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,li.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return lv(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ai;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ai||(ai={}));function lv(e){return"storage/"+e}function bC(){const e="An unknown error occurred, please check the error payload for server response.";return new li(ai.UNKNOWN,e)}function AMe(e){return new li(ai.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function MMe(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new li(ai.UNAUTHENTICATED,e)}function kMe(){return new li(ai.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function RMe(e){return new li(ai.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function DMe(){return new li(ai.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function LMe(){return new li(ai.CANCELED,"User canceled the upload/download.")}function PMe(e){return new li(ai.INVALID_URL,"Invalid URL '"+e+"'.")}function NMe(e){return new li(ai.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function OMe(){return new li(ai.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Xq+"' property when initializing the app?")}function FMe(){return new li(ai.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function BMe(e){return new li(ai.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Uw(e){return new li(ai.INVALID_ARGUMENT,e)}function jq(){return new li(ai.APP_DELETED,"The Firebase app was deleted.")}function zMe(e){return new li(ai.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b0(e,t){return new li(ai.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function e1(e){throw new li(ai.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=hr.makeFromUrl(t,n)}catch{return new hr(t,"")}if(i.path==="")return i;throw NMe(t)}static makeFromUrl(t,n){let i=null;const s="([A-Za-z0-9.\\-_]+)";function r(_){_.path.charAt(_.path.length-1)==="/"&&(_.path_=_.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(_){_.path_=decodeURIComponent(_.path)}const d="v[A-Za-z0-9_]+",u=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",h=new RegExp(`^https?://${u}/${d}/b/${s}/o${f}`,"i"),m={bucket:1,path:3},p=n===Gq?"(?:storage.googleapis.com|storage.cloud.google.com)":n,U="([^?#]*)",b=new RegExp(`^https?://${p}/${s}/${U}`,"i"),E=[{regex:a,indices:l,postModify:r},{regex:h,indices:m,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let _=0;_<E.length;_++){const I=E[_],k=I.regex.exec(t);if(k){const w=k[I.indices.bucket];let T=k[I.indices.path];T||(T=""),i=new hr(w,T),I.postModify(i);break}}if(i==null)throw PMe(t);return i}}class HMe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VMe(e,t,n){let i=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...U){c||(c=!0,t.apply(null,U))}function u(U){s=setTimeout(()=>{s=null,e(h,l())},U)}function f(){r&&clearTimeout(r)}function h(U,...b){if(c){f();return}if(U){f(),d.call(null,U,...b);return}if(l()||o){f(),d.call(null,U,...b);return}i<64&&(i*=2);let E;a===1?(a=2,E=0):E=(i+Math.random())*1e3,u(E)}let m=!1;function p(U){m||(m=!0,f(),!c&&(s!==null?(U||(a=2),clearTimeout(s),u(0)):U||(a=1)))}return u(0),r=setTimeout(()=>{o=!0,p(!0)},n),p}function $Me(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GMe(e){return e!==void 0}function XMe(e){return typeof e=="object"&&!Array.isArray(e)}function Yq(e){return typeof e=="string"||e instanceof String}function PN(e){return yC()&&e instanceof Blob}function yC(){return typeof Blob<"u"}function NN(e,t,n,i){if(i<t)throw Uw(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw Uw(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jMe(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function YMe(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const s=t(i)+"="+t(e[i]);n=n+s+"&"}return n=n.slice(0,-1),n}var vu;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(vu||(vu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WMe(e,t){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,r=t.indexOf(e)!==-1;return n||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KMe{constructor(t,n,i,s,r,o,a,l,c,d,u,f=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((h,m)=>{this.resolve_=h,this.reject_=m,this.start_()})}start_(){const t=(i,s)=>{if(s){i(!1,new ib(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===vu.NO_ERROR,l=r.getStatus();if(!a||WMe(l,this.additionalRetryCodes_)&&this.retry){const d=r.getErrorCode()===vu.ABORT;i(!1,new ib(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new ib(c,r))})},n=(i,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());GMe(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=bC();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?jq():LMe();o(l)}else{const l=DMe();o(l)}};this.canceled_?n(!1,new ib(!1,null,!0)):this.backoffId_=VMe(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&$Me(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ib{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function ZMe(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function qMe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function QMe(e,t){t&&(e["X-Firebase-GMPID"]=t)}function JMe(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function eke(e,t,n,i,s,r,o=!0){const a=YMe(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return QMe(c,t),ZMe(c,n),qMe(c,r),JMe(c,i),new KMe(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tke(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nke(...e){const t=tke();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(yC())return new Blob(e);throw new li(ai.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ike(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ske(e){if(typeof atob>"u")throw BMe("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class cv{constructor(t,n){this.data=t,this.contentType=n||null}}function rke(e,t){switch(e){case aa.RAW:return new cv(Wq(t));case aa.BASE64:case aa.BASE64URL:return new cv(Kq(e,t));case aa.DATA_URL:return new cv(ake(t),lke(t))}throw bC()}function Wq(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const r=i,o=e.charCodeAt(++n);i=65536|(r&1023)<<10|o&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function oke(e){let t;try{t=decodeURIComponent(e)}catch{throw b0(aa.DATA_URL,"Malformed data URL.")}return Wq(t)}function Kq(e,t){switch(e){case aa.BASE64:{const s=t.indexOf("-")!==-1,r=t.indexOf("_")!==-1;if(s||r)throw b0(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case aa.BASE64URL:{const s=t.indexOf("+")!==-1,r=t.indexOf("/")!==-1;if(s||r)throw b0(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ske(t)}catch(s){throw s.message.includes("polyfill")?s:b0(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}class Zq{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw b0(aa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=cke(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function ake(e){const t=new Zq(e);return t.base64?Kq(aa.BASE64,t.rest):oke(t.rest)}function lke(e){return new Zq(e).contentType}function cke(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(t,n){let i=0,s="";PN(t)?(this.data_=t,i=t.size,s=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,n){if(PN(this.data_)){const i=this.data_,s=ike(i,t,n);return s===null?null:new vc(s)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new vc(i,!0)}}static getBlob(...t){if(yC()){const n=t.map(i=>i instanceof vc?i.data_:i);return new vc(nke.apply(null,n))}else{const n=t.map(o=>Yq(o)?rke(aa.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const s=new Uint8Array(i);let r=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[r++]=o[a]}),new vc(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dke(e){let t;try{t=JSON.parse(e)}catch{return null}return XMe(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uke(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function fke(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function qq(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hke(e,t){return t}class Us{constructor(t,n,i,s){this.server=t,this.local=n||t,this.writable=!!i,this.xform=s||hke}}let sb=null;function gke(e){return!Yq(e)||e.length<2?e:qq(e)}function mke(){if(sb)return sb;const e=[];e.push(new Us("bucket")),e.push(new Us("generation")),e.push(new Us("metageneration")),e.push(new Us("name","fullPath",!0));function t(r,o){return gke(o)}const n=new Us("name");n.xform=t,e.push(n);function i(r,o){return o!==void 0?Number(o):o}const s=new Us("size");return s.xform=i,e.push(s),e.push(new Us("timeCreated")),e.push(new Us("updated")),e.push(new Us("md5Hash",null,!0)),e.push(new Us("cacheControl",null,!0)),e.push(new Us("contentDisposition",null,!0)),e.push(new Us("contentEncoding",null,!0)),e.push(new Us("contentLanguage",null,!0)),e.push(new Us("contentType",null,!0)),e.push(new Us("metadata","customMetadata",!0)),sb=e,sb}function pke(e,t){function n(){const i=e.bucket,s=e.fullPath,r=new hr(i,s);return t._makeStorageReference(r)}Object.defineProperty(e,"ref",{get:n})}function Uke(e,t,n){const i={};i.type="file";const s=n.length;for(let r=0;r<s;r++){const o=n[r];i[o.local]=o.xform(i,t[o.server])}return pke(i,e),i}function bke(e,t,n){const i=dke(t);return i===null?null:Uke(e,i,n)}function yke(e,t){const n={},i=t.length;for(let s=0;s<i;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Eke{constructor(t,n,i,s){this.url=t,this.method=n,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vke(e){if(!e)throw bC()}function _ke(e,t){function n(i,s){const r=bke(e,s,t);return vke(r!==null),r}return n}function wke(e){function t(n,i){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=kMe():s=MMe():n.getStatus()===402?s=AMe(e.bucket):n.getStatus()===403?s=RMe(e.path):s=i,s.status=n.getStatus(),s.serverResponse=i.serverResponse,s}return t}function Tke(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Ike(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=Tke(null,t)),i}function Ske(e,t,n,i,s){const r=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let _=0;_<2;_++)E=E+Math.random().toString().slice(2);return E}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Ike(t,i,s),d=yke(c,n),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",h=vc.getBlob(u,i,f);if(h===null)throw FMe();const m={name:c.fullPath},p=jMe(r,e.host,e._protocol),U="POST",b=e.maxUploadRetryTime,y=new Eke(p,U,_ke(e,n),b);return y.urlParams=m,y.headers=o,y.body=h.uploadData(),y.errorHandler=wke(t),y}class Cke{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=vu.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=vu.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=vu.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,s){if(this.sent_)throw e1("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),s!==void 0)for(const r in s)s.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,s[r].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw e1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw e1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw e1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw e1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class xke extends Cke{initXhr(){this.xhr_.responseType="text"}}function Ake(){return new xke}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(t,n){this._service=t,n instanceof hr?this._location=n:this._location=hr.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Wu(t,n)}get root(){const t=new hr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return qq(this._location.path)}get storage(){return this._service}get parent(){const t=uke(this._location.path);if(t===null)return null;const n=new hr(this._location.bucket,t);return new Wu(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw zMe(t)}}function Mke(e,t,n){e._throwIfRoot("uploadBytes");const i=Ske(e.storage,e._location,mke(),new vc(t,!0),n);return e.storage.makeRequestWithTokens(i,Ake).then(s=>({metadata:s,ref:e}))}function kke(e,t){const n=fke(e._location.path,t),i=new hr(e._location.bucket,n);return new Wu(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rke(e){return/^[A-Za-z]+:\/\//.test(e)}function Dke(e,t){return new Wu(e,t)}function Qq(e,t){if(e instanceof EC){const n=e;if(n._bucket==null)throw OMe();const i=new Wu(n,n._bucket);return t!=null?Qq(i,t):i}else return t!==void 0?kke(e,t):e}function Lke(e,t){if(t&&Rke(t)){if(e instanceof EC)return Dke(e,t);throw Uw("To use ref(service, url), the first argument must be a Storage instance.")}else return Qq(e,t)}function ON(e,t){const n=t==null?void 0:t[Xq];return n==null?null:hr.makeFromBucketSpec(n,e)}function Pke(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:hZ(s,e.app.options.projectId))}class EC{constructor(t,n,i,s,r){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=s,this._firebaseVersion=r,this._bucket=null,this._host=Gq,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=CMe,this._maxUploadRetryTime=xMe,this._requests=new Set,s!=null?this._bucket=hr.makeFromBucketSpec(s,this._host):this._bucket=ON(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=hr.makeFromBucketSpec(this._url,t):this._bucket=ON(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){NN("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){NN("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(yZ(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Wu(this,t)}_makeRequest(t,n,i,s,r=!0){if(this._deleted)return new HMe(jq());{const o=eke(t,this._appId,i,s,n,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,s).getPromise()}}const FN="@firebase/storage",BN="0.13.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jq="storage";function eQ(e,t,n){return e=Lo(e),Mke(e,t,n)}function tQ(e,t){return e=Lo(e),Lke(e,t)}function Nke(e=_Z(),t){e=Lo(e);const i=bZ(e,Jq).getImmediate({identifier:t}),s=uZ("storage");return s&&Oke(i,...s),i}function Oke(e,t,n,i={}){Pke(e,t,n,i)}function Fke(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new EC(n,i,s,t,EZ)}function Bke(){yp(new xg(Jq,Fke,"PUBLIC").setMultipleInstances(!0)),Zc(FN,BN,""),Zc(FN,BN,"esm2017")}Bke();let hy;try{hy=JSON.parse('{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}')}catch{console.warn('Error JSON parsing firebase config. Supplied value: {"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}'),hy={}}let dv=null,uv=null,fv=null;const nQ=()=>(dv||(dv=vZ(hy)),dv),iQ=()=>(uv||(uv=aMe(nQ())),uv),zke=()=>(fv||(fv=Nke(nQ())),fv),sQ=async()=>zke(),Hke=async(e,t)=>{const n=JSON.stringify(t),i=new TextEncoder().encode(n),{encryptedBuffer:s,iv:r}=await NE(e,i);return{ciphertext:s,iv:r}},bw=async(e,t)=>{const n=e.ciphertext.toUint8Array(),i=e.iv.toUint8Array(),s=await dp(i,n,t),r=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(r)},Qd=class Qd{};B(Qd,"cache",new WeakMap),B(Qd,"get",t=>Qd.cache.get(t)),B(Qd,"set",(t,n)=>{Qd.cache.set(t,yc(n))});let xp=Qd;const rQ=(e,t)=>{if(e.socket&&e.roomId&&e.roomKey){const n=yc(t);return xp.get(e.socket)===n}return!0},vC=async({prefix:e,files:t})=>{const n=await sQ(),i=[],s=[];return await Promise.all(t.map(async({id:r,buffer:o})=>{try{const a=tQ(n,`${e}/${r}`);await eQ(a,o,{cacheControl:`public, max-age=${NIe}`}),s.push(r)}catch{i.push(r)}})),{savedFiles:s,erroredFiles:i}},zN=async(e,t)=>{const n=yc(e),{ciphertext:i,iv:s}=await Hke(t,e);return{sceneVersion:n,ciphertext:zl.fromUint8Array(new Uint8Array(i)),iv:zl.fromUint8Array(s)}},Vke=async(e,t,n)=>{const{roomId:i,roomKey:s,socket:r}=e;if(!i||!s||!r||rQ(e,t))return null;const o=iQ(),a=Dq(o,"scenes",i),l=await SMe(o,async d=>{const u=await d.get(a);if(!u.exists()){const U=await zN(t,s);return d.set(a,U),U}const f=u.data(),h=Ac(wr(await bw(f,s),null)),m=Ac(DS(t,h,n)),p=await zN(m,s);return d.update(a,p),p}),c=Ac(wr(await bw(l,s),null));return xp.set(r,c),c},$ke=async(e,t,n)=>{const i=iQ(),s=Dq(i,"scenes",e),r=await vMe(s);if(!r.exists())return null;const o=r.data(),a=Ac(wr(await bw(o,t),null,{deleteInvisibleElements:!0}));return n&&xp.set(n,a),a},oQ=async(e,t,n)=>{const i=[],s=new Map;return await Promise.all([...new Set(n)].map(async r=>{try{const o=`https://firebasestorage.googleapis.com/v0/b/${hy.storageBucket}/o/${encodeURIComponent(e.replace(/^\//,""))}%2F${r}`,a=await fetch(`${o}?alt=media`);if(a.status<400){const l=await a.arrayBuffer(),{data:c,metadata:d}=await kY(new Uint8Array(l),{decryptionKey:t}),u=new TextDecoder().decode(c);i.push({mimeType:d.mimeType||Ee.binary,id:r,dataURL:u,created:(d==null?void 0:d.created)||Date.now(),lastRetrieved:(d==null?void 0:d.created)||Date.now()})}else s.set(r,!0)}catch(o){s.set(r,!0),console.error(o)}})),{loadedFiles:i,erroredFiles:s}},aQ=e=>e.isDeleted?e.updated>Date.now()-PIe:!_l(e),Ac=e=>e.filter(t=>aQ(t)),Gke="https://json.excalidraw.com/api/v2/",Xke="https://json.excalidraw.com/api/v2/post/",jke=async()=>{const e=new Uint8Array(OIe);return window.crypto.getRandomValues(e),Pz(e)},lQ=/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/,HN=e=>{const t=new URL(e).hash;return lQ.test(t)},Yke=e=>{const n=new URL(e).hash.match(lQ);return n&&n[2].length!==22?(window.alert(x("alerts.invalidEncryptionKey")),null):n?{roomId:n[1],roomKey:n[2]}:null},Wke=async()=>{const e=await jke(),t=await GI();if(!t)throw new Error("Couldn't generate room key");return{roomId:e,roomKey:t}},Kke=e=>`${window.location.origin}${window.location.pathname}#room=${e.roomId},${e.roomKey}`,Zke=async({buffer:e,decryptionKey:t})=>{let n;try{const r=e.slice(0,Bb),o=e.slice(Bb,e.byteLength);n=await dp(new Uint8Array(r),o,t)}catch{const o=new Uint8Array(Bb);n=await dp(o,e,t)}const i=new window.TextDecoder("utf-8").decode(new Uint8Array(n)),s=JSON.parse(i);return{elements:s.elements||null,appState:s.appState||null}},qke=async(e,t)=>{try{const n=await fetch(`${Gke}${e}`);if(!n.ok)return window.alert(x("alerts.importBackendFailed")),{};const i=await n.arrayBuffer();try{const{data:s}=await kY(new Uint8Array(i),{decryptionKey:t}),r=JSON.parse(new TextDecoder().decode(s));return{elements:r.elements||null,appState:r.appState||null}}catch(s){return console.warn("error when decoding shareLink data using the new format:",s),Zke({buffer:i,decryptionKey:t})}}catch(n){return window.alert(x("alerts.importBackendFailed")),console.error(n),{}}},Qke=async(e,t,n)=>{const i=await GI("string"),s=await MY(new TextEncoder().encode(im(e,t,n,"database")),{encryptionKey:i});try{const r=new Map;for(const c of e)Jn(c)&&n[c.fileId]&&r.set(c.fileId,n[c.fileId]);const o=await PS({files:r,encryptionKey:i,maxBytes:LS}),l=await(await fetch(Xke,{method:"POST",body:s.buffer})).json();if(l.id){const c=new URL(window.location.href);c.hash=`json=${l.id},${i}`;const d=c.toString();return await vC({prefix:`/files/shareLinks/${l.id}`,files:o}),{url:d,errorMessage:null}}else if(l.error_class==="RequestTooLargeError")return{url:null,errorMessage:x("alerts.couldNotCreateShareableLinkTooBig")};return{url:null,errorMessage:x("alerts.couldNotCreateShareableLink")}}catch(r){return console.error(r),{url:null,errorMessage:x("alerts.couldNotCreateShareableLink")}}};function Jke(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var i=function(){return indexedDB.databases().finally(n)};t=setInterval(i,100),i()}).finally(function(){return clearInterval(t)})}function Ef(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function U8(e,t){const n=Jke().then(()=>{const i=indexedDB.open(e);return i.onupgradeneeded=()=>i.result.createObjectStore(t),Ef(i)});return(i,s)=>n.then(r=>s(r.transaction(t,i).objectStore(t)))}let hv;function cm(){return hv||(hv=U8("keyval-store","keyval")),hv}function cQ(e,t=cm()){return t("readonly",n=>Ef(n.get(e)))}function _C(e,t,n=cm()){return n("readwrite",i=>(i.put(t,e),Ef(i.transaction)))}function eRe(e,t=cm()){return t("readwrite",n=>(e.forEach(i=>n.put(i[1],i[0])),Ef(n.transaction)))}function tRe(e,t=cm()){return t("readonly",n=>Promise.all(e.map(i=>Ef(n.get(i)))))}function nRe(e,t=cm()){return t("readwrite",n=>(n.delete(e),Ef(n.transaction)))}function iRe(e,t){return e("readonly",n=>(n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ef(n.transaction)))}function sRe(e=cm()){const t=[];return iRe(e,n=>t.push([n.key,n.value])).then(()=>t)}class rRe{constructor(){B(this,"locks",new Map);B(this,"lock",t=>{this.locks.set(t,!0)});B(this,"unlock",t=>(this.locks.delete(t),!this.isLocked()))}isLocked(t){return t?this.locks.has(t):!!this.locks.size}}const gy={[Tn.VERSION_DATA_STATE]:-1,[Tn.VERSION_FILES]:-1},VN=e=>JSON.parse(localStorage.getItem(e)||"-1")>gy[e],dQ=e=>{const t=Date.now();try{localStorage.setItem(e,JSON.stringify(t)),gy[e]=t}catch(n){console.error("error while updating browser state verison",n)}},oRe=()=>{try{for(const e of Object.keys(gy))localStorage.setItem(e,JSON.stringify(-1)),gy[e]=-1}catch(e){console.error("error while resetting browser state verison",e)}},y0=U8("files-db","files-store"),qb=Nt(!1);class aRe extends lZ{constructor(){super(...arguments);B(this,"clearObsoleteFiles",async n=>{await sRe(y0).then(i=>{for(const[s,r]of i)(!r.lastRetrieved||Date.now()-r.lastRetrieved>24*3600*1e3)&&!n.currentFileIds.includes(s)&&nRe(s,y0)})})}}const lRe=(e,t)=>{var i;const n=go.get(qb);try{const s=Dj(t);((i=s.openSidebar)==null?void 0:i.name)===Yr.name&&s.openSidebar.tab===pu&&(s.openSidebar=null),localStorage.setItem(Tn.LOCAL_STORAGE_ELEMENTS,JSON.stringify(qt(e))),localStorage.setItem(Tn.LOCAL_STORAGE_APP_STATE,JSON.stringify(s)),dQ(Tn.VERSION_DATA_STATE),n&&go.set(qb,!1)}catch(s){console.error(s),cRe(s)&&!n&&go.set(qb,!0)}},cRe=e=>e instanceof DOMException&&e.name==="QuotaExceededError",Oi=class Oi{};B(Oi,"_save",Al(async(t,n,i,s)=>{lRe(t,n),await Oi.fileStorage.saveFiles({elements:t,files:i}),s()},AIe)),B(Oi,"save",(t,n,i,s)=>{Oi.isSavePaused()||Oi._save(t,n,i,s)}),B(Oi,"flushSave",()=>{Oi._save.flush()}),B(Oi,"locker",new rRe),B(Oi,"pauseSave",t=>{Oi.locker.lock(t)}),B(Oi,"resumeSave",t=>{Oi.locker.unlock(t)}),B(Oi,"isSavePaused",()=>document.hidden||Oi.locker.isLocked()),B(Oi,"fileStorage",new aRe({getFiles(t){return tRe(t,y0).then(async n=>{const i=[],s=new Map,r=[];n.forEach((o,a)=>{const l=t[a];if(o){const c={...o,lastRetrieved:Date.now()};r.push([l,c]),i.push(c)}else s.set(l,!0)});try{eRe(r,y0)}catch(o){console.warn(o)}return{loadedFiles:i,erroredFiles:s}})},async saveFiles({addedFiles:t}){const n=new Map,i=new Map;return dQ(Tn.VERSION_FILES),await Promise.all([...t].map(async([s,r])=>{try{await _C(s,r,y0),n.set(s,r)}catch(o){console.error(o),i.set(s,r)}})),{savedFiles:n,erroredFiles:i}}}));let Hi=Oi;const ao=class ao{static async load(){return await cQ(ao.key,ao.store)||null}static save(t){return _C(ao.key,t,ao.store)}};B(ao,"idb_name",Tn.IDB_LIBRARY),B(ao,"key","libraryData"),B(ao,"store",U8(`${ao.idb_name}-db`,`${ao.idb_name}-store`));let my=ao;class dRe{static load(){const t=localStorage.getItem(Tn.__LEGACY_LOCAL_STORAGE_LIBRARY);if(t!=null){const n=JSON.parse(t);if(n)return{libraryItems:n}}return null}static clear(){localStorage.removeItem(Tn.__LEGACY_LOCAL_STORAGE_LIBRARY)}}const yw=Nt({message:null,nonce:0}),uQ=({collabError:e})=>{const[t,n]=C.useState(!1),i=C.useRef(0);return C.useEffect(()=>(n(!0),i.current=window.setTimeout(()=>{n(!1)},1e3),()=>{window.clearTimeout(i.current)}),[e.message,e.nonce]),e.message?g(Nl,{label:e.message,long:!0,children:g("div",{className:ae("collab-errors-button",{"collab-errors-button-shake":t}),children:lge})}):null};uQ.displayName="CollabError";class uRe{constructor(t){B(this,"collab");B(this,"socket",null);B(this,"socketInitialized",!1);B(this,"roomId",null);B(this,"roomKey",null);B(this,"broadcastedElementVersions",new Map);B(this,"queueFileUpload",na(async()=>{try{await this.collab.fileManager.saveFiles({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),files:this.collab.excalidrawAPI.getFiles()})}catch(i){i.name!=="AbortError"&&this.collab.excalidrawAPI.updateScene({appState:{errorMessage:i.message}})}let t=!1;const n=this.collab.excalidrawAPI.getSceneElementsIncludingDeleted().map(i=>this.collab.fileManager.shouldUpdateImageElementStatus(i)?(t=!0,xe(i,{status:"saved"})):i);t&&this.collab.excalidrawAPI.updateScene({elements:n,captureUpdate:q.NEVER})},kIe));B(this,"broadcastScene",async(t,n,i)=>{if(t===vs.INIT&&!i)throw new Error("syncAll must be true when sending SCENE.INIT");const s=n.reduce((o,a)=>((i||!this.broadcastedElementVersions.has(a.id)||a.version>this.broadcastedElementVersions.get(a.id))&&aQ(a)&&o.push(a),o),[]),r={type:t,payload:{elements:s}};for(const o of s)this.broadcastedElementVersions.set(o.id,o.version);this.queueFileUpload(),await this._broadcastSocketData(r)});B(this,"broadcastIdleChange",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:vs.IDLE_STATUS,payload:{socketId:this.socket.id,userState:t,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});B(this,"broadcastMouseLocation",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:vs.MOUSE_LOCATION,payload:{socketId:this.socket.id,pointer:t.pointer,button:t.button||"up",selectedElementIds:this.collab.excalidrawAPI.getAppState().selectedElementIds,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});B(this,"broadcastVisibleSceneBounds",(t,n)=>{var i;if((i=this.socket)!=null&&i.id){const s={type:vs.USER_VISIBLE_SCENE_BOUNDS,payload:{socketId:this.socket.id,username:this.collab.state.username,sceneBounds:t.sceneBounds}};return this._broadcastSocketData(s,!0,n)}});B(this,"broadcastUserFollowed",t=>{var n;(n=this.socket)!=null&&n.id&&this.socket.emit(jb.USER_FOLLOW_CHANGE,t)});this.collab=t}open(t,n,i){return this.socket=t,this.roomId=n,this.roomKey=i,this.socket.on("init-room",()=>{this.socket&&(this.socket.emit("join-room",this.roomId),at("share","room joined"))}),this.socket.on("new-user",async s=>{this.broadcastScene(vs.INIT,this.collab.getSceneElementsIncludingDeleted(),!0)}),this.socket.on("room-user-change",s=>{this.collab.setCollaborators(s)}),t}close(){this.socket&&(this.queueFileUpload.flush(),this.socket.close(),this.socket=null,this.roomId=null,this.roomKey=null,this.socketInitialized=!1,this.broadcastedElementVersions=new Map)}isOpen(){return!!(this.socketInitialized&&this.socket&&this.roomId&&this.roomKey)}async _broadcastSocketData(t,n=!1,i){var s;if(this.isOpen()){const r=JSON.stringify(t),o=new TextEncoder().encode(r),{encryptedBuffer:a,iv:l}=await NE(this.roomKey,o);(s=this.socket)==null||s.emit(n?jb.SERVER_VOLATILE:jb.SERVER,i??this.roomId,a,l)}}}var fRe={};const fQ=Nt(null),Ew=Nt(!1),hQ=Nt(!1),gQ=Nt(null);class hRe extends C.PureComponent{constructor(n){super(n);B(this,"portal");B(this,"fileManager");B(this,"excalidrawAPI");B(this,"activeIntervalId");B(this,"idleTimeoutId");B(this,"socketInitializationTimer");B(this,"lastBroadcastedOrReceivedSceneVersion",-1);B(this,"collaborators",new Map);B(this,"onUmmount",null);B(this,"onOfflineStatusToggle",()=>{go.set(hQ,!window.navigator.onLine)});B(this,"isCollaborating",()=>go.get(Ew));B(this,"setIsCollaborating",n=>{go.set(Ew,n)});B(this,"onUnload",()=>{this.destroySocketClient({isUnload:!0})});B(this,"beforeUnload",hn(n=>{const i=Ac(this.getSceneElementsIncludingDeleted());this.isCollaborating()&&(this.fileManager.shouldPreventUnload(i)||!rQ(this.portal,i))&&(this.saveCollabRoomToFirebase(i),fRe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?R9(n):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))}));B(this,"saveCollabRoomToFirebase",async n=>{n=ua(n);try{const i=await Vke(this.portal,n,this.excalidrawAPI.getAppState());this.resetErrorIndicator(),this.isCollaborating()&&i&&this.handleRemoteSceneUpdate(this._reconcileElements(i))}catch(i){const s=/is longer than.*?bytes/.test(i.message)?x("errors.collabSaveFailed_sizeExceeded"):x("errors.collabSaveFailed");(!this.state.dialogNotifiedErrors[s]||!this.isCollaborating())&&(this.setErrorDialog(s),this.setState({dialogNotifiedErrors:{...this.state.dialogNotifiedErrors,[s]:!0}})),this.isCollaborating()&&this.setErrorIndicator(s),console.error(i)}});B(this,"stopCollaboration",(n=!0)=>{if(this.queueBroadcastAllElements.cancel(),this.queueSaveToFirebase.cancel(),this.loadImageFiles.cancel(),this.resetErrorIndicator(!0),this.saveCollabRoomToFirebase(Ac(this.excalidrawAPI.getSceneElementsIncludingDeleted())),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),!n)Hi.fileStorage.reset(),this.destroySocketClient();else if(window.confirm(x("alerts.collabStopOverridePrompt"))){oRe(),window.history.pushState({},Bc,window.location.origin),this.destroySocketClient(),Hi.fileStorage.reset();const i=this.excalidrawAPI.getSceneElementsIncludingDeleted().map(s=>xt(s)&&s.status==="saved"?xe(s,{status:"pending"}):s);this.excalidrawAPI.updateScene({elements:i,captureUpdate:q.NEVER})}});B(this,"destroySocketClient",n=>{this.lastBroadcastedOrReceivedSceneVersion=-1,this.portal.close(),this.fileManager.reset(),n!=null&&n.isUnload||(this.setIsCollaborating(!1),this.setActiveRoomLink(null),this.collaborators=new Map,this.excalidrawAPI.updateScene({collaborators:this.collaborators}),Hi.resumeSave("collaboration"))});B(this,"fetchImageFilesFromFirebase",async n=>{const i=n.elements.filter(s=>Jn(s)&&!this.fileManager.isFileTracked(s.fileId)&&!s.isDeleted&&(n.forceFetchFiles?s.status!=="pending"||Date.now()-s.updated>1e4:s.status==="saved")).map(s=>s.fileId);return await this.fileManager.getFiles(i)});B(this,"decryptPayload",async(n,i,s)=>{try{const r=await dp(n,i,s),o=new TextDecoder("utf-8").decode(new Uint8Array(r));return JSON.parse(o)}catch(r){return window.alert(x("alerts.decryptFailed")),console.error(r),{type:vs.INVALID_RESPONSE}}});B(this,"fallbackInitializationHandler",null);B(this,"startCollaboration",async n=>{if(this.state.username||Ue(()=>import("./random-username.esm-__vdrxyo.js"),__vite__mapDeps([])).then(({getRandomUsername:l})=>{const c=l();this.setUsername(c)}),this.portal.socket)return null;let i,s;n?{roomId:i,roomKey:s}=n:({roomId:i,roomKey:s}=await Wke(),window.history.pushState({},Bc,Kke({roomId:i,roomKey:s})));const r=Fy();this.setIsCollaborating(!0),Hi.pauseSave("collaboration");const{default:o}=await Ue(()=>import("./index-ChGp7972.js"),__vite__mapDeps([])),a=()=>{this.initializeRoom({roomLinkData:n,fetchScene:!0}).then(l=>{r.resolve(l)})};this.fallbackInitializationHandler=a;try{this.portal.socket=this.portal.open(o("https://oss-collab.excalidraw.com",{transports:["websocket","polling"]}),i,s),this.portal.socket.once("connect_error",a)}catch(l){return console.error(l),this.setErrorDialog(l.message),null}if(n)this.excalidrawAPI.resetScene();else{const l=this.excalidrawAPI.getSceneElements().map(c=>xt(c)&&c.status==="saved"?xe(c,{status:"pending"}):c);this.excalidrawAPI.updateScene({elements:l,captureUpdate:q.NEVER}),this.saveCollabRoomToFirebase(Ac(l))}return this.socketInitializationTimer=window.setTimeout(a,MIe),this.portal.socket.on("client-broadcast",async(l,c)=>{var u;if(!this.portal.roomKey)return;const d=await this.decryptPayload(c,l,this.portal.roomKey);switch(d.type){case vs.INVALID_RESPONSE:return;case vs.INIT:{if(!this.portal.socketInitialized){this.initializeRoom({fetchScene:!1});const f=d.payload.elements,h=this._reconcileElements(f);this.handleRemoteSceneUpdate(h),r.resolve({elements:h,scrollToContent:!0})}break}case vs.UPDATE:this.handleRemoteSceneUpdate(this._reconcileElements(d.payload.elements));break;case vs.MOUSE_LOCATION:{const{pointer:f,button:h,username:m,selectedElementIds:p}=d.payload,U=d.payload.socketId||d.payload.socketID;this.updateCollaborator(U,{pointer:f,button:h,selectedElementIds:p,username:m});break}case vs.USER_VISIBLE_SCENE_BOUNDS:{const{sceneBounds:f,socketId:h}=d.payload,m=this.excalidrawAPI.getAppState();if(((u=m.userToFollow)==null?void 0:u.socketId)!==h){console.warn(`receiving remote client's (from ${h}) viewport bounds even though we're not subscribed to it!`);return}if(m.userToFollow&&m.followedBy.has(m.userToFollow.socketId))return;this.excalidrawAPI.updateScene({appState:Bj({appState:m,bounds:f,fitToViewport:!0,viewportZoomFactor:1}).appState});break}case vs.IDLE_STATUS:{const{userState:f,socketId:h,username:m}=d.payload;this.updateCollaborator(h,{userState:f,username:m});break}default:Ua(d,null)}}),this.portal.socket.on("first-in-room",async()=>{this.portal.socket&&this.portal.socket.off("first-in-room");const l=await this.initializeRoom({fetchScene:!0,roomLinkData:n});r.resolve(l)}),this.portal.socket.on(jb.USER_FOLLOW_ROOM_CHANGE,l=>{this.excalidrawAPI.updateScene({appState:{followedBy:new Set(l)}}),this.relayVisibleSceneBounds({force:!0})}),this.initializeIdleDetector(),this.setActiveRoomLink(window.location.href),r});B(this,"initializeRoom",async({fetchScene:n,roomLinkData:i})=>{if(clearTimeout(this.socketInitializationTimer),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),n&&i&&this.portal.socket){this.excalidrawAPI.resetScene();try{const s=await $ke(i.roomId,i.roomKey,this.portal.socket);if(s)return this.setLastBroadcastedOrReceivedSceneVersion(yc(s)),{elements:s,scrollToContent:!0}}catch(s){console.error(s)}finally{this.portal.socketInitialized=!0}}else this.portal.socketInitialized=!0;return null});B(this,"_reconcileElements",n=>{const i=this.excalidrawAPI.getAppState(),s=this.getSceneElementsIncludingDeleted();n=wr(n,s);let r=DS(s,n,i);return r=$Y(r,s),this.setLastBroadcastedOrReceivedSceneVersion(yc(r)),r});B(this,"loadImageFiles",na(async()=>{const{loadedFiles:n,erroredFiles:i}=await this.fetchImageFilesFromFirebase({elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()});this.excalidrawAPI.addFiles(n),I1({excalidrawAPI:this.excalidrawAPI,erroredFiles:i,elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()})},RIe));B(this,"handleRemoteSceneUpdate",n=>{this.excalidrawAPI.updateScene({elements:n,captureUpdate:q.NEVER}),this.loadImageFiles()});B(this,"onPointerMove",()=>{this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.idleTimeoutId=window.setTimeout(this.reportIdle,JA),this.activeIntervalId||(this.activeIntervalId=window.setInterval(this.reportActive,eM))});B(this,"onVisibilityChange",()=>{document.hidden?(this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.onIdleStateChange(tu.AWAY)):(this.idleTimeoutId=window.setTimeout(this.reportIdle,JA),this.activeIntervalId=window.setInterval(this.reportActive,eM),this.onIdleStateChange(tu.ACTIVE))});B(this,"reportIdle",()=>{this.onIdleStateChange(tu.IDLE),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null)});B(this,"reportActive",()=>{this.onIdleStateChange(tu.ACTIVE)});B(this,"initializeIdleDetector",()=>{document.addEventListener(te.POINTER_MOVE,this.onPointerMove),document.addEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange)});B(this,"updateCollaborator",(n,i)=>{var o;const s=new Map(this.collaborators),r=Object.assign({},s.get(n),i,{isCurrentUser:n===((o=this.portal.socket)==null?void 0:o.id)});s.set(n,r),this.collaborators=s,this.excalidrawAPI.updateScene({collaborators:s})});B(this,"setLastBroadcastedOrReceivedSceneVersion",n=>{this.lastBroadcastedOrReceivedSceneVersion=n});B(this,"getLastBroadcastedOrReceivedSceneVersion",()=>this.lastBroadcastedOrReceivedSceneVersion);B(this,"getSceneElementsIncludingDeleted",()=>this.excalidrawAPI.getSceneElementsIncludingDeleted());B(this,"onPointerUpdate",na(n=>{n.pointersMap.size<2&&this.portal.socket&&this.portal.broadcastMouseLocation(n)},LIe));B(this,"relayVisibleSceneBounds",n=>{const i=this.excalidrawAPI.getAppState();this.portal.socket&&(i.followedBy.size>0||n!=null&&n.force)&&this.portal.broadcastVisibleSceneBounds({sceneBounds:SV(i)},`follow@${this.portal.socket.id}`)});B(this,"onIdleStateChange",n=>{this.portal.broadcastIdleChange(n)});B(this,"broadcastElements",n=>{yc(n)>this.getLastBroadcastedOrReceivedSceneVersion()&&(this.portal.broadcastScene(vs.UPDATE,n,!1),this.lastBroadcastedOrReceivedSceneVersion=yc(n),this.queueBroadcastAllElements())});B(this,"syncElements",n=>{this.broadcastElements(n),this.queueSaveToFirebase()});B(this,"queueBroadcastAllElements",na(()=>{this.portal.broadcastScene(vs.UPDATE,this.excalidrawAPI.getSceneElementsIncludingDeleted(),!0);const n=this.getLastBroadcastedOrReceivedSceneVersion(),i=Math.max(n,yc(this.getSceneElementsIncludingDeleted()));this.setLastBroadcastedOrReceivedSceneVersion(i)},CP));B(this,"queueSaveToFirebase",na(()=>{this.portal.socketInitialized&&this.saveCollabRoomToFirebase(Ac(this.excalidrawAPI.getSceneElementsIncludingDeleted()))},CP,{leading:!1}));B(this,"setUsername",n=>{this.setState({username:n}),BIe(n)});B(this,"getUsername",()=>this.state.username);B(this,"setActiveRoomLink",n=>{this.setState({activeRoomLink:n}),go.set(gQ,n)});B(this,"getActiveRoomLink",()=>this.state.activeRoomLink);B(this,"setErrorIndicator",n=>{go.set(yw,{message:n,nonce:Date.now()})});B(this,"resetErrorIndicator",(n=!1)=>{go.set(yw,{message:null,nonce:0}),n&&this.setState({dialogNotifiedErrors:{}})});B(this,"setErrorDialog",n=>{this.setState({errorMessage:n})});this.state={errorMessage:null,dialogNotifiedErrors:{},username:rZ()||"",activeRoomLink:null},this.portal=new uRe(this),this.fileManager=new lZ({getFiles:async i=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new yg;return oQ(`files/rooms/${s}`,r,i)},saveFiles:async({addedFiles:i})=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new yg;const{savedFiles:o,erroredFiles:a}=await vC({prefix:`${sZ.collabFiles}/${s}`,files:await PS({files:i,encryptionKey:r,maxBytes:LS})});return{savedFiles:o.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map),erroredFiles:a.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map)}}}),this.excalidrawAPI=n.excalidrawAPI,this.activeIntervalId=null,this.idleTimeoutId=null}componentDidMount(){window.addEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.addEventListener("online",this.onOfflineStatusToggle),window.addEventListener("offline",this.onOfflineStatusToggle),window.addEventListener(te.UNLOAD,this.onUnload);const n=this.excalidrawAPI.onUserFollow(o=>{this.portal.socket&&this.portal.broadcastUserFollowed(o)}),i=jp(this.relayVisibleSceneBounds),s=this.excalidrawAPI.onScrollChange(()=>i());this.onUmmount=()=>{n(),s()},this.onOfflineStatusToggle();const r={isCollaborating:this.isCollaborating,onPointerUpdate:this.onPointerUpdate,startCollaboration:this.startCollaboration,syncElements:this.syncElements,fetchImageFilesFromFirebase:this.fetchImageFilesFromFirebase,stopCollaboration:this.stopCollaboration,setUsername:this.setUsername,getUsername:this.getUsername,getActiveRoomLink:this.getActiveRoomLink,setCollabError:this.setErrorDialog};go.set(fQ,r)}componentWillUnmount(){var n;window.removeEventListener("online",this.onOfflineStatusToggle),window.removeEventListener("offline",this.onOfflineStatusToggle),window.removeEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.removeEventListener(te.UNLOAD,this.onUnload),window.removeEventListener(te.POINTER_MOVE,this.onPointerMove),window.removeEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),(n=this.onUmmount)==null||n.call(this)}setCollaborators(n){var s;const i=new Map;for(const r of n)i.set(r,Object.assign({},this.collaborators.get(r),{isCurrentUser:r===((s=this.portal.socket)==null?void 0:s.id)}));this.collaborators=i,this.excalidrawAPI.updateScene({collaborators:i})}render(){const{errorMessage:n}=this.state;return g(fe,{children:n!=null&&g(gS,{onClose:()=>this.setErrorDialog(null),children:n})})}}const gRe=(e,t,n,i)=>{e.save(),e.strokeStyle=i,e.beginPath(),e.moveTo(n[0][0]*t,n[0][1]*t),e.lineTo(n[1][0]*t,n[1][1]*t),e.stroke(),e.restore()},mRe=(e,t,[n,i,s,r],o)=>{e.save(),e.strokeStyle=o,e.beginPath(),e.moveTo(n[0]*t,n[1]*t),e.bezierCurveTo(i[0]*t,i[1]*t,s[0]*t,s[1]*t,r[0]*t,r[1]*t),e.stroke(),e.restore()},pRe=(e,t,n,i)=>{const{points:s,fill:r,close:o}=n;if(!(s.length<2)){e.save(),e.beginPath(),e.moveTo(s[0][0]*t,s[0][1]*t);for(let a=1;a<s.length;a+=1)e.lineTo(s[a][0]*t,s[a][1]*t);o!==!1&&e.closePath(),r&&(e.save(),e.globalAlpha=.15,e.fillStyle=i,e.fill(),e.restore()),e.strokeStyle=i,e.stroke(),e.restore()}},URe=e=>e.type==="polygon",bRe=(e,t)=>{e.strokeStyle="#888",e.save(),e.beginPath(),e.moveTo(-10*t,-10*t),e.lineTo(10*t,10*t),e.moveTo(10*t,-10*t),e.lineTo(-10*t,10*t),e.stroke(),e.save()},$N=(e,t,n,i,s,r,o)=>{if(!t.fixedPoint){console.warn("Binding must have a fixedPoint");return}const a=n.get(t.elementId),[l,c]=Ss(t.fixedPoint,a,n);e.save(),e.strokeStyle=o,e.lineWidth=1,e.beginPath(),e.moveTo(l*i,c*i),e.bezierCurveTo(l*i-s,c*i-r,l*i-s,c*i+r,l*i,c*i),e.stroke(),e.restore()},GN=(e,t,n,i,s,r,o)=>{const a=n.get(e.elementId);if(!e.fixedPoint){console.warn("Binding must have a fixedPoint");return}const[l,c]=Ss(e.fixedPoint,a,n);t.save(),t.strokeStyle=o,t.lineWidth=1,t.beginPath(),t.moveTo(l*i,c*i),t.bezierCurveTo(l*i+s,c*i+r,l*i+s,c*i-r,l*i,c*i),t.stroke(),t.restore()},yRe=(e,t,n)=>{const i=we(t),s=16;t.forEach(r=>{var o,a,l,c,d,u,f;if(!r.isDeleted){if(Te(r)){if(r.startBinding){if(!((a=(o=i.get(r.startBinding.elementId))==null?void 0:o.boundElements)!=null&&a.find(h=>h.id===r.id)))return;$N(e,r.startBinding,i,n,s,s,((l=r.startBinding)==null?void 0:l.mode)==="orbit"?"red":"black")}if(r.endBinding){if(!((d=(c=i.get(r.endBinding.elementId))==null?void 0:c.boundElements)!=null&&d.find(h=>h.id===r.id)))return;$N(e,r.endBinding,i,n,s,s,((u=r.endBinding)==null?void 0:u.mode)==="orbit"?"red":"black")}}si(r)&&((f=r.boundElements)!=null&&f.length)&&r.boundElements.forEach(h=>{var p,U;if(h.type!=="arrow")return;const m=i.get(h.id);m&&((p=m.startBinding)==null?void 0:p.elementId)===r.id&&GN(m.startBinding,e,i,n,s,s,"green"),m&&((U=m.endBinding)==null?void 0:U.elementId)===r.id&&GN(m.endBinding,e,i,n,s,s,"green")})}})},XN=(e,t,n)=>{e.forEach(i=>{switch(!0){case Pne(i.data):gRe(t,n.zoom.value,i.data,i.color);break;case Ane(i.data):mRe(t,n.zoom.value,i.data,i.color);break;case URe(i.data):pRe(t,n.zoom.value,i.data,i.color);break;default:throw new Error(`Unknown element type ${JSON.stringify(i)}`)}})},ERe=(e,t,n,i)=>{var a,l,c,d;const[s,r]=FE(e,i),o=BE({canvas:e,scale:i,normalizedWidth:s,normalizedHeight:r,viewBackgroundColor:"transparent"});if(o.save(),o.translate(t.scrollX*t.zoom.value,t.scrollY*t.zoom.value),bRe(o,t.zoom.value),yRe(o,n,t.zoom.value),(a=window.visualDebug)!=null&&a.currentFrame&&((l=window.visualDebug)!=null&&l.data)&&window.visualDebug.data.length>0){const[u]=vRe();XN(window.visualDebug.data[u],o,t)}else(c=window.visualDebug)==null||c.data.forEach(u=>{XN(u,o,t)});window.visualDebug&&(window.visualDebug.data=((d=window.visualDebug)==null?void 0:d.data.map(u=>u.filter(f=>f.permanent)))??[])},vRe=()=>{var n,i,s;const e=((n=window.visualDebug)==null?void 0:n.currentFrame)??0,t=((i=window.visualDebug)==null?void 0:i.data.length)??0;return t>0?[e%t,((s=window.visualDebug)==null?void 0:s.currentFrame)??0]:[0,0]},_Re=jp((e,t,n,i)=>{ERe(e,t,n,i)},{trailing:!0}),mQ=()=>{var e;return Array.isArray((e=window.visualDebug)==null?void 0:e.data)},wRe=({onChange:e})=>{const t=C.useCallback(()=>{var r,o;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1))&&(window.visualDebug.currentFrame=0),window.visualDebug.currentFrame+=1,e()},[e]),n=C.useCallback(()=>{var r,o,a;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1)||((a=window.visualDebug)==null?void 0:a.currentFrame)<1)&&(window.visualDebug.currentFrame=1),window.visualDebug.currentFrame-=1,e()},[e]),i=C.useCallback(()=>{window.visualDebug.currentFrame=void 0,e()},[e]),s=C.useCallback(()=>{window.visualDebug&&(window.visualDebug.currentFrame=void 0,window.visualDebug.data=[]),e()},[e]);return P(fe,{children:[g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:s,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Ia})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:n,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(d_,{flip:!0})})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:i,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:lf})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-backward","aria-label":"Move backward",type:"button",onClick:t,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(d_,{})})})]})},TRe=de.forwardRef(({appState:e,scale:t},n)=>{const{width:i,height:s}=e;return g("canvas",{style:{width:i,height:s,position:"absolute",zIndex:2,pointerEvents:"none"},width:i*t,height:s*t,ref:n,children:"Debug Canvas"})}),IRe=()=>{const{t:e}=Ft();return g("a",{className:"encrypted-icon tooltip",href:"https://plus.excalidraw.com/blog/end-to-end-encryption",target:"_blank",rel:"noopener","aria-label":e("encrypted.link"),children:g(Nl,{label:e("encrypted.tooltip"),long:!0,children:mge})})},SRe=de.memo(({onChange:e})=>g(ZK,{children:P("div",{style:{display:"flex",gap:".5rem",alignItems:"center"},children:[mQ()&&g(wRe,{onChange:e}),!ju&&g(IRe,{})]})}));function CRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ap(e){"@babel/helpers - typeof";return Ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ap(e)}function xRe(e,t){if(Ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ap(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ARe(e){var t=xRe(e,"string");return Ap(t)=="symbol"?t:t+""}function MRe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ARe(i.key),i)}}function kRe(e,t,n){return t&&MRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var pQ=[],RRe=pQ.forEach,DRe=pQ.slice;function LRe(e){return RRe.call(DRe.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e}var jN=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,PRe=function(t,n,i){var s=i||{};s.path=s.path||"/";var r=encodeURIComponent(n),o=t+"="+r;if(s.maxAge>0){var a=s.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(s.domain){if(!jN.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!jN.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite){var l=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(l){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},YN={create:function(t,n,i,s){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+i*60*1e3)),s&&(r.domain=s),document.cookie=PRe(t,encodeURIComponent(n),r)},read:function(t){for(var n=t+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var r=i[s];r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null},remove:function(t){this.create(t,"",-1)}},NRe={name:"cookie",lookup:function(t){var n;if(t.lookupCookie&&typeof document<"u"){var i=YN.read(t.lookupCookie);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupCookie&&typeof document<"u"&&YN.create(n.lookupCookie,t,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},ORe={name:"querystring",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));for(var s=i.substring(1),r=s.split("&"),o=0;o<r.length;o++){var a=r[o].indexOf("=");if(a>0){var l=r[o].substring(0,a);l===t.lookupQuerystring&&(n=r[o].substring(a+1))}}}return n}},t1=null,WN=function(){if(t1!==null)return t1;try{t1=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{t1=!1}return t1},FRe={name:"localStorage",lookup:function(t){var n;if(t.lookupLocalStorage&&WN()){var i=window.localStorage.getItem(t.lookupLocalStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupLocalStorage&&WN()&&window.localStorage.setItem(n.lookupLocalStorage,t)}},n1=null,KN=function(){if(n1!==null)return n1;try{n1=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{n1=!1}return n1},BRe={name:"sessionStorage",lookup:function(t){var n;if(t.lookupSessionStorage&&KN()){var i=window.sessionStorage.getItem(t.lookupSessionStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupSessionStorage&&KN()&&window.sessionStorage.setItem(n.lookupSessionStorage,t)}},zRe={name:"navigator",lookup:function(t){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)n.push(navigator.languages[i]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},HRe={name:"htmlTag",lookup:function(t){var n,i=t.htmlTag||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},VRe={name:"path",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof i[t.lookupFromPathIndex]!="string")return;n=i[t.lookupFromPathIndex].replace("/","")}else n=i[0].replace("/","")}return n}},$Re={name:"subdomain",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);i instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?n=i[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=i[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function GRe(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var UQ=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};CRe(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return kRe(e,[{key:"init",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=LRe(i,this.options||{},GRe()),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(NRe),this.addDetector(ORe),this.addDetector(FRe),this.addDetector(BRe),this.addDetector(zRe),this.addDetector(HRe),this.addDetector(VRe),this.addDetector($Re)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var i=this;n||(n=this.options.order);var s=[];return n.forEach(function(r){if(i.detectors[r]){var o=i.detectors[r].lookup(i.options);o&&typeof o=="string"&&(o=[o]),o&&(s=s.concat(o))}}),this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}},{key:"cacheUserLanguage",value:function(n,i){var s=this;i||(i=this.options.caches),i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||i.forEach(function(r){s.detectors[r]&&s.detectors[r].cacheUserLanguage(n,s.options)}))}}]),e}();UQ.type="languageDetector";const wC=new UQ;wC.init({languageUtils:{}});const bQ=()=>{var i;const e=wC.detect(),t=Array.isArray(e)?e[0]:e;return(t?(i=sE.find(s=>s.code.startsWith(t)))==null?void 0:i.code:null)||af.code},yQ=Nt(bQ()),XRe=()=>{const[e,t]=bg(yQ);return C.useEffect(()=>{wC.cacheUserLanguage(e)},[e]),[e,t]},jRe=({style:e})=>{const{t,langCode:n}=Ft(),i=zT(yQ);return g("select",{className:"dropdown-select dropdown-select__language",onChange:({target:s})=>i(s.value),value:n,"aria-label":t("buttons.selectLanguage"),style:e,children:sE.map(s=>g("option",{value:s.code,children:s.label},s.code))})},YRe=de.memo(e=>P(Ct,{children:[g(Ct.DefaultItems.LoadScene,{}),g(Ct.DefaultItems.SaveToActiveFile,{}),g(Ct.DefaultItems.Export,{}),g(Ct.DefaultItems.SaveAsImage,{}),e.isCollabEnabled&&g(Ct.DefaultItems.LiveCollaborationTrigger,{isCollaborating:e.isCollaborating,onSelect:()=>e.onCollabDialogOpen()}),g(Ct.DefaultItems.CommandPalette,{className:"highlighted"}),g(Ct.DefaultItems.SearchMenu,{}),g(Ct.DefaultItems.Help,{}),g(Ct.DefaultItems.ClearCanvas,{}),g(Ct.Separator,{}),g(Ct.ItemLink,{icon:o_,href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=hamburger",className:"",children:"Excalidraw+"}),g(Ct.DefaultItems.Socials,{}),g(Ct.ItemLink,{icon:bG,href:`https://app.excalidraw.com${ju?"":"/sign-up"}?utm_source=signin&utm_medium=app&utm_content=hamburger`,className:"highlighted",children:ju?"Sign in":"Sign up"}),D9(),g(Ct.Separator,{}),g(Ct.DefaultItems.Preferences,{}),g(Ct.DefaultItems.ToggleTheme,{allowSystemTheme:!0,theme:e.theme,onSelect:e.setTheme}),g(Ct.ItemCustom,{children:g(jRe,{style:{width:"100%"}})}),g(Ct.DefaultItems.ChangeCanvasBackground,{})]})),WRe=de.memo(e=>{const{t}=Ft();let n;return ju?n=t("welcomeScreen.app.center_heading_plus").split(/(Excalidraw\+)/).map((i,s)=>i==="Excalidraw+"?g("a",{style:{pointerEvents:Gd.inheritFromUI},href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenSignedInUser",children:"Excalidraw+"},s):i):n=P(fe,{children:[t("welcomeScreen.app.center_heading"),g("br",{}),t("welcomeScreen.app.center_heading_line2"),g("br",{}),t("welcomeScreen.app.center_heading_line3")]}),P(ys,{children:[g(ys.Hints.MenuHint,{children:t("welcomeScreen.app.menuHint")}),g(ys.Hints.ToolbarHint,{}),g(ys.Hints.HelpHint,{}),P(ys.Center,{children:[g(ys.Center.Logo,{}),g(ys.Center.Heading,{children:n}),P(ys.Center.Menu,{children:[g(ys.Center.MenuItemLoadScene,{}),g(ys.Center.MenuItemHelp,{}),e.isCollabEnabled&&g(ys.Center.MenuItemLiveCollaborationTrigger,{onSelect:()=>e.onCollabDialogOpen()}),!ju&&g(ys.Center.MenuItemLink,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenGuest",shortcut:null,icon:bG,children:"Sign up"})]})]})]})}),vw=async(e,t,n,i)=>{const s=await sQ(),r=`${Mz(12)}`,o=await GI(),a=await NE(o,im(e,t,n,"database")),l=new Blob([a.iv,new Uint8Array(a.encryptedBuffer)],{type:Ee.binary}),c=tQ(s,`/migrations/scenes/${r}`);await eQ(c,l,{customMetadata:{data:JSON.stringify({version:2,name:i}),created:Date.now().toString()}});const d=new Map;for(const u of e)Jn(u)&&n[u.fileId]&&d.set(u.fileId,n[u.fileId]);if(d.size){const u=await PS({files:d,encryptionKey:o,maxBytes:LS});await vC({prefix:`/migrations/files/scenes/${r}`,files:u})}window.open(`https://app.excalidraw.com/import?excalidraw=${r},${o}`)},KRe=({elements:e,appState:t,files:n,name:i,onError:s,onSuccess:r})=>{const{t:o}=Ft();return P(K_,{color:"primary",children:[g("div",{className:"Card-icon",children:g(QK,{style:{"--color-logo-icon":"#fff",width:"2.8rem",height:"2.8rem"}})}),g("h2",{children:"Excalidraw+"}),g("div",{className:"Card-details",children:o("exportDialog.excalidrawplus_description")}),g(qe,{className:"Card-button",type:"button",title:o("exportDialog.excalidrawplus_button"),"aria-label":o("exportDialog.excalidrawplus_button"),showAriaLabel:!0,onClick:async()=>{try{at("export","eplus",`ui (${Yp()})`),await vw(e,t,n,i),r()}catch(a){console.error(a),a.name!=="AbortError"&&s(new Error(o("exportDialog.excalidrawplus_exportError")))}}})]})};class ZRe extends de.Component{constructor(){super(...arguments);B(this,"state",{hasError:!1,sentryEventId:"",localStorage:""})}render(){return this.state.hasError?this.errorSplash():this.props.children}componentDidCatch(n,i){const s={};for(const[r,o]of Object.entries({...localStorage}))try{s[r]=JSON.parse(o)}catch{s[r]=o}$9(r=>{r.setExtras(i);const o=Y9(n);this.setState(a=>({hasError:!0,sentryEventId:o,localStorage:JSON.stringify(s)}))})}selectTextArea(n){n.target!==document.activeElement&&(n.preventDefault(),n.target.select())}async createGithubIssue(){let n="";try{const i=(await Ue(()=>import("./bug-issue-template-BID_ABWq.js"),__vite__mapDeps([]))).default;n=encodeURIComponent(i(this.state.sentryEventId))}catch(i){console.error(i)}window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${n}`,"_blank","noopener noreferrer")}errorSplash(){return g("div",{className:"ErrorSplash excalidraw",children:P("div",{className:"ErrorSplash-messageContainer",children:[g("div",{className:"ErrorSplash-paragraph bigger align-center",children:g(Hs,{i18nKey:"errorSplash.headingMain",button:n=>g("button",{onClick:()=>window.location.reload(),children:n})})}),P("div",{className:"ErrorSplash-paragraph align-center",children:[g(Hs,{i18nKey:"errorSplash.clearCanvasMessage",button:n=>g("button",{onClick:()=>{try{localStorage.clear(),window.location.reload()}catch(i){console.error(i)}},children:n})}),g("br",{}),P("div",{className:"smaller",children:[g("span",{role:"img","aria-label":"warning",children:""}),x("errorSplash.clearCanvasCaveat"),g("span",{role:"img","aria-hidden":"true",children:""})]})]}),P("div",{children:[g("div",{className:"ErrorSplash-paragraph",children:x("errorSplash.trackedToSentry",{eventId:this.state.sentryEventId})}),g("div",{className:"ErrorSplash-paragraph",children:g(Hs,{i18nKey:"errorSplash.openIssueMessage",button:n=>g("button",{onClick:()=>this.createGithubIssue(),children:n})})}),g("div",{className:"ErrorSplash-paragraph",children:P("div",{className:"ErrorSplash-details",children:[g("label",{children:x("errorSplash.sceneContent")}),g("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage})]})})]})]})})}}const qRe=({value:e})=>{const[t,n]=C.useState(null),[i,s]=C.useState(!1);return C.useEffect(()=>{let r=!0;return Ue(()=>import("./qrcode.chunk-DRz-_p9I.js"),__vite__mapDeps([])).then(({generateQRCodeSVG:o})=>{if(r)try{n(o(e))}catch{s(!0)}}).catch(()=>{r&&s(!0)}),()=>{r=!1}},[e]),i?null:t?g("div",{className:"ShareDialog__active__qrcode",role:"img","aria-label":"QR code for collaboration link",dangerouslySetInnerHTML:{__html:t}}):g("div",{className:"ShareDialog__active__qrcode ShareDialog__active__qrcode--loading",children:g(Sa,{})})},EQ=Nt({isOpen:!1}),QRe=()=>{const e=window.navigator,t=/Apple/.test(e.vendor),n=e.appVersion.indexOf("Win")!==-1;return t?cge:n?uge:qT},JRe=({collabAPI:e,activeRoomLink:t,handleClose:n})=>{const{t:i}=Ft(),[,s]=C.useState(!1),r=C.useRef(0),o=C.useRef(null),a="share"in navigator,{onCopy:l,copyStatus:c}=mS(),d=async()=>{var f;try{await kd(t)}catch{e.setCollabError(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(f=o.current)==null||f.select()},u=async()=>{try{await navigator.share({title:i("roomDialog.shareTitle"),text:i("roomDialog.shareTitle"),url:t})}catch{}};return P(fe,{children:[g("h3",{className:"ShareDialog__active__header",children:i("labels.liveCollaboration").replace(/\./g,"")}),g(Xu,{defaultValue:e.getUsername(),placeholder:"Your name",label:"Your name",onChange:e.setUsername,onKeyDown:f=>f.key===$.ENTER&&n()}),P("div",{className:"ShareDialog__active__linkRow",children:[g(Xu,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:t}),a&&g($s,{size:"large",variant:"icon",label:"Share",icon:QRe(),className:"ShareDialog__active__share",onClick:u}),g($s,{size:"large",label:i("buttons.copyLink"),icon:f2,status:c,onClick:()=>{d(),l()}})]}),g(qRe,{value:t}),P("div",{className:"ShareDialog__active__description",children:[P("p",{children:[P("span",{role:"img","aria-hidden":"true",className:"ShareDialog__active__description__emoji",children:[""," "]}),i("roomDialog.desc_privacy")]}),g("p",{children:i("roomDialog.desc_exitSession")})]}),g("div",{className:"ShareDialog__active__actions",children:g($s,{size:"large",variant:"outlined",color:"danger",label:i("roomDialog.button_stopSession"),icon:tme,onClick:()=>{at("share","room closed"),e.stopCollaboration(),e.isCollaborating()||n()}})})]})},eDe=e=>{const{t}=Ft(),{collabAPI:n}=e,i=n?P(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("labels.liveCollaboration").replace(/\./g,"")}),P("div",{className:"ShareDialog__picker__description",children:[g("div",{style:{marginBottom:"1em"},children:t("roomDialog.desc_intro")}),t("roomDialog.desc_privacy")]}),g("div",{className:"ShareDialog__picker__button",children:g($s,{size:"large",label:t("roomDialog.button_startSession"),icon:eme,onClick:()=>{at("share","room creation",`ui (${Yp()})`),n.startCollaboration(null)}})}),e.type==="share"&&g("div",{className:"ShareDialog__separator",children:g("span",{children:t("shareDialog.or")})})]}):null;return P(fe,{children:[i,e.type==="share"&&P(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("exportDialog.link_title")}),g("div",{className:"ShareDialog__picker__description",children:t("exportDialog.link_details")}),g("div",{className:"ShareDialog__picker__button",children:g($s,{size:"large",label:t("exportDialog.link_button"),icon:m5,onClick:async()=>{await e.onExportToBackend(),e.handleClose()}})})]})]})},tDe=e=>{const t=Oh(gQ);return g(Tr,{size:"small",onCloseRequest:e.handleClose,title:!1,children:g("div",{className:"ShareDialog",children:e.collabAPI&&t?g(JRe,{collabAPI:e.collabAPI,activeRoomLink:t,handleClose:e.handleClose}):g(eDe,{...e})})})},nDe=e=>{const[t,n]=bg(EQ),{openDialog:i}=Qt();return C.useEffect(()=>{i&&n({isOpen:!1})},[i,n]),t.isOpen?g(tDe,{handleClose:()=>n({isOpen:!1}),collabAPI:e.collabAPI,onExportToBackend:e.onExportToBackend,type:t.type}):null},ZN=()=>{var e;return(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-color-scheme: dark)")},iDe=()=>{const[e,t]=C.useState(()=>localStorage.getItem(Tn.LOCAL_STORAGE_THEME)||be.LIGHT),[n,i]=C.useState(be.LIGHT);return C.useEffect(()=>{const s=ZN(),r=a=>{i(a.matches?be.DARK:be.LIGHT)};e==="system"&&(s==null||s.addEventListener("change",r));const o=a=>{!a[$.CTRL_OR_CMD]&&a.altKey&&a.shiftKey&&a.code===ut.D&&(a.preventDefault(),a.stopImmediatePropagation(),t(n===be.DARK?be.LIGHT:be.DARK))};return document.addEventListener(te.KEYDOWN,o,{capture:!0}),()=>{s==null||s.removeEventListener("change",r),document.removeEventListener(te.KEYDOWN,o,{capture:!0})}},[e,n,t]),C.useLayoutEffect(()=>{var s;localStorage.setItem(Tn.LOCAL_STORAGE_THEME,e),i(e==="system"?(s=ZN())!=null&&s.matches?be.DARK:be.LIGHT:e)},[e]),{editorTheme:n,appTheme:e,setAppTheme:t}},lo=class lo{static async loadChats(){try{return await cQ(lo.key,lo.store)||[]}catch(t){return console.warn("Failed to load TTD chats from IndexedDB:",t),[]}}static async saveChats(t){try{await _C(lo.key,t,lo.store)}catch(n){throw console.warn("Failed to save TTD chats to IndexedDB:",n),n}}};B(lo,"idb_name",Tn.IDB_TTD_CHATS),B(lo,"key","ttdChats"),B(lo,"store",U8(`${lo.idb_name}-db`,`${lo.idb_name}-store`));let _w=lo;const sDe=({excalidrawAPI:e})=>P(fe,{children:[g(IIe,{generate:async({frame:t,children:n})=>{const i=e.getAppState(),s=await r4e({elements:n,appState:{...i,exportBackground:!0,viewBackgroundColor:i.viewBackgroundColor},exportingFrame:t,files:e.getFiles(),mimeType:Ee.jpg}),r=await KY(s),o=oT(n),a=await fetch("https://oss-ai.excalidraw.com/v1/ai/diagram-to-code/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({texts:o,image:r,theme:i.theme})});if(!a.ok){const l=await a.text(),c=ase(l);if(!c)throw new Error(l);if(c.statusCode===429)return{html:`<html>
                <body style="margin: 0; text-align: center">
                <div style="display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; padding: 0 60px">
                  <div style="color:red">Too many requests today,</br>please try again tomorrow!</div>
                  </br>
                  </br>
                  <div>You can also try <a href="https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=d2c" target="_blank" rel="noopener">Excalidraw+</a> to get more requests.</div>
                </div>
                </body>
                </html>`};throw new Error(c.message||l)}try{const{html:l}=await a.json();if(!l)throw new Error("Generation failed (invalid response)");return{html:l}}catch{throw new Error("Generation failed (invalid response)")}}}),g(fS,{onTextSubmit:async t=>{const{onChunk:n,onStreamCreated:i,signal:s,messages:r}=t;return await TIe({url:"https://oss-ai.excalidraw.com/v1/ai/text-to-diagram/chat-streaming",messages:r,onChunk:n,onStreamCreated:i,extractRateLimits:!0,signal:s})},persistenceAdapter:_w})]}),rDe="REQUEST_SCENE",rb="https://app.excalidraw.com",oDe=async({rawElementsString:e,rawAppStateString:t})=>{if(!e||!t)throw new vo("Elements or appstate is missing.");try{const n=JSON.parse(e);if(!n.length)throw new vo("Scene is empty, nothing to export.");const i=JSON.parse(t),s=n.reduce((o,a)=>("fileId"in a&&a.fileId&&o.push(a.fileId),o),[]),r=await Hi.fileStorage.getFiles(s);return{type:"SCENE_DATA",elements:n,appState:i,files:r}}catch(n){throw n instanceof vo?n:new vo("Failed to parse scene data.")}},aDe=async({token:e,publicKey:t})=>{try{const[n,i,s]=e.split(".");if(!n||!i||!s)throw new vo("Invalid JWT format");const r=tL(i),o=tL(s),a=`${n}.${i}`,l=Uint8Array.from(o,p=>p.charCodeAt(0)),c=t.replace(/-----\w+ PUBLIC KEY-----/g,""),d=Uint8Array.from(atob(c),p=>p.charCodeAt(0)),u=await crypto.subtle.importKey("spki",d,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!0,["verify"]);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",u,l,new TextEncoder().encode(a)))throw new Error("Invalid JWT");const h=JSON.parse(r),m=Math.floor(Date.now()/1e3);if(h.exp&&h.exp<m)throw new Error("JWT has expired")}catch(n){throw console.error("Failed to verify JWT:",n),new Error(n instanceof Error?n.message:"Invalid JWT")}},lDe=()=>{const e=C.useRef(!1);return C.useLayoutEffect(()=>{const t=async n=>{if(n.origin!==rb)throw new vo("Invalid origin");if(n.data.type===rDe){if(!n.data.jwt)throw new vo("JWT is missing");try{try{await aDe({token:n.data.jwt,publicKey:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`})}catch(s){throw console.error(`Failed to verify JWT: ${s.message}`),new vo("Failed to verify JWT")}const i=await oDe({rawAppStateString:localStorage.getItem(Tn.LOCAL_STORAGE_APP_STATE),rawElementsString:localStorage.getItem(Tn.LOCAL_STORAGE_ELEMENTS)});n.source.postMessage(i,{targetOrigin:rb})}catch(i){const s={type:"ERROR",message:i instanceof vo?i.message:"Failed to export scene data"};n.source.postMessage(s,{targetOrigin:rb})}}};if(window.addEventListener("message",t),!e.current){e.current=!0;const n={type:"READY"};window.parent.postMessage(n,rb)}return()=>{window.removeEventListener("message",t)}},[]),null},cDe=({isSignedIn:e})=>g("a",{href:e?"https://app.excalidraw.com":"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=guestBanner#excalidraw-redirect",target:"_blank",rel:"noopener",className:"plus-banner",children:"Excalidraw+"}),qN=({children:e,href:t})=>g("a",{href:t,target:"_blank",rel:"noopener",className:"link-button",children:g($s,{children:e})}),dDe=()=>{const{theme:e,openSidebar:t}=Qt();return P(X5,{children:[P(X5.TabTriggers,{children:[g(Ns.TabTrigger,{tab:"comments",style:{opacity:(t==null?void 0:t.tab)==="comments"?1:.4},children:kme}),g(Ns.TabTrigger,{tab:"presentation",style:{opacity:(t==null?void 0:t.tab)==="presentation"?1:.4},children:Rme})]}),g(Ns.Tab,{tab:"comments",children:P("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_comments_${e===be.DARK?"dark":"light"}.jpg)`,opacity:.7}}),g("div",{className:"app-sidebar-promo-text",children:"Make comments with Excalidraw+"}),g(qN,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=comments_promo#excalidraw-redirect",children:"Sign up now"})]})}),g(Ns.Tab,{tab:"presentation",className:"px-3",children:P("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_presentations_${e===be.DARK?"dark":"light"}.svg)`,backgroundSize:"60%",opacity:.4}}),g("div",{className:"app-sidebar-promo-text",children:"Create presentations with Excalidraw+"}),g(qN,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=presentations_promo#excalidraw-redirect",children:"Sign up now"})]})})]})};var uDe={};tZ();window.EXCALIDRAW_THROTTLE_RENDER=!0;let Wf=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Wf=e});let vQ=!1;if(window.self!==window.top)try{const e=new URL(document.referrer),t=new URL(window.location.href);e.origin===t.origin&&(vQ=!0)}catch{}const QN={title:x("overwriteConfirm.modal.shareableLink.title"),description:g(Hs,{i18nKey:"overwriteConfirm.modal.shareableLink.description",bold:e=>g("strong",{children:e}),br:()=>g("br",{})}),actionLabel:x("overwriteConfirm.modal.shareableLink.button"),color:"danger"},ww=async e=>{var c,d;const n=new URLSearchParams(window.location.search).get("id"),i=window.location.hash.match(/^#json=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/),s=window.location.hash.match(/^#url=(.*)$/),r=oZ();let o={elements:wr(r==null?void 0:r.elements,null,{repairBindings:!0,deleteInvisibleElements:!0}),appState:Xc(r==null?void 0:r.appState,null)},a=Yke(window.location.href);const l=!!(n||i||a);if(l)if(!o.elements.length||a||await V_(QN)){if(i){const u=await qke(i[1],i[2]);o={elements:$Y(wr(u.elements,null,{repairBindings:!0,deleteInvisibleElements:!0}),r==null?void 0:r.elements),appState:Xc(u.appState,r==null?void 0:r.appState)}}o.scrollToContent=!0,a||window.history.replaceState({},Bc,window.location.origin)}else{if(document.hidden)return new Promise((u,f)=>{window.addEventListener("focus",()=>ww(e).then(u).catch(f),{once:!0})});a=null,window.history.replaceState({},Bc,window.location.origin)}else if(s){window.history.replaceState({},Bc,window.location.origin);const u=s[1];try{const f=await fetch(window.decodeURIComponent(u)),h=await ZI(await f.blob(),null,null);if(!o.elements.length||await V_(QN))return{scene:h,isExternalScene:l}}catch{return{scene:{appState:{errorMessage:x("alerts.invalidSceneUrl")}},isExternalScene:l}}}if(a&&e.collabAPI){const{excalidrawAPI:u}=e,f=await e.collabAPI.startCollaboration(a);return{scene:{...f,appState:{...Xc({...f==null?void 0:f.appState,theme:((c=r==null?void 0:r.appState)==null?void 0:c.theme)||((d=f==null?void 0:f.appState)==null?void 0:d.theme)},u.getAppState()),isLoading:!1},elements:DS((f==null?void 0:f.elements)||[],u.getSceneElementsIncludingDeleted(),u.getAppState())},isExternalScene:!0,id:a.roomId,key:a.roomKey}}else if(o)return l&&i?{scene:o,isExternalScene:l,id:i[1],key:i[2]}:{scene:o,isExternalScene:!1};return{scene:null,isExternalScene:!1}},fDe=()=>{const[e,t]=C.useState(""),n=ise(),{editorTheme:i,appTheme:s,setAppTheme:r}=iDe(),[o,a]=XRe(),l=Nn(),c=C.useRef({promise:null});c.current.promise||(c.current.promise=Fy());const d=C.useRef(null);C.useEffect(()=>{at("load","frame",Yp()),setTimeout(()=>{at("load","version",g4())},cie)},[]);const[u,f]=EW(),[,h]=bg(EQ),[m]=bg(fQ),[p]=$Ie(Ew,()=>HN(window.location.href)),U=Oh(yw);u4e({excalidrawAPI:u,adapter:my,migrationAdapter:dRe});const[,b]=C.useState(!1);C.useEffect(()=>{},[u]),C.useEffect(()=>{if(!u||!n&&!m)return;const N=(O,z=!1)=>{var H;if(O.scene)if(m!=null&&m.isCollaborating())O.scene.elements&&m.fetchImageFilesFromFirebase({elements:O.scene.elements,forceFetchFiles:!0}).then(({loadedFiles:X,erroredFiles:Q})=>{u.addFiles(X),I1({excalidrawAPI:u,erroredFiles:Q,elements:u.getSceneElementsIncludingDeleted()})});else{const X=((H=O.scene.elements)==null?void 0:H.reduce((Q,re)=>Jn(re)?Q.concat(re.fileId):Q,[]))||[];O.isExternalScene?oQ(`${sZ.shareLinkFiles}/${O.id}`,O.key,X).then(({loadedFiles:Q,erroredFiles:re})=>{u.addFiles(Q),I1({excalidrawAPI:u,erroredFiles:re,elements:u.getSceneElementsIncludingDeleted()})}):z&&(X.length&&Hi.fileStorage.getFiles(X).then(({loadedFiles:Q,erroredFiles:re})=>{Q.length&&u.addFiles(Q),I1({excalidrawAPI:u,erroredFiles:re,elements:u.getSceneElementsIncludingDeleted()})}),Hi.fileStorage.clearObsoleteFiles({currentFileIds:X}))}};ww({collabAPI:m,excalidrawAPI:u}).then(async O=>{N(O,!0),c.current.promise.resolve(O.scene)});const L=async O=>{O.preventDefault(),N_()||(m!=null&&m.isCollaborating()&&!HN(window.location.href)&&m.stopCollaboration(!1),u.updateScene({appState:{isLoading:!0}}),ww({collabAPI:m,excalidrawAPI:u}).then(H=>{N(H),H.scene&&u.updateScene({elements:wr(H.scene.elements,null,{repairBindings:!0}),appState:Xc(H.scene.appState,null),captureUpdate:q.IMMEDIATELY})}))},j=Al(()=>{if(!document.hidden&&(m&&!m.isCollaborating()||n)){if(VN(Tn.VERSION_DATA_STATE)){const O=oZ(),z=rZ();a(bQ()),u.updateScene({...O,captureUpdate:q.NEVER}),my.load().then(H=>{H&&u.updateLibrary({libraryItems:H.libraryItems})}),m==null||m.setUsername(z||"")}if(VN(Tn.VERSION_FILES)){const O=u.getSceneElementsIncludingDeleted(),z=u.getFiles(),H=(O==null?void 0:O.reduce((X,Q)=>Jn(Q)&&!z[Q.fileId]?X.concat(Q.fileId):X,[]))||[];H.length&&Hi.fileStorage.getFiles(H).then(({loadedFiles:X,erroredFiles:Q})=>{X.length&&u.addFiles(X),I1({excalidrawAPI:u,erroredFiles:Q,elements:u.getSceneElementsIncludingDeleted()})})}}},DIe),Y=()=>{Hi.flushSave()},G=O=>{(O.type===te.BLUR||document.hidden)&&Hi.flushSave(),(O.type===te.VISIBILITY_CHANGE||O.type===te.FOCUS)&&j()};return window.addEventListener(te.HASHCHANGE,L,!1),window.addEventListener(te.UNLOAD,Y,!1),window.addEventListener(te.BLUR,G,!1),document.addEventListener(te.VISIBILITY_CHANGE,G,!1),window.addEventListener(te.FOCUS,G,!1),()=>{window.removeEventListener(te.HASHCHANGE,L,!1),window.removeEventListener(te.UNLOAD,Y,!1),window.removeEventListener(te.BLUR,G,!1),window.removeEventListener(te.FOCUS,G,!1),document.removeEventListener(te.VISIBILITY_CHANGE,G,!1)}},[n,m,u,a]),C.useEffect(()=>{const N=L=>{Hi.flushSave(),u&&Hi.fileStorage.shouldPreventUnload(u.getSceneElements())&&(uDe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?R9(L):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))};return window.addEventListener(te.BEFORE_UNLOAD,N),()=>{window.removeEventListener(te.BEFORE_UNLOAD,N)}},[u]);const y=(N,L,j)=>{m!=null&&m.isCollaborating()&&m.syncElements(N),Hi.isSavePaused()||Hi.save(N,L,j,()=>{if(u){let Y=!1;const G=u.getSceneElementsIncludingDeleted().map(O=>{if(Hi.fileStorage.shouldUpdateImageElementStatus(O)){const z=xe(O,{status:"saved"});return z!==O&&(Y=!0),z}return O});Y&&u.updateScene({elements:G,captureUpdate:q.NEVER})}}),d.current&&u&&_Re(d.current,L,N,window.devicePixelRatio)},[E,_]=C.useState(null),I=async(N,L,j)=>{if(N.length===0)throw new Error(x("alerts.cannotExportEmptyCanvas"));try{const{url:Y,errorMessage:G}=await Qke(N,{...L,viewBackgroundColor:L.exportBackground?L.viewBackgroundColor:Aa().viewBackgroundColor},j);if(G)throw new Error(G);Y&&_(Y)}catch(Y){if(Y.name!=="AbortError"){const{width:G,height:O}=L;throw console.error(Y,{width:G,height:O,devicePixelRatio:window.devicePixelRatio}),new Error(Y.message)}}},k=(N,L)=>g(VIe,{setToast:j=>u.setToast({message:j}),appState:L,elements:N}),w=Oh(hQ),T=Oh(qb),A=C.useCallback(()=>h({isOpen:!0,type:"collaborationOnly"}),[h]);if(vQ)return g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"100%"},children:g("h1",{children:"I'm not a pretzel!"})});const S={label:"Excalidraw+",category:gt.links,predicate:!0,icon:g("div",{style:{width:14},children:o_}),keywords:["plus","cloud","server"],perform:()=>{window.open("https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}},D={label:"Sign up",category:gt.links,predicate:!0,icon:g("div",{style:{width:14},children:o_}),keywords:["excalidraw","plus","cloud","server","signin","login","signup"],perform:()=>{window.open("https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}};return g("div",{style:{height:"100%"},className:ae("excalidraw-app",{"is-collaborating":p}),children:P(iZ,{excalidrawAPI:f,onChange:y,initialData:c.current.promise,isCollaborating:p,onPointerUpdate:m==null?void 0:m.onPointerUpdate,UIOptions:{canvasActions:{toggleTheme:!0,export:{onExportToBackend:I,renderCustomUI:u?(N,L,j)=>g(KRe,{elements:N,appState:L,files:j,name:u.getName(),onError:Y=>{u==null||u.updateScene({appState:{errorMessage:Y.message}})},onSuccess:()=>{u.updateScene({appState:{openDialog:null}})}}):void 0}}},langCode:o,renderCustomStats:k,detectScroll:!1,handleKeyboardGlobally:!0,autoFocus:!0,theme:i,renderTopRightUI:N=>N||!m||n?null:P("div",{className:"excalidraw-ui-top-right",children:[(u==null?void 0:u.getEditorInterface().formFactor)==="desktop"&&g(cDe,{isSignedIn:ju}),U.message&&g(uQ,{collabError:U}),g(qK,{isCollaborating:p,onSelect:()=>h({isOpen:!0,type:"share"}),editorInterface:l})]}),onLinkOpen:(N,L)=>{N.link&&Lh(N.link)&&(L.preventDefault(),u==null||u.scrollToContent(N.link,{animate:!0}))},children:[g(YRe,{onCollabDialogOpen:A,isCollaborating:p,isCollabEnabled:!n,theme:s,setTheme:N=>r(N),refresh:()=>b(N=>!N)}),g(WRe,{onCollabDialogOpen:A,isCollabEnabled:!n}),P(lu,{children:[g(lu.Actions.ExportToImage,{}),g(lu.Actions.SaveToDisk,{}),u&&g(lu.Action,{title:x("overwriteConfirm.action.excalidrawPlus.title"),actionLabel:x("overwriteConfirm.action.excalidrawPlus.button"),onClick:()=>{vw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())},children:x("overwriteConfirm.action.excalidrawPlus.description")})]}),g(SRe,{onChange:()=>u==null?void 0:u.refresh()}),u&&g(sDe,{excalidrawAPI:u}),g(nZ,{}),p&&w&&g("div",{className:"alertalert--warning",children:x("alerts.collabOfflineWarning")}),T&&g("div",{className:"alert alert--danger",children:x("alerts.localStorageQuotaExceeded")}),E&&g(xIe,{link:E,onCloseRequest:()=>_(null),setErrorMessage:t}),u&&!n&&g(hRe,{excalidrawAPI:u}),g(nDe,{collabAPI:m,onExportToBackend:async()=>{if(u)try{await I(u.getSceneElements(),u.getAppState(),u.getFiles())}catch(N){t(N.message)}}}),g(dDe,{}),e&&g(gS,{onClose:()=>t(""),children:e}),g(PL,{customCommandPaletteItems:[{label:x("labels.liveCollaboration"),category:gt.app,keywords:["team","multiplayer","share","public","session","invite"],icon:QT,perform:()=>{h({isOpen:!0,type:"collaborationOnly"})}},{label:x("roomDialog.button_stopSession"),category:gt.app,predicate:()=>!!(m!=null&&m.isCollaborating()),keywords:["stop","session","end","leave","close","exit","collaboration"],perform:()=>{m&&(m.stopCollaboration(),m.isCollaborating()||h({isOpen:!1}))}},{label:x("labels.share"),category:gt.app,predicate:!0,icon:qT,keywords:["link","shareable","readonly","export","publish","snapshot","url","collaborate","invite"],perform:async()=>{h({isOpen:!0,type:"share"})}},{label:"GitHub",icon:KT,category:gt.links,predicate:!0,keywords:["issues","bugs","requests","report","features","social","community"],perform:()=>{window.open("https://github.com/excalidraw/excalidraw","_blank","noopener noreferrer")}},{label:x("labels.followUs"),icon:oG,category:gt.links,predicate:!0,keywords:["twitter","contact","social","community"],perform:()=>{window.open("https://x.com/excalidraw","_blank","noopener noreferrer")}},{label:x("labels.discordChat"),category:gt.links,predicate:!0,icon:rG,keywords:["chat","talk","contact","bugs","requests","report","feedback","suggestions","social","community"],perform:()=>{window.open("https://discord.gg/UexuTaE","_blank","noopener noreferrer")}},{label:"YouTube",icon:yG,category:gt.links,predicate:!0,keywords:["features","tutorials","howto","help","community"],perform:()=>{window.open("https://youtube.com/@excalidraw","_blank","noopener noreferrer")}},...ju?[{...D,label:"Sign in / Go to Excalidraw+"}]:[S,D],{label:x("overwriteConfirm.action.excalidrawPlus.button"),category:gt.export,icon:dge,predicate:!0,keywords:["plus","export","save","backup"],perform:()=>{u&&vw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())}},{...PL.defaultItems.toggleTheme,perform:()=>{r(i===be.DARK?be.LIGHT:be.DARK)}},{label:x("labels.installPWA"),category:gt.app,predicate:()=>!!Wf,perform:()=>{Wf&&(Wf.prompt(),Wf.userChoice.then(()=>{Wf=null}))}}]}),mQ()&&u&&g(TRe,{appState:u.getAppState(),scale:window.devicePixelRatio,ref:d})]})})},hDe=()=>window.location.pathname==="/excalidraw-plus-export"?g(lDe,{}):g(ZRe,{children:g(Dhe,{store:go,children:g(fDe,{})})});window.__EXCALIDRAW_SHA__="3a5ef4020d7515f34c96d179b631911bb8ef8a9f";const gDe=document.getElementById("root"),mDe=Wte.createRoot(gDe);Kte();mDe.render(g(C.StrictMode,{children:g(hDe,{})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/subset-worker.chunk-CVR6pt27.js","assets/subset-shared.chunk-D3ioWSie.js","assets/pica-DDHCQIrT.js","assets/mermaid-to-excalidraw-C2eqzxpF.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=index-HC6utdGa.js.map
